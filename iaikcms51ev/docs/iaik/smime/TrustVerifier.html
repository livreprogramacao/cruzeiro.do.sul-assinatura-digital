<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:15 GMT 2016 -->
<TITLE>
TrustVerifier (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.smime.TrustVerifier class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="TrustVerifier (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/smime/SMimeUtil.html" title="class in iaik.smime"><B>PREV CLASS</B></A>&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/smime/TrustVerifier.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="TrustVerifier.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.smime</FONT>
<BR>
Class TrustVerifier</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.smime.TrustVerifier</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>TrustVerifier</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
A TrustVerifier object keeps track of trusted certificates and verifies
 certificate chains. The class implements a very simple trust verifier 
 (for example, it does not handle X.509v3 extensions and has no kind of 
 revocation checking) that can be replaced by a more advanced one if desired.
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.io.PrintWriter</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#debugWriter_">debugWriter_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writer to which debug information may be written.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.Hashtable</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#trustedCerts_">trustedCerts_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Trust store holding the certificates using IssuerAndSerialNumber as key.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#TrustVerifier()">TrustVerifier</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new TrustVerifier.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#addTrustedCertificate(iaik.x509.X509Certificate)">addTrustedCertificate</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a trusted certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#checkEMail(java.lang.String, iaik.x509.X509Certificate)">checkEMail</A></B>(java.lang.String&nbsp;emailFROM,
           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signer)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if the email given in the From header corresponds to the one
 given in the certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#getCertificates(java.security.Principal)">getCertificates</A></B>(java.security.Principal&nbsp;subjectDN)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all certificates with the given subjectDN.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#getCertificates(java.lang.String)">getCertificates</A></B>(java.lang.String&nbsp;email)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all certificates with the given email address.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.util.Enumeration</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#getEmailAddresses(iaik.x509.X509Certificate)">getEmailAddresses</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the email adresses of the subject in the given certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Enumeration</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#getTrustedCertificates()">getTrustedCertificates</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enumerates the explicitly trusted certificates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#getTrustedIssuerCert(iaik.x509.X509Certificate)">getTrustedIssuerCert</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the issuer certificate of the given certificate (if available in
 the pool of trusted certificates).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#getTrustedIssuerCerts(iaik.x509.X509Certificate)">getTrustedIssuerCerts</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets all issuer certificates of the given certificate (if available in
 the pool of trusted certificates).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#isTrustedCertificate(iaik.x509.X509Certificate)">isTrustedCertificate</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if the given certificate is explicitly trusted.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#removeTrustedCertificate(iaik.x509.X509Certificate)">removeTrustedCertificate</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes a trusted certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#setDebugStream(java.io.OutputStream)">setDebugStream</A></B>(java.io.OutputStream&nbsp;out)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the stream to which debug information shall be printed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#size()">size</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the number of explicitly trusted certificates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#verifyCertificateChain(iaik.x509.X509Certificate[])">verifyCertificateChain</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies a certificate chain.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#verifyCertificateChain(iaik.x509.X509Certificate[], java.lang.String)">verifyCertificateChain</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs,
                       java.lang.String&nbsp;debugID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies a certificate chain.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#verifyChain(iaik.x509.X509Certificate[])">verifyChain</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>Deprecated.</B>&nbsp;<I>use <A HREF="../../iaik/smime/TrustVerifier.html#verifyCertificateChain(iaik.x509.X509Certificate[])"><CODE>verifyCertificateChain</CODE></A> instead</I></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/smime/TrustVerifier.html#verifyChain(iaik.x509.X509Certificate[], java.lang.String)">verifyChain</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs,
            java.lang.String&nbsp;debugID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>Deprecated.</B>&nbsp;<I>use <A HREF="../../iaik/smime/TrustVerifier.html#verifyCertificateChain(iaik.x509.X509Certificate[], java.lang.String)"><CODE>verifyCertificateChain</CODE></A> instead</I></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="trustedCerts_"><!-- --></A><H3>
trustedCerts_</H3>
<PRE>
protected java.util.Hashtable <B>trustedCerts_</B></PRE>
<DL>
<DD>Trust store holding the certificates using IssuerAndSerialNumber as key.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="debugWriter_"><!-- --></A><H3>
debugWriter_</H3>
<PRE>
protected java.io.PrintWriter <B>debugWriter_</B></PRE>
<DL>
<DD>Writer to which debug information may be written.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="TrustVerifier()"><!-- --></A><H3>
TrustVerifier</H3>
<PRE>
public <B>TrustVerifier</B>()</PRE>
<DL>
<DD>Creates a new TrustVerifier. Initially the list of trusted certificates
 is empty.
<P>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="addTrustedCertificate(iaik.x509.X509Certificate)"><!-- --></A><H3>
addTrustedCertificate</H3>
<PRE>
public void <B>addTrustedCertificate</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</PRE>
<DL>
<DD>Adds a trusted certificate.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the trusted certificate to be added.</DL>
</DD>
</DL>
<HR>

<A NAME="removeTrustedCertificate(iaik.x509.X509Certificate)"><!-- --></A><H3>
removeTrustedCertificate</H3>
<PRE>
public boolean <B>removeTrustedCertificate</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</PRE>
<DL>
<DD>Removes a trusted certificate. If the certificate was not trusted
 this method does nothing.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the certificate to be removed from the trust repository
<DT><B>Returns:</B><DD><code>true</code> if the cert successfully has been remove, <code>false</code> otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="size()"><!-- --></A><H3>
size</H3>
<PRE>
public int <B>size</B>()</PRE>
<DL>
<DD>Returns the number of explicitly trusted certificates.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the number of explicitly trusted certificates</DL>
</DD>
</DL>
<HR>

<A NAME="getTrustedCertificates()"><!-- --></A><H3>
getTrustedCertificates</H3>
<PRE>
public java.util.Enumeration <B>getTrustedCertificates</B>()</PRE>
<DL>
<DD>Enumerates the explicitly trusted certificates. 
 The enumeration maybe empty.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the explicitly trusted certificates</DL>
</DD>
</DL>
<HR>

<A NAME="getCertificates(java.security.Principal)"><!-- --></A><H3>
getCertificates</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[] <B>getCertificates</B>(java.security.Principal&nbsp;subjectDN)</PRE>
<DL>
<DD>Returns all certificates with the given subjectDN.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>subjectDN</CODE> - the subjectDN to be searched for
<DT><B>Returns:</B><DD>all certificates with the given subjectDN; the array may be
         empty if no certificate with the subjectDN is included</DL>
</DD>
</DL>
<HR>

<A NAME="getCertificates(java.lang.String)"><!-- --></A><H3>
getCertificates</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[] <B>getCertificates</B>(java.lang.String&nbsp;email)</PRE>
<DL>
<DD>Returns all certificates with the given email address.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>email</CODE> - the email address to be searched for
<DT><B>Returns:</B><DD>all certificates with the given email address; the array may be
         empty if no certificate with the email address is included</DL>
</DD>
</DL>
<HR>

<A NAME="isTrustedCertificate(iaik.x509.X509Certificate)"><!-- --></A><H3>
isTrustedCertificate</H3>
<PRE>
public boolean <B>isTrustedCertificate</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</PRE>
<DL>
<DD>Checks if the given certificate is explicitly trusted.
 <P>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the cert which shall be checked for trust
<DT><B>Returns:</B><DD><code>true</code> if the cert is trusted, <code>false</code> otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="getTrustedIssuerCert(iaik.x509.X509Certificate)"><!-- --></A><H3>
getTrustedIssuerCert</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A> <B>getTrustedIssuerCert</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</PRE>
<DL>
<DD>Gets the issuer certificate of the given certificate (if available in
 the pool of trusted certificates).
 <P>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the cert to be searched for a trusted issuer
<DT><B>Returns:</B><DD>the trusted issuer certificate or <code>null</code> if no trusted issuer cert 
         is in the repository</DL>
</DD>
</DL>
<HR>

<A NAME="getTrustedIssuerCerts(iaik.x509.X509Certificate)"><!-- --></A><H3>
getTrustedIssuerCerts</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[] <B>getTrustedIssuerCerts</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</PRE>
<DL>
<DD>Gets all issuer certificates of the given certificate (if available in
 the pool of trusted certificates).
 <P>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the cert to be searched for trusted issuers
<DT><B>Returns:</B><DD>the trusted issuer certificates; the array may be empty if no trusted 
         issuer certs are in the repository</DL>
</DD>
</DL>
<HR>

<A NAME="verifyChain(iaik.x509.X509Certificate[])"><!-- --></A><H3>
verifyChain</H3>
<PRE>
public boolean <B>verifyChain</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs)</PRE>
<DL>
<DD><B>Deprecated.</B>&nbsp;<I>use <A HREF="../../iaik/smime/TrustVerifier.html#verifyCertificateChain(iaik.x509.X509Certificate[])"><CODE>verifyCertificateChain</CODE></A> instead</I>
<P>
<DD>Verifies a certificate chain. The end entity certificate should be at index
 0 in the array. The chain should either 
 be null, a full certificate chain (up to and including the self signed
 root certificate), or an incomplete certificate chain. 
 <P>
 This implementation does the following in order:
 <OL>
 <LI>If the chain is null, it returns true if null is trusted, otherwise
 false.
 <LI>The chain is verified starting at the user certificate via <CODE>verifyCert()</CODE>.
 If any call returns true it returns true, if any throws an exception it
 returns false.
 <LI>If the previous steps did not cause the method to stop it returns
 true if and only if <CODE>size()</CODE> returns 0, i.e. no certificates are
 trusted at all.
 </OL>
 <P>
 That means invalid certificate chains (signatures that do not verify,
 expired certificates) are never accepted. If trusted certificates are
 set only valid chains containing a trusted certificate are accepted,
 otherwise all valid chains are accepted.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certs</CODE> - the cert chain to be verified
<DT><B>Returns:</B><DD><code>true</code> if the chain verifies up to a trusted certificate or
         the chain verifies and there are no trusted certificates in the pool (all
         is trusted), <code>false</code> otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="verifyChain(iaik.x509.X509Certificate[], java.lang.String)"><!-- --></A><H3>
verifyChain</H3>
<PRE>
public boolean <B>verifyChain</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs,
                           java.lang.String&nbsp;debugID)</PRE>
<DL>
<DD><B>Deprecated.</B>&nbsp;<I>use <A HREF="../../iaik/smime/TrustVerifier.html#verifyCertificateChain(iaik.x509.X509Certificate[], java.lang.String)"><CODE>verifyCertificateChain</CODE></A> instead</I>
<P>
<DD>Verifies a certificate chain. The end entity certificate should be at index
 0 in the array. The chain should either 
 be null, a full certificate chain (up to and including the self signed
 root certificate), or an incomplete certificate chain. 
 <P>
 This implementation does the following in order:
 <OL>
 <LI>If the chain is null, it returns true if null is trusted, otherwise
 false.
 <LI>The chain is verified starting at the user certificate via <CODE>verifyCert()</CODE>.
 If any call returns true it returns true, if any throws an exception it
 returns false.
 <LI>If the previous steps did not cause the method to stop it returns
 true if and only if <CODE>size()</CODE> returns 0, i.e. no certificates are
 trusted at all.
 </OL>
 <P>
 That means invalid certificate chains (signatures that do not verify,
 expired certificates) are never accepted. If trusted certificates are
 set only valid chains containing a trusted certificate are accepted,
 otherwise all valid chains are accepted.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certs</CODE> - the cert chain to be verified<DD><CODE>debugID</CODE> - an ID to may be printed in front of debug messages; may be <code>null</code>
<DT><B>Returns:</B><DD><code>true</code> if the chain verifies up to a trusted certificate or
         the chain verifies and there are no trusted certificates in the pool (all
         is trusted), <code>false</code> otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="verifyCertificateChain(iaik.x509.X509Certificate[])"><!-- --></A><H3>
verifyCertificateChain</H3>
<PRE>
public void <B>verifyCertificateChain</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs)
                            throws java.security.cert.CertificateException</PRE>
<DL>
<DD>Verifies a certificate chain. The end entity certificate should be at index
 0 in the array. The chain should either 
 be null, a full certificate chain (up to and including the self signed
 root certificate), or an incomplete certificate chain. 
 <P>
 This implementation does the following in order:
 <OL>
 <LI>If the chain is null, it returns true if null is trusted, otherwise
 false.
 <LI>The chain is verified starting at the user certificate via <CODE>verifyCert()</CODE>.
 If any call returns true it returns true, if any throws an exception it
 returns false.
 <LI>If the previous steps did not cause the method to stop it returns
 true if and only if <CODE>size()</CODE> returns 0, i.e. no certificates are
 trusted at all.
 </OL>
 <P>
 That means invalid certificate chains (signatures that do not verify,
 expired certificates) are never accepted. If trusted certificates are
 set only valid chains containing a trusted certificate are accepted,
 otherwise all valid chains are accepted.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certs</CODE> - the cert chain to be verified
<DT><B>Throws:</B>
<DD><CODE>java.security.cert.CertificateException</CODE> - if the chain does not verify up to a trusted certificate</DL>
</DD>
</DL>
<HR>

<A NAME="verifyCertificateChain(iaik.x509.X509Certificate[], java.lang.String)"><!-- --></A><H3>
verifyCertificateChain</H3>
<PRE>
public void <B>verifyCertificateChain</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certs,
                                   java.lang.String&nbsp;debugID)
                            throws java.security.cert.CertificateException</PRE>
<DL>
<DD>Verifies a certificate chain. The end entity certificate should be at index
 0 in the array. The chain should either 
 be null, a full certificate chain (up to and including the self signed
 root certificate), or an incomplete certificate chain. 
 <P>
 This implementation does the following in order:
 <OL>
 <LI>If the chain is null, it returns true if null is trusted, otherwise
 false.
 <LI>The chain is verified starting at the user certificate via <CODE>verifyCert()</CODE>.
 If any call returns true it returns true, if any throws an exception it
 returns false.
 <LI>If the previous steps did not cause the method to stop it returns
 true if and only if <CODE>size()</CODE> returns 0, i.e. no certificates are
 trusted at all.
 </OL>
 <P>
 That means invalid certificate chains (signatures that do not verify,
 expired certificates) are never accepted. If trusted certificates are
 set only valid chains containing a trusted certificate are accepted,
 otherwise all valid chains are accepted.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certs</CODE> - the cert chain to be verified<DD><CODE>debugID</CODE> - an ID to may be printed in front of debug messages; may be <code>null</code>
<DT><B>Throws:</B>
<DD><CODE>java.security.cert.CertificateException</CODE> - if the chain does not verify up to a trusted certificate</DL>
</DD>
</DL>
<HR>

<A NAME="setDebugStream(java.io.OutputStream)"><!-- --></A><H3>
setDebugStream</H3>
<PRE>
public void <B>setDebugStream</B>(java.io.OutputStream&nbsp;out)</PRE>
<DL>
<DD>Sets the stream to which debug information shall be printed.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>out</CODE> - the stream to which debug information shall be written;
               maybe <code>null</code> for disabling debug output</DL>
</DD>
</DL>
<HR>

<A NAME="checkEMail(java.lang.String, iaik.x509.X509Certificate)"><!-- --></A><H3>
checkEMail</H3>
<PRE>
public boolean <B>checkEMail</B>(java.lang.String&nbsp;emailFROM,
                          <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signer)</PRE>
<DL>
<DD>Checks if the email given in the From header corresponds to the one
 given in the certificate.
 This method performs the following checks:
 <ol>
 <li>If there is the email given in the subjectDN of the cert and is equal
     to the email of the From header, this method returns true. If it is not 
     equal this method returns false.
 <li>If there is an email given in the subjectAltName extension of the cert 
     and is equal to the email of the From header, this method returns true. 
     If it is not equal this method returns false.
 <li>If there is neither an email given in the subjectDN field nor in the
     subAltName extension, this method returns true if the cert is a CA cert
     which for S/MIME does not have to contain an email. If the cert is an
     end entity cert and has no email, this method returns false.
 </ol>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>emailFROM</CODE> - the email given in the From header field (the email has to be
                  formatted as an "addr-spec" as defined in RFC 822. An addr-spec
                  has the form "local-part@domain".<DD><CODE>signer</CODE> - the signer certificate
<DT><B>Returns:</B><DD><code>true</code> if this certificate contains an email that matches
         to the From: email, or if the certificate does not contain an email
         but is a CA certificate; <code>false</code> if emails are present
         in the certificate but none of them matches to the From: email, or
         if the certificate is an end entity certificate without an email</DL>
</DD>
</DL>
<HR>

<A NAME="getEmailAddresses(iaik.x509.X509Certificate)"><!-- --></A><H3>
getEmailAddresses</H3>
<PRE>
public static java.util.Enumeration <B>getEmailAddresses</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</PRE>
<DL>
<DD>Returns the email adresses of the subject in the given certificate.
 The method checks also adresses in the subject alternative name extension.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the certificate to be searched for any included email address
<DT><B>Returns:</B><DD>an Enumeration of all email addresses (String objects) contained 
         in the given certificate</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/smime/SMimeUtil.html" title="class in iaik.smime"><B>PREV CLASS</B></A>&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/smime/TrustVerifier.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="TrustVerifier.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
