<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:16 GMT 2016 -->
<TITLE>
SenderAndReceiptContentDigest (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.smime.ess.utils.SenderAndReceiptContentDigest class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SenderAndReceiptContentDigest (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SenderAndReceiptContentDigest.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.smime.ess.utils</FONT>
<BR>
Class SenderAndReceiptContentDigest</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>iaik.smime.ess.utils.SenderAndReceiptContentDigest</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>SenderAndReceiptContentDigest</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
An utility class for keeping sender signature message digest and receipt content
 message digest values for SignedReceipt validation.
 <p>
 When receiving a <A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess"><CODE>signed</CODE></A> <A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess"><CODE>Receipt</CODE></A>
 on a response to a <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A>, the sender may have
 to validate that the SignedData the recipient has received actually has contained the content
 and attributes that have been signed by the sender, and that the SignedData the receipient has
 received actually has been the SignedData sent by the sender. The first validation step may be
 done by comparing the message digest signature value that has been calculated by the sender
 with the value of the MsgSigDigest attribute of the signed receipt. The second validation step
 may be done by comparing an independently by the sender calculated hash over the receipt
 content with the value of the MessageDigest attribute of the signed receipt. Precondition for
 this validation is that the sender, when creating its SignedData-with-ReceiptRequest (calculates
 and) keeps the required message digest values. This class provides an utility for collecting
 both digest values into one <code>SenderAndReceiptContentDigest</code> object and <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#storeEntry(iaik.smime.ess.utils.SenderAndReceiptContentDigest)"><CODE>putting</CODE></A> this object into a repository from where it
 may be fetched when later required for signed receipt validation. The search key for the
 repository is the <A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess"><CODE>Receipt</CODE></A> that links the
 SenderAndReceiptContentDigest object to the SignerInfo of the original SignedData object. 
 <br>
 In an typical application a sender will add a <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A>
 to its <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime"><CODE>signed</CODE></A> content to indicate the recipient to send a signed
 receipt in reply to the original message:
 <pre>
 boolean implicit = true;
 // create a SignedContent for the data to be signed
 SignedContent sc = new SignedContent(implicit, SignedContent.SIGNED_DATA);
 // set the data to be signed
 sc.setDataHandler(dataHandler);
 // add signer certificates
 sc.setCertificates(signerCertificates);
 // create a set of standard attributes
 Attribute[] attributes = SMimeUtil.createStandardAttributes(new IssuerAndSerialNumber(encryptionCertOfSigner), true);
 // add a ReceiptRequest attribute to request a receipt to be sent back to the sender
 int size = attributes.length;
 Attribute[] signedAttributes = new Attribute[size + 1];
 System.arraycopy(attributes, 0, signedAttributes, 0, size);
 signedAttributes[size] = new Attribute(createReceiptRequest(signerCertificate.getPublicKey(), from));
 // add signer information including the signed attributes
 sc.addSigner(signerPrivateKey, signerCertificate, AlgorithmID.sha1, AlgorithmID.rsaEncryption, signedAttributes);
 // create and send a MimeMessage for the signed content   
 msg.setContent(sc, sc.getContentType());
 sc.setHeaders(msg);
 Transport.send(msg);
 </pre>
 Since digest and signature values are not calculated before writing/sending the message, the
 required validation values shall be kept only <b>after</b> sending the message:
 <pre>
 // get the SignerInfo of the sender
 SignerInfo originatorSignerInfo = signedContent.getSignerInfos()[0];
 // get/calculate and store the validation digest values 
 SenderAndReceiptContentDigest.storeEntry(new SenderAndReceiptContentDigest(originatorSignerInfo));
 </pre>
 Later, when receiving the signed <A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess"><CODE>reeipt content</CODE></A> the original
 sender may <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#validateReceiptContent(iaik.smime.ess.ReceiptContent)"><CODE>validate</CODE></A> the MsgSigDigest and MessageDigest
 values against the kept digest values (according to section 2.6 (clause 3. to 6.) of <a href = 
 http://www.ietf.org/rfc/rfc2634>RFC&nbsp;2634</a>):
 <pre>
 // get the receipt content from the message received
 ReceiptContent receiptContent = (ReceiptContent)receiptMsg.getContent();
 // dump receipt information   
 Receipt receipt = (Receipt)receiptContent.getContent();
 System.out.println("Receipt received:");
 System.out.println(receipt);
 // verify the signature of the receipt signer  
 X509Certificate receiptSigner = null;
 try {
   receiptSigner = receiptContent.verify();
   System.out.println("This receipt content is signed from: "+receiptSigner.getSubjectDN());
 } catch (SignatureException ex) {
   System.out.println("Signature verification error!");
 }
 // validate the message digest values   
 try {
   SenderAndReceiptContentDigest.validateReceiptContent(receiptContent);
 } catch (ESSException ex) {
  System.out.println(ex.toString());   
 }    
 System.out.println("ReceiptContent successful validated!");
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess"><CODE>Receipt</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess"><CODE>ReceiptContent</CODE></A>, 
<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A>, 
<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime"><CODE>SignedContent</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;java.util.Hashtable</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#digestStore_">digestStore_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Repository for keeping sender message signature digest values and
 receipt content digest values for later Signed Receipt validation.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#receipt_">receipt_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Receipt used to map this SenderAndReceiptContentDigest to some SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#receiptContentDigest_">receiptContentDigest_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The message digest value of the Receipt content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#senderMessageDigest_">senderMessageDigest_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The message signature digest value used by the sender to generate the original signedData signerInfo signature value.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#SenderAndReceiptContentDigest(iaik.asn1.ASN1Object)">SenderAndReceiptContentDigest</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SenderAndReceiptContentDigest from an ASN.1 object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#SenderAndReceiptContentDigest(java.io.InputStream)">SenderAndReceiptContentDigest</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SenderAndReceiptContentDigest from an input stream supplying the
 BER encoded SenderAndReceiptContentDigest.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#SenderAndReceiptContentDigest(iaik.smime.ess.Receipt, byte[], byte[])">SenderAndReceiptContentDigest</A></B>(<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A>&nbsp;receipt,
                              byte[]&nbsp;senderMessageDigest,
                              byte[]&nbsp;receiptContentDigest)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates SenderAndReceiptContentDigest from Receipt,
 sender message digest value and receipt content digest value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#SenderAndReceiptContentDigest(iaik.cms.SignerInfo)">SenderAndReceiptContentDigest</A></B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;originatorSignerInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates SenderAndReceiptContentDigest from the given original (sender) SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#SenderAndReceiptContentDigest(iaik.cms.SignerInfo, iaik.cms.SecurityProvider, boolean)">SenderAndReceiptContentDigest</A></B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;originatorSignerInfo,
                              <A HREF="../../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider,
                              boolean&nbsp;sortAttributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates SenderAndReceiptContentDigest from the given original (sender) SignerInfo.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#clearDigestStore()">clearDigestStore</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clears the digest store.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#decode(iaik.asn1.ASN1Object)">decode</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decodes the given ASN.1 <code>SenderAndReceiptContentDigest</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#decode(java.io.InputStream)">decode</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reads and decodes a BER encoded SenderAndReceiptContentDigest from the given input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.util.Enumeration</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#getAllEntries()">getAllEntries</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an Enumeration of all entries in the digest store.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#getEntry(iaik.smime.ess.Receipt)">getEntry</A></B>(<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A>&nbsp;receipt)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SenderAndReceiptContentDigest with the given Receipt from the digest store.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#getReceipt()">getReceipt</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the receipt.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#getReceiptContentDigest()">getReceiptContentDigest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the message digest value of the Receipt content</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#getSenderMessageDigest()">getSenderMessageDigest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the message signature digest value used by the 
 sender to generate the original signedData signerInfo signature value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#initDigestStore(java.io.InputStream)">initDigestStore</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializes the digest store from the given stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#removeEntry(iaik.smime.ess.Receipt)">removeEntry</A></B>(<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A>&nbsp;receipt)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes the SenderAndReceiptContentDigest with the given Receipt from the digest store.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#removeEntry(iaik.smime.ess.utils.SenderAndReceiptContentDigest)">removeEntry</A></B>(<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A>&nbsp;senderAndReceiptContentDigest)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes the given senderAndReceiptContentDigest from the digest store.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#storeEntry(iaik.smime.ess.utils.SenderAndReceiptContentDigest)">storeEntry</A></B>(<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A>&nbsp;senderAndReceiptContentDigest)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keep the given senderAndReceiptContentDigest for later Signed Receipt validation.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#toASN1Object()">toASN1Object</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this SenderAndReceiptContentDigest as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string representation of this SenderAndReceiptContentDigest.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#validate(iaik.smime.ess.ReceiptContent)">validate</A></B>(<A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess">ReceiptContent</A>&nbsp;receiptContent)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validates the Signed Receipt according to section 2.6 (clause 3. to 6.) of <a href = 
 http://www.ietf.org/rfc/rfc2634>RFC&nbsp;2634</a>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#validateReceiptContent(iaik.smime.ess.ReceiptContent)">validateReceiptContent</A></B>(<A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess">ReceiptContent</A>&nbsp;receiptContent)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validates the Signed Receipt according to section 2.6 (clause 3. to 6.) of <a href = 
 http://www.ietf.org/rfc/rfc2634>RFC&nbsp;2634</a>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#writeDigestStore(java.io.OutputStream)">writeDigestStore</A></B>(java.io.OutputStream&nbsp;os)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes the digest store contents to the given output stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#writeTo(java.io.OutputStream)">writeTo</A></B>(java.io.OutputStream&nbsp;os)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes this ESS <code>SenderAndReceiptContentDigest</code> object BER 
 encoded to the given output stream.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="digestStore_"><!-- --></A><H3>
digestStore_</H3>
<PRE>
protected static java.util.Hashtable <B>digestStore_</B></PRE>
<DL>
<DD>Repository for keeping sender message signature digest values and
 receipt content digest values for later Signed Receipt validation.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="receipt_"><!-- --></A><H3>
receipt_</H3>
<PRE>
protected <A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A> <B>receipt_</B></PRE>
<DL>
<DD>The Receipt used to map this SenderAndReceiptContentDigest to some SignerInfo.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="senderMessageDigest_"><!-- --></A><H3>
senderMessageDigest_</H3>
<PRE>
protected byte[] <B>senderMessageDigest_</B></PRE>
<DL>
<DD>The message signature digest value used by the sender to generate the original signedData signerInfo signature value.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="receiptContentDigest_"><!-- --></A><H3>
receiptContentDigest_</H3>
<PRE>
protected byte[] <B>receiptContentDigest_</B></PRE>
<DL>
<DD>The message digest value of the Receipt content.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SenderAndReceiptContentDigest(iaik.smime.ess.Receipt, byte[], byte[])"><!-- --></A><H3>
SenderAndReceiptContentDigest</H3>
<PRE>
public <B>SenderAndReceiptContentDigest</B>(<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A>&nbsp;receipt,
                                     byte[]&nbsp;senderMessageDigest,
                                     byte[]&nbsp;receiptContentDigest)</PRE>
<DL>
<DD>Creates SenderAndReceiptContentDigest from Receipt,
 sender message digest value and receipt content digest value.
 The receipt may be used to associate the message
 digest values with the original SignerInfo of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>receipt</CODE> - the receipt to link to the SignedData SignerInfo<DD><CODE>senderMessageDigest</CODE> - the message signature digest value used by the 
        sender to generate the original signedData signerInfo signature value<DD><CODE>receiptContentDigest</CODE> - the message digest value of the Receipt content</DL>
</DL>
<HR>

<A NAME="SenderAndReceiptContentDigest(iaik.cms.SignerInfo)"><!-- --></A><H3>
SenderAndReceiptContentDigest</H3>
<PRE>
public <B>SenderAndReceiptContentDigest</B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;originatorSignerInfo)
                              throws <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates SenderAndReceiptContentDigest from the given original (sender) SignerInfo.
 <p>
 The required receipt, sender message signature digest value
 and receipt content digest value are calculated/obtained from the SignerInfo, if
 available. If not available, an ESSException is thrown. Since we assume that this
 constructor will be used on the sender side (for keeping the sender message signature digest value
 and receipt content digest value for validation when later receiving the signed
 receipt) the signed attributes are sorted when creating the SET OF encoding for
 calculation of the MsgSigDigest value.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>originatorSignerInfo</CODE> - the signerInfo (of the original sender) from which to get required
                             receipt and digest values
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if the given SignerInfo cannot supply receipt or digest values
                         as required</DL>
</DL>
<HR>

<A NAME="SenderAndReceiptContentDigest(iaik.cms.SignerInfo, iaik.cms.SecurityProvider, boolean)"><!-- --></A><H3>
SenderAndReceiptContentDigest</H3>
<PRE>
public <B>SenderAndReceiptContentDigest</B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;originatorSignerInfo,
                                     <A HREF="../../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider,
                                     boolean&nbsp;sortAttributes)
                              throws <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates SenderAndReceiptContentDigest from the given original (sender) SignerInfo.
 <p>
 The required receipt, sender message signature digest value
 and receipt content digest value are obtained from the SignerInfo, if
 available. If not available, an ESSException is thrown.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>originatorSignerInfo</CODE> - the signerInfo (of the original sender) from which to get required
                             receipt and digest values<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used by this object, if <code>null</code>, the 
                         default system-wide installed SecurityProvider is used; this constructor may
                         use the SecurityProvider method <A HREF="../../../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])"><CODE>getHash()</CODE></A> to calculate the hash from the receipt content<DD><CODE>sortAttributes</CODE> - whether to sort the signed attributes when creating the SET OF encoding
                       for MsgSigDigest value calculation; usually this will be set to <code>true</code>
                       because a SenderAndReceiptContentDigest typically may be created on the 
                       sender side to be kept for later validation of the received signed receipt.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if the given SignerInfo cannot supply receipt or digest values
                         as required</DL>
</DL>
<HR>

<A NAME="SenderAndReceiptContentDigest(iaik.asn1.ASN1Object)"><!-- --></A><H3>
SenderAndReceiptContentDigest</H3>
<PRE>
public <B>SenderAndReceiptContentDigest</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)
                              throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>Creates a SenderAndReceiptContentDigest from an ASN.1 object.
 <p>
 A proprietary ASN.1 SEQUENCE is used to model this SenderAndReceiptContentDigest:
 <pre>
 SenderAndReceiptContentDigest ::=  SEQUENCE {        
   receipt              Receipt,
   senderMessageDigest  OCTET STRING,
   receiptContentDigest OCTET STRING}
 </pre>
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the ASN.1 object to be parsed
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if an error occurs while parsing</DL>
</DL>
<HR>

<A NAME="SenderAndReceiptContentDigest(java.io.InputStream)"><!-- --></A><H3>
SenderAndReceiptContentDigest</H3>
<PRE>
public <B>SenderAndReceiptContentDigest</B>(java.io.InputStream&nbsp;is)
                              throws java.io.IOException</PRE>
<DL>
<DD>Creates a SenderAndReceiptContentDigest from an input stream supplying the
 BER encoded SenderAndReceiptContentDigest.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream from where to read the encoded object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while reading from the stream</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="storeEntry(iaik.smime.ess.utils.SenderAndReceiptContentDigest)"><!-- --></A><H3>
storeEntry</H3>
<PRE>
public static <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A> <B>storeEntry</B>(<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A>&nbsp;senderAndReceiptContentDigest)</PRE>
<DL>
<DD>Keep the given senderAndReceiptContentDigest for later Signed Receipt validation.
 This method puts the given senderAndReceiptContentDigest into the digest store hashtable
 by using the inherent Receipt as hashtable key. Any old entry with the same
 Receipt is replaced.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>senderAndReceiptContentDigest</CODE> - the SenderAndReceiptContentDigest to be kept
<DT><B>Returns:</B><DD>the former SenderAndReceiptContentDigest, if present; <code>null</code> otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="removeEntry(iaik.smime.ess.utils.SenderAndReceiptContentDigest)"><!-- --></A><H3>
removeEntry</H3>
<PRE>
public static <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A> <B>removeEntry</B>(<A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A>&nbsp;senderAndReceiptContentDigest)</PRE>
<DL>
<DD>Removes the given senderAndReceiptContentDigest from the digest store.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>senderAndReceiptContentDigest</CODE> - the SenderAndReceiptContentDigest to be removed
<DT><B>Returns:</B><DD>the removed SenderAndReceiptContentDigest; or <code>null</code> if no such object was present</DL>
</DD>
</DL>
<HR>

<A NAME="removeEntry(iaik.smime.ess.Receipt)"><!-- --></A><H3>
removeEntry</H3>
<PRE>
public static <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A> <B>removeEntry</B>(<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A>&nbsp;receipt)</PRE>
<DL>
<DD>Removes the SenderAndReceiptContentDigest with the given Receipt from the digest store.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>receipt</CODE> - the Receipt identifying the SenderAndReceiptContentDigest to be removed
<DT><B>Returns:</B><DD>the removed SenderAndReceiptContentDigest; or <code>null</code> if no SenderAndReceiptContentDigest for the given Receipt
         can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getEntry(iaik.smime.ess.Receipt)"><!-- --></A><H3>
getEntry</H3>
<PRE>
public static <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A> <B>getEntry</B>(<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A>&nbsp;receipt)</PRE>
<DL>
<DD>Gets the SenderAndReceiptContentDigest with the given Receipt from the digest store.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>receipt</CODE> - the Receipt identifying the SenderAndReceiptContentDigest to get
<DT><B>Returns:</B><DD>the SenderAndReceiptContentDigest; or <code>null</code> if no SenderAndReceiptContentDigest for the given Receipt
         can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getAllEntries()"><!-- --></A><H3>
getAllEntries</H3>
<PRE>
public static java.util.Enumeration <B>getAllEntries</B>()</PRE>
<DL>
<DD>Returns an Enumeration of all entries in the digest store.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>an enumeration of all entries in the digest store</DL>
</DD>
</DL>
<HR>

<A NAME="clearDigestStore()"><!-- --></A><H3>
clearDigestStore</H3>
<PRE>
public static void <B>clearDigestStore</B>()</PRE>
<DL>
<DD>Clears the digest store.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="validateReceiptContent(iaik.smime.ess.ReceiptContent)"><!-- --></A><H3>
validateReceiptContent</H3>
<PRE>
public static <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" title="class in iaik.smime.ess.utils">SenderAndReceiptContentDigest</A> <B>validateReceiptContent</B>(<A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess">ReceiptContent</A>&nbsp;receiptContent)
                                                            throws <A HREF="../../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                                                   <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Validates the Signed Receipt according to section 2.6 (clause 3. to 6.) of <a href = 
 http://www.ietf.org/rfc/rfc2634>RFC&nbsp;2634</a>.
 <p>
 This method first looks if a SenderAndReceiptContentDigest with the Receipt of
 the ReceiptContent to be validated has been kept. If yes, the MsgSigDigest attribute value
 of ReceiptContent-SignerInfo is compared with the kept sender message signature
 digest value and its MessageDigest attribute value is compared with the kept ReceiptContent 
 message digest value.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>receiptContent</CODE> - the ReceiptContent to be validated
<DT><B>Returns:</B><DD>the kept SenderAndReceiptContentDigest used for validation (i.e. the one with the same Receipt
         as the given ReceiptContent)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if some attribute parsing error occurs
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if the validation fails because any of the required digest
                         values is not present or the digest comparison fails</DL>
</DD>
</DL>
<HR>

<A NAME="initDigestStore(java.io.InputStream)"><!-- --></A><H3>
initDigestStore</H3>
<PRE>
public static void <B>initDigestStore</B>(java.io.InputStream&nbsp;is)
                            throws java.io.IOException</PRE>
<DL>
<DD>Initializes the digest store from the given stream.
 This method may be used to init the digest store from an external
 source where it has been previously written by calling method 
 <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#writeDigestStore(java.io.OutputStream)"><CODE>writeDigestStore</CODE></A>. Any existing
 entries are cleared before the store is initiailized.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream from which to read
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while reading from the stream</DL>
</DD>
</DL>
<HR>

<A NAME="writeDigestStore(java.io.OutputStream)"><!-- --></A><H3>
writeDigestStore</H3>
<PRE>
public static void <B>writeDigestStore</B>(java.io.OutputStream&nbsp;os)
                             throws java.io.IOException</PRE>
<DL>
<DD>Writes the digest store contents to the given output stream.
 Any entry contributes as a component to an ASN.1 SEQUENCE.
 Use <A HREF="../../../../iaik/smime/ess/utils/SenderAndReceiptContentDigest.html#initDigestStore(java.io.InputStream)"><CODE>initDigestStore</CODE></A> for 
 reading the contents back.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which to write the digest store
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while writing the store</DL>
</DD>
</DL>
<HR>

<A NAME="getReceipt()"><!-- --></A><H3>
getReceipt</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A> <B>getReceipt</B>()</PRE>
<DL>
<DD>Returns the receipt.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the receipt</DL>
</DD>
</DL>
<HR>

<A NAME="getSenderMessageDigest()"><!-- --></A><H3>
getSenderMessageDigest</H3>
<PRE>
public byte[] <B>getSenderMessageDigest</B>()</PRE>
<DL>
<DD>Returns the message signature digest value used by the 
 sender to generate the original signedData signerInfo signature value.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the sender message signature digest value</DL>
</DD>
</DL>
<HR>

<A NAME="getReceiptContentDigest()"><!-- --></A><H3>
getReceiptContentDigest</H3>
<PRE>
public byte[] <B>getReceiptContentDigest</B>()</PRE>
<DL>
<DD>Returns the message digest value of the Receipt content
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the message digest value of the Receipt content</DL>
</DD>
</DL>
<HR>

<A NAME="decode(java.io.InputStream)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(java.io.InputStream&nbsp;is)
            throws java.io.IOException</PRE>
<DL>
<DD>Reads and decodes a BER encoded SenderAndReceiptContentDigest from the given input stream.
 <p>
 A proprietary ASN.1 SEQUENCE is used to model this SenderAndReceiptContentDigest:
 <pre>
 SenderAndReceiptContentDigest ::=  SEQUENCE {        
   receipt              Receipt,
   senderMessageDigest  OCTET STRING,
   receiptContentDigest OCTET STRING}
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream from where to read the encoded SenderAndReceiptContentDigest
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while reading from the stream</DL>
</DD>
</DL>
<HR>

<A NAME="decode(iaik.asn1.ASN1Object)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)
            throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>Decodes the given ASN.1 <code>SenderAndReceiptContentDigest</code> object.
 <p>
 A proprietary ASN.1 SEQUENCE is used to model this SenderAndReceiptContentDigest:
 <pre>
 SenderAndReceiptContentDigest ::=  SEQUENCE {        
   receipt              Receipt,
   senderMessageDigest  OCTET STRING,
   receiptContentDigest OCTET STRING}
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the SenderAndReceiptContentDigest as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if the object cannot be paresd</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object()"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>()</PRE>
<DL>
<DD>Returns this SenderAndReceiptContentDigest as ASN1Object.
 <p>
 A proprietary ASN.1 SEQUENCE is used to model this SenderAndReceiptContentDigest:
 <pre>
 SenderAndReceiptContentDigest ::=  SEQUENCE {        
   receipt              Receipt,
   senderMessageDigest  OCTET STRING,
   receiptContentDigest OCTET STRING}
 </pre>
<P>
<DD><DL>

<DT><B>Returns:</B><DD>this SenderAndReceiptContentDigest as ASN1Object</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os)
             throws <A HREF="../../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                    java.io.IOException</PRE>
<DL>
<DD>Writes this ESS <code>SenderAndReceiptContentDigest</code> object BER 
 encoded to the given output stream.
 <p>
 A proprietary ASN.1 SEQUENCE is used to model this SenderAndReceiptContentDigest:
 <pre>
 SenderAndReceiptContentDigest ::=  SEQUENCE {        
   receipt              Receipt,
   senderMessageDigest  OCTET STRING,
   receiptContentDigest OCTET STRING}
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which to write the SenderAndReceiptContentDigest
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if an encoding error occurs
<DD><CODE>java.io.IOException</CODE> - if an error occurs during writing to the stream</DL>
</DD>
</DL>
<HR>

<A NAME="validate(iaik.smime.ess.ReceiptContent)"><!-- --></A><H3>
validate</H3>
<PRE>
public void <B>validate</B>(<A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess">ReceiptContent</A>&nbsp;receiptContent)
              throws <A HREF="../../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                     <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Validates the Signed Receipt according to section 2.6 (clause 3. to 6.) of <a href = 
 http://www.ietf.org/rfc/rfc2634>RFC&nbsp;2634</a>.
 <p>
 Gets the SignerInfo from the ReceiptContent and compares its MsgSigDigest attribute value
 with the kept sender message signature digest value and its MessageDigest attribute value
 with the kept ReceiptContent message digest value. This method additionally compares the
 Receipt of the supplied receiptContent with the one of this SenderAndReceiptContentDigest.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>receiptContent</CODE> - the ReceiptContent to be validated
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if some attribute parsing error occurs
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if the validation fails because any of the required digest
                         values is not present or the digest comparison fails, or
                         the Receipts do not match</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string representation of this SenderAndReceiptContentDigest.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>this Receipt as string</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?iaik/smime/ess/utils/SenderAndReceiptContentDigest.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SenderAndReceiptContentDigest.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../../../siclogo.jpg> <IMG SRC=../../../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
