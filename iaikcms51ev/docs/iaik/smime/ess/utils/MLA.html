<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:16 GMT 2016 -->
<TITLE>
MLA (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.smime.ess.utils.MLA class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="MLA (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/KeyStoreDatabaseException.html" title="class in iaik.smime.ess.utils"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?iaik/smime/ess/utils/MLA.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MLA.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.smime.ess.utils</FONT>
<BR>
Class MLA</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>iaik.smime.ess.utils.MLA</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>MLA</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
Mail list agent Handler. It may be used to <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolve</CODE></A>  
 an S/MIME message into its several layers and subsequently <A HREF="../../../../iaik/smime/ess/utils/MLA.html#createSignedContent(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], boolean, iaik.smime.ess.utils.ESSLayers)"><CODE>create</CODE></A> a new signed message according to
 section 4 (Mail List Management) of <a href = http://www.ietf.org/rfc/rfc2634>
 (RFC&nbsp;2634) (ESS)</a>:
 <pre>
 In all cases, the MLA MUST sign the message to be sent to the ML
 members in a new "outer" signedData layer. The MLA MUST add or update
 an mlExpansionHistory attribute in the "outer" signedData that it
 creates to document MLA processing. If there was an "outer"
 signedData layer included in the original message received by the
 MLA, then the MLA-created "outer" signedData layer MUST include each
 signed attribute present in the original "outer" signedData layer,
 unless the MLA explicitly replaces an attribute (such as signingTime
 or mlExpansionHistory) with a new value.

 When an S/MIME message is received by the MLA, the MLA MUST first
 determine which received signedData layer, if any, is the "outer"
 signedData layer.  To identify the received "outer" signedData layer,
 the MLA MUST verify the signature and fully process the
 signedAttributes in each of the outer signedData layers (working from
 the outside in) to determine if any of them either include an
 mlExpansionHistory attribute or encapsulate an envelopedData object.

 The MLA search for the "outer" signedData layer is completed when
 it finds one of the following:

  - the "outer" signedData layer that includes an mlExpansionHistory
    attribute or encapsulates an envelopedData object
  - an envelopedData layer
  - the original content (that is, a layer that is neither
    envelopedData nor signedData).

 If the MLA finds an "outer" signedData layer, then the MLA MUST
 perform the following steps:

 1. Strip off all of the signedData layers that encapsulated the
    "outer" signedData layer

 2. Strip off the "outer" signedData layer itself (after remembering
    the included signedAttributes)

 3. Expand the envelopedData (if present)

 4. Sign the message to be sent to the ML members in a new "outer"
    signedData layer that includes the signedAttributes (unless
    explicitly replaced) from the original, received "outer" signedData
    layer.

 If the MLA finds an "outer" signedData layer that includes an
 mlExpansionHistory attribute AND the MLA subsequently finds an
 envelopedData layer buried deeper with the layers of the received
 message, then the MLA MUST strip off all of the signedData layers
 down to the envelopedData layer (including stripping off the original
 "outer" signedData layer) and MUST sign the expanded envelopedData in
 a new "outer" signedData layer that includes the signedAttributes
 (unless explicitly replaced) from the original, received "outer"
 signedData layer.

 If the MLA does not find an "outer" signedData layer AND does not
 find an envelopedData layer, then the MLA MUST sign the original,
 received message in a new "outer" signedData layer. If the MLA does
 not find an "outer" signedData AND does find an envelopedData layer
 then it MUST expand the envelopedData layer, if present, and sign it
 in a new "outer" signedData layer.
 </pre>
 <p>
 When <A HREF="../../../../iaik/smime/ess/utils/MLA.html#MLA(iaik.smime.ess.EntityIdentifier)"><CODE>creating</CODE></A> a new MLA, a mail list 
 identifier should be supplied to uniquely identify the MLA, e.g.:
 <pre>
 // signing certificate of the MLA
 X509Certificate signingCertOfMLA = ...;
 EntityIdentifier mlaID = new IssuerAndSerialNumber(signingCertOfMLA);
 MLA mla = new MLA(mlaID);
 </pre>
 During message <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolving</CODE></A> the MLA ID is required to
 check for an expansion loop. When <A HREF="../../../../iaik/smime/ess/utils/MLA.html#createSignedContent(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], boolean, iaik.smime.ess.utils.ESSLayers)"><CODE>creating</CODE></A>
 a new signed message the MLA ID is used for adding a <A HREF="../../../../iaik/smime/ess/MLData.html" title="class in iaik.smime.ess"><CODE>MLData</CODE></A> object to the <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>
 attribute.
 <p>
 Since a message may contain encrypted layers, a decryption key of the MLA is required
 to be able to decrypt an encrypted layer when <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolving</CODE></A> the
 input message into its layers. Decryption keys of the MLA maybe supplied 
 when setting a <A HREF="../../../../iaik/smime/ess/utils/KeyStoreDatabase.html" title="class in iaik.smime.ess.utils"><CODE>KeyStoreDatabase</CODE></A>:
 <pre>
 KeyStoreDatabase keyStoreDatabase = ...;
 mla.setKeyDatabase(keyStoreDatabase);
 </pre>
 When <A HREF="../../../../iaik/smime/ess/utils/MLA.html#createSignedContent(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], boolean, iaik.smime.ess.utils.ESSLayers)"><CODE>creating</CODE></A> a new message signed by the MLA
 it might be necessary to expand an encrypted layer for the MLA recipient
 list. Encryption info for the final recipients may be set via method <A HREF="../../../../iaik/smime/ess/utils/MLA.html#setEncryptionInfo(iaik.cms.OriginatorInfo, iaik.cms.RecipientInfo[], iaik.asn1.structures.AlgorithmID, int)"><CODE>setEncryptionInfo</CODE></A>, e.g.:
 <pre>
 // information about the originator; if required:
 OriginatorInfo originatorInfo = ...;
 // the recipient list:
 RecipientInfo[] recipients = ...;
 // the content encryption algorithm to be used:
 AlgorithmID contentEA = ...;
 // the length of the content encryption key:
 int cekLength = ...;
 mla.setEncryptionInfo(originatorInfo, recipients, contentEA, cekLength); 
 </pre>
 After having <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolved</CODE></A> a message into its layers, a proper
 <A HREF="../../../../iaik/smime/ess/utils/MLA.html#createSignedContent(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], boolean, iaik.smime.ess.utils.ESSLayers)"><CODE>createSignedContent</CODE></A> method may be called to create a new message signed by the MLA:
 <pre>
 // the message to process:
 MimeMessage msg = ...;
 // resolve the message into its layers:
 ESSLayers layers = mla.resolve(msg);
 // MLA creates a new signed content:
 SignerInfo mlaSignerInfo = ...;
 X509Certificate[] mlaCerts = ...;
 boolean implicit = ...;
 SignedContent sc = mla.createSignedContent(mlaSignerInfo, mlaCerts, implicit, layers);
 </pre>
 Summing up, the following sample shows how this MLA utility may be used to 
 operate as ML agent according to <a href = http://www.ietf.org/rfc/rfc2634>
 (RFC&nbsp;2634)</a> (ESS):
 <pre>
 // Create a new MLA
 X509Certificate signingCertOfMLA = ...;
 EntityIdentifier mlaID = new IssuerAndSerialNumber(signingCertOfMLA);
 MLA mla = new MLA(mlaID);
 // a key database holds the MLA decryption keys:
 KeyStoreDatabase keyStoreDatabase = ...;
 mla.setKeyDatabase(keyStoreDatabase);
 // encryption information for the MLA recipient list:
 RecipientInfo[] recipients = ...;
 // the content encryption algorithm to be used:
 AlgorithmID contentEA = ...;
 // the length of the content encryption key:
 int cekLength = ...;
 mla.setEncryptionInfo(null, recipients, contentEA, cekLength); 
 // the message to process:
 MimeMessage msg = ...;
 // resolve the message into its layers:
 ESSLayers layers = mla.resolve(msg);
 // MLA creates a new signed content:
 SMimeSignerInfo mlaSignerInfo = ...;
 X509Certificate[] mlaCerts = ...;
 boolean implicit = ...;
 SignedContent sc = mla.createSignedContent(mlaSignerInfo, mlaCerts, implicit, layers);
 // now the MLA may send the new signed message to its recipients:
 MimeMessage mlaMsg = ...;
 mlaMsg.setContent(sc, sc.getContentType());
 sc.setHeaders(mlaMsg);
 Transport.send(mlaMsg);
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A>, 
<A HREF="../../../../iaik/smime/EncryptedContent.html" title="class in iaik.smime"><CODE>EncryptedContent</CODE></A>, 
<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime"><CODE>SignedContent</CODE></A>, 
<A HREF="../../../../iaik/smime/SMimeSignerInfo.html" title="class in iaik.smime"><CODE>SMimeSignerInfo</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/EntityIdentifier.html" title="class in iaik.smime.ess"><CODE>EntityIdentifier</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/MLData.html" title="class in iaik.smime.ess"><CODE>MLData</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess"><CODE>MLReceiptPolicy</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/CertificateDatabase.html" title="interface in iaik.smime.ess.utils"><CODE>CertificateDatabase</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/EnvelopedESSLayer.html" title="class in iaik.smime.ess.utils"><CODE>EnvelopedESSLayer</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/ESSLayer.html" title="class in iaik.smime.ess.utils"><CODE>ESSLayer</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils"><CODE>ESSLayers</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/KeyDatabase.html" title="interface in iaik.smime.ess.utils"><CODE>KeyDatabase</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/KeyStoreDatabase.html" title="class in iaik.smime.ess.utils"><CODE>KeyStoreDatabase</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils"><CODE>SignedESSLayer</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#debugID_">debugID_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An id to may be printed in front of debug messages, if set.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.io.PrintWriter</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#debugWriter_">debugWriter_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writer to which debug information may be written.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#MLA()">MLA</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Empty default constructor.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#MLA(iaik.smime.ess.EntityIdentifier)">MLA</A></B>(<A HREF="../../../../iaik/smime/ess/EntityIdentifier.html" title="class in iaik.smime.ess">EntityIdentifier</A>&nbsp;mailListIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an MLA object for the given MailListIdentifier.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#createSignedAttributes(iaik.smime.ess.utils.SignedESSLayer, java.util.Date, iaik.smime.ess.MLReceiptPolicy, iaik.x509.X509Certificate, boolean, java.lang.String)">createSignedAttributes</A></B>(<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils">SignedESSLayer</A>&nbsp;outerLayer,
                       java.util.Date&nbsp;signingTime,
                       <A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;receiptPolicy,
                       <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;encryptionCertificate,
                       boolean&nbsp;includeEncryptionCertIDForMSOE,
                       java.lang.String&nbsp;debugID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a set of attributes to be added when creating a new signed outer layer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#createSignedContent(java.security.PrivateKey, java.util.Date, iaik.x509.X509Certificate, iaik.x509.X509Certificate[], iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, iaik.x509.X509Certificate, boolean, boolean, iaik.smime.ess.utils.ESSLayers)">createSignedContent</A></B>(java.security.PrivateKey&nbsp;privateKey,
                    java.util.Date&nbsp;signingTime,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certificates,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;encryptionCertificate,
                    boolean&nbsp;includeEncryptionCertIDForMSOE,
                    boolean&nbsp;implicit,
                    <A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;essLayers)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedData layer for the private signing key of this MLA.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#createSignedContent(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], boolean, iaik.smime.ess.utils.ESSLayers)">createSignedContent</A></B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certificates,
                    boolean&nbsp;implicit,
                    <A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;essLayers)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedData layer for the private signing key of this MLA.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/utils/CertificateDatabase.html" title="interface in iaik.smime.ess.utils">CertificateDatabase</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#getCertificateDatabase()">getCertificateDatabase</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the certificate database, if set.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/utils/KeyDatabase.html" title="interface in iaik.smime.ess.utils">KeyDatabase</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#getKeyDatabase()">getKeyDatabase</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the KeyDatabase, if set.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#getMLReceiptPolicy()">getMLReceiptPolicy</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the MLReceiptPolicy of this MLA.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils">SecurityLabelHandler</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#getSecurityLabelHandler()">getSecurityLabelHandler</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityLabelHandler, if set.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#getStopOnInvalidSignature()">getStopOnInvalidSignature</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets whether to stop <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolving</CODE></A> a message 
 when a signed layer is detected where some of the signatures
 cannot be verified successfully.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#mergeMLReceiptPolicies(iaik.smime.ess.MLReceiptPolicy, iaik.smime.ess.MLReceiptPolicy, java.lang.String)">mergeMLReceiptPolicies</A></B>(<A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;mlAPolicy,
                       <A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;mlBPolicy,
                       java.lang.String&nbsp;debugID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Merges two MLReceiptPolicies belonging to two MLAs where one MLA (B) is member of the
 mailing list owned by the other MLA (A).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)">resolve</A></B>(javax.mail.Part&nbsp;part)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Resolves the given part into its layers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part, java.lang.String)">resolve</A></B>(javax.mail.Part&nbsp;part,
        java.lang.String&nbsp;debugID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Resolves the given part into its layers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#setCertificateDatabase(iaik.smime.ess.utils.CertificateDatabase)">setCertificateDatabase</A></B>(<A HREF="../../../../iaik/smime/ess/utils/CertificateDatabase.html" title="interface in iaik.smime.ess.utils">CertificateDatabase</A>&nbsp;certDatabase)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the certificate database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#setDebugStream(java.lang.String, java.io.OutputStream)">setDebugStream</A></B>(java.lang.String&nbsp;debugID,
               java.io.OutputStream&nbsp;out)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the stream to which debug information shall be printed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#setEncryptionInfo(iaik.cms.OriginatorInfo, iaik.cms.RecipientInfo[], iaik.asn1.structures.AlgorithmID, int)">setEncryptionInfo</A></B>(<A HREF="../../../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo,
                  <A HREF="../../../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                  int&nbsp;cekLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets any information that maybe required when it is necessary
 to encrypt an expanded enveloped layer before creating and
 signing a new message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#setKeyDatabase(iaik.smime.ess.utils.KeyDatabase)">setKeyDatabase</A></B>(<A HREF="../../../../iaik/smime/ess/utils/KeyDatabase.html" title="interface in iaik.smime.ess.utils">KeyDatabase</A>&nbsp;keyDatabase)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the KeyDatabase.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#setMLReceiptPolicy(iaik.smime.ess.MLReceiptPolicy)">setMLReceiptPolicy</A></B>(<A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;mlReceiptPolicy)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the MLReceiptPolicy of this MLA.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#setSecurityLabelHandler(iaik.smime.ess.utils.SecurityLabelHandler)">setSecurityLabelHandler</A></B>(<A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils">SecurityLabelHandler</A>&nbsp;securityLabelHandler)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityLabelHandler.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#setStopOnInvalidSignature(boolean)">setStopOnInvalidSignature</A></B>(boolean&nbsp;stop)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets whether to stop <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolving</CODE></A> a message 
 when a signed layer is detected where some of the signatures
 cannot be verified successfully.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/MLA.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a String representation of this MLA.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="debugWriter_"><!-- --></A><H3>
debugWriter_</H3>
<PRE>
protected java.io.PrintWriter <B>debugWriter_</B></PRE>
<DL>
<DD>Writer to which debug information may be written.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="debugID_"><!-- --></A><H3>
debugID_</H3>
<PRE>
protected java.lang.String <B>debugID_</B></PRE>
<DL>
<DD>An id to may be printed in front of debug messages, if set.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="MLA()"><!-- --></A><H3>
MLA</H3>
<PRE>
public <B>MLA</B>()</PRE>
<DL>
<DD>Empty default constructor. May be used when only intending to <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolve</CODE></A>
 a message into its layers.
<P>
</DL>
<HR>

<A NAME="MLA(iaik.smime.ess.EntityIdentifier)"><!-- --></A><H3>
MLA</H3>
<PRE>
public <B>MLA</B>(<A HREF="../../../../iaik/smime/ess/EntityIdentifier.html" title="class in iaik.smime.ess">EntityIdentifier</A>&nbsp;mailListIdentifier)</PRE>
<DL>
<DD>Creates an MLA object for the given MailListIdentifier.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>mailListIdentifier</CODE> - the ID of the MLA that processes the MimeMessage to
        resolve it into its several layers</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setKeyDatabase(iaik.smime.ess.utils.KeyDatabase)"><!-- --></A><H3>
setKeyDatabase</H3>
<PRE>
public void <B>setKeyDatabase</B>(<A HREF="../../../../iaik/smime/ess/utils/KeyDatabase.html" title="interface in iaik.smime.ess.utils">KeyDatabase</A>&nbsp;keyDatabase)</PRE>
<DL>
<DD>Sets the KeyDatabase.
 A KeyDatabase maybe set to supply private keys if required for decrypting
 any included EnvelopedData layer.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyDatabase</CODE> - the KeyDatabase supplying private keys for EnvelopedData layer decryption</DL>
</DD>
</DL>
<HR>

<A NAME="getKeyDatabase()"><!-- --></A><H3>
getKeyDatabase</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/utils/KeyDatabase.html" title="interface in iaik.smime.ess.utils">KeyDatabase</A> <B>getKeyDatabase</B>()</PRE>
<DL>
<DD>Get the KeyDatabase, if set.
 A KeyDatabase maybe <A HREF="../../../../iaik/smime/ess/utils/MLA.html#setKeyDatabase(iaik.smime.ess.utils.KeyDatabase)"><CODE>set</CODE></A> to supply private keys if required for decrypting
 any included EnvelopedData layer.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the KeyDatabase, if set</DL>
</DD>
</DL>
<HR>

<A NAME="setCertificateDatabase(iaik.smime.ess.utils.CertificateDatabase)"><!-- --></A><H3>
setCertificateDatabase</H3>
<PRE>
public void <B>setCertificateDatabase</B>(<A HREF="../../../../iaik/smime/ess/utils/CertificateDatabase.html" title="interface in iaik.smime.ess.utils">CertificateDatabase</A>&nbsp;certDatabase)</PRE>
<DL>
<DD>Sets the certificate database.
 A CertificateDatabase maybe set to supply certificates that may be required to verify some 
 SignedData layer that does not contain the signer certificates.
 No trust verifying is performed by this MLA utility.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certDatabase</CODE> - the CertificateDatabase supplying certificates if required for verifying the
        signature(s) of a SignedData layer that does not contain the signer certificates</DL>
</DD>
</DL>
<HR>

<A NAME="getCertificateDatabase()"><!-- --></A><H3>
getCertificateDatabase</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/utils/CertificateDatabase.html" title="interface in iaik.smime.ess.utils">CertificateDatabase</A> <B>getCertificateDatabase</B>()</PRE>
<DL>
<DD>Get the certificate database, if set.
 A CertificateDatabase maybe <A HREF="../../../../iaik/smime/ess/utils/MLA.html#setCertificateDatabase(iaik.smime.ess.utils.CertificateDatabase)"><CODE>set</CODE></A> to supply certificates that 
 may be required to verify some SignedData layer that does not contain the signer certificates.
 No trust verifying is performed by this MLA utility.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the CertificateDatabase, if set</DL>
</DD>
</DL>
<HR>

<A NAME="setSecurityLabelHandler(iaik.smime.ess.utils.SecurityLabelHandler)"><!-- --></A><H3>
setSecurityLabelHandler</H3>
<PRE>
public void <B>setSecurityLabelHandler</B>(<A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils">SecurityLabelHandler</A>&nbsp;securityLabelHandler)</PRE>
<DL>
<DD>Sets the SecurityLabelHandler.
 A SecurityLabelHandler maybe set to decide how to process ESSSecurityLabel/EquivalentLabels 
 attributes if included in some SignedData layer.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityLabelHandler</CODE> - the SecurityLabelHandler processing ESSSecurityLabel/EquivalentLabels
                             attributes</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityLabelHandler()"><!-- --></A><H3>
getSecurityLabelHandler</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils">SecurityLabelHandler</A> <B>getSecurityLabelHandler</B>()</PRE>
<DL>
<DD>Gets the SecurityLabelHandler, if set.
 A SecurityLabelHandler maybe <A HREF="../../../../iaik/smime/ess/utils/MLA.html#setSecurityLabelHandler(iaik.smime.ess.utils.SecurityLabelHandler)"><CODE>set</CODE></A> to decide how to process 
 ESSSecurityLabel/EquivalentLabels attributes if included in some SignedData layer.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityLabelHandler for processing ESSSecurityLabel/EquivalentLabels attributes,
         or <code>null</code> if no SecurityLabelHandler is set</DL>
</DD>
</DL>
<HR>

<A NAME="setStopOnInvalidSignature(boolean)"><!-- --></A><H3>
setStopOnInvalidSignature</H3>
<PRE>
public void <B>setStopOnInvalidSignature</B>(boolean&nbsp;stop)</PRE>
<DL>
<DD>Sets whether to stop <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolving</CODE></A> a message 
 when a signed layer is detected where some of the signatures
 cannot be verified successfully. If set to <code>false</code>
 the message is resolving is continued and the signature 
 verification result is <A HREF="../../../../iaik/smime/ess/utils/SignerInfoVerificationResult.html" title="class in iaik.smime.ess.utils"><CODE>kept</CODE></A> for later inspection.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>stop</CODE> - whether to stop message resolving if an invalid 
        signature is detected in a signed layer or not</DL>
</DD>
</DL>
<HR>

<A NAME="getStopOnInvalidSignature()"><!-- --></A><H3>
getStopOnInvalidSignature</H3>
<PRE>
public boolean <B>getStopOnInvalidSignature</B>()</PRE>
<DL>
<DD>Gets whether to stop <A HREF="../../../../iaik/smime/ess/utils/MLA.html#resolve(javax.mail.Part)"><CODE>resolving</CODE></A> a message 
 when a signed layer is detected where some of the signatures
 cannot be verified successfully. If set to <code>false</code>
 the message is resolving is continued and the signature 
 verification rsult is <A HREF="../../../../iaik/smime/ess/utils/SignerInfoVerificationResult.html" title="class in iaik.smime.ess.utils"><CODE>kept</CODE></A> for later inspection.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>whether to stop message resolving if an invalid 
         signature is detected in a signed layer or not</DL>
</DD>
</DL>
<HR>

<A NAME="setMLReceiptPolicy(iaik.smime.ess.MLReceiptPolicy)"><!-- --></A><H3>
setMLReceiptPolicy</H3>
<PRE>
public void <B>setMLReceiptPolicy</B>(<A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;mlReceiptPolicy)</PRE>
<DL>
<DD>Sets the MLReceiptPolicy of this MLA.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>mlReceiptPolicy</CODE> - the MLReceiptPolicy of this MLA.</DL>
</DD>
</DL>
<HR>

<A NAME="getMLReceiptPolicy()"><!-- --></A><H3>
getMLReceiptPolicy</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A> <B>getMLReceiptPolicy</B>()</PRE>
<DL>
<DD>Gets the MLReceiptPolicy of this MLA.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the MLReceiptPolicy of this MLA, or <code>null</code> if no
         MLReceiptPolicy is set</DL>
</DD>
</DL>
<HR>

<A NAME="setEncryptionInfo(iaik.cms.OriginatorInfo, iaik.cms.RecipientInfo[], iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
setEncryptionInfo</H3>
<PRE>
public void <B>setEncryptionInfo</B>(<A HREF="../../../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo,
                              <A HREF="../../../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                              int&nbsp;cekLength)</PRE>
<DL>
<DD>Sets any information that maybe required when it is necessary
 to encrypt an expanded enveloped layer before creating and
 signing a new message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>originatorInfo</CODE> - any originator information (certificates/crls)
                       to be set for the expanded encrypted layer, if
                       required<DD><CODE>recipients</CODE> - the list of recipients for which to expand
                   an enveloped layer<DD><CODE>contentEA</CODE> - the content encryption algorithm to be used
                  to encrypt an expanded enveloped layer<DD><CODE>cekLength</CODE> - the length of the content encryption key to 
                  be used</DL>
</DD>
</DL>
<HR>

<A NAME="resolve(javax.mail.Part)"><!-- --></A><H3>
resolve</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A> <B>resolve</B>(javax.mail.Part&nbsp;part)
                  throws <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Resolves the given part into its layers.
 The layers are searched for signed outer and inner layer according to
 section 4 (Mail List Management) of <a href = http://www.ietf.org/rfc/rfc2634>
 (RFC&nbsp;2634) (ESS)</a>:
 <pre>

 When an S/MIME message is received by the MLA, the MLA MUST first
 determine which received signedData layer, if any, is the "outer"
 signedData layer.  To identify the received "outer" signedData layer,
 the MLA MUST verify the signature and fully process the
 signedAttributes in each of the outer signedData layers (working from
 the outside in) to determine if any of them either include an
 mlExpansionHistory attribute or encapsulate an envelopedData object.

 The MLA search for the "outer" signedData layer is completed when
 it finds one of the following:

  - the "outer" signedData layer that includes an mlExpansionHistory
    attribute or encapsulates an envelopedData object
  - an envelopedData layer
  - the original content (that is, a layer that is neither
    envelopedData nor signedData).

 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>part</CODE> - the MIME part to be processed
<DT><B>Returns:</B><DD>an array holding all the layers of te MIME part (the outermost layer
         is located at index 0, the innermost layer at index n-1)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if an error occurs when parsing/decomposing the message</DL>
</DD>
</DL>
<HR>

<A NAME="resolve(javax.mail.Part, java.lang.String)"><!-- --></A><H3>
resolve</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A> <B>resolve</B>(javax.mail.Part&nbsp;part,
                         java.lang.String&nbsp;debugID)
                  throws <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Resolves the given part into its layers.
 The layers are searched for signed outer and inner layer according to
 section 4 (Mail List Management) of <a href = http://www.ietf.org/rfc/rfc2634>
 (RFC&nbsp;2634) (ESS)</a>:
 <pre>

 When an S/MIME message is received by the MLA, the MLA MUST first
 determine which received signedData layer, if any, is the "outer"
 signedData layer.  To identify the received "outer" signedData layer,
 the MLA MUST verify the signature and fully process the
 signedAttributes in each of the outer signedData layers (working from
 the outside in) to determine if any of them either include an
 mlExpansionHistory attribute or encapsulate an envelopedData object.

 The MLA search for the "outer" signedData layer is completed when
 it finds one of the following:

  - the "outer" signedData layer that includes an mlExpansionHistory
    attribute or encapsulates an envelopedData object
  - an envelopedData layer
  - the original content (that is, a layer that is neither
    envelopedData nor signedData).

 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>part</CODE> - the MIME part to be processed<DD><CODE>debugID</CODE> - an ID to may be printed in front of debug messages; may be <code>null</code>
<DT><B>Returns:</B><DD>an array holding all the layers of te MIME part (the outermost layer
         is located at index 0, the innermost layer at index n-1)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if an error occurs when parsing/decomposing the message</DL>
</DD>
</DL>
<HR>

<A NAME="createSignedContent(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], boolean, iaik.smime.ess.utils.ESSLayers)"><!-- --></A><H3>
createSignedContent</H3>
<PRE>
public <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A> <B>createSignedContent</B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certificates,
                                         boolean&nbsp;implicit,
                                         <A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;essLayers)
                                  throws java.security.NoSuchAlgorithmException,
                                         java.security.SignatureException,
                                         javax.mail.MessagingException,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A>,
                                         <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates a new SignedData layer for the private signing key of this MLA.
 <p>
 This method first searches the layers of the original message to find the
 outermost layer to be signed. Any attributes to be included already have
 to be set for the supplied SignerInfo. If the the new message will have
 to sign an previously encrypted content the corresponding encrypted layer
 will be expanded about (replaced by) the recipient list that belongs to
 this MLA according to section 4 (Mail List Management) of <a href = 
 http://www.ietf.org/rfc/rfc2634> (RFC&nbsp;2634) (ESS)</a>:
 <pre>
 In all cases, the MLA MUST sign the message to be sent to the ML
 members in a new "outer" signedData layer. The MLA MUST add or update
 an mlExpansionHistory attribute in the "outer" signedData that it
 creates to document MLA processing. If there was an "outer"
 signedData layer included in the original message received by the
 MLA, then the MLA-created "outer" signedData layer MUST include each
 signed attribute present in the original "outer" signedData layer,
 unless the MLA explicitly replaces an attribute (such as signingTime
 or mlExpansionHistory) with a new value.

 ...

 If the MLA finds an "outer" signedData layer, then the MLA MUST
 perform the following steps:

 1. Strip off all of the signedData layers that encapsulated the
    "outer" signedData layer

 2. Strip off the "outer" signedData layer itself (after remembering
    the included signedAttributes)

 3. Expand the envelopedData (if present)

 4. Sign the message to be sent to the ML members in a new "outer"
    signedData layer that includes the signedAttributes (unless
    explicitly replaced) from the original, received "outer" signedData
    layer.

 If the MLA finds an "outer" signedData layer that includes an
 mlExpansionHistory attribute AND the MLA subsequently finds an
 envelopedData layer buried deeper with the layers of the received
 message, then the MLA MUST strip off all of the signedData layers
 down to the envelopedData layer (including stripping off the original
 "outer" signedData layer) and MUST sign the expanded envelopedData in
 a new "outer" signedData layer that includes the signedAttributes
 (unless explicitly replaced) from the original, received "outer"
 signedData layer.

 If the MLA does not find an "outer" signedData layer AND does not
 find an envelopedData layer, then the MLA MUST sign the original,
 received message in a new "outer" signedData layer. If the MLA does
 not find an "outer" signedData AND does find an envelopedData layer
 then it MUST expand the envelopedData layer, if present, and sign it
 in a new "outer" signedData layer.
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfo</CODE> - the signer information (maybe <code>null</code> to let
                   this method create the required SignerInfo<DD><CODE>certificates</CODE> - any certificate to be included in the SignedData<DD><CODE>implicit</CODE> - whether to create an implicit signed (application/pkcs7-mime)
        or an explicit signed (multipart/signed) message
<DT><B>Returns:</B><DD>the new created signed layer
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digestor signature
                                     algorithm is not supported
<DD><CODE>java.security.SignatureException</CODE> - if a signed outer layer is present where not all signatures
            can be successfully verified
<DD><CODE>javax.mail.MessagingException</CODE> - if a messaging error occurs while creating the signed content
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if an error occurs during attribute parsing
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if the SignedContent cannot be created because
                         the content to be signed cannot be resolved</DL>
</DD>
</DL>
<HR>

<A NAME="createSignedContent(java.security.PrivateKey, java.util.Date, iaik.x509.X509Certificate, iaik.x509.X509Certificate[], iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, iaik.x509.X509Certificate, boolean, boolean, iaik.smime.ess.utils.ESSLayers)"><!-- --></A><H3>
createSignedContent</H3>
<PRE>
public <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A> <B>createSignedContent</B>(java.security.PrivateKey&nbsp;privateKey,
                                         java.util.Date&nbsp;signingTime,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certificates,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;encryptionCertificate,
                                         boolean&nbsp;includeEncryptionCertIDForMSOE,
                                         boolean&nbsp;implicit,
                                         <A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;essLayers)
                                  throws java.security.NoSuchAlgorithmException,
                                         java.security.SignatureException,
                                         javax.mail.MessagingException,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A>,
                                         <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates a new SignedData layer for the private signing key of this MLA.
 <p>
 This method first searches the layers of the original message to find the
 outermost layer to be signed. If an outer signed layer is present, any of
 its signed attributes are included in the new SignedData layer, except for
 those (e.g. signingTime, MLExpansionHistory,...) that have to be explicitly
 replaced/updated and are calculated by this method. If the the new message 
 will have to sign an previously encrypted content the corresponding encrypted
 layer will be expanded about (replaced by) the recipient list that belongs
 to this MLA according to section 4 (Mail List Management) of <a href = 
 http://www.ietf.org/rfc/rfc2634> (RFC&nbsp;2634) (ESS)</a>:
 <pre>
 In all cases, the MLA MUST sign the message to be sent to the ML
 members in a new "outer" signedData layer. The MLA MUST add or update
 an mlExpansionHistory attribute in the "outer" signedData that it
 creates to document MLA processing. If there was an "outer"
 signedData layer included in the original message received by the
 MLA, then the MLA-created "outer" signedData layer MUST include each
 signed attribute present in the original "outer" signedData layer,
 unless the MLA explicitly replaces an attribute (such as signingTime
 or mlExpansionHistory) with a new value.

 ...

 If the MLA finds an "outer" signedData layer, then the MLA MUST
 perform the following steps:

 1. Strip off all of the signedData layers that encapsulated the
    "outer" signedData layer

 2. Strip off the "outer" signedData layer itself (after remembering
    the included signedAttributes)

 3. Expand the envelopedData (if present)

 4. Sign the message to be sent to the ML members in a new "outer"
    signedData layer that includes the signedAttributes (unless
    explicitly replaced) from the original, received "outer" signedData
    layer.

 If the MLA finds an "outer" signedData layer that includes an
 mlExpansionHistory attribute AND the MLA subsequently finds an
 envelopedData layer buried deeper with the layers of the received
 message, then the MLA MUST strip off all of the signedData layers
 down to the envelopedData layer (including stripping off the original
 "outer" signedData layer) and MUST sign the expanded envelopedData in
 a new "outer" signedData layer that includes the signedAttributes
 (unless explicitly replaced) from the original, received "outer"
 signedData layer.

 If the MLA does not find an "outer" signedData layer AND does not
 find an envelopedData layer, then the MLA MUST sign the original,
 received message in a new "outer" signedData layer. If the MLA does
 not find an "outer" signedData AND does find an envelopedData layer
 then it MUST expand the envelopedData layer, if present, and sign it
 in a new "outer" signedData layer.
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>privateKey</CODE> - the private key of the signer<DD><CODE>signingTime</CODE> - data and time of signing<DD><CODE>certificates</CODE> - any certificate to be included in the SignedData<DD><CODE>digestAlgorithm</CODE> - the digest algorithm to be used<DD><CODE>signatureAlgorithm</CODE> - the signature algorithm to be used<DD><CODE>encryptionCertificate</CODE> - the encryption certificate of the
        signer (or <code>null</code> if signing and encryption cert are the
        same or no encryption certificate shall be indicated)<DD><CODE>includeEncryptionCertIDForMSOE</CODE> - if <code>true</code>,
        a private MS attribute will be included allowing MSOE to recognize
        the encryption cert of the signer if using different certs for
        signing/encryption<DD><CODE>implicit</CODE> - whether to create an implicit signed (application/pkcs7-mime)
        or an explicit signed (multipart/signed) message
<DT><B>Returns:</B><DD>the new created signed layer
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digestor signature
                                     algorithm is not supported
<DD><CODE>java.security.SignatureException</CODE> - if a signed outer layer is present where not all signatures
            can be successfully verified
<DD><CODE>javax.mail.MessagingException</CODE> - if a messaging error occurs while creating the signed content
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if an error occurs during attribute parsing
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if the SignedContent cannot be created because
                         the content to be signed cannot be resolved</DL>
</DD>
</DL>
<HR>

<A NAME="mergeMLReceiptPolicies(iaik.smime.ess.MLReceiptPolicy, iaik.smime.ess.MLReceiptPolicy, java.lang.String)"><!-- --></A><H3>
mergeMLReceiptPolicies</H3>
<PRE>
protected <A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A> <B>mergeMLReceiptPolicies</B>(<A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;mlAPolicy,
                                                 <A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;mlBPolicy,
                                                 java.lang.String&nbsp;debugID)</PRE>
<DL>
<DD>Merges two MLReceiptPolicies belonging to two MLAs where one MLA (B) is member of the
 mailing list owned by the other MLA (A).
 The merging is done according to the section 4.3 (Mail List Agent Signed Receipt Policy Processing)
 of <a href = "http://www.ietf.org/rfc/rfc2634.txt">RFC 2634 (Enhanced Security Services for S/MIME</a>:
 <pre>
              |                    B's policy
 A's policy   | none   insteadOf        inAdditionTo      missing
 -----------------------------------------------------------------------
 none         | none   none             none              none
 insteadOf    | none   insteadOf(B)     *1                insteadOf(A)
 inAdditionTo | none   insteadOf(B)     *2                inAdditionTo(A)
 missing      | none   insteadOf(B)     inAdditionTo(B)   missing

  *1 = insteadOf(insteadOf(A) + inAdditionTo(B))
  *2 = inAdditionTo(inAdditionTo(A) + inAdditionTo(B))

 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>mlAPolicy</CODE> - the MLReceiptPolicy of the first MLA (A)<DD><CODE>mlBPolicy</CODE> - the MLReceiptPolicy of the second MLA (B) being a member of the 
                  mailing list owned by A
<DT><B>Returns:</B><DD>the new (merged) MLReceiptPolicy of MLA B</DL>
</DD>
</DL>
<HR>

<A NAME="createSignedAttributes(iaik.smime.ess.utils.SignedESSLayer, java.util.Date, iaik.smime.ess.MLReceiptPolicy, iaik.x509.X509Certificate, boolean, java.lang.String)"><!-- --></A><H3>
createSignedAttributes</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>createSignedAttributes</B>(<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils">SignedESSLayer</A>&nbsp;outerLayer,
                                             java.util.Date&nbsp;signingTime,
                                             <A HREF="../../../../iaik/smime/ess/MLReceiptPolicy.html" title="class in iaik.smime.ess">MLReceiptPolicy</A>&nbsp;receiptPolicy,
                                             <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;encryptionCertificate,
                                             boolean&nbsp;includeEncryptionCertIDForMSOE,
                                             java.lang.String&nbsp;debugID)
                                      throws <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A>,
                                             <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>Creates a set of attributes to be added when creating a new signed outer layer.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>outerLayer</CODE> - the current signed outer layer from which attribute to be copied,
                   maybe <code>null</code> if no signed outer layer was present<DD><CODE>signingTime</CODE> - the time where the new message is signed; if <code>null</code>
                    the current time is taken for the signingTime attribute and
                    the MLData expansion time<DD><CODE>receiptPolicy</CODE> - the receiptPolicy of this MLA, maybe <code>null</code><DD><CODE>encryptionCertificate</CODE> - the encryption certificate of the
        MLA (or <code>null</code> if signing and encryption cert is the
        same or no encryption certificate shall be indicated)<DD><CODE>includeEncryptionCertIDForMSOE</CODE> - if <code>true</code>,
        a private MS attribute will be included allowing MSOE to recognize
        the encryption cert of the signer if using different certs for
        signing/encryption
<DT><B>Returns:</B><DD>the new created set of attributes to be signed
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setDebugStream(java.lang.String, java.io.OutputStream)"><!-- --></A><H3>
setDebugStream</H3>
<PRE>
public void <B>setDebugStream</B>(java.lang.String&nbsp;debugID,
                           java.io.OutputStream&nbsp;out)</PRE>
<DL>
<DD>Sets the stream to which debug information shall be printed.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>debugID</CODE> - an ID to may be printed in front of debug messages; may be <code>null</code><DD><CODE>out</CODE> - the stream to which debug information shall be written;
               maybe <code>null</code> for disabling debug output</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a String representation of this MLA.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>a string representation of the MLA</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/KeyStoreDatabaseException.html" title="class in iaik.smime.ess.utils"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SecurityLabelHandler.html" title="interface in iaik.smime.ess.utils"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?iaik/smime/ess/utils/MLA.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MLA.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../../../siclogo.jpg> <IMG SRC=../../../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
