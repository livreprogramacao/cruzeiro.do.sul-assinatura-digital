<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:16 GMT 2016 -->
<TITLE>
SignedReceipt (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.smime.ess.utils.SignedReceipt class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SignedReceipt (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?iaik/smime/ess/utils/SignedReceipt.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedReceipt.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.smime.ess.utils</FONT>
<BR>
Class SignedReceipt</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>iaik.smime.ess.utils.SignedReceipt</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>SignedReceipt</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
Utility for parsing a message for an included <code>ReceiptRequest</code> attribute
 and in return creating a signed <code>Receipt</code> message. 
 <p>
 The <a href = http://www.ietf.org/rfc/rfc2634>Enhanced Security Services 
 for S/MIMEv3 (ESS) (RFC&nbsp;2634)</a> specifies the <code>Receipt</code>
 content type to be set as content of a <A HREF="../../../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A>
 which shall be sent in response to a <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> received:
 <pre>
 Receipt ::= SEQUENCE {
   version ESSVersion,
   contentType ContentType,
   signedContentIdentifier ContentIdentifier,
   originatorSignatureValue OCTET STRING }
 
 id-ct-receipt OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
   rsadsi(113549) pkcs(1) pkcs-9(9) smime(16) id-ct(1) 1}

 ESSVersion ::= INTEGER  { v1(1) }
 </pre>
 When receiving a <A HREF="../../../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A> having any 
 <A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> holding a <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> the recipient first has to check
 if all ReceiptRequests contained in any of the SignerInfos are
 identical. According to the rules given in <a href = 
 http://www.ietf.org/rfc/rfc2634>RFC&nbsp;2634</a>, section 2.3, 
 the recipient then checks if it is requested to create signed
 receipt(s) to be sent to dedicated user(s):
 <pre>
 1. If an mlExpansionHistory attribute is present in the outermost
    signedData block, do one of the following two steps, based on the
    absence or presence of mlReceiptPolicy:

     1.1. If an mlReceiptPolicy value is absent from the last MLData
          element, a Mail List receipt policy has not been specified
          and the processing software SHOULD examine the
          receiptRequest attribute value to determine if a receipt
          should be created and returned.

     1.2. If an mlReceiptPolicy value is present in the last MLData
          element, do one of the following two steps, based on the
          value of mlReceiptPolicy:

         1.2.1. If the mlReceiptPolicy value is none, then the receipt
                policy of the Mail List supersedes the originator
                request for a signed receipt and a signed receipt MUST
                NOT be created.

         1.2.2. If the mlReceiptPolicy value is insteadOf or
                inAdditionTo, the processing software SHOULD examine
                the receiptsFrom value from the receiptRequest
                attribute to determine if a receipt should be created
                and returned. If a receipt is created, the insteadOf
                and inAdditionTo fields identify entities that SHOULD
                be sent the receipt instead of or in addition to the
                originator.

 2. If the receiptsFrom value of the receiptRequest attribute
    allOrFirstTier, do one of the following two steps based on the
    value of allOrFirstTier.

     2.1. If the value of allOrFirstTier is allReceipts, then a signed
          receipt SHOULD be created.

     2.2. If the value of allOrFirstTier is firstTierRecipients, do
          one of the following two steps based on the presence of an
          mlExpansionHistory attribute in an outer signedData block:

         2.2.1. If an mlExpansionHistory attribute is present, then
                this recipient is not a first tier recipient and a
                signed receipt MUST NOT be created.

         2.2.2. If an mlExpansionHistory attribute is not present,
                then a signed receipt SHOULD be created.

 3. If the receiptsFrom value of the receiptRequest attribute is a
    receiptList:
   3.1. If receiptList contains one of the GeneralNames of the
        recipient, then a signed receipt SHOULD be created.

  3.2. If receiptList does not contain one of the GeneralNames of
       the recipient, then a signed receipt MUST NOT be created.
 </pre>
 If a signed receipt has to be sent, the recipient performs the following
 steps for creating the signed receipt and setting it as content of a 
 SignedData object ("signedData/Receipt", see <a href = 
 http://www.ietf.org/rfc/rfc2634>RFC&nbsp;2634</a>, section 2.4): 
 <pre>
 1. The signature of the original signedData signerInfo that includes
    the receiptRequest signed attribute MUST be successfully verified
    before creating the signedData/Receipt.

    1.1. The content of the original signedData object is digested as
         described in [CMS]. The resulting digest value is then
         compared with the value of the messageDigest attribute
         included in the signedAttributes of the original signedData
         signerInfo. If these digest values are different, then the
         signature verification process fails and the
         signedData/Receipt MUST NOT be created.

     1.2. The ASN.1 DER encoded signedAttributes (including
          messageDigest, receiptRequest and, possibly, other signed
          attributes) in the original signedData signerInfo are
          digested as described in [CMS]. The resulting digest
          value, called msgSigDigest, is then used to verify the
          signature of the original signedData signerInfo. If the
          signature verification fails, then the signedData/Receipt
           MUST NOT be created.

 2. A Receipt structure is created.

     2.1. The value of the Receipt version field is set to 1.

     2.2. The object identifier from the contentType attribute
          included in the original signedData signerInfo that
          includes the receiptRequest attribute is copied into
          the Receipt contentType.

     2.3. The original signedData signerInfo receiptRequest
          signedContentIdentifier is copied into the Receipt
          signedContentIdentifier.

     2.4. The signature value from the original signedData signerInfo
          that includes the receiptRequest attribute is copied into
          the Receipt originatorSignatureValue.

 3. The Receipt structure is ASN.1 DER encoded to produce a data
    stream, D1.
 4. D1 is digested. The resulting digest value is included as the
    messageDigest attribute in the signedAttributes of the signerInfo
    which will eventually contain the signedData/Receipt signature
    value.

 5. The digest value (msgSigDigest) calculated in Step 1 to verify the
    signature of the original signedData signerInfo is included as the
    msgSigDigest attribute in the signedAttributes of the signerInfo
    which will eventually contain the signedData/Receipt signature
    value.

 6. A contentType attribute including the id-ct-receipt object
    identifier MUST be created and added to the signed attributes of
    the signerInfo which will eventually contain the
    signedData/Receipt signature value.

 7. A signingTime attribute indicating the time that the
    signedData/Receipt is signed SHOULD be created and added to the
    signed attributes of the signerInfo which will eventually contain
    the signedData/Receipt signature value. Other attributes (except
    receiptRequest) may be added to the signedAttributes of the
    signerInfo.

 8. The signedAttributes (messageDigest, msgSigDigest, contentType and,
    possibly, others) of the signerInfo are ASN.1 DER encoded and
    digested as described in [CMS]. The resulting digest value is used
    to calculate the signature value which is then included in the
    signedData/Receipt signerInfo.

 9. The ASN.1 DER encoded Receipt content MUST be directly encoded
    within the signedData encapContentInfo eContent OCTET STRING
    defined in [CMS]. The id-ct-receipt object identifier MUST be
    included in the signedData encapContentInfo eContentType. This
    results in a single ASN.1 encoded object composed of a signedData
    including the Receipt content. The Data content type MUST NOT be
    used.  The Receipt content MUST NOT be encapsulated in a MIME
    header or any other header prior to being encoded as part of the
    signedData object.

 10. The signedData/Receipt is then put in an application/pkcs7-mime
     MIME wrapper with the smime-type parameter set to
     "signed-receipt".  This will allow for identification of signed
     receipts without having to crack the ASN.1 body. The smime-type
     parameter would still be set as normal in any layer wrapped
     around this message.
 11. If the signedData/Receipt is to be encrypted within an
     envelopedData object, then an outer signedData object MUST be
     created that encapsulates the envelopedData object, and a
     contentHints attribute with contentType set to the id-ct-receipt
     object identifier MUST be included in the outer signedData
     SignerInfo signedAttributes.  When a receiving agent processes the
     outer signedData object, the presence of the id-ct-receipt OID in
     the contentHints contentType indicates that a signedData/Receipt
     is encrypted within the envelopedData object encapsulated by the
     outer signedData.
 </pre>
 <br>
 <hr>
 <br>
 When creating a new <code>SignedReceipt</code> object an application may immediately
 provide signed inner layer (containing a <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute) and (optional) signed outer layer (possibly 
 containing a <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>
 attribute), or may provide message <A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils"><CODE>layers</CODE></A> or
 message <code>Part</code>. In the latter case the layers or part, respectively,
 are parsed for any inlcuded signed innner or signed outer layer. If the
 signed inner layer contains a <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute, the proceeding above is used to see if 
 a receipt is requested from the ReceiptRequest recipient and to whom
 a signed receipt shall be sent, if requested. If an outer layer is present
 and is parsed if it contains a  <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> that may supersede the original receipt request or
 list of intended receipt recipients. 
 <br>
 After having successfully created a <code>SignedReceipt</code> any of the
 following methods may be used for <A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess"><CODE>Receipt</CODE></A>
 building:
 <ul>
 <li><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceipt()"><CODE>createReceipt</CODE></A>: creates a <A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess"><CODE>Receipt</CODE></A> from the information parsed from the received message. This method may be used
     when needing the raw Receipt only:
     <pre> 
     // email address of the receipt creator (the one who has received the receipt request)
     String receiptEmailAddress = ...;
     // message containing the receipt request:
     MimeMessage msg = ...;
     SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
     Receipt receipt = signedReceipt.createReceipt();
     </pre>
 <li><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceiptContent()"><CODE>createReceiptContent</CODE></A>: creates a <A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess"><CODE>ReceiptContent</CODE></A> from the information parsed from the received message. After having created the
      ReceiptContent ReceiptContent} an application may set signer information and certificates to finally
      sent the signed receipt to the intended rscipients, e.g.:
      <pre>
      // email address of the receipt creator (the one who has received the receipt request)
      String receiptEmailAddress = ...;
      // message containing the receipt request:
      MimeMessage msg = ...;
      SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
      // sendTo is the one to which the receipt should be send
      String sendTo = signedReceipt.getReceiptsToAddressList();
      MimeMessage msg = new MimeMessage(...);
      msg.setFrom(new InternetAddress(receiptEmailAddress));
      msg.setRecipients(Message.RecipientType.TO, InternetAddress.parse(sendTo));
      msg.setSubject(...);
      ...
      ReceiptContent receiptContent = signedReceipt.createReceiptContent();
      // for this simple demo signer = recipient
      receiptContent.setCertificates(...);
      receiptContent.setSigner(...);
      msg.setContent(receiptContent, receiptContent.getContentType());
      receiptContent.setHeaders(msg);
      Transport.send(msg);
      </pre>
 <li><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceiptMessage(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], javax.mail.Session, java.lang.String)"><CODE>createReceiptMessage</CODE></A>: 
      creates a receipt message from the information parsed from the received message. The receipt signer
      information has to be supplied as CMS <A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> object, e.g.:
      <pre>
      // email address of the receipt creator (the one who has received the receipt request)
      String receiptEmailAddress = ...;
      // message containing the receipt request:
      MimeMessage msg = ...;
      SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
      String subject = "...";
      SignerInfo receiptSigner = ...;
      Message msg = signedReceipt.createReceiptMessage(receiptSigner, 
                                                       signerCertificates,
                                                       session,
                                                       subject);
      Transport.send(msg);
      </pre>
 <li><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceiptMessage(java.security.PrivateKey, iaik.x509.X509Certificate[], iaik.x509.X509Certificate, iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, iaik.x509.X509Certificate, boolean, javax.mail.Session, java.lang.String)"><CODE>createReceiptMessage</CODE></A>: 
      creates a receipt message from the information parsed from the received message. The receipt is signed
      with the given key using the supplied signature algorithm, e.g.:
      <pre>
      // email address of the receipt creator (the one who has received the receipt request)
      String receiptEmailAddress = ...;
      // message containing the receipt request:
      MimeMessage msg = ...;
      SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
      String subject = "...";
      Message msg = signedReceipt.createReceiptMessage(signerPrivateKey, 
                                                       certificates,
                                                       signerCertificate,
                                                       AlgorithmID.sha1,
                                                       AlgorithmID.rsaEncryption,
                                                       encryptionCertOfSigner,
                                                       true,
                                                       session,
                                                       subject);
      Transport.send(msg);
      </pre>
 </ul>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess"><CODE>Receipt</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess"><CODE>ReceiptContent</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils"><CODE>ESSLayers</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/ESSLayer.html" title="class in iaik.smime.ess.utils"><CODE>ESSLayer</CODE></A>, 
<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils"><CODE>SignedESSLayer</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.io.PrintWriter</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#debugWriter_">debugWriter_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writer to which debug information may be written.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.ess.utils.ESSLayers, iaik.asn1.structures.GeneralNames)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given ESS layers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.ess.utils.ESSLayers, iaik.asn1.structures.GeneralNames, java.io.OutputStream)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName,
              java.io.OutputStream&nbsp;debugStream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given ESS layers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.ess.utils.ESSLayers, java.lang.String)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
              java.lang.String&nbsp;myEmailAddress)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given ESS layers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.ess.utils.ESSLayers, java.lang.String, java.io.OutputStream)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
              java.lang.String&nbsp;myEmailAddress,
              java.io.OutputStream&nbsp;debugStream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given ESS layers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(javax.mail.Part, iaik.asn1.structures.GeneralNames)">SignedReceipt</A></B>(javax.mail.Part&nbsp;part,
              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given mail part.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(javax.mail.Part, iaik.asn1.structures.GeneralNames, java.io.OutputStream)">SignedReceipt</A></B>(javax.mail.Part&nbsp;part,
              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName,
              java.io.OutputStream&nbsp;debugStream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given mail part.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(javax.mail.Part, java.lang.String)">SignedReceipt</A></B>(javax.mail.Part&nbsp;part,
              java.lang.String&nbsp;myEmailAddress)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given mail part.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(javax.mail.Part, java.lang.String, java.io.OutputStream)">SignedReceipt</A></B>(javax.mail.Part&nbsp;part,
              java.lang.String&nbsp;myEmailAddress,
              java.io.OutputStream&nbsp;debugStream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from the given mail part.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, iaik.asn1.structures.GeneralNames)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
              <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from given inner and outer layer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, iaik.asn1.structures.GeneralNames, java.io.OutputStream)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
              <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName,
              java.io.OutputStream&nbsp;debugStream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from given inner and outer layer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, java.lang.String)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
              <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
              java.lang.String&nbsp;myEmailAddress)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from given inner and outer layer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, java.lang.String, java.io.OutputStream)">SignedReceipt</A></B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
              <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
              java.lang.String&nbsp;myEmailAddress,
              java.io.OutputStream&nbsp;debugStream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt from given inner and outer layer.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceipt()">createReceipt</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a Receipt attribute based on the information parsed
 from the originator SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess">ReceiptContent</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceiptContent()">createReceiptContent</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a ReceiptContent based on the information parsed
 from the originator SignerInfo (got from the inner signed layer
 of the receipt request conatining message).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.mail.internet.MimeMessage</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceiptMessage(java.security.PrivateKey, iaik.x509.X509Certificate[], iaik.x509.X509Certificate, iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, iaik.x509.X509Certificate, boolean, javax.mail.Session, java.lang.String)">createReceiptMessage</A></B>(java.security.PrivateKey&nbsp;privateKey,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certificates,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;encryptionCertificate,
                     boolean&nbsp;includeEncryptionCertIDForMSOE,
                     javax.mail.Session&nbsp;session,
                     java.lang.String&nbsp;subject)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt message based on the information parsed
 from the originator SignerInfo (got from the inner signed layer
 of the receipt request conatining message).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.mail.internet.MimeMessage</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#createReceiptMessage(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], javax.mail.Session, java.lang.String)">createReceiptMessage</A></B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;receiptSigner,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;signerCertificates,
                     javax.mail.Session&nbsp;session,
                     java.lang.String&nbsp;subject)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedReceipt message based on the information parsed
 from the originator SignerInfo (got from the inner signed layer
 of the receipt request conatining message).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess">MLExpansionHistory</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#getMLExpansionHistory()">getMLExpansionHistory</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the MLExpansionHistory attribute of the outer layer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#getOriginatorSignerInfos()">getOriginatorSignerInfos</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all SignerInfos of the original inner SignedData layer that contain a
 valid <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess">ReceiptRequest</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#getReceiptRequest()">getReceiptRequest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the ReceiptRequest attribute from the originator SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#getReceiptsTo()">getReceiptsTo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the general names this SignedReceipt should be sent to.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#getReceiptsToAddresses()">getReceiptsToAddresses</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the email addresses this SignedReceipt should be sent to.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../iaik/smime/ess/utils/SignedReceipt.html#getReceiptsToAddressList()">getReceiptsToAddressList</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the email addresses this SignedReceipt should be sent to.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="debugWriter_"><!-- --></A><H3>
debugWriter_</H3>
<PRE>
protected java.io.PrintWriter <B>debugWriter_</B></PRE>
<DL>
<DD>Writer to which debug information may be written.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, java.lang.String)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
                     <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
                     java.lang.String&nbsp;myEmailAddress)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from given inner and outer layer.
 A <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute in the inner layer may indicate
 that a SignedReceipt has to be sent. A <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>
 attribute in the outer layer may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>innerLayer</CODE> - the inner signed layer of a possible multi layer message<DD><CODE>outerLayer</CODE> - the outer signed layer of a possible multi layer message; may be null<DD><CODE>myEmailAddress</CODE> - the email address of the SignedReceipt creator (the one who sends the signed receipt)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason (e.g. no receipt is
                                   requested from the holder of myEmailAddress)</DL>
</DL>
<HR>

<A NAME="SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, java.lang.String, java.io.OutputStream)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
                     <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
                     java.lang.String&nbsp;myEmailAddress,
                     java.io.OutputStream&nbsp;debugStream)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from given inner and outer layer.
 A <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute in the inner layer may indicate
 that a SignedReceipt has to be sent. A <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>
 attribute in the outer layer may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>innerLayer</CODE> - the inner signed layer of a possible multi layer message<DD><CODE>outerLayer</CODE> - the outer signed layer of a possible multi layer message; may be null<DD><CODE>myEmailAddress</CODE> - the email address of the SignedReceipt creator (the one who sends the signed receipt)<DD><CODE>debugStream</CODE> - the stream to which debug information shall be written;
                    maybe <code>null</code> for disabling debug output
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason (e.g. no receipt is
                                   requested from the holder of myEmailAddress)</DL>
</DL>
<HR>

<A NAME="SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, iaik.asn1.structures.GeneralNames)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
                     <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from given inner and outer layer.
 A <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute in the inner layer may indicate
 that a SignedReceipt has to be sent. A <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>
 attribute in the outer layer may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>innerLayer</CODE> - the inner signed layer of a possible multi layer message<DD><CODE>outerLayer</CODE> - the outer signed layer of a possible multi layer message; may be null<DD><CODE>myName</CODE> - the name of the SignedReceipt creator (the one who sends the signed receipt)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason (e.g. no receipt is
                                   requested from the holder of myName)</DL>
</DL>
<HR>

<A NAME="SignedReceipt(iaik.smime.SignedContent, iaik.smime.SignedContent, iaik.asn1.structures.GeneralNames, java.io.OutputStream)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;innerLayer,
                     <A HREF="../../../../iaik/smime/SignedContent.html" title="class in iaik.smime">SignedContent</A>&nbsp;outerLayer,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName,
                     java.io.OutputStream&nbsp;debugStream)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from given inner and outer layer.
 A <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute in the inner layer may indicate
 that a SignedReceipt has to be sent. A <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A>
 attribute in the outer layer may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>innerLayer</CODE> - the inner signed layer of a possible multi layer message<DD><CODE>outerLayer</CODE> - the outer signed layer of a possible multi layer message; may be null<DD><CODE>myName</CODE> - the name of the SignedReceipt creator (the one who sends the signed receipt)<DD><CODE>debugStream</CODE> - the stream to which debug information shall be written;
                    maybe <code>null</code> for disabling debug output
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason (e.g. no receipt is
                                   requested from the holder of myName)</DL>
</DL>
<HR>

<A NAME="SignedReceipt(iaik.smime.ess.utils.ESSLayers, java.lang.String)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
                     java.lang.String&nbsp;myEmailAddress)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given ESS layers.
 If the given layers contain a signed inner layer, its <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may indicate that a SignedReceipt has to be sent. 
 If the given layers contain a signed outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>layers</CODE> - the ESS layers possibly containing a signed inner and a signed outer layer<DD><CODE>myEmailAddress</CODE> - the email address of the SignedReceipt creator (the one who sends the signed receipt)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if the parsing of the layers fails for some reason</DL>
</DL>
<HR>

<A NAME="SignedReceipt(iaik.smime.ess.utils.ESSLayers, java.lang.String, java.io.OutputStream)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
                     java.lang.String&nbsp;myEmailAddress,
                     java.io.OutputStream&nbsp;debugStream)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given ESS layers.
 If the given layers contain a signed inner layer, its <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may indicate that a SignedReceipt has to be sent. 
 If the given layers contain a signed outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>layers</CODE> - the ESS layers possibly containing a signed inner and a signed outer layer<DD><CODE>myEmailAddress</CODE> - the email address of the SignedReceipt creator (the one who sends the signed receipt)<DD><CODE>debugStream</CODE> - the stream to which debug information shall be written;
                    maybe <code>null</code> for disabling debug output
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if the parsing of the layers fails for some reason</DL>
</DL>
<HR>

<A NAME="SignedReceipt(iaik.smime.ess.utils.ESSLayers, iaik.asn1.structures.GeneralNames)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given ESS layers.
 If the given layers contain a signed inner layer, its <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may indicate that a SignedReceipt has to be sent. 
 If the given layers contain a signed outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>layers</CODE> - the ESS layers possibly containing a signed inner and a signed outer layer<DD><CODE>myName</CODE> - the name of the SignedReceipt creator (the one who sends the signed receipt)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if the parsing of the layers fails for some reason</DL>
</DL>
<HR>

<A NAME="SignedReceipt(iaik.smime.ess.utils.ESSLayers, iaik.asn1.structures.GeneralNames, java.io.OutputStream)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(<A HREF="../../../../iaik/smime/ess/utils/ESSLayers.html" title="class in iaik.smime.ess.utils">ESSLayers</A>&nbsp;layers,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName,
                     java.io.OutputStream&nbsp;debugStream)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given ESS layers.
 If the given layers contain a signed inner layer, its <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may indicate that a SignedReceipt has to be sent. 
 If the given layers contain a signed outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>layers</CODE> - the ESS layers possibly containing a signed inner and a signed outer layer<DD><CODE>myName</CODE> - the name of the SignedReceipt creator (the one who sends the signed receipt)<DD><CODE>debugStream</CODE> - the stream to which debug information shall be written;
                    maybe <code>null</code> for disabling debug output
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE></DL>
</DL>
<HR>

<A NAME="SignedReceipt(javax.mail.Part, java.lang.String)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(javax.mail.Part&nbsp;part,
                     java.lang.String&nbsp;myEmailAddress)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given mail part.
 The part is parsed for its layers. If the layers contain a signed inner layer, its 
 <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may
 indicate that a SignedReceipt has to be sent. If the given layers contain a signed
 outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute
 (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>part</CODE> - the MIME part possibly containing a signed inner and a signed outer layer<DD><CODE>myEmailAddress</CODE> - the email address of the SignedReceipt creator (the one who sends the signed receipt)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if an error occurs when parsing/decomposing the part or
                              any of the signatures of a signed layer is invalid</DL>
</DL>
<HR>

<A NAME="SignedReceipt(javax.mail.Part, java.lang.String, java.io.OutputStream)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(javax.mail.Part&nbsp;part,
                     java.lang.String&nbsp;myEmailAddress,
                     java.io.OutputStream&nbsp;debugStream)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given mail part.
 The part is parsed for its layers. If the layers contain a signed inner layer, its 
 <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may
 indicate that a SignedReceipt has to be sent. If the given layers contain a signed
 outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute
 (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>part</CODE> - the MIME part possibly containing a signed inner and a signed outer layer<DD><CODE>myEmailAddress</CODE> - the email address of the SignedReceipt creator (the one who sends the signed receipt)<DD><CODE>debugStream</CODE> - the stream to which debug information shall be written;
                    maybe <code>null</code> for disabling debug output
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if an error occurs when parsing/decomposing the part or
                              any of the signatures of a signed layer is invalid</DL>
</DL>
<HR>

<A NAME="SignedReceipt(javax.mail.Part, iaik.asn1.structures.GeneralNames)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(javax.mail.Part&nbsp;part,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given mail part.
 The part is parsed for its layers. If the layers contain a signed inner layer, its 
 <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may
 indicate that a SignedReceipt has to be sent. If the given layers contain a signed
 outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute
 (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>part</CODE> - the MIME part possibly containing a signed inner and a signed outer layer<DD><CODE>myName</CODE> - the name of the SignedReceipt creator (the one who sends the signed receipt)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if an error occurs when parsing/decomposing the part or
                              any of the signatures of a signed layer is invalid</DL>
</DL>
<HR>

<A NAME="SignedReceipt(javax.mail.Part, iaik.asn1.structures.GeneralNames, java.io.OutputStream)"><!-- --></A><H3>
SignedReceipt</H3>
<PRE>
public <B>SignedReceipt</B>(javax.mail.Part&nbsp;part,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>&nbsp;myName,
                     java.io.OutputStream&nbsp;debugStream)
              throws <A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A>,
                     <A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></PRE>
<DL>
<DD>Creates a SignedReceipt from the given mail part.
 The part is parsed for its layers. If the layers contain a signed inner layer, its 
 <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute (if included) may
 indicate that a SignedReceipt has to be sent. If the given layers contain a signed
 outer layer, its <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess"><CODE>MLExpansionHistory</CODE></A> attribute
 (if included) may supersede the receipt request of the sender.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>part</CODE> - the MIME part possibly containing a signed inner and a signed outer layer<DD><CODE>myName</CODE> - the name of the SignedReceipt creator (the one who sends the signed receipt)<DD><CODE>debugStream</CODE> - the stream to which debug information shall be written;
                    maybe <code>null</code> for disabling debug output
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils">SignedReceiptException</A></CODE> - if the signed receipt creation fails for any reason 
            (e.g. no receipt is requested from the holder of myName, or there is no
                  signed inner layer at all)
<DD><CODE><A HREF="../../../../iaik/smime/ess/utils/ESSLayerException.html" title="class in iaik.smime.ess.utils">ESSLayerException</A></CODE> - if an error occurs when parsing/decomposing the part  or
                              any of the signatures of a signed layer is invalid</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getReceiptRequest()"><!-- --></A><H3>
getReceiptRequest</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess">ReceiptRequest</A> <B>getReceiptRequest</B>()</PRE>
<DL>
<DD>Returns the ReceiptRequest attribute from the originator SignerInfo.
 Based on the information from this request, the signed receipt will be built.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the ReceiptRequest attribute from the originator SignerInfo</DL>
</DD>
</DL>
<HR>

<A NAME="getMLExpansionHistory()"><!-- --></A><H3>
getMLExpansionHistory</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/MLExpansionHistory.html" title="class in iaik.smime.ess">MLExpansionHistory</A> <B>getMLExpansionHistory</B>()</PRE>
<DL>
<DD>Return the MLExpansionHistory attribute of the outer layer. Maybe null if there is no outer layer
 or if the outer layer does not contain a MLExpansionHistory attribute. If present, the MLExpansionHistory
 may have influence on the receipt content creation procedure (e.g. if it supersedes the original
 receipt request).
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getReceiptsTo()"><!-- --></A><H3>
getReceiptsTo</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/GeneralNames.html" title="class or interface in iaik.asn1.structures">GeneralNames</A>[] <B>getReceiptsTo</B>()</PRE>
<DL>
<DD>Returns the general names this SignedReceipt should be sent to.
 The GeneralNames array returned by this method must not necessarily be the same
 as contained in the <code>receiptsTo</code> field of the ReceiptRequest 
 attribute to which this signed receipt corresponds. Depending on the
 presence of an outer SignedLayer layer which may contain an MLExpansionHistory
 attribute an MLReceiptPolicy of IN_ADDITION_TO or INSTEAD_OF may affect the
 receiptsTo entries.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the general names this SignedReceipt should be sent to.</DL>
</DD>
</DL>
<HR>

<A NAME="getReceiptsToAddresses()"><!-- --></A><H3>
getReceiptsToAddresses</H3>
<PRE>
public java.lang.String[] <B>getReceiptsToAddresses</B>()</PRE>
<DL>
<DD>Returns the email addresses this SignedReceipt should be sent to.
 The email String array returned by this method must not necessarily be the same
 as contained in the <code>receiptsTo</code> field of the ReceiptRequest 
 attribute to which this signed receipt corresponds. Depending on the
 presence of an outer SignedLayer layer which may contain an MLExpansionHistory
 attribute an MLReceiptPolicy of IN_ADDITION_TO or INSTEAD_OF may affect the
 receiptsTo entries. This method steps to all receiptsTo GeneralNames and
 picks any included rfc822name.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the email addresses this SignedReceipt should be sent to.</DL>
</DD>
</DL>
<HR>

<A NAME="getReceiptsToAddressList()"><!-- --></A><H3>
getReceiptsToAddressList</H3>
<PRE>
public java.lang.String <B>getReceiptsToAddressList</B>()</PRE>
<DL>
<DD>Returns the email addresses this SignedReceipt should be sent to.
 The email address list (as comma separeted String of addresses) returned by
 this method must not necessarily be the same as contained in the 
 <code>receiptsTo</code> field of the ReceiptRequest attribute to which
 this signed receipt corresponds. Depending on the presence of an outer
 SignedLayer layer which may contain an MLExpansionHistory attribute an
 MLReceiptPolicy of IN_ADDITION_TO or INSTEAD_OF may affect the
 receiptsTo entries. This method steps to all receiptsTo GeneralNames and
 picks any included rfc822name.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the email addresses this SignedReceipt should be sent to (as comma
         separeted String of addresses).</DL>
</DD>
</DL>
<HR>

<A NAME="getOriginatorSignerInfos()"><!-- --></A><H3>
getOriginatorSignerInfos</H3>
<PRE>
public <A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[] <B>getOriginatorSignerInfos</B>()</PRE>
<DL>
<DD>Returns all SignerInfos of the original inner SignedData layer that contain a
 valid <A HREF="../../../../iaik/smime/ess/ReceiptRequest.html" title="class in iaik.smime.ess"><CODE>ReceiptRequest</CODE></A> attribute.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>all SignerInfos of the original inner SignedData layer that contain a
         valid ReceiptRequest attribute</DL>
</DD>
</DL>
<HR>

<A NAME="createReceipt()"><!-- --></A><H3>
createReceipt</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/Receipt.html" title="class in iaik.smime.ess">Receipt</A> <B>createReceipt</B>()
                      throws <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates a Receipt attribute based on the information parsed
 from the originator SignerInfo.
 This method may be used when needing the raw Receipt only:
 <pre> 
 // email address of the receipt creator (the one who has received the receipt request)
 String receiptEmailAddress = ...;
 // message containing the receipt request:
 MimeMessage msg = ...;
 SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
 Receipt receipt = signedReceipt.createReceipt();
 </pre>
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the newly created Receipt attribute.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if an error occurs when creating the
            Receipt attribute (e.g. no originator SignerInfo
            has been obtained from the signed inner layer, or
            no ReceiptRequest is included in the originator
            SignerInfo)</DL>
</DD>
</DL>
<HR>

<A NAME="createReceiptContent()"><!-- --></A><H3>
createReceiptContent</H3>
<PRE>
public <A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess">ReceiptContent</A> <B>createReceiptContent</B>()
                                    throws <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates a ReceiptContent based on the information parsed
 from the originator SignerInfo (got from the inner signed layer
 of the receipt request conatining message). After having created the <A HREF="../../../../iaik/smime/ess/ReceiptContent.html" title="class in iaik.smime.ess"><CODE>ReceiptContent</CODE></A> an application may set
 signer information and certificates to finally sent the
 SignedReceipt to the intended rscipients, e.g.:
 <pre>
 // email address of the receipt creator (the one who has received the receipt request)
 String receiptEmailAddress = ...;
 // message containing the receipt request:
 MimeMessage msg = ...;
 SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
 // sendTo is the one to which the receipt should be send
 String sendTo = signedReceipt.getReceiptsToAddressList();
 MimeMessage msg = new MimeMessage(...);
 msg.setFrom(new InternetAddress(receiptEmailAddress));
 msg.setRecipients(Message.RecipientType.TO, InternetAddress.parse(sendTo));
 msg.setSubject(...);
 ...
 ReceiptContent receiptContent = signedReceipt.createReceiptContent();
 // for this simple demo signer = recipient
 receiptContent.setCertificates(...);
 receiptContent.setSigner(...);
 msg.setContent(receiptContent, receiptContent.getContentType());
 receiptContent.setHeaders(msg);
 Transport.send(msg);
 </pre>
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the newly created ReceiptContent
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if an error occurs when creating the
            ReceiptContent (e.g. no originator SignerInfo
            has been obtained from the signed inner layer, or
            no ReceiptRequest is included in the originator
            SignerInfo)</DL>
</DD>
</DL>
<HR>

<A NAME="createReceiptMessage(iaik.cms.SignerInfo, iaik.x509.X509Certificate[], javax.mail.Session, java.lang.String)"><!-- --></A><H3>
createReceiptMessage</H3>
<PRE>
public javax.mail.internet.MimeMessage <B>createReceiptMessage</B>(<A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;receiptSigner,
                                                            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;signerCertificates,
                                                            javax.mail.Session&nbsp;session,
                                                            java.lang.String&nbsp;subject)
                                                     throws javax.mail.MessagingException,
                                                            <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates a SignedReceipt message based on the information parsed
 from the originator SignerInfo (got from the inner signed layer
 of the receipt request conatining message). The receipt signer
 information has to be supplied as CMS <A HREF="../../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> object, e.g.:
 <pre>
 // email address of the receipt creator (the one who has received the receipt request)
 String receiptEmailAddress = ...;
 // message containing the receipt request:
 MimeMessage msg = ...;
 SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
 String subject = "...";
 SignerInfo receiptSigner = ...;
 Message msg = signedReceipt.createReceiptMessage(receiptSigner, 
                                                  signerCertificates,
                                                  session,
                                                  subject);
 Transport.send(msg);
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>receiptSigner</CODE> - information about the signer of the receipt<DD><CODE>signerCertificates</CODE> - the certificates of the receipt signer<DD><CODE>session</CODE> - the current mail session<DD><CODE>subject</CODE> - the subject header of the receipt message
<DT><B>Returns:</B><DD>the newly created SignedReceipt message
<DT><B>Throws:</B>
<DD><CODE>javax.mail.MessagingException</CODE> - if an error occurs when creating the message
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if an error occurs when creating the
            Receipt  message (e.g. no originator SignerInfo
            has been obtained from the signed inner layer, or
            no ReceiptRequest is included in the originator
            SignerInfo)</DL>
</DD>
</DL>
<HR>

<A NAME="createReceiptMessage(java.security.PrivateKey, iaik.x509.X509Certificate[], iaik.x509.X509Certificate, iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, iaik.x509.X509Certificate, boolean, javax.mail.Session, java.lang.String)"><!-- --></A><H3>
createReceiptMessage</H3>
<PRE>
public javax.mail.internet.MimeMessage <B>createReceiptMessage</B>(java.security.PrivateKey&nbsp;privateKey,
                                                            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]&nbsp;certificates,
                                                            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate,
                                                            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                                            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                                            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;encryptionCertificate,
                                                            boolean&nbsp;includeEncryptionCertIDForMSOE,
                                                            javax.mail.Session&nbsp;session,
                                                            java.lang.String&nbsp;subject)
                                                     throws javax.mail.MessagingException,
                                                            <A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></PRE>
<DL>
<DD>Creates a SignedReceipt message based on the information parsed
 from the originator SignerInfo (got from the inner signed layer
 of the receipt request conatining message). The receipt is signed
 with the given key using the supplied signature algorithm, e.g.:
 <pre>
 // email address of the receipt creator (the one who has received the receipt request)
 String receiptEmailAddress = ...;
 // message containing the receipt request:
 MimeMessage msg = ...;
 SignedReceipt signedReceipt = new SignedReceipt(msg, receiptEmailAddress);
 String subject = "...";
 Message msg = signedReceipt.createReceiptMessage(signerPrivateKey, 
                                                  signerCertificates,
                                                  AlgorithmID.sha1,
                                                  AlgorithmID.rsaEncryption,
                                                  encryptionCertOfSigner,
                                                  true,
                                                  session,
                                                  subject);
 Transport.send(msg);
 </pre>
 When using this method to create a SignedRecipt message, the 
 following attributes are set for the receipt SignerInfo:
 <ul>
  <li>Content-Type (ESS receipt)
  <li>Signing-Time
  <li>S/MIME Capabilities specifying the follwing symmetric ciphers:
    <ul>
      <li>des_CBC (DES in CBC mode)
      <li>des_EDE3_CBC (TripleDes in CBC mode)
      <li>rc2_CBC (RC2 in CBC mode with 128, 64 or 40 bit key)
    </ul>
 <li>SMIMEEncryptionKeyPreference, if <code>encryptionCertificate</code> is not <code>null</code>
 <li>a private MS attribute ("1.3.6.1.4.1.311.16.4") identifying the encryption cert if 
     if <code>encryptionCertificate</code> is not <code>null</code> and 
     <code>includeEncryptionCertIDForMSOE</code> allowing MSOE to recognize
     the encryption certificate is different certs are used for signing
     and encryption
 <li>ESS MsgSigDigest representing the digest value on the original content
 </ul>
 The PKCS#9 message digest attribute automatically will be added later, during
 the data is written to a stream, and after SHA-1 hash calculation is completed.
 <p>
 Inclusion of a special private Microsoft signed attribute (type: 1.3.6.1.4.1.311.16.4)
 for identifying encryption certificate of the sender by IssuerAndSerialNumber
 might be useful to tell Outlook Express the encryption certificate to be used if
 separate certificates are used for signing and encryption. If you want to include
 this attribute, set <code>includeEncryptionCertIDForMSOE</code> to <code>true</code>
 and supply the IssuerAndSerialNumber of the encryption certificate ("encrypter").
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>privateKey</CODE> - the private key to sign the content<DD><CODE>certificates</CODE> - the (signing and possibly encryption) certificates of the 
                     signer;<DD><CODE>signerCertificate</CODE> - the certificate of the signer<DD><CODE>digestAlgorithm</CODE> - the digest algorithm; default: SHA-1 (used, if null)<DD><CODE>signatureAlgorithm</CODE> - the signature algorithm; default: rsaEncryption (used, if null);
        <b>Attention!</b> use AlgorithmID.rsaEncryption for RSA signing!<DD><CODE>encryptionCertificate</CODE> - the encryption certificate of the
        sender (or <code>null</code> if signing and encryption cert are the
        same or no encryption certificate shall be indicated)<DD><CODE>includeEncryptionCertIDForMSOE</CODE> - if <code>true</code>,
        a private MS attribute will be included allowing MSOE to recognize
        the encryption cert of the signer if using different certs for
        signing/encryption<DD><CODE>session</CODE> - the current mail session<DD><CODE>subject</CODE> - the subject header of the receipt message
<DT><B>Returns:</B><DD>the newly created SignedReceipt message
<DT><B>Throws:</B>
<DD><CODE>javax.mail.MessagingException</CODE> - if an error occurs when creating the message
<DD><CODE><A HREF="../../../../iaik/smime/ess/ESSException.html" title="class in iaik.smime.ess">ESSException</A></CODE> - if an error occurs when creating the
            Receipt  message (e.g. no originator SignerInfo
            has been obtained from the signed inner layer, or
            no ReceiptRequest is included in the originator
            SignerInfo)</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SignedESSLayer.html" title="class in iaik.smime.ess.utils"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../iaik/smime/ess/utils/SignedReceiptException.html" title="class in iaik.smime.ess.utils"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?iaik/smime/ess/utils/SignedReceipt.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedReceipt.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../../../siclogo.jpg> <IMG SRC=../../../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
