<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:12 GMT 2016 -->
<TITLE>
EnvelopedDataStream (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.EnvelopedDataStream class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="EnvelopedDataStream (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/EnvelopedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/HashEngine.html" title="interface in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/EnvelopedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="EnvelopedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class EnvelopedDataStream</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.EnvelopedDataStream</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A>, java.util.EventListener</DD>
</DL>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms">EnvelopedData</A>, <A HREF="../../iaik/smime/SMimeEncrypted.html" title="class in iaik.smime">SMimeEncrypted</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>EnvelopedDataStream</B><DT>extends java.lang.Object<DT>implements <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A></DL>
</PRE>

<P>
This class represents the stream-supporting implementation of the CMS content
 type <code>EnvelopedData</code>.
 <p>
 Each CMS content type is associated with a specific object identifier,
 derived from:
 <p><PRE>
 pkcs-7 OBJECT IDENTIFIER ::=
   { iso(1) member-body(2) US(840) rsadsi(113549)
       pkcs(1) 7 }
 </PRE><p>
 The object identifier for the <code>EnvelopedData</code> content type is
 defined as:
 <p><code>
 envelopedData OBJECT IDENTIFIER ::= { pkcs-7 3 }
 </code><p>
 which corresponds to the OID string "1.2.840.113549.1.7.3".
 <p>
 The Cryptographic Message Syntax (CMS) (<a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>) 
 specifies the <code>EnvelopedData</code> content type for providing a syntax
 for building digital envelopes. Content of any type may be enveloped for any 
 number of recipients in parallel. For each recipient, a commonly at random
 generated content-encryption key is encrypted with the particular recipient 
 key and - together with recipient-specific information - collected into a 
 <code>RecipientInfo</code> value. The content is encrypted with the 
 content-encryption key giving a <code>EncryptedContent</code> value, which - 
 in combination with a recipient-specific encrypted content-encryption key - forms
 the digital envelope for each particular recipient. All <code>RecipientInfo</code>
 values are collected together with the encrypted content into an<code>
 EnvelopedData</code> value to be sent to each intended recipient.
 <p>
 This class implements the <code>EnvelopedData</code> structure resulting from
 the last step described above. The <code>EnvelopedData</code> type is defined
 as ASN.1 SEQUENCE type containing the following components (see 
 <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>):
 <p><PRE>
 EnvelopedData ::= SEQUENCE {
   version                CMSVersion,
   originatorInfo     [0] IMPLICIT OriginatorInfo OPTIONAL,
   recipientInfos         RecipientInfos,
   encryptedContentInfo   EncryptedContentInfo 
   unprotectedAttrs   [1] IMPLICIT UnptotectedAttributes OPTIONAL }
 <br>
 OriginatorInfo ::= SEQUENCE {
   certs [0] IMPLICIT CertificateSet OPTIONAL,
   crls [1] IMPLICIT RevocationInfoChoices OPTIONAL }
 <br>
 RecipientInfos ::= SET OF RecipientInfo
 <br>
 EncryptedContentInfo ::= SEQUENCE {
   contentType                 ContentType,
   contentEncryptionAlgorithm  ContentEncryptionAlgorithmIdentifier,
   encryptedContent        [0] IMPLICIT EncryptedContent OPTIONAL }
 <br>
 EncryptedContent ::= OCTET STRING
 <br>
 UnprotectedAttributes ::= SET SIZE (1..MAX) OF Attribute
 </PRE><p>
 The <code>recipientInfos</code> field is a non-empty collection of
 per-recipient information. The <code>encryptedContentInfo</code> field
 specifies the type of the content being enveloped, the content-encryption
 algorithm (the same for all recipients) used for encrypting the content,
 and the result of the content encryption. If the encrypted content value
 is not present in the <code>encryptedContent</code> field, it has to be
 supplied by other means.
 <br>
 CMS provides five alternatives for encrypting the content depending
 on the key management algorithm used to protect the content encryption 
 key for a specific recipient:
 <ul>
 <li>key transport: the content-encryption key is encrypted with the public
                    key of the recipient. This technique is compatible to PKCS#7
                    when creating a RecipientInfo of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> for the public key of the recipient 
                    certificate, identified by <A HREF="../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>IssuerAndSerialNumber</CODE></A>. CMS recommends to use RSA for encrypting
                    the content encryption key.
 <li>key agreement: the recipient public key and the sender private key are
                    used to generate a pairwise symmetric key, then the content
                    encryption key is encrypted with the pairwise symmetric key.
                    Each RecipientInfo of type <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A> may transfer the encrypted content
                    encryption key to one or more recipient using the same key
                    agreement algorithm and domain parameters for that algorithm.
                    CMS recommends to use ESDH with an ephemeral sender key.
 <li>symmetric key-encryption keys: the content-encryption key is encrypted with
                   a previously distributed symmetric key-encryption key. The
                   RecipientInfo is of type <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A> using a CMS key wrap algorithm like
                   Triple-DES key wrap or RC2 key wrap.
 <li>password based encryption: the content-encryption key is encrypted with a
                   secret key derived from a password. The RecipientInfo is of
                   type <A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PassowrdRecipientInfo</CODE></A>
                   using a CMS key wrap algorithm like PWRI-KEK (<a href = 
                   http://www.ietf.org/rfc/rfc3211.txt" target="_blank">RFC 3211</a>).
 <li>user defined key management. The RecipientInfo is of type <A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A>.
 </ul>
 The optional <code>originatorInfo</code> field may be used to include certificate/crl 
 information about the originator if required by the key managemant protocol.
 <code>unprotectedAttrs</code> optionally may provide some attributes that are
 not encrypted.
 <p>
 A recipient, when receiving the <code>EnvelopedData</code> message,
 decrypts the corresponding encrypted content-encryption key with his/her
 key according the right key management protocol for subsequently decrypting the
 encrypted content using the content-encryption key just recovered. The recipient's 
 key is referenced by proper <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms"><CODE>KeyIdentifier</CODE></A> included
 in the corresponding <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> object.
 <p>
 See <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a> for more 
 information.
 <p>
 <hr>
 <p>
 When creating a new <code>EnvelopedDataStream</code> object for the data to be enveloped
 the symmetric algorithm has to be specified to be used for content-encryption. After setting
 the recipients, the EnvelopedDataStream object may be encoded and written to an output stream
 by using a proper <A HREF="../../iaik/cms/EnvelopedDataStream.html#writeTo(java.io.OutputStream, int)"><CODE>writeTo</CODE></A> method, e.g.:
 <ol>
 <li>Create a new EnvelopedDataStream object and specify the content encryption algorithm
     to be used by means of the <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>EnvelopedDataStream(InputStream is, AlgorithmID contentEA)</CODE></A> constructor. Calling
     this constructor internally will generate the temporary content-encryption key for the
     specified content-encryption algorithm. If using a content-encryption algorithm
     allowing keys of different size, you may specify the key length by using the
     <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><CODE>EnvelopedDataStream(InputStream is, AlgorithmID contentEA, int keyLength)</CODE></A>
     constructor.
     <pre>
     //the data to be enveloped supplied from an input stream:
     InputStream dataStream = ...;
     //use TripleDES in CBC mode for encrypting the content
     EnvelopedDataStream enveloped_data = new EnvelopedDataStream(dataStream, (AlgorithmID)AlgorithmID.des_EDE3_CBC.clone());
     </pre>
 <li>For each intended recipient, create a <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> object of requested type (<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>,
     or <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>), and add all RecipientInfos 
     to the EnvelopedDataStream object by calling the <A HREF="../../iaik/cms/EnvelopedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])"><CODE>setRecipientInfos</CODE></A> method, e.g.
     (assuming to use KeyTransRecipientInfos for two recipients with corresponding 
     certificates <code>cert1</code> and <code>cert2</code>):
     <pre>
     RecipientInfo[] recipients = new RecipientInfo[2];
     recipients[0] = new KeyTransRecipientInfo(cert1, (AlgorithmID)AlgorithmID.rsaEncryption.clone());
     recipients[1] = new KeyTransRecipientInfo(cert2, (AlgorithmID)AlgorithmID.rsaEncryption.clone());
     enveloped_data.setRecipientInfos(recipients);
     </pre>
 <li>Use a proper <A HREF="../../iaik/cms/EnvelopedDataStream.html#writeTo(java.io.OutputStream, int)"><CODE>writeTo</CODE></A> method for BER encoding the
     EnvelopedData object and writing it to an output stream. You optionally may specify
     a particular block size for splitting the encoding of encrypted content. This step
     also will perform the encryption of the symmetric content-encryption key for each
     participated recipient.
     <pre>
     int blockSize = ...;
     OutputStream encoded_stream = ...;
     enveloped_data.writeTo(encoded_stream, blockSize);
     </pre>
     respectively
     <pre>
     enveloped_data.writeTo(encoded_stream);
     </pre>
     When a positve block size (default 2048) is specified for encoding the EnvelopedData to a stream,
     the encrypted content is BER encoded as indefinite constructed octet string being composed
     of a series of definite primitive encoded octet strings of <code>blockSize</code> length:
     <pre>
     0x24 0x80
               0x04 &lt;blocksize&gt; &lt;first encrypted content block&gt;
               0x04 &lt;blocksize&gt; &lt;second encrypted content block&gt;
               0x04 &lt;blocksize&gt; &lt;third encrypted content block&gt;
                   ...
     0x00 0x00
     </pre>
     instead of:
     <pre>
     0x04 &lt;length&gt; &lt;encrypted content&gt;
     </pre>
 </ol>
 A recipient, when receiving a EnvelopedDataStream encoding, uses the
 <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream)"><CODE>EnvelopedDataStream(InputStream is)</CODE></A>
 constructor for parsing the internal structure. Before reading the recovered content by
 means of the <A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method, the cipher has to be
 initialized for decryption with the particular recipient key by calling one of the
 following <code>setupCipher</code> methods:
 <ul>
 <li><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key, int)"><CODE>setupCipher(Key recipientKey, int recipientInfoIndex)</CODE></A>:
     This method can be used for decrypting the encrypted content-encryption key for 
     a RecipientInfo of any type; however, you must know the right index into the 
     <code>recipientInfo</code> field. The recovered content-encryption key is used
     for setting up the cipher to decrypt the encrypted content.
 <li><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key, iaik.cms.KeyIdentifier)"><CODE>setupCipher(Key recipientKey, 
     KeyIdentifier recipientKeyIdentifier)</CODE></A>: This method can be used for decrypting the
     encrypted content-encryption key for a RecipientInfo of any type; the recipient is
     identified by its <A HREF="../../iaik/cms/RecipientKeyIdentifier.html" title="class in iaik.cms"><CODE>RecipientKeyIdentifier</CODE></A>.
     The recovered content-encryption key is used for setting up the cipher to decrypt
     the encrypted content.
 <li><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key, iaik.x509.X509Certificate)"><CODE>setupCipher(Key recipientKey, 
     X509Certificate recipientCertificate)</CODE></A>: This method only can be used for decrypting
     the encrypted content-encryption key for a RecipientInfo of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>; the recipient is
     identified by its public key certficate. The recovered content-encryption key is used
     for setting up the cipher to decrypt the encrypted content.
 <li><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key)"><CODE>setupCipher(Key)</CODE></A>: In contrast to the three <code>setupCipher</code>
     above you have to supply the already decrypted content-encryption key when setting
     up the cipher for content encryption using this <code>setupCipher</code> method.
 </ul>
 Since in our example both recipients use a RecipientInfo of type <code>KeyTransRecipientInfo</code>,
 we can use any of the <code>setupCipher</code> methods to setup the cipher for
 decrypting the encrypted content-encryption key and the encrypted content:
 <ol>
 <li>Create an EnvelopedDataStream structure from the supplied encoding, decode and parse
     the internal structure:
     <pre>
     EnvelopedDataStream enveloped_data = new EnvelopedDataStream(encoded_stream);
     </pre>
 <li>Get information about the inherent EncryptedContentInfo:
     <pre>
     EncryptedContentInfoStream eci = (EncryptedContentInfoStream)enveloped_data.getEncryptedContentInfo();
     System.out.println("Content type: "+eci.getContentType().getName());
     System.out.println("Content encryption algorithm: "+eci.getContentEncryptionAlgorithm().getName());
     </pre>
 <li>Get information about the included RecipientInfos:
     <pre>
     RecipientInfo[] recipients = enveloped_data.getRecipientInfos();
     System.out.println("Included RecipientInfos:");
     for (int i=0; i < recipients.length; i++) {
        System.out.print("Recipient "+(i+1)+":");
        System.out.println(recipients[i]);
     }
     </pre>
 <li>Use some recipient specific key to decrypt the inherent encrypted
     secret key to be used for initializing the cipher for encrypted-content decryption:
     <pre>
     // the private key of recipient 1:
     Key privateKey = ...;
     //setup cipher for recipient 1:
     int recipientInfoIndex = 0;
     enveloped_data.setupCipher(privateKey, recipientInfoIndex);
     </pre>
     Unlike the non-stream supporting <A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms"><CODE>EnvelopedData</CODE></A> class where the encrypted-content decryption
     already is performed inside the <code>setupCipher</code> method, the cipher
     will be only initialized for decryption in this class. The encrypted-content
     decryption actually is done during reading the data obtained by calling the
     <A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method. So do not call
     <code>getInputStream</code> before setting up the cipher!
     <p>
 <li>Get and read the recovered content:
     <pre>
     InputStream data_is = enveloped_data.getInputStream();
     byte[] buf = new byte[4096];
     int r;
     while ((r = data_is.read(buf)) > 0) {
        // do something useful
     }
     </pre>
 </ol>
 <p>
 <hr>
 <p>
 This class may be also use to create/encrypt or parse/decrypt <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>explicit</CODE></A> 
 EnvelopedData messages where the encrypted content is not included in the 
 EnvelopedData/EncryptedContentInfo but transferred by other means outside the
 EnvelopedData/EncryptedContentInfo. 
 <br>
 For creating an <code>EnvelopedDataStream</code> in explicit mode the (to-be-encrypted) 
 content has to be specified as usual when calling the constructor. 
 Subsequently method <A HREF="../../iaik/cms/EnvelopedDataStream.html#setMode(int)"><CODE><code>setMode</code></CODE></A> has to be called to set
 the mode to <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>EnvelopedDataStream.EXPLICIT</CODE></A>. Before finally <A HREF="../../iaik/cms/EnvelopedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writing</CODE></A> the EnvelopedData encoded to an output stream, method <A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()"><CODE><code>getInputStream()</code></CODE></A> has to be called to read (and thereby)
 encrypt the content data to be transferred by other means:
 <pre>
 //the data to be enveloped supplied from an input stream:
 InputStream dataStream = ...;
 //use, e.g., TripleDES in CBC mode for encrypting the content
 EnvelopedDataStream envelopedData = new EnvelopedDataStream(dataStream, (AlgorithmID)AlgorithmID.des_EDE3_CBC.clone());
 // the encrypted content shall be transmitted outside the EnvelopedData
 envelopedData.setMode(EnvelopedDataStream.EXPLICIT);
 // create and set the recipient infos
 RecipientInfo[] recipients = ...;
 envelopedData.setRecipientInfos(recipients);
 // read and encrypt the content data to be transmitted outside the EnvelopedData
 InputStream encryptedContentIs = envelopedData.getInputStream();
 byte[] buf = ...;
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 }
 // encode the EnvelopedData
 OutputStream os = ...;
 envelopedData.writeTo(os); 
 </pre>
 When parsing an explicit EnvelopedData method <A HREF="../../iaik/cms/EnvelopedDataStream.html#setInputStream(java.io.InputStream)"><CODE><code>setInputStream</code></CODE></A>
 has to be called to specify the encrypted content received by other means:
 <pre>
 // the input stream from which to read the encoded EnvelopedData:
 InputStream encodedStream = ...;
 // create EnvelopedDataStream
 EnvelopedDataStream envelopedData = new EnvelopedDataStream(encodedStream);
   ...
 // set the encrypted content received by other means
 InputStream encryptedContentStream = ...;
 envelopedData.setInputStream(encryptedContentStream);
 // setup cipher and decrypt the message for the, e.g., first recipient
 PrivateKey privateKey = ...;
 int recipientInfoIndex = 0;
 envelopedData.setupCipher(privateKey, 0);
 InputStream decryptedDataIs = envelopedData.getInputStream();
 byte[] buf = new byte[4096];
 int r;
 while ((r = decryptedDataIs.read(buf)) > 0) {
   // do something useful
 }  
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms"><CODE>EncryptedContentInfoStream</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#blockSize_">blockSize_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The block size for block oriented stream encoding.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#encryptedContentInfo_">encryptedContentInfo_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The EncryptedContentInfo for the encrypted content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT">EXPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the encrypted message is not transported within the EnvelopedData (EncryptedContentInfo).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#IMPLICIT">IMPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the encrypted message is included in the EnvelopedData (EncryptedContentInfo).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#keyChanged_">keyChanged_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Whether the content encryption key has changed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#originatorInfo_">originatorInfo_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The optional OriginatorInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.Vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#recipientInfos_">recipientInfos_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Repository for the RecipientInfos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#securityProvider_">securityProvider_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The SecurityProvider providing the required cryptographic engines.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#symmetricKey_">symmetricKey_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The secret content encryption key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#unprotectedAttrs_">unprotectedAttrs_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optional unprotected attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#version_">version_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The version number; default 0.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream()">EnvelopedDataStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default constructor for dynamic object creation in ContentInfoStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream)">EnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new EnvelopedDataStream from a BER encoded EnvelopedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)">EnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)">EnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                    int&nbsp;keyLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)">EnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is,
                    <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new EnvelopedDataStream from a BER encoded EnvelopedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)">EnvelopedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                    java.io.InputStream&nbsp;is,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)">EnvelopedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                    java.io.InputStream&nbsp;is,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                    int&nbsp;keyLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)">EnvelopedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                    java.io.InputStream&nbsp;is,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                    int&nbsp;keyLength,
                    <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.cms.RecipientInfo[], iaik.cms.EncryptedContentInfoStream)">EnvelopedDataStream</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients,
                    <A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A>&nbsp;encryptedCI)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructs an EnvelopedDataStream object with an already
 created EncryptedContentInfoStream.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#addRecipientInfo(iaik.cms.RecipientInfo)">addRecipientInfo</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds one recipient to the list of recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#decode(java.io.InputStream)">decode</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reads and decodes an BER encoded EnvelopedData from a the given input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getBlockSize()">getBlockSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the block size defining the length of each definite primitive
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getContentType()">getContentType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the content type this class implements.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getEncryptedContentInfo()">getEncryptedContentInfo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the EncryptedContentInfo included in this <code>EnvelopedDataStream</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.InputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()">getInputStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an InputStream from where the decrypted data can be read.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getMode()">getMode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the mode of this EncryptedContentInfoStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getOriginatorInfo()">getOriginatorInfo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the OriginatorInfo, if included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getRecipientInfo(iaik.cms.KeyIdentifier)">getRecipientInfo</A></B>(<A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the RecipientInfo belonging to the recipient identified by the
 given recipient identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getRecipientInfo(iaik.x509.X509Certificate)">getRecipientInfo</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the recipient info matching to the supplied recipient certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getRecipientInfos()">getRecipientInfos</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the recipient infos included in this
 <code>EnvelopedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getRecipientInfos(int)">getRecipientInfos</A></B>(int&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the recipient infos included in this
 <code>EnvelopedData</code> object that have the specified type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getSecurityProvider()">getSecurityProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityProvider installed for this EncryptedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getUnprotectedAttribute(iaik.asn1.ObjectID)">getUnprotectedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first unprotected attribute matching to the given ObjectID, if 
 included in this EnvelopedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getUnprotectedAttributes()">getUnprotectedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the unprotected attributes included in this EnvelopedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#getVersion()">getVersion</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the syntax version number.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#notifyEOF()">notifyEOF</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method implements the EOFListener interface for performing the final decoding.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setBlockSize(int)">setBlockSize</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the block size for defining the length of each definite primitive
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setInputStream(java.io.InputStream)">setInputStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the input stream that supplies the content data to be encrypted.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setMode(int)">setMode</A></B>(int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the mode for this EnvelopedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setOriginatorInfo(iaik.cms.OriginatorInfo)">setOriginatorInfo</A></B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the optional OriginatorInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])">setRecipientInfos</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A></B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityProvider for this EnvelopedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setUnprotectedAttributes(iaik.asn1.structures.Attribute[])">setUnprotectedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of (unprotected) attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key)">setupCipher</A></B>(java.security.Key&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the given symmetric key to setup the cipher for decrypting the content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key, int)">setupCipher</A></B>(java.security.Key&nbsp;recipientKey,
            int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the content-encryption key to setup the
 cipher for decrypting the encrypted content of this <code>EnvelopedDataStream</code>
 object for the requesting recipient, specified by its <code>recipientInfoIndex</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key, iaik.cms.KeyIdentifier)">setupCipher</A></B>(java.security.Key&nbsp;recipientKey,
            <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the content-encryption key to setup the
 cipher for decrypting the encrypted content of this <code>EnvelopedDataStream</code>
 object for the requesting recipient, specified by the given recipient identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key, iaik.x509.X509Certificate)">setupCipher</A></B>(java.security.Key&nbsp;recipientKey,
            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the content-encryption key to setup the
 cipher for decrypting the encrypted content of this <code>EnvelopedDataStream</code>
 object for the requesting recipient, specified by the given recipient certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#toASN1Object()">toASN1Object</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this EnvelopedDataStream as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#toASN1Object(int)">toASN1Object</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this EnvelopedData as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some information about this
 <code>EnvelopedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#toString(boolean)">toString</A></B>(boolean&nbsp;detailed)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some - if requested - detailed information
 about this <code>EnvelopedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#writeTo(java.io.OutputStream)">writeTo</A></B>(java.io.OutputStream&nbsp;os)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes this EnvelopedData BER encoded to the given output stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/EnvelopedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</A></B>(java.io.OutputStream&nbsp;os,
        int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes this EnvelopedData BER encoded to the given output stream
 where a constructed OCTET STRING may be used for encoding the content.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="IMPLICIT"><!-- --></A><H3>
IMPLICIT</H3>
<PRE>
public static final int <B>IMPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the encrypted message is included in the EnvelopedData (EncryptedContentInfo).
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.EnvelopedDataStream.IMPLICIT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="EXPLICIT"><!-- --></A><H3>
EXPLICIT</H3>
<PRE>
public static final int <B>EXPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the encrypted message is not transported within the EnvelopedData (EncryptedContentInfo).
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.EnvelopedDataStream.EXPLICIT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="version_"><!-- --></A><H3>
version_</H3>
<PRE>
protected int <B>version_</B></PRE>
<DL>
<DD>The version number; default 0.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="originatorInfo_"><!-- --></A><H3>
originatorInfo_</H3>
<PRE>
protected <A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A> <B>originatorInfo_</B></PRE>
<DL>
<DD>The optional OriginatorInfo.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="recipientInfos_"><!-- --></A><H3>
recipientInfos_</H3>
<PRE>
protected java.util.Vector <B>recipientInfos_</B></PRE>
<DL>
<DD>Repository for the RecipientInfos.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="encryptedContentInfo_"><!-- --></A><H3>
encryptedContentInfo_</H3>
<PRE>
protected <A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A> <B>encryptedContentInfo_</B></PRE>
<DL>
<DD>The EncryptedContentInfo for the encrypted content.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="symmetricKey_"><!-- --></A><H3>
symmetricKey_</H3>
<PRE>
protected javax.crypto.SecretKey <B>symmetricKey_</B></PRE>
<DL>
<DD>The secret content encryption key.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="blockSize_"><!-- --></A><H3>
blockSize_</H3>
<PRE>
protected int <B>blockSize_</B></PRE>
<DL>
<DD>The block size for block oriented stream encoding.
 (Default: 2048 to enforce indefinite constructed encoding).
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="unprotectedAttrs_"><!-- --></A><H3>
unprotectedAttrs_</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>unprotectedAttrs_</B></PRE>
<DL>
<DD>Optional unprotected attributes.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="securityProvider_"><!-- --></A><H3>
securityProvider_</H3>
<PRE>
protected <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>securityProvider_</B></PRE>
<DL>
<DD>The SecurityProvider providing the required cryptographic engines.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="keyChanged_"><!-- --></A><H3>
keyChanged_</H3>
<PRE>
protected boolean <B>keyChanged_</B></PRE>
<DL>
<DD>Whether the content encryption key has changed.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="EnvelopedDataStream()"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
protected <B>EnvelopedDataStream</B>()</PRE>
<DL>
<DD>Default constructor for dynamic object creation in ContentInfoStream.
 The block size is set to 2048 to enforce indefinite constructed encoding.
<P>
</DL>
<HR>

<A NAME="EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(java.io.InputStream&nbsp;is,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA)
                    throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.
 <p>
 The content type is set to CMS <code>Data</code>.
 <p>
 When using this constructor, automatically a temporary symmetric key for content
 encryption is generated. If using a content-encryption algorithm allowing keys
 of different size, you may specify the key length by using the <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><CODE>EnvelopedDataStream(InputStream is, AlgorithmID contentEA, int keyLength)</CODE></A>
 constructor.
 <br>
 Note that the supplied <code>contentEA</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying the data to be enveloped<DD><CODE>contentEA</CODE> - the content encryption algorithm for encrypting the content
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the specified algorithm</DL>
</DL>
<HR>

<A NAME="EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                           java.io.InputStream&nbsp;is,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA)
                    throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.
 <p>
 When using this constructor, automatically a temporary symmetric key for content
 encryption is generated. If using a content-encryption algorithm allowing keys
 of different size, you may specify the key length by using the <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><CODE>EnvelopedDataStream(ObjectID contentType, InputStream is, AlgorithmID contentEA, 
 int keyLength)</CODE></A> constructor.
 <br>
 Note that the supplied <code>contentEA</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the content type of the content to be enveloped<DD><CODE>is</CODE> - the InputStream containing the data to envelope<DD><CODE>contentEA</CODE> - the content encryption algorithm for encrypting the content
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the specified algorithm</DL>
</DL>
<HR>

<A NAME="EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(java.io.InputStream&nbsp;is,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                           int&nbsp;keyLength)
                    throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.
 <br>
 The content type is set to CMS <b>Data</b>.
 <p>
 When using this constructor, automatically a symmetric key for content
 encryption is generated. If the specified content encryption algorithm supports
 variable key lengths, a particular key length may be set by means of the 
 <code>keyLength</code> parameter.
 If no length is specified, the defined default key length will be used. If the
 algorithm only works with keys of fixed-size length, the keyLength parameter
 may be set to -1 or the <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>EnvelopedDataStream(InputStream is, AlgorithmID contentEA)</CODE></A> constructor may be used.
 <br>
 Note that the supplied <code>contentEA</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream containing the data to envelope<DD><CODE>contentEA</CODE> - the content encryption algorithm for encrypting the content<DD><CODE>keyLength</CODE> - the key length that may be set when using a content
                  encryption algorithm that supports variable key lengths
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the specified algorithm</DL>
</DL>
<HR>

<A NAME="EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                           java.io.InputStream&nbsp;is,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                           int&nbsp;keyLength)
                    throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.
 <p>
 When using this constructor, automatically a symmetric key for content
 encryption is generated.
 If the specified content encryption algorithm supports variable key lengths, a
 particular key length may be set by means of the <code>keyLength</code> parameter.
 If no length is specified, the defined default key length will be used. If the
 algorithm only works with keys of fixed-size length, the keyLength parameter
 may be set to -1 or the <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>EnvelopedDataStream(ObjectID contentType, InputStream is, AlgorithmID contentEA)</CODE></A> 
 constructor may be used.
 <br>
 Note that the supplied <code>contentEA</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the content type of the content to be enveloped<DD><CODE>is</CODE> - the InputStream containing the data to envelope<DD><CODE>contentEA</CODE> - the content encryption algorithm for encrypting the content<DD><CODE>keyLength</CODE> - the key length that may be set when using a content
                  encryption algorithm that supports variable key lengths
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the specified algorithm</DL>
</DL>
<HR>

<A NAME="EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                           java.io.InputStream&nbsp;is,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentEA,
                           int&nbsp;keyLength,
                           <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                    throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new EnvelopedDataStream object where the content to be enveloped
 is read from the supplied InputStream.
 <p>
 When using this constructor, automatically a symmetric key for content
 encryption is generated.
 If the specified content encryption algorithm supports variable key lengths, a
 particular key length may be set by means of the <code>keyLength</code> parameter.
 If no length is specified, the defined default key length will be used. If the
 algorithm only works with keys of fixed-size length, the keyLength parameter
 may be set to -1 or the <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>EnvelopedDataStream(ObjectID contentType, InputStream is, AlgorithmID contentEA)</CODE></A> 
 constructor may be used.
 <br>
 Note that the supplied <code>contentEA</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the content type of the content to be enveloped<DD><CODE>is</CODE> - the InputStream containing the data to envelope<DD><CODE>contentEA</CODE> - the content encryption algorithm for encrypting the content<DD><CODE>keyLength</CODE> - the key length that may be set when using a content
                  encryption algorithm that supports variable key lengths<DD><CODE>securityProvider</CODE> - the security provider to be used; if <code>null</code> the 
                         default system-wide SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the specified algorithm</DL>
</DL>
<HR>

<A NAME="EnvelopedDataStream(iaik.cms.RecipientInfo[], iaik.cms.EncryptedContentInfoStream)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients,
                           <A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A>&nbsp;encryptedCI)</PRE>
<DL>
<DD>Constructs an EnvelopedDataStream object with an already
 created EncryptedContentInfoStream.
 <p>
 The given array of <code>RecipientInfo</code> specifies a collection of
 per-recipient information, and the given <code>EncryptedContentInfoStream</code>
 supplies the already encrypted content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>recipients</CODE> - information about the recipients<DD><CODE>encryptedCI</CODE> - the encrypted content info</DL>
</DL>
<HR>

<A NAME="EnvelopedDataStream(java.io.InputStream)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(java.io.InputStream&nbsp;is)
                    throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                           java.io.IOException</PRE>
<DL>
<DD>Creates a new EnvelopedDataStream from a BER encoded EnvelopedData
 object which is read from the given InputStream. The encoded EnvelopedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a BER encoded CMS EnvelopedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>
<HR>

<A NAME="EnvelopedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)"><!-- --></A><H3>
EnvelopedDataStream</H3>
<PRE>
public <B>EnvelopedDataStream</B>(java.io.InputStream&nbsp;is,
                           <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                    throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                           java.io.IOException</PRE>
<DL>
<DD>Creates a new EnvelopedDataStream from a BER encoded EnvelopedData
 object which is read from the given InputStream. The encoded EnvelopedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a BER encoded CMS EnvelopedData object<DD><CODE>securityProvider</CODE> - the security provider to be used; if <code>null</code> the 
                         default system-wide SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setSecurityProvider(iaik.cms.SecurityProvider)"><!-- --></A><H3>
setSecurityProvider</H3>
<PRE>
public void <B>setSecurityProvider</B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Sets the SecurityProvider for this EnvelopedDataStream.
 <p>
 This method allows to explicitly set a SecurityProvider for this EnvelopedDataStream.
 If no explicit SecurityProvider is set, the default system wide installed 
 SecurityProvider will be used for the required cryptographic operations.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters)"><CODE>getInputStreamCipherEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamCipherEngine.html" title="interface in iaik.cms"><CODE>InputStreamCipherEngine</CODE></A>
     for stream based content en/decryption as used by the inherent EncryptedContentInfoStream
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters)"><CODE>getByteArrayCipherEngine</CODE></A></code>
     methods to get a <A HREF="../../iaik/cms/ByteArrayCipherEngine.html" title="interface in iaik.cms"><CODE>ByteArrayCipherEngine</CODE></A>
     for content en/decryption for non-stream <A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms"><CODE>EnvelopedData</CODE></A> objects
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric content encryption key as used by the inherent EncryptedContentInfo
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameters(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameters</CODE></A></code>
     to parse algorithm parameters from an AlgorithmID as used by the inherent EncryptedContentInfo
 <li>several SecurityProvider methods for key en/decryption and parsing as used by the inherent recipient infos
 </ul>
 An application may supply the SecurityProvider immediately when creating an EnvelopedData object. This
 may be preferable on the parsing side, and also when creating a new EnvelopedData object where the
 EncryptedContentInfo and the RecipientInfos have to be <A HREF="../../iaik/cms/EnvelopedDataStream.html#EnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)"><CODE>created</CODE></A> by this class.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityProvider</CODE> - the SecurityProvider to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityProvider()"><!-- --></A><H3>
getSecurityProvider</H3>
<PRE>
public <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>getSecurityProvider</B>()</PRE>
<DL>
<DD>Gets the SecurityProvider installed for this EncryptedDataStream.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters)"><CODE>getInputStreamCipherEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamCipherEngine.html" title="interface in iaik.cms"><CODE>InputStreamCipherEngine</CODE></A> for
     stream based content en/decryption as used by the inherent EncryptedContentInfoStream
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters)"><CODE>getByteArrayCipherEngine</CODE></A></code>
     methods to get a <A HREF="../../iaik/cms/ByteArrayCipherEngine.html" title="interface in iaik.cms"><CODE>ByteArrayCipherEngine</CODE></A>
     for content en/decryption for non-stream <A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms"><CODE>EnvelopedData</CODE></A> objects
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric content encryption key as used by the inherent EncryptedContentInfo
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameters(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameters</CODE></A></code>
     to parse algorithm parameters from an AlgorithmID as used by the inherent EncryptedContentInfo
 <li>several SecurityProvider method for key en/decryption and parsing as used by the inherent recipient infos
 </ul>
 If no explicit SecurityProvider has been <A HREF="../../iaik/cms/EnvelopedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)"><CODE>set</CODE></A> for this object, 
 the default system wide installed SecurityProvider will be used for the required cryptographic
 operations. However, this method will return <code>null</code> if it does not have its own
 SecurityProvider.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityProvider explicitly installed for this object, or <code>null</code> if
         this object does not have its own SecurityProvider</DL>
</DD>
</DL>
<HR>

<A NAME="setMode(int)"><!-- --></A><H3>
setMode</H3>
<PRE>
public void <B>setMode</B>(int&nbsp;mode)</PRE>
<DL>
<DD>Sets the mode for this EnvelopedDataStream.
 <p>
 This method may be only called to set the mode to <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A>
 for creating a new EnvelopedDataStream in <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode where the 
 encrypted content shall not be included in the EnvelopedData. In this case 
 the encrypted content has to be transmitted by other means. This method may not
 be called in <A HREF="../../iaik/cms/EnvelopedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> mode (default) where
 the encrypted content is included in the EnvelopedData. This method MUST
 not be called when parsing an EnvelopedData where the mode is automatically
 detected and cannot be changed.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>mode</CODE> - the mode, either <A HREF="../../iaik/cms/EnvelopedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
                       the encrypted content (default) or <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A>
                       to not include it)
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the mode is not <A HREF="../../iaik/cms/EnvelopedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A>
                                    or <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A>; or if this
                                    method is called when parsing an EnvelopedData</DL>
</DD>
</DL>
<HR>

<A NAME="getMode()"><!-- --></A><H3>
getMode</H3>
<PRE>
public int <B>getMode</B>()</PRE>
<DL>
<DD>Gets the mode of this EncryptedContentInfoStream.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the mode, either <A HREF="../../iaik/cms/EnvelopedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
                   the encrypted content (default) or 
                   <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A>
                   to not include it)</DL>
</DD>
</DL>
<HR>

<A NAME="decode(java.io.InputStream)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(java.io.InputStream&nbsp;is)
            throws java.io.IOException,
                   <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></PRE>
<DL>
<DD>Reads and decodes an BER encoded EnvelopedData from a the given input stream.
 The encoded EnvelopedData may (or may not) be wrapped into a ContentInfo.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#decode(java.io.InputStream)">decode</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream holding a BER encoded EnvelopedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DD>
</DL>
<HR>

<A NAME="getContentType()"><!-- --></A><H3>
getContentType</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>getContentType</B>()</PRE>
<DL>
<DD>Returns the content type this class implements.
 <p>
 Use <code>getEncryptedContentInfo().getContentType()</code> for getting the
 type the encrypted content represents.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getContentType()">getContentType</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>ObjectID.cms_envelopedData</code></DL>
</DD>
</DL>
<HR>

<A NAME="setOriginatorInfo(iaik.cms.OriginatorInfo)"><!-- --></A><H3>
setOriginatorInfo</H3>
<PRE>
public void <B>setOriginatorInfo</B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</PRE>
<DL>
<DD>Sets the optional OriginatorInfo.
 <p>
 The originatorInfo may be set for including certificates and/or certificate
 revocation lists for the originator if required by the key management
 algorithm used.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>originatorInfo</CODE> - the OriginatorInfo to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setRecipientInfos(iaik.cms.RecipientInfo[])"><!-- --></A><H3>
setRecipientInfos</H3>
<PRE>
public void <B>setRecipientInfos</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</PRE>
<DL>
<DD>Sets the recipient infos.
 <p>
 Any <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for en/decrypting the content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipients</CODE> - a collection of per-recipient information<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addRecipientInfo(iaik.cms.RecipientInfo)"><!-- --></A><H3>
addRecipientInfo</H3>
<PRE>
public void <B>addRecipientInfo</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</PRE>
<DL>
<DD>Adds one recipient to the list of recipient infos.
 <p>
 Any <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for en/decrypting the content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipient</CODE> - the RecipientInfo to be added<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setUnprotectedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setUnprotectedAttributes</H3>
<PRE>
public void <B>setUnprotectedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of (unprotected) attributes.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the unprotected attributes to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setBlockSize(int)"><!-- --></A><H3>
setBlockSize</H3>
<PRE>
public void <B>setBlockSize</B>(int&nbsp;blockSize)</PRE>
<DL>
<DD>Sets the block size for defining the length of each definite primitive
 encoded octet string component.
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole encrypted data is encoded as definite primitive octet string.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#setBlockSize(int)">setBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - for defining the encoding scheme and setting the octet
        string component length, if positive</DL>
</DD>
</DL>
<HR>

<A NAME="getBlockSize()"><!-- --></A><H3>
getBlockSize</H3>
<PRE>
public int <B>getBlockSize</B>()</PRE>
<DL>
<DD>Gets the block size defining the length of each definite primitive
 encoded octet string component.
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole data is encoded as definite primitive octet string.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getBlockSize()">getBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the block size defining the encoding scheme and setting the octet
        string component length, if positive</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key, int)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public javax.crypto.SecretKey <B>setupCipher</B>(java.security.Key&nbsp;recipientKey,
                                          int&nbsp;recipientInfoIndex)
                                   throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                          java.security.NoSuchAlgorithmException,
                                          java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the content-encryption key to setup the
 cipher for decrypting the encrypted content of this <code>EnvelopedDataStream</code>
 object for the requesting recipient, specified by its <code>recipientInfoIndex</code>.
 <p>
 This method first uses the given key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding <code>RecipientInfo</code>
 structure, and subsequently uses this key to initialize a CipherInputStream for
 decrypting the inherent encrypted content.
 <p>
 Unlike the non-stream supporting <A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms"><CODE>EnvelopedData</CODE></A> class where the encrypted-content decryption
 already is performed inside the <code>setupCipher</code> method, the cipher
 will be only initialized for decrypting in this class. The encrypted-content
 decryption actually is done during reading the data obtained by calling the
 <A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method. So do not call
 <code>getInputStream</code> before setting up the cipher!
 <p>
 <b>Note</b> that you have to know the right index into the <code>recipientInfos</code>
 field when using this method for setting up the cipher for decryption. You may
 search for the index by using one of the <code>getRecipientInfo</code> methods
 thereby identifying the recipient by its <A HREF="../../iaik/cms/EnvelopedDataStream.html#getRecipientInfo(iaik.cms.KeyIdentifier)"><CODE>keyIdentifier</CODE></A> or -- if suitable for the key management algorithm used -- <A HREF="../../iaik/cms/EnvelopedDataStream.html#getRecipientInfo(iaik.x509.X509Certificate)"><CODE>certificate</CODE></A>.
 <br>
 However, when having some recipient using a key agreement protocol the corresponding
 RecipientInfo is of type <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>
 which may hold encrypted content-encryption keys for more than only one recipients 
 using the same key agreement algorithm with same domain parameters. Since this 
 <code>setupCipher</code> method only can get the KeyAgreeRecipientInfo with the given
 index (but not search for the right recipient in the KeyAgreeRecipientInfo), it
 will step through any recipient included in the KeyAgreeRecipientInfo trying to
 decrypt the encrypted content-encryption key with the supplied key. This may give
 some overhead so it might be appropriate to use another <code>setupCipher</code> method
 allowing to immediately identify the particular recipient in mind by its
 #setupCipher(Key, KeyIdentifier) keyIdentifier} or <A HREF="../../iaik/cms/EnvelopedDataStream.html#setupCipher(java.security.Key, iaik.x509.X509Certificate)"><CODE>certificate</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the key of the recipient to be used for decrypting
                     the encrypted content-encryption key.<DD><CODE>recipientInfoIndex</CODE> - the index into the recipientInfos field
<DT><B>Returns:</B><DD>the (decrypted) secret content encryption key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the content-encryption key
            or setting up the cipher for decrypting the content
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the content-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key, iaik.cms.KeyIdentifier)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public javax.crypto.SecretKey <B>setupCipher</B>(java.security.Key&nbsp;recipientKey,
                                          <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)
                                   throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                          java.security.NoSuchAlgorithmException,
                                          java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the content-encryption key to setup the
 cipher for decrypting the encrypted content of this <code>EnvelopedDataStream</code>
 object for the requesting recipient, specified by the given recipient identifier.
 <p>
 This method first uses the given key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding <code>RecipientInfo</code>
 structure, and subsequently uses this key to initialize a CipherInputStream for
 decrypting the inherent encrypted content.
 <p>
 Unlike the non-stream supporting <A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms"><CODE>EnvelopedData</CODE></A> class where the encrypted-content decryption
 already is performed inside the <code>setupCipher</code> method, the cipher
 will be only initialized for decrypting in this class. The encrypted-content
 decryption actually is done during reading the data obtained by calling the
 <A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method. So do not call
 <code>getInputStream</code> before setting up the cipher!
 <p>
 This <code>setupCipher</code> can be used to setup the cipher for decryption for
 any type of RecipientInfo. The supplied recipient identifier will be used for
 searching for the right RecipientInfo in the <code>recipientInfos</code> field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the key of the recipient to be used for decrypting
                     the encrypted content-encryption key.<DD><CODE>recipientIdentifier</CODE> - specifies which RecipientInfo the given key belongs to
<DT><B>Returns:</B><DD>the (decrypted) secret content encryption key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the content-encryption key
            or setting up the cipher for decrypting the content, or no RecipientInfo
            for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the content-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key, iaik.x509.X509Certificate)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public javax.crypto.SecretKey <B>setupCipher</B>(java.security.Key&nbsp;recipientKey,
                                          <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)
                                   throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                          java.security.NoSuchAlgorithmException,
                                          java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the content-encryption key to setup the
 cipher for decrypting the encrypted content of this <code>EnvelopedDataStream</code>
 object for the requesting recipient, specified by the given recipient certificate.
 <p>
 This method first uses the given key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding <code>RecipientInfo</code>
 structure, and subsequently uses this key to initialize a CipherInputStream for
 decrypting the inherent encrypted content.
 <p>
 Unlike the non-stream supporting <A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms"><CODE>EnvelopedData</CODE></A> class where the encrypted-content decryption
 already is performed inside the <code>setupCipher</code> method, the cipher
 will be only initialized for decrypting in this class. The encrypted-content
 decryption actually is done during reading the data obtained by calling the
 <A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method. So do not call
 <code>getInputStream</code> before setting up the cipher!
 <p>
 <b>Note</b> that this method only can be used for decrypting the encrypted content
 if the recipient in mind has a RecipientInfo of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A> using a public
 key from a certificate for its key management protocol.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the private key of the recipient to be used for decrypting
                     the encrypted content-encryption key.<DD><CODE>recipientCertificate</CODE> - the certificate of the recipient specifying which 
        RecipientInfo the recipient private key belongs to
<DT><B>Returns:</B><DD>the (decrypted) secret content encryption key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the content-encryption key
            or setting up the cipher for decrypting the content, or no RecipientInfo
            for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the content-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified private key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public void <B>setupCipher</B>(java.security.Key&nbsp;key)
                 throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                        java.security.NoSuchAlgorithmException,
                        java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the given symmetric key to setup the cipher for decrypting the content.
 <p>
 The secret key supplied to this method has to be the already decrypted
 content encryption key.
 <p>
 Unlike the non-stream supporting <A HREF="../../iaik/cms/EnvelopedData.html" title="class in iaik.cms"><CODE>EnvelopedData</CODE></A> class where the encrypted-content decryption
 already is performed inside the <code>setupCipher</code> method, the cipher
 will be only initialized for decrypting in this class. The encrypted-content
 decryption actually is done during reading the data obtained by calling the
 <A HREF="../../iaik/cms/EnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method. So do not call
 <code>getInputStream</code> before setting up the cipher!
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - the temporary symmetric key that has been used to encrypt the content,
            and now is used for decrypting it again
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while setting up the cipher for decrypting the content
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the content-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="getInputStream()"><!-- --></A><H3>
getInputStream</H3>
<PRE>
public java.io.InputStream <B>getInputStream</B>()</PRE>
<DL>
<DD>Returns an InputStream from where the decrypted data can be read.
 <p>
 Attention! The stream only may be read once.
 <p>
 When having created a new (implcit) <code>EnvelopedDataStream</code> object to
 be encoded to a stream, this method should not be called at all, since the stream
 automatically will be read during performing the encoding (which is done
 when calling a <A HREF="../../iaik/cms/EnvelopedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> method). However, when
 not using the <code>EnvelopedDataStream</code> in <A HREF="../../iaik/cms/EnvelopedDataStream.html#EXPLICIT"><CODE>explicit</CODE></A>
 mode, this <code>getInputStream</code> method may be called to get and read
 the encrypted content to be transferred by other means:
 <pre>
 //the data to be enveloped supplied from an input stream:
 InputStream dataStream = ...;
 //use, e.g., TripleDES in CBC mode for encrypting the content
 EnvelopedDataStream envelopedData = new EnvelopedDataStream(dataStream, (AlgorithmID)AlgorithmID.des_EDE3_CBC.clone());
 
 // if we want to transmit the encrypted content by other means we use the explicit mode
 envelopedData.setMode(EnvelopedDataStream.EXPLICIT);
 
 // create and set the recipient infos
 RecipientInfo[] recipients = ...;
 envelopedData.setRecipientInfos(recipients);
 
 // if we use explicit mode we read and encrypt the content data to be transmitted 
 // outside the EnvelopedData
 InputStream encryptedContentIs = envelopedData.getInputStream();
 byte[] buf = ...;
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 }
 
 // encode the EnvelopedData
 OutputStream os = ...;
 envelopedData.writeTo(os); 
 </pre>  
 <br>
 When having decoded and parsed a received <code>EnvelopedDataStream</code> object
 comimg from some stream, this method may be used for obtaining the raw (decrypted) data
 after having setup the cipher for decrypting the content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an InputStream for reading the decrypted data</DL>
</DD>
</DL>
<HR>

<A NAME="setInputStream(java.io.InputStream)"><!-- --></A><H3>
setInputStream</H3>
<PRE>
public void <B>setInputStream</B>(java.io.InputStream&nbsp;is)</PRE>
<DL>
<DD>Sets the input stream that supplies the content data to be encrypted.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream holding the content data to encrypt</DL>
</DD>
</DL>
<HR>

<A NAME="getVersion()"><!-- --></A><H3>
getVersion</H3>
<PRE>
public int <B>getVersion</B>()</PRE>
<DL>
<DD>Returns the syntax version number.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the syntax version number</DL>
</DD>
</DL>
<HR>

<A NAME="getOriginatorInfo()"><!-- --></A><H3>
getOriginatorInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A> <B>getOriginatorInfo</B>()</PRE>
<DL>
<DD>Gets the OriginatorInfo, if included.
 <p>
 The originatorInfo may be set for including certificates and/or
 certificate revocation lists if required by the key management
 algorithm used.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the originatorInfo, if included; otherwise <code>null</code></DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfos()"><!-- --></A><H3>
getRecipientInfos</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[] <B>getRecipientInfos</B>()</PRE>
<DL>
<DD>Returns all the recipient infos included in this
 <code>EnvelopedData</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all the <code>RecipientInfo</code> objects
         included into this <code>EnvelopedData</code></DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfos(int)"><!-- --></A><H3>
getRecipientInfos</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[] <B>getRecipientInfos</B>(int&nbsp;type)</PRE>
<DL>
<DD>Returns all the recipient infos included in this
 <code>EnvelopedData</code> object that have the specified type.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all the <code>RecipientInfo</code> objects
         included into this <code>EnvelopedData</code> that have the 
         specified type (e.g. all KeyTransRecipientInfos); the array may
         be empty if no RecipientInfo with the requested type is included</DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfo(iaik.x509.X509Certificate)"><!-- --></A><H3>
getRecipientInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A> <B>getRecipientInfo</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</PRE>
<DL>
<DD>Returns the recipient info matching to the supplied recipient certificate.
 <p>
 This method may be used by a recipient for quering for the recipient info
 that holds the content encryption key encrypted with the public key of the
 given certificate. 
 <br>
 <b>Note</b> that this method only can be used for searching for RecipientInfos
 of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or
 <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, but <b>NOT</b>
 for a RecipientInfo of type <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>
 which does use a certificate.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the RecipientInfo matching to the supplied recipient certificate,
         or <code>null</code> if no recipient info belonging to the given
         certificate can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfo(iaik.cms.KeyIdentifier)"><!-- --></A><H3>
getRecipientInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A> <B>getRecipientInfo</B>(<A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</PRE>
<DL>
<DD>Returns the RecipientInfo belonging to the recipient identified by the
 given recipient identifier.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientIdentifier</CODE> - the recipient identifier identifying the
                            recipient in mind
<DT><B>Returns:</B><DD>the RecipientInfo matching to the supplied recipient identifier,
         or <code>null</code> if no recipient info belonging to the given
         recipient identifier can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getEncryptedContentInfo()"><!-- --></A><H3>
getEncryptedContentInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A> <B>getEncryptedContentInfo</B>()</PRE>
<DL>
<DD>Returns the EncryptedContentInfo included in this <code>EnvelopedDataStream</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the inherent EncryptedContentInfo</DL>
</DD>
</DL>
<HR>

<A NAME="getUnprotectedAttributes()"><!-- --></A><H3>
getUnprotectedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getUnprotectedAttributes</B>()</PRE>
<DL>
<DD>Gets the unprotected attributes included in this EnvelopedData.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the unprotected attributes; if included</DL>
</DD>
</DL>
<HR>

<A NAME="getUnprotectedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getUnprotectedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getUnprotectedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first unprotected attribute matching to the given ObjectID, if 
 included in this EnvelopedData object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the first unprotected attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object()"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>()
                        throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this EnvelopedDataStream as ASN1Object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toASN1Object()">toASN1Object</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>this <code>EnvelopedDataStream</code> as ASN1Object.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object(int)"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>(int&nbsp;blockSize)
                           throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this EnvelopedData as ASN1Object.
 <p>
 If <blockSize> is positive a constructed
 OCTET STRING is used for encoding the encrypted content. This method actually
 will perform the encryption of the symmetric content-encryption key for
 each participated recipient.
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Returns:</B><DD>this EnvelopedData as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os)
             throws java.io.IOException</PRE>
<DL>
<DD>Writes this EnvelopedData BER encoded to the given output stream.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this EnvelopedData shall be written
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream, int)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os,
                    int&nbsp;blockSize)
             throws java.io.IOException</PRE>
<DL>
<DD>Writes this EnvelopedData BER encoded to the given output stream
 where a constructed OCTET STRING may be used for encoding the content.
 <p>
 When encoding the content data to the given stream it is piped through a
 cipher stream thereby performing the content encryption.
 <p>
 If the a positive <code>blockSize</code> value is specified, the encrypted content
 is encoded as indefinite constructed octet string being composed of a certain number
 of definite primitive encoded octet strings of <code>blockSize</code> length:
 <pre>
 0x24 0x80
           0x04 &lt;blocksize&gt; &lt;first encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;second encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;third encrypted content block&gt;
                ...
 0x00 0x00
 </pre>
 Otherwise, whole the encrypted content is encoded
 as definite primitive octet string:
 <pre>
  0x04 &lt;length&gt; &lt;encrypted content&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this SignedData shall be written<DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs during writing the object</DL>
</DD>
</DL>
<HR>

<A NAME="notifyEOF()"><!-- --></A><H3>
notifyEOF</H3>
<PRE>
public void <B>notifyEOF</B>()
               throws java.io.IOException</PRE>
<DL>
<DD>This method implements the EOFListener interface for performing the final decoding.
 Since unprotected attributes, if present, are located at the end of an EnvelopedData
 structure, they only can be accessed after reading/decrypting the data included
 in the EncryptedContentInfo located before the unprotected attributes.
 For that reason, when starting the parsing of an EnvelopedData message only
 version, (originatorInfo), recipientInfos, and EncryptedContentInfo fields can be parsed
 before reading/decrypting the data.
 Since the data is supplied from an input stream, a <code>iaik.utils.NotifyEOFInputStream
 </code>is wrapped around this content data stream
 for indicating that the parsing procedure is to be notified when the stream actually
 has been read. At that point, the programm exceuting automatically jumps to the
 <code>notifyEOF</code> method for finishing the decoding by parsing the
 remaining unprotected attributes, if present.
 <br>
 <b>An application shall <i>not</i> call this method!</b> This method only is qualified
 as public method since it implements the IAIK-JCE iaik.utils.EOFListener interface.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html#notifyEOF()" title="class or interface in iaik.utils">notifyEOF</A></CODE> in interface <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while parsing the stream</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string giving some information about this
 <code>EnvelopedData</code> object.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="toString(boolean)"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>(boolean&nbsp;detailed)</PRE>
<DL>
<DD>Returns a string giving some - if requested - detailed information
 about this <code>EnvelopedData</code> object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toString(boolean)">toString</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>detailed</CODE> - - whether or not to give detailed information
<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/EnvelopedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/HashEngine.html" title="interface in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/EnvelopedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="EnvelopedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
