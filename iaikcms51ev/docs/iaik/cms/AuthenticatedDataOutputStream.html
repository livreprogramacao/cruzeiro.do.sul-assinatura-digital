<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:10 GMT 2016 -->
<TITLE>
AuthenticatedDataOutputStream (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.AuthenticatedDataOutputStream class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="AuthenticatedDataOutputStream (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthenticatedData.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthenticatedDataOutputStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthenticatedDataOutputStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class AuthenticatedDataOutputStream</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by ">java.io.OutputStream
      <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.AuthenticatedDataOutputStream</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.io.Closeable, java.io.Flushable</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>AuthenticatedDataOutputStream</B><DT>extends java.io.OutputStream</DL>
</PRE>

<P>
This is an <code>OutputStream</code> implementation of the CMS
 (<a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>) AuthenticatedData 
 structure. It allows creating an AuthenticatedData object by writing the
 content to be authenticated to this stream.
 <p>
 It supports implicit (where the content is included in the AuthenticatedData object)
 and explicit (where the content is transmitted by other means) authentication formats.
 <p>
 This stream version will encode the content of the AuthenticatedData as a constructed
 OCTET STRING. Each <code>write</code> operation to this stream will result in an OCTET STRING block
 within this constructed OCTET STRING. Consequently, the size of each block equals the
 size of the data provided to the wirte operation.
 <p>
 The final call to <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> will finish mac calcualtion and encoding and write
 any authenticated and/or unauthenticated attributes and the mac value.
 <p>
 The typical usage of this class looks like the following example for creating a 
 CMS AuthenticatedData structure with the authenticated content included and
 using RSA for encrypting the secret mac key for the intended recipient(s).
 <pre>
   // the inherent content type
   ObjectID contentType = ObjectID.cms_data;
   // the mac algorithm to be used
   AlgorithmID macAlgorithm = (AlgorithmID)AlgorithmID.hMAC_SHA1.clone();
   // the length of the mac key to be generated
   int macKeyLength = 64;
   // we do not need mac algorithm parameters
   AlgorithmParameterSpec macParams = null;
   // we want to include authenticated attributes and therefore need a digest algorithm
   AlgorithmID digestAlgorithm = (AlgorithmID)AlgorithmID.sha1.clone();
   // the transmission mode (either AuthenticatedDataOutputStream.IMPLICIT or AuthenticatedDataOutputStream.EXPLICIT)
   int mode = AuthenticatedDataOutputStream.IMPLICIT;
   
   // the input stream from which to read the data to be authenticated
   InputStream dataInputStream = ...
   // the output stream to which to write the AuthenticatedData
   OutputStream resultStream = ...
   
   // create AuthenticatedDataOutputStream
   AuthenticatedDataOutputStream authenticatedData = 
     new AuthenticatedDataOutputStream(contentType, 
                                       resultStream, 
                                       macAlgorithm,
                                       macKeyLength,
                                       macParams,
                                       digestAlgorithm,
                                       mode);
     
   // the certificate of the recipient (we assume to use RSA for encrypting the mac key)
   X509Certificate recipientCert = ...
   // create and add RecipientInfo
   RecipientInfo recipient = new KeyTransRecipientInfo(recipientCert, AlgorithmID.rsaEncryption);
   authenticatedData.addRecipientInfo(recipient);   
       
   // add some authenticated attribute(s) (the MessageDigest attribute is calculated automatically)
   Attribute[] attributes = { new Attribute(new CMSContentType(contentType)) };
   authenticatedData.setAuthenticatedAttributes(attributes);
   
   // write in the data to be authenticated
   byte[] buffer = new byte[2048];
   int bytesRead;
   while ((bytesRead = dataInputStream.read(buffer)) != -1) {
     authenticatedData.write(buffer, 0, bytesRead);
   }
   // closing the stream calculates and adds the mac value and closes the underlying stream
   authenticatedData.close();
 
 </pre>
 For using the AuthenticatedDataOutputStream in explicit mode, specify 
 <code>AuthenticatedDataOutputStream.EXPLICIT</code> when creating the <code>AuthenticatedDataOutputStream</code>
 object:
 <pre>
   AuthenticatedDataOutputStream authenticatedData = 
     new AuthenticatedDataOutputStream(resultStream, AuthenticatedDataOutputStream.EXPLICIT);
 </pre>
 The further proceeding is the same as in implicit mode. When calling a <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE><code>write</code></CODE></A> method, the content data is dropped (since it must not be included in
 the AuthenticatedData object and has to be transmitted by other means). However, piping the
 data through <code>write</code> calls is required for hash and mac calculation.
 <p>
 If you want to encapsulate the AuthenticatedData into a ContentInfo you first must
 wrap a <A HREF="../../iaik/cms/ContentInfoOutputStream.html" title="class in iaik.cms"><CODE>ContentInfoOutputStream</CODE></A> around the final
 output stream (the ContentInfoStream has to write its headers to the
 stream at first, thus it must be created at the &quot;lowest&quot; level):
 <pre>
   ContentInfoOutputStream contentInfoStream = 
     new ContentInfoOutputStream(ObjectID.cms_authData, resultStream);
   // now create AuthenticatedDataOutputStream for the ContentInfoStream:
   AuthenticatedDataOutputStream authenticatedData = 
     new AuthenticatedDataOutputStream(contentType, 
                                       contentInfoStream, 
                                       macAlgorithm,
                                       macKeyLength,
                                       macParams,
                                       digestAlgorithm,
                                       mode);
       
   // the further proceeding is same as above
   
   // the certificate of the recipient (we assume to use RSA for encrypting the mac key)
   X509Certificate recipientCert = ...
   // create and add RecipientInfo
   RecipientInfo recipient = new KeyTransRecipientInfo(recipientCert, AlgorithmID.rsaEncryption);
   authenticatedData.addRecipientInfo(recipient);   
       
   // add some authenticated attribute(s) (the MessageDigest attribute is calculated automatically)
   Attribute[] attributes = { new Attribute(new CMSContentType(contentType)) };
   authenticatedData.setAuthenticatedAttributes(attributes);
   
   // write in the data to be authenticated
   byte[] buffer = new byte[2048];
   int bytesRead;
   while ((bytesRead = dataInputStream.read(buffer)) != -1) {
     authenticatedData.write(buffer, 0, bytesRead);
   }
   // closing the stream calculates and adds the mac value and closes the underlying stream
   authenticatedData.close();

 </pre>
 
 Use class <A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms"><CODE>AuthenticatedDataStream</CODE></A> to read in and parse
 the encoded AuthenticatedData and verify the message authentication code.
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms"><CODE>AuthenticatedDataStream</CODE></A>, 
<A HREF="../../iaik/cms/ContentInfoOutputStream.html" title="class in iaik.cms"><CODE>ContentInfoOutputStream</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT">EXPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the content is not transmitted within the AuthenticatedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT">IMPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the content is included in the AuthenticatedData.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, byte[], iaik.asn1.structures.AlgorithmID, int)">AuthenticatedDataOutputStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                              java.io.OutputStream&nbsp;out,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                              byte[]&nbsp;mac,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                              int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AuthenticatedDataOutputStream from an already calculated MAC value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)">AuthenticatedDataOutputStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                              java.io.OutputStream&nbsp;out,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                              int&nbsp;macKeyLength,
                              java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                              int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)">AuthenticatedDataOutputStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                              java.io.OutputStream&nbsp;out,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                              int&nbsp;macKeyLength,
                              java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                              int&nbsp;mode,
                              <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int)">AuthenticatedDataOutputStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                              java.io.OutputStream&nbsp;out,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                              int&nbsp;macKeyLength,
                              java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                              int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int, iaik.cms.SecurityProvider)">AuthenticatedDataOutputStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                              java.io.OutputStream&nbsp;out,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                              int&nbsp;macKeyLength,
                              java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                              int&nbsp;mode,
                              <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#addRecipientInfo(iaik.cms.RecipientInfo)">addRecipientInfo</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds one recipient to the list of recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()">close</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finishes the encoding, calculates the mac value and writes the mac value and
 any authenticated/unauthenticated attributes (if set) to the stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#flush()">flush</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flushes any internal data and calls flush of the underlying stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getAuthenticatedAttribute(iaik.asn1.ObjectID)">getAuthenticatedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first authenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getAuthenticatedAttributes()">getAuthenticatedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the authenticated attributes included in this AutheticatedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getAuthenticatedDigest()">getAuthenticatedDigest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the value of the MessageDigest attribute, if 
 included in the authenticated attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getMac()">getMac</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the MAC value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getSecurityProvider()">getSecurityProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityProvider installed for this EncryptedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getUnauthenticatedAttribute(iaik.asn1.ObjectID)">getUnauthenticatedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first unauthenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getUnauthenticatedAttributes()">getUnauthenticatedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the unauthenticated attributes included in this AutheticatedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#getVersion()">getVersion</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the syntax version number.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#isPassThroughClose()">isPassThroughClose</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks whether a call to <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> will call <code>close</code> of the 
 underlying output stream</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])">setAuthenticatedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of (authenticated) attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setOriginatorInfo(iaik.cms.OriginatorInfo)">setOriginatorInfo</A></B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the optional OriginatorInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setPassThroughClose(boolean)">setPassThroughClose</A></B>(boolean&nbsp;passThroughClose)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting this to <code>true</code> will cause <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> to call
 <code>close</code> of the underlying output stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])">setRecipientInfos</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A></B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityProvider for this AuthenticatedDataOutputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])">setUnauthenticatedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of (unauthenticated) attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some information about this
 <code>AutheticatedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#toString(boolean)">toString</A></B>(boolean&nbsp;detailed)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some - if requested - detailed information
 about this <code>AutheticatedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])">write</A></B>(byte[]&nbsp;b)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Processes the given content data to be authenticated.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[], int, int)">write</A></B>(byte[]&nbsp;b,
      int&nbsp;off,
      int&nbsp;len)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Processes the given content data to be authenticated.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(int)">write</A></B>(int&nbsp;b)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Processes the given content byte to be authenticated.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="IMPLICIT"><!-- --></A><H3>
IMPLICIT</H3>
<PRE>
public static final int <B>IMPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the content is included in the AuthenticatedData.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.AuthenticatedDataOutputStream.IMPLICIT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="EXPLICIT"><!-- --></A><H3>
EXPLICIT</H3>
<PRE>
public static final int <B>EXPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the content is not transmitted within the AuthenticatedData.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.AuthenticatedDataOutputStream.EXPLICIT">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int)"><!-- --></A><H3>
AuthenticatedDataOutputStream</H3>
<PRE>
public <B>AuthenticatedDataOutputStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                                     java.io.OutputStream&nbsp;out,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                                     int&nbsp;macKeyLength,
                                     java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                                     int&nbsp;mode)
                              throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
 This constructor generates a symmetric MAC key and uses an <A HREF="../../iaik/cms/OutputStreamMacEngine.html" title="interface in iaik.cms"><CODE>OutputStreamMacEngine</CODE></A> to wrap a mac calculating output stream around the output
 stream to which the data to be authenticated is later written (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>out</CODE> - the OutputStream receiving the authenticated data<DD><CODE>macAlg</CODE> - the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedDataOutputStream</H3>
<PRE>
public <B>AuthenticatedDataOutputStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                                     java.io.OutputStream&nbsp;out,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                                     int&nbsp;macKeyLength,
                                     java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                                     int&nbsp;mode,
                                     <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                              throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
 This constructor generates a symmetric MAC key and uses an <A HREF="../../iaik/cms/OutputStreamMacEngine.html" title="interface in iaik.cms"><CODE>OutputStreamMacEngine</CODE></A> to wrap a mac calculating output stream around the output
 stream to which the data to be authenticated is later written (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>out</CODE> - the OutputStream receiving the authenticated data<DD><CODE>macAlg</CODE> - the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for any required
                         cryptographic operation
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthenticatedDataOutputStream</H3>
<PRE>
public <B>AuthenticatedDataOutputStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                                     java.io.OutputStream&nbsp;out,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                                     int&nbsp;macKeyLength,
                                     java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                                     int&nbsp;mode)
                              throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
 This constructor generates a symmetric MAC key. If the <code>digestAlg</code> parameter
 is not null, an <A HREF="../../iaik/cms/OutputStreamHashEngine.html" title="interface in iaik.cms"><CODE>OutputStreamHashEngine</CODE></A> 
 is used to wrap a hash calculating output stream around the output stream to which the data to
 be authenticated is later written (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>). In this case 
 authenticated attributes have to be set by calling method <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A> and the MAC value is calculated from the DER encoded
 authenticated attributes which contain the -- (if not set) automatically calculated -- 
 MessageDigest attribute.
 However, if the <code>digestAlg</code> parameter is null, an <A HREF="../../iaik/cms/OutputStreamMacEngine.html" title="interface in iaik.cms"><CODE>OutputStreamMacEngine</CODE></A> is used to wrap a MAC calculating
 output stream around the output stream to which the data to be authenticated is later
 written (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>). In this case the MAC value is calculated immediately
 from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>out</CODE> - the OutputStream receiving the authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm to be used for hash computation if
                  authenticated attributes are to be included<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedDataOutputStream</H3>
<PRE>
public <B>AuthenticatedDataOutputStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                                     java.io.OutputStream&nbsp;out,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                                     int&nbsp;macKeyLength,
                                     java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                                     int&nbsp;mode,
                                     <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                              throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataOutputStream which later writes the complete encoded 
 AuthenticatedData structure to the given output stream (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
 This constructor generates a symmetric MAC key. If the <code>digestAlg</code> parameter
 is not null, an <A HREF="../../iaik/cms/OutputStreamHashEngine.html" title="interface in iaik.cms"><CODE>OutputStreamHashEngine</CODE></A> 
 is used to wrap a hash calculating output stream around the output stream to which the data to
 be authenticated is later written (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>). In this case 
 authenticated attributes have to be set by calling method <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A> and the MAC value is calculated from the DER encoded
 authenticated attributes which contain the -- (if not set) automatically calculated -- 
 MessageDigest attribute.
 However, if the <code>digestAlg</code> parameter is null, an <A HREF="../../iaik/cms/OutputStreamMacEngine.html" title="interface in iaik.cms"><CODE>OutputStreamMacEngine</CODE></A> is used to wrap a MAC calculating
 output stream around the output stream to which the data to be authenticated is later
 written (e.g. <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>). In this case the MAC value is calculated immediately
 from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>out</CODE> - the OutputStream receiving the authenticated data<DD><CODE>macAlg</CODE> - the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>digestAlg</CODE> - the digest algorithm to be used for hash computation if
                  authenticated attributes are to be included<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for any required
                         cryptographic operation
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataOutputStream(iaik.asn1.ObjectID, java.io.OutputStream, iaik.asn1.structures.AlgorithmID, byte[], iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthenticatedDataOutputStream</H3>
<PRE>
public <B>AuthenticatedDataOutputStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                                     java.io.OutputStream&nbsp;out,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                                     byte[]&nbsp;mac,
                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                                     int&nbsp;mode)</PRE>
<DL>
<DD>Creates an AuthenticatedDataOutputStream from an already calculated MAC value.
 No mac or digest calculation is initialized. If <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A> are supplied, they already have to contain
 the MessageDigest attribute. Any <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])"><CODE>RecipientInfo</CODE></A> added
 to this AuthenticatedDataOutputStream already has to contain the encrypted mac key
 (i.e. no MAC key is generated and encrypted for each recipient).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>out</CODE> - the OutputStream receiving the authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm used for mac calculation<DD><CODE>mac</CODE> - the already calculated mac value<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm used for hash calculation<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="write(byte[], int, int)"><!-- --></A><H3>
write</H3>
<PRE>
public void <B>write</B>(byte[]&nbsp;b,
                  int&nbsp;off,
                  int&nbsp;len)
           throws java.io.IOException</PRE>
<DL>
<DD>Processes the given content data to be authenticated.
 The mac/digest calculation is updated with the given data. In <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> 
 mode the content data is encoded and written to the output stream. In <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode the content data is not written to the output stream (since it must not
 be included in the AuthenticatedData and has to be transmitted by other means), but 
 contributes to the mac/digest calculation as required.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>write</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b</CODE> - The data to be authenticated as byte array.<DD><CODE>off</CODE> - The start offset in the data array <code>b</code>.<DD><CODE>len</CODE> - The number of bytes to write.
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If an I/O error occurs.</DL>
</DD>
</DL>
<HR>

<A NAME="write(byte[])"><!-- --></A><H3>
write</H3>
<PRE>
public void <B>write</B>(byte[]&nbsp;b)
           throws java.io.IOException</PRE>
<DL>
<DD>Processes the given content data to be authenticated.
 The mac/digest calculation is updated with the given data. In <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> 
 mode the content data is encoded and written to the output stream. In <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode the content data is not written to the output stream (since it must not
 be included in the AuthenticatedData and has to be transmitted by other means), but 
 contributes to the mac/digest calculation as required.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>write</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b</CODE> - The data to be signed as byte array.
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If an I/O error occurs.</DL>
</DD>
</DL>
<HR>

<A NAME="write(int)"><!-- --></A><H3>
write</H3>
<PRE>
public void <B>write</B>(int&nbsp;b)
           throws java.io.IOException</PRE>
<DL>
<DD>Processes the given content byte to be authenticated.
 The mac/digest calculation is updated with the given data. In <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> 
 mode the content data is encoded and written to the output stream. In <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode the content data is not written to the output stream (since it must not
 be included in the AuthenticatedData and has to be transmitted by other means), but 
 contributes to the mac/digest calculation as required.
 <p>
 Note that when repeatedly calling this method to write single data bytes 
 the encoding may consist of many single-byte OCTET STRINGs. Thus it may be more
 appropriate to use a byte array expcting <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#write(byte[])"><CODE><code>write</code></CODE></A>
 method.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>write</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b</CODE> - The content data byte to be authenticated
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If an I/O error occurs.</DL>
</DD>
</DL>
<HR>

<A NAME="flush()"><!-- --></A><H3>
flush</H3>
<PRE>
public void <B>flush</B>()
           throws java.io.IOException</PRE>
<DL>
<DD>Flushes any internal data and calls flush of the underlying stream.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>flush</CODE> in interface <CODE>java.io.Flushable</CODE><DT><B>Overrides:</B><DD><CODE>flush</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If flushing the stream fails.</DL>
</DD>
</DL>
<HR>

<A NAME="close()"><!-- --></A><H3>
close</H3>
<PRE>
public void <B>close</B>()
           throws java.io.IOException</PRE>
<DL>
<DD>Finishes the encoding, calculates the mac value and writes the mac value and
 any authenticated/unauthenticated attributes (if set) to the stream.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>close</CODE> in interface <CODE>java.io.Closeable</CODE><DT><B>Overrides:</B><DD><CODE>close</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs while writing to the stream</DL>
</DD>
</DL>
<HR>

<A NAME="isPassThroughClose()"><!-- --></A><H3>
isPassThroughClose</H3>
<PRE>
public boolean <B>isPassThroughClose</B>()</PRE>
<DL>
<DD>Checks whether a call to <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> will call <code>close</code> of the 
 underlying output stream
<P>
<DD><DL>

<DT><B>Returns:</B><DD><code>true</code> if a call to <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> will call
         <code>close</code> of the underlying output stream;
         <code>false</code> if a call to <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> will not close the
         underlying stream.</DL>
</DD>
</DL>
<HR>

<A NAME="setPassThroughClose(boolean)"><!-- --></A><H3>
setPassThroughClose</H3>
<PRE>
public void <B>setPassThroughClose</B>(boolean&nbsp;passThroughClose)</PRE>
<DL>
<DD>Setting this to <code>true</code> will cause <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> to call
 <code>close</code> of the underlying output stream. If <code>false</code>,
 a call to <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#close()"><CODE>close()</CODE></A> will not close the underlying stream.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>passThroughClose</CODE> - <code>true</code> to pass through <code>close()</code> 
                         calls. <code>false</code> to not pass them through.</DL>
</DD>
</DL>
<HR>

<A NAME="setSecurityProvider(iaik.cms.SecurityProvider)"><!-- --></A><H3>
setSecurityProvider</H3>
<PRE>
public void <B>setSecurityProvider</B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Sets the SecurityProvider for this AuthenticatedDataOutputStream.
 <p>
 This method allows to explicitly set a SecurityProvider for this AuthenticatedDataOutputStream.
 If no explicit SecurityProvider is set, the default system wide installed 
 SecurityProvider will be used for the required cryptographic operations.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.OutputStream)"><CODE>getOutputStreamHashEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/OutputStreamHashEngine.html" title="interface in iaik.cms"><CODE>OutputStreamHashEngine</CODE></A>
     for stream based digest calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamMacEngine(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, java.io.OutputStream)"><CODE>getOutputStreamMacEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/OutputStreamMacEngine.html" title="interface in iaik.cms"><CODE>OutputStreamMacEngine</CODE></A>
     for stream based mac calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateMac(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])"><CODE>calculateMac</CODE></A></code>
     for mac calculation from DER encoded authenticated attributes; if present
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric mac key
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameterSpec(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameterSpec</CODE></A></code>
     to create an AlgorithmParameterSpec from algorithm parameters (if included in a MAC
     algorithmID)
 <li>several SecurityProvider methods for key en/decryption and parsing as used by the inherent
     recipient infos
 </ul>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityProvider</CODE> - the SecurityProvider to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityProvider()"><!-- --></A><H3>
getSecurityProvider</H3>
<PRE>
public <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>getSecurityProvider</B>()</PRE>
<DL>
<DD>Gets the SecurityProvider installed for this EncryptedDataStream.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.OutputStream)"><CODE>getOutputStreamHashEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/OutputStreamHashEngine.html" title="interface in iaik.cms"><CODE>OutputStreamHashEngine</CODE></A>
     for stream based digest calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamMacEngine(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, java.io.OutputStream)"><CODE>getOutputStreamMacEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/OutputStreamMacEngine.html" title="interface in iaik.cms"><CODE>OutputStreamMacEngine</CODE></A>
     for stream based mac calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateMac(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])"><CODE>calculateMac</CODE></A></code>
     for mac calculation from DER encoded authenticated attributes; if present
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric mac key
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameterSpec(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameterSpec</CODE></A></code>
     to create an AlgorithmParameterSpec from algorithm parameters (if included in a MAC
     algorithmID)
 <li>several SecurityProvider methods for key en/decryption and parsing as used by the inherent
     recipient infos
 </ul>
 If no explicit SecurityProvider has been <A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html#setSecurityProvider(iaik.cms.SecurityProvider)"><CODE>set</CODE></A> for this object, 
 the default system wide installed SecurityProvider will be used for the required cryptographic
 operations. However, this method will return <code>null</code> if it does not have its own
 SecurityProvider.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityProvider explicitly installed for this object, or <code>null</code> if
         this object does not have its own SecurityProvider</DL>
</DD>
</DL>
<HR>

<A NAME="setOriginatorInfo(iaik.cms.OriginatorInfo)"><!-- --></A><H3>
setOriginatorInfo</H3>
<PRE>
public void <B>setOriginatorInfo</B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</PRE>
<DL>
<DD>Sets the optional OriginatorInfo.
 <p>
 The originatorInfo may be set for including certificates and/or certificate
 revocation lists for the originator if required by the key management
 algorithm used (e.g. ESDH or ESDH Diffie Hellman Key Agreement).
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>originatorInfo</CODE> - the OriginatorInfo to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setRecipientInfos(iaik.cms.RecipientInfo[])"><!-- --></A><H3>
setRecipientInfos</H3>
<PRE>
public void <B>setRecipientInfos</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</PRE>
<DL>
<DD>Sets the recipient infos.
 <p>
 Any <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for en/decrypting the symmetric mac key.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipients</CODE> - a collection of per-recipient information<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addRecipientInfo(iaik.cms.RecipientInfo)"><!-- --></A><H3>
addRecipientInfo</H3>
<PRE>
public void <B>addRecipientInfo</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</PRE>
<DL>
<DD>Adds one recipient to the list of recipient infos.
 <p>
 The <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for en/decrypting the symmetric mac key.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipient</CODE> - the RecipientInfo to be added<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setAuthenticatedAttributes</H3>
<PRE>
public void <B>setAuthenticatedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of (authenticated) attributes.
 If authenticated attributes are present, the MAC value is calculated
 from the DER encoded authenticated attributes which have to contain
 the MessageDigest attribute. In this case the <code>digestAlgorithm</code>
 field is not allowed to be null since it identifies the algorithm to
 be used for calculating a digest value from the content and set it
 as MessageDigest attribute. If the MessageDigest attribute is not
 included in the set of attributes supplied to this methode, it
 is automatically calculated and set.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the authenticated attributes to be set
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if no digest algorithm has been specified
            when creating this AuthenticatedDataOutputStream object</DL>
</DD>
</DL>
<HR>

<A NAME="setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setUnauthenticatedAttributes</H3>
<PRE>
public void <B>setUnauthenticatedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of (unauthenticated) attributes.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the unauthenticated attributes to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedDigest()"><!-- --></A><H3>
getAuthenticatedDigest</H3>
<PRE>
public byte[] <B>getAuthenticatedDigest</B>()
                              throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Gets the value of the MessageDigest attribute, if 
 included in the authenticated attributes.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the message digest included in the authenticated attributes
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if no message digest attribute is included</DL>
</DD>
</DL>
<HR>

<A NAME="getVersion()"><!-- --></A><H3>
getVersion</H3>
<PRE>
public int <B>getVersion</B>()</PRE>
<DL>
<DD>Returns the syntax version number.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the syntax version number</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedAttributes()"><!-- --></A><H3>
getAuthenticatedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getAuthenticatedAttributes</B>()</PRE>
<DL>
<DD>Gets the authenticated attributes included in this AutheticatedData.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the authenticated attributes; if included</DL>
</DD>
</DL>
<HR>

<A NAME="getUnauthenticatedAttributes()"><!-- --></A><H3>
getUnauthenticatedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getUnauthenticatedAttributes</B>()</PRE>
<DL>
<DD>Gets the unauthenticated attributes included in this AutheticatedData.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the unauthenticated attributes; if included</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getAuthenticatedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getAuthenticatedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first authenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the first authenticated attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="getMac()"><!-- --></A><H3>
getMac</H3>
<PRE>
public byte[] <B>getMac</B>()</PRE>
<DL>
<DD>Gets the MAC value.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the MAC value.</DL>
</DD>
</DL>
<HR>

<A NAME="getUnauthenticatedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getUnauthenticatedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getUnauthenticatedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first unauthenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the first unauthenticated attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string giving some information about this
 <code>AutheticatedData</code> object.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="toString(boolean)"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>(boolean&nbsp;detailed)</PRE>
<DL>
<DD>Returns a string giving some - if requested - detailed information
 about this <code>AutheticatedData</code> object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>detailed</CODE> - - whether or not to give detailed information
<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthenticatedData.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthenticatedDataOutputStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthenticatedDataOutputStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
