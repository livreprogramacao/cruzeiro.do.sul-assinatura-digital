<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:14 GMT 2016 -->
<TITLE>
SignedDataOutputStream (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.SignedDataOutputStream class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SignedDataOutputStream (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/SignedDataInOutStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/SignedDataOutputStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedDataOutputStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class SignedDataOutputStream</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by ">java.io.OutputStream
      <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.SignedDataOutputStream</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.io.Closeable, java.io.Flushable</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>SignedDataOutputStream</B><DT>extends java.io.OutputStream</DL>
</PRE>

<P>
This is an <code>OutputStream</code> implementation of the CMS
 (<a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>) SignedData 
 structure. It allows creating a signed object by writing the content to be
 signed to this stream.
 <p>
 It supports implicit (where the content is included in the SignedData object) and
 explicit (where the content is transmitted by other means) signatures.
 <p>
 This stream version will encode the content of the SignedData as a constructed OCTET STRING. Each
 write operation to this stream will result in an OCTET STRING block within this constructed OCTET
 STRING. Consequently, the size of each block equals the size of the data provided to the wirte
 operation.
 <p>
 The final call to <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> will finish the encoding and write the certificates, CRLs (if set)
 and actual signatures, i.e. the <code>SignerInfo</code> structures.
 <p>
 The typical usage of this class looks like the following example for creating a 
 CMS SignedData structure with the signed content included.
 <pre>
   // the private key of the signer
   PrivateKey signatureKey = ...
   // the certificates of the signer
   X509Certificate[] certificateChain = ...
   // the input stream from which to read the data to be signed
   InputStream dataInputStream = ...
   // the output stream to which to write the signed data
   OutputStream resultStream = ...
   
   // create SignedDataOutputStream
   SignedDataOutputStream signedData = 
     new SignedDataOutputStream(resultStream, SignedDataOutputStream.IMPLICIT);
       
   // add the certificates
   signedData.addCertificates(certificateChain);
   
   // add a SignerInfo
   X509Certificate signatureCert = certificateChain[0];
   SignerInfo signerInfo = new SignerInfo(
     new IssuerAndSerialNumber(signatureCert), AlgorithmID.sha1, signatureKey);
   // define some attributes
   Attribute[] attributes = { 
     new Attribute(new CMSContentType(ObjectID.cms_data)),
     new Attribute(new SigningTime())
   };
   // set the attributes
   signerInfo.setSignedAttributes(attributes);
   // and add the new signer
   signedData.addSignerInfo(signerInfo);
   
   // write in the data to be signed
   byte[] buffer = new byte[2048];
   int bytesRead;
   while ((bytesRead = dataInputStream.read(buffer)) != -1) {
     signedData.write(buffer, 0, bytesRead);
   }
   // closing the stream add the signer infos and closes the underlying stream
   signedData.close();
 
 </pre>
 For using the SignedDataOutputStream in explicit mode, specify 
 <code>SignedDataOutputStream.EXPLICIT</code> when creating the <code>SignedDataOutputStream</code>
 object:
 <pre>
   SignedDataOutputStream signedData = 
     new SignedDataOutputStream(resultStream, SignedDataOutputStream.EXPLICIT);
 </pre>
 The further proceeding is the same as in implicit mode. When calling a <A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[])"><CODE><code>write</code></CODE></A> method, the content data is dropped (since it must not be included in
 the SignedData object and has to be transmitted by other means). However, piping the
 data through <code>write</code> calls is required for hash and signature calculation.
 <p>
 If you want to encapsulate the SignedData into a ContentInfo you first must
 wrap a <A HREF="../../iaik/cms/ContentInfoOutputStream.html" title="class in iaik.cms"><CODE>ContentInfoOutputStream</CODE></A> around the final
 output stream (the ContentInfoOutputStream has to write its headers to the
 stream at first, thus it must be created at the &quot;lowest&quot; level):
 <pre>
   ContentInfoOutputStream contentInfoStream = 
     new ContentInfoOutputStream(ObjectID.cms_signedData, resultStream);
   // now create SignedDataOutputStream for the ContentInfoStream:
   SignedDataOutputStream signedData = 
     new SignedDataOutputStream(contentInfoStream, SignedDataOutputStream.IMPLICIT);
       
   // the further proceeding is same as above
   
   // add the certificates
   signedData.addCertificates(certificateChain);
   
   // add a SignerInfo
   X509Certificate signatureCert = certificateChain[0];
   SignerInfo signerInfo = new SignerInfo(
     new IssuerAndSerialNumber(signatureCert), AlgorithmID.sha1, signatureKey);
   // define some attributes
   Attribute[] attributes = { 
     new Attribute(new CMSContentType(ObjectID.cms_data)),
     new Attribute(new SigningTime())
   };
   // set the attributes
   signerInfo.setSignedAttributes(attributes);
   // and add the new signer
   signedData.addSignerInfo(signerInfo);
   
   // write in the data to be signed
   byte[] buffer = new byte[2048];
   int bytesRead;
   while ((bytesRead = dataInputStream.read(buffer)) != -1) {
     signedData.write(buffer, 0, bytesRead);
   }
   // closing the stream add the signer infos and closes the underlying stream
   signedData.close();
 </pre>
 
 Use class <A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms"><CODE>SignedDataStream</CODE></A> to read in and parse
 the encoded SignedData and verify the signature(s).
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A>, 
<A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms"><CODE>SignedDataStream</CODE></A>, 
<A HREF="../../iaik/cms/ContentInfoStream.html" title="class in iaik.cms"><CODE>ContentInfoStream</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#EXPLICIT">EXPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the signed message is not transported within the Signature</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#IMPLICIT">IMPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the signed message is included in the Signature</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#SignedDataOutputStream(java.io.OutputStream, int)">SignedDataOutputStream</A></B>(java.io.OutputStream&nbsp;out,
                       int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataOutputStream object which later writes the complete encoded 
 SignedData structure to the given output stream (e.g.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#SignedDataOutputStream(java.io.OutputStream, iaik.asn1.ObjectID, int)">SignedDataOutputStream</A></B>(java.io.OutputStream&nbsp;out,
                       <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                       int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataOutputStream object which later writes the complete encoded 
 SignedData structure to the given output stream (e.g.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#SignedDataOutputStream(java.io.OutputStream, iaik.asn1.ObjectID, int, iaik.cms.SecurityProvider)">SignedDataOutputStream</A></B>(java.io.OutputStream&nbsp;out,
                       <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                       int&nbsp;mode,
                       <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataOutputStream object which later writes the complete encoded 
 SignedData structure to the given output stream (e.g.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#addCertificates(java.security.cert.Certificate[])">addCertificates</A></B>(java.security.cert.Certificate[]&nbsp;certificates)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given certificates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#addCRLs(iaik.x509.X509CRL[])">addCRLs</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given cerificate-revocation lists.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#addSignerInfo(iaik.cms.SignerInfo)">addSignerInfo</A></B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a SignerInfo object to this SignedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#close()">close</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finishes the encoding and writes the certificates, CRLs (if set) and the 
 <code>SignerInfo</code> objects to the stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#flush()">flush</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flushes any internal data and calls flush of the underlying stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#getMessageDigest(iaik.asn1.structures.AlgorithmID)">getMessageDigest</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the message digest calculated for a specific algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#getSecurityProvider()">getSecurityProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityProvider installed for this SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#isPassThroughClose()">isPassThroughClose</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks whether a call to <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> will call <code>close</code> of the 
 underlying output stream</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setCertificates(java.security.cert.Certificate[])">setCertificates</A></B>(java.security.cert.Certificate[]&nbsp;certificates)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the certificates of the several signers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setCertificateSet(iaik.cms.CertificateSet)">setCertificateSet</A></B>(<A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A>&nbsp;certSet)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the certificateSet to be included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setCRLs(iaik.x509.X509CRL[])">setCRLs</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of cerificate-revocation lists.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setMessageDigest(iaik.asn1.structures.AlgorithmID, byte[])">setMessageDigest</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                 byte[]&nbsp;digest)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method can be used to set an externally calculated MessageDigest value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setPassThroughClose(boolean)">setPassThroughClose</A></B>(boolean&nbsp;passThroughClose)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting this to <code>true</code> will cause <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> to call
 <code>close</code> of the underlying output stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setRevocationInfoChoices(iaik.cms.RevocationInfoChoices)">setRevocationInfoChoices</A></B>(<A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A>&nbsp;crls)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the crls (RevocationInfoChoices) to be included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A></B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityProvider for this SignedDataOutputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#setSignerInfos(iaik.cms.SignerInfo[])">setSignerInfos</A></B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[]&nbsp;signerInfos)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a collection of per-signer information.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some information about this
 <code>SignedDataOutputStream</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#toString(boolean)">toString</A></B>(boolean&nbsp;detailed)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some - if requested - detailed information
 about this <code>SignedDataOutputStream</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[])">write</A></B>(byte[]&nbsp;b)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Processes the given content data to be signed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[], int, int)">write</A></B>(byte[]&nbsp;b,
      int&nbsp;off,
      int&nbsp;len)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Processes the given content data to be signed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataOutputStream.html#write(int)">write</A></B>(int&nbsp;b)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Processes the given content byte to be signed.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="IMPLICIT"><!-- --></A><H3>
IMPLICIT</H3>
<PRE>
public static final int <B>IMPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the signed message is included in the Signature
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.SignedDataOutputStream.IMPLICIT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="EXPLICIT"><!-- --></A><H3>
EXPLICIT</H3>
<PRE>
public static final int <B>EXPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the signed message is not transported within the Signature
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.SignedDataOutputStream.EXPLICIT">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SignedDataOutputStream(java.io.OutputStream, int)"><!-- --></A><H3>
SignedDataOutputStream</H3>
<PRE>
public <B>SignedDataOutputStream</B>(java.io.OutputStream&nbsp;out,
                              int&nbsp;mode)</PRE>
<DL>
<DD>Creates a new SignedDataOutputStream object which later writes the complete encoded 
 SignedData structure to the given output stream (e.g. <A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
 The content type of the inherent content data is set to <code>ObjectID.cms_data</code>.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>out</CODE> - The output stream to which to write the encoded SignedData 
            structure.<DD><CODE>mode</CODE> - The mode. Either <A HREF="../../iaik/cms/SignedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> for including the content or
                              <A HREF="../../iaik/cms/SignedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> for not including it.</DL>
</DL>
<HR>

<A NAME="SignedDataOutputStream(java.io.OutputStream, iaik.asn1.ObjectID, int)"><!-- --></A><H3>
SignedDataOutputStream</H3>
<PRE>
public <B>SignedDataOutputStream</B>(java.io.OutputStream&nbsp;out,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                              int&nbsp;mode)</PRE>
<DL>
<DD>Creates a new SignedDataOutputStream object which later writes the complete encoded 
 SignedData structure to the given output stream (e.g. <A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>out</CODE> - The output stream to which to write the encoded SignedData 
            structure.<DD><CODE>contentType</CODE> - The content type of the data signed by this object,
                    e.g. <code>ObjectID.cms_data</code>.<DD><CODE>mode</CODE> - The mode. Either <A HREF="../../iaik/cms/SignedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> for including the content or
                              <A HREF="../../iaik/cms/SignedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> for not including it.</DL>
</DL>
<HR>

<A NAME="SignedDataOutputStream(java.io.OutputStream, iaik.asn1.ObjectID, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
SignedDataOutputStream</H3>
<PRE>
public <B>SignedDataOutputStream</B>(java.io.OutputStream&nbsp;out,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                              int&nbsp;mode,
                              <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Creates a new SignedDataOutputStream object which later writes the complete encoded 
 SignedData structure to the given output stream (e.g. <A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[])"><CODE>write(byte[])</CODE></A>).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>out</CODE> - The output stream to which to write the encoded SignedData 
            structure.<DD><CODE>contentType</CODE> - The content type of the data signed by this object,
                    e.g. <code>ObjectID.cms_data</code>.<DD><CODE>mode</CODE> - The mode. Either <A HREF="../../iaik/cms/SignedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> for including the content or
                              <A HREF="../../iaik/cms/SignedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> for not including it.<DD><CODE>securityProvider</CODE> - The optional security provider for getting
                         the required crypto algorithm implementations.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="write(byte[], int, int)"><!-- --></A><H3>
write</H3>
<PRE>
public void <B>write</B>(byte[]&nbsp;b,
                  int&nbsp;off,
                  int&nbsp;len)
           throws java.io.IOException</PRE>
<DL>
<DD>Processes the given content data to be signed.
 For later signature calculation the data is hashed with any digest algorithm used
 by any of the SignerInfos that have been <A HREF="../../iaik/cms/SignedDataOutputStream.html#addSignerInfo(iaik.cms.SignerInfo)"><CODE>added</CODE></A>
 so far. In <A HREF="../../iaik/cms/SignedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> mode the content data is encoded and written 
 to the output stream. In <A HREF="../../iaik/cms/SignedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode the content data is not 
 written to the output stream (since it must not be included in the SignedData and 
 has to be transmitted by other means), but contributes to the hash calculation as 
 required.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>write</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b</CODE> - The data to be signed as byte array.<DD><CODE>off</CODE> - The start offset in the data array <code>b</code>.<DD><CODE>len</CODE> - The number of bytes to write.
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If an I/O error occurs.</DL>
</DD>
</DL>
<HR>

<A NAME="write(byte[])"><!-- --></A><H3>
write</H3>
<PRE>
public void <B>write</B>(byte[]&nbsp;b)
           throws java.io.IOException</PRE>
<DL>
<DD>Processes the given content data to be signed.
 For later signature calculation the data is hashed with any digest algorithm used
 by any of the SignerInfos that have been <A HREF="../../iaik/cms/SignedDataOutputStream.html#addSignerInfo(iaik.cms.SignerInfo)"><CODE>added</CODE></A>
 so far. In <A HREF="../../iaik/cms/SignedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> mode the content data is encoded and written 
 to the output stream. In <A HREF="../../iaik/cms/SignedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode the content data is not 
 written to the output stream (since it must not be included in the SignedData and 
 has to be transmitted by other means), but contributes to the hash calculation as 
 required.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>write</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b</CODE> - The data to be signed as byte array.
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If an I/O error occurs.</DL>
</DD>
</DL>
<HR>

<A NAME="write(int)"><!-- --></A><H3>
write</H3>
<PRE>
public void <B>write</B>(int&nbsp;b)
           throws java.io.IOException</PRE>
<DL>
<DD>Processes the given content byte to be signed.
 For later signature calculation the data is hashed with any digest algorithm used
 by any of the SignerInfos that have been <A HREF="../../iaik/cms/SignedDataOutputStream.html#addSignerInfo(iaik.cms.SignerInfo)"><CODE>added</CODE></A>
 so far. In <A HREF="../../iaik/cms/SignedDataOutputStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> mode the content data is encoded and written 
 to the output stream. In <A HREF="../../iaik/cms/SignedDataOutputStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode the content data is not 
 written to the output stream (since it must not be included in the SignedData and 
 has to be transmitted by other means), but contributes to the hash calculation as 
 required.
 <p>
 Note that when repeatedly calling this method to write single data bytes 
 the encoding may consist of many single-byte OCTET STRINGs. Thus it may be more
 appropriate to use a byte array expcting <A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[])"><CODE><code>write</code></CODE></A>
 method.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>write</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b</CODE> - The content data byte to be signed
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If an I/O error occurs.</DL>
</DD>
</DL>
<HR>

<A NAME="flush()"><!-- --></A><H3>
flush</H3>
<PRE>
public void <B>flush</B>()
           throws java.io.IOException</PRE>
<DL>
<DD>Flushes any internal data and calls flush of the underlying stream.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>flush</CODE> in interface <CODE>java.io.Flushable</CODE><DT><B>Overrides:</B><DD><CODE>flush</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If flushing the stream fails.</DL>
</DD>
</DL>
<HR>

<A NAME="close()"><!-- --></A><H3>
close</H3>
<PRE>
public void <B>close</B>()
           throws java.io.IOException</PRE>
<DL>
<DD>Finishes the encoding and writes the certificates, CRLs (if set) and the 
 <code>SignerInfo</code> objects to the stream.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>close</CODE> in interface <CODE>java.io.Closeable</CODE><DT><B>Overrides:</B><DD><CODE>close</CODE> in class <CODE>java.io.OutputStream</CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs while writing to the stream</DL>
</DD>
</DL>
<HR>

<A NAME="isPassThroughClose()"><!-- --></A><H3>
isPassThroughClose</H3>
<PRE>
public boolean <B>isPassThroughClose</B>()</PRE>
<DL>
<DD>Checks whether a call to <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> will call <code>close</code> of the 
 underlying output stream
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>true</code> if a call to <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> will call
         <code>close</code> of the underlying output stream;
         <code>false</code> if a call to <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> will not close the
         underlying stream.</DL>
</DD>
</DL>
<HR>

<A NAME="setPassThroughClose(boolean)"><!-- --></A><H3>
setPassThroughClose</H3>
<PRE>
public void <B>setPassThroughClose</B>(boolean&nbsp;passThroughClose)</PRE>
<DL>
<DD>Setting this to <code>true</code> will cause <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> to call
 <code>close</code> of the underlying output stream. If <code>false</code>,
 a call to <A HREF="../../iaik/cms/SignedDataOutputStream.html#close()"><CODE>close()</CODE></A> will not close the underlying stream.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>passThroughClose</CODE> - <code>true</code> to pass through <code>close()</code> 
                         calls. <code>false</code> to not pass them through.</DL>
</DD>
</DL>
<HR>

<A NAME="setSecurityProvider(iaik.cms.SecurityProvider)"><!-- --></A><H3>
setSecurityProvider</H3>
<PRE>
public void <B>setSecurityProvider</B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Sets the SecurityProvider for this SignedDataOutputStream.
 <p>
 This method allows to explicitly set a SecurityProvider for this SignedDataOutputStream.
 If no explicit SecurityProvider is set, the default system wide installed 
 SecurityProvider will be used for the required cryptographic operations.
 <p>
 This class may use the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.OutputStream)"><CODE>getOutputStreamHashEngine()</CODE></A></code>
     to get an OutputStreamHashEngine through which the data is to be piped for hash value calculation
 </ul>
 And the following methods may be used by the inherent <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> objects:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes()</CODE></A></code>
     to calculate the signature value from the encoding of the signed attributes
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromHash()</CODE></A></code>
     to calculate the signature value from the message hash
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])"><CODE>getHash()</CODE></A></code>
     as may be required for cert hash calculation when querying for included <A HREF="../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> attributes
 </ul>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityProvider</CODE> - the SecurityProvider to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityProvider()"><!-- --></A><H3>
getSecurityProvider</H3>
<PRE>
public <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>getSecurityProvider</B>()</PRE>
<DL>
<DD>Gets the SecurityProvider installed for this SignerInfo.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.OutputStream)"><CODE>getOutputStreamHashEngine()</CODE></A></code>
     to get an OutputStreamHashEngine through which the data is to be piped for hash value calculation
 </ul>
 And the following methods may be used by the inherent <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> objects:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes()</CODE></A></code>
     to calculate the signature value from the encoding of the signed attributes
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromHash()</CODE></A></code>
     to calculate the signature value from the message hash
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])"><CODE>getHash()</CODE></A></code>
     as may be required for cert hash calculation when querying for included <A HREF="../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> attributes
 </ul>
 If no explicit SecurityProvider has been <A HREF="../../iaik/cms/SignedDataOutputStream.html#setSecurityProvider(iaik.cms.SecurityProvider)"><CODE>set</CODE></A> for this object, 
 the default system wide installed SecurityProvider will be used for the required cryptographic
 operations. However, this method will return <code>null</code> if it does not have its own
 SecurityProvider.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityProvider explicitly installed for this object, or <code>null</code> if
         this object does not have its own SecurityProvider</DL>
</DD>
</DL>
<HR>

<A NAME="getMessageDigest(iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
getMessageDigest</H3>
<PRE>
public byte[] <B>getMessageDigest</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm)
                        throws java.security.NoSuchAlgorithmException,
                               <A HREF="../../iaik/cms/CMSRuntimeException.html" title="class in iaik.cms">CMSRuntimeException</A></PRE>
<DL>
<DD>Returns the message digest calculated for a specific algorithm. This method
 implements the <CODE>DigestProvider</CODE>
 interface, and therefore has to be qualified as <i>public</i> method. However, there should
 be no necessity for an application to utilize this method. This method only is called
 from inside the <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> class
 for obtaining the digest calculated on the content for the specified hash algorithm.
 <p>
 <b>It is strongly recommended <i>not</i> to explicitly call this method,
 since it actually finshes the digest computation for all hash values resulting
 from piping the data through the digest streams. This only has to be performed
 once and is done from inside the <code>SignerInfo</code> class!</b>
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the hash algorithm to be used for digest computation
<DT><B>Returns:</B><DD>the message digest calculated on the content for the given hash algorithm
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no message digest for the specified algorithm
<DD><CODE><A HREF="../../iaik/cms/CMSRuntimeException.html" title="class in iaik.cms">CMSRuntimeException</A></CODE> - if an error occurs because of some kind of initiailization problem
                                (e.g. the data to be digested has not been supplied)</DL>
</DD>
</DL>
<HR>

<A NAME="setMessageDigest(iaik.asn1.structures.AlgorithmID, byte[])"><!-- --></A><H3>
setMessageDigest</H3>
<PRE>
public void <B>setMessageDigest</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                             byte[]&nbsp;digest)
                      throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>This method can be used to set an externally calculated MessageDigest value.
 When having created a new SignedDataOutputStream for signing some content, this
 method has to be called after having <A HREF="../../iaik/cms/SignedDataOutputStream.html#setSignerInfos(iaik.cms.SignerInfo[])"><CODE>added</CODE></A> the
 SignerInfos. If none of the SignerInfos uses the specified digest algorithm
 a NoSuchAlgorithmException is thrown and the digest cannot be added.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the hash algorithm for which the digest shall be set<DD><CODE>digest</CODE> - the new value for the messsage digest
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the specified digest algorithm is not
                                     by any of the SignerInfos of this SignedData</DL>
</DD>
</DL>
<HR>

<A NAME="setCertificates(java.security.cert.Certificate[])"><!-- --></A><H3>
setCertificates</H3>
<PRE>
public void <B>setCertificates</B>(java.security.cert.Certificate[]&nbsp;certificates)</PRE>
<DL>
<DD>Sets the certificates of the several signers.
 <p>
 <b>Attention!</b> Only X.509 public key certificates (instances of
 <code>iaik.x509.X509Certificate</code>) or X.509 attribute certificates 
 (instances of <code>iaik.x509.attr.AttributeCertificate</code>) or other
 certificates (instances of <code>iaik.cms.OtherCertificate</code>) can be
 added to this CertificateSet; PKCS#6 extended certificates are obsolete
 and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certificates</CODE> - the certificates to be set
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied certificates
            is not a <code>iaik.x509.X509Certificate</code> or 
            <code>iaik.x509.attr.AttributeCertificate</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="addCertificates(java.security.cert.Certificate[])"><!-- --></A><H3>
addCertificates</H3>
<PRE>
public void <B>addCertificates</B>(java.security.cert.Certificate[]&nbsp;certificates)</PRE>
<DL>
<DD>Adds the given certificates.
 <p>
 <b>Attention!</b> Only X.509 public key certificates (instances of
 <code>iaik.x509.X509Certificate</code>) or X.509 attribute certificates 
 (instances of <code>iaik.x509.attr.AttributeCertificate</code>) or other
 certificates (instances of <code>iaik.cms.OtherCertificate</code>) can be
 added to this CertificateSet; PKCS#6 extended certificates are obsolete
 and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certificates</CODE> - the certificates to be added
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied certificates
            is not a <code>iaik.x509.X509Certificate</code> or 
            <code>iaik.x509.attr.AttributeCertificate</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="setCertificateSet(iaik.cms.CertificateSet)"><!-- --></A><H3>
setCertificateSet</H3>
<PRE>
public void <B>setCertificateSet</B>(<A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A>&nbsp;certSet)</PRE>
<DL>
<DD>Sets the certificateSet to be included.
 This method provides an alternative way to set the certificates by immediately
 supplying a <A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms"><CODE>CertificateSet</CODE></A> that may hold any
 number of X.509 public key and/or attribute certificates.
 <br>
 <b>Attention!</b> Only X.509 public key certificates (instances of
 <code>iaik.x509.X509Certificate</code>) or X.509 attribute certificates 
 (instances of <code>iaik.x509.attr.AttributeCertificate</code>) or other
 certificates (instances of <code>iaik.cms.OtherCertificate</code>) can be
 added to this CertificateSet; PKCS#6 extended certificates are obsolete
 and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certSet</CODE> - the certificate set to be added
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied certificates
            is not a <code>iaik.x509.X509Certificate</code> or 
            <code>iaik.x509.attr.AttributeCertificate</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="setRevocationInfoChoices(iaik.cms.RevocationInfoChoices)"><!-- --></A><H3>
setRevocationInfoChoices</H3>
<PRE>
public void <B>setRevocationInfoChoices</B>(<A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A>&nbsp;crls)</PRE>
<DL>
<DD>Sets the crls (RevocationInfoChoices) to be included.
 This method provides an alternative way to set the crls by immediately
 supplying a <A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms"><CODE>RevocationInfoChoices</CODE></A> set that may hold any
 number of X.509 or other crls.
 <br>
 <b>Attention!</b> Only X.509 crls (instances of
 <code>iaik.x509.X509CRL</code>) or other revocation infos
 (instances of <code>iaik.cms.OtherRevocationInfo</code>) can be
 included in the given RevocationInfoChoices set.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>crls</CODE> - the RevocationInfoChoices to be set
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied revocation
            infos is not a <code>iaik.x509.X509CRL</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="setCRLs(iaik.x509.X509CRL[])"><!-- --></A><H3>
setCRLs</H3>
<PRE>
public void <B>setCRLs</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</PRE>
<DL>
<DD>Sets a set of cerificate-revocation lists.
 <p>
 The given CRLs supply information about the revocation status of the
 certificates specified in the <code>certificates</code> field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>crls</CODE> - a set of cerificate-revocation lists as array of X509CRLs</DL>
</DD>
</DL>
<HR>

<A NAME="addCRLs(iaik.x509.X509CRL[])"><!-- --></A><H3>
addCRLs</H3>
<PRE>
public void <B>addCRLs</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</PRE>
<DL>
<DD>Adds the given cerificate-revocation lists.
 <p>
 The given CRLs supply information about the revocation status of the
 certificates specified in the <code>certificates</code> field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>crls</CODE> - the crls to be added</DL>
</DD>
</DL>
<HR>

<A NAME="setSignerInfos(iaik.cms.SignerInfo[])"><!-- --></A><H3>
setSignerInfos</H3>
<PRE>
public void <B>setSignerInfos</B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[]&nbsp;signerInfos)
                    throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Sets a collection of per-signer information.
 <p>
 There may be any number of elements in the collection, including zero.
 For digest engine initialization any SignerInfos shall be set <i>before</i>
 writing any content data to this SignedDataOutputStream.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfos</CODE> - a collection of per-signer information
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the message digest algorithm
            used by any of the given SignerInfos<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addSignerInfo(iaik.cms.SignerInfo)"><!-- --></A><H3>
addSignerInfo</H3>
<PRE>
public void <B>addSignerInfo</B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)
                   throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Adds a SignerInfo object to this SignedData.
 <p>
 This method not only adds the given SignerInfo, but also
 initializes the hash computation by wrapping a digest stream
 for the hash algorithm of the signer around the content output stream.
 Thus this method shall be called <i>before</i> <A HREF="../../iaik/cms/SignedDataOutputStream.html#write(byte[])"><CODE>writing</CODE></A> any content data to this SignedDataOutputStream.
 <br>
 If the given SignerInfo contains signed attributes, it must include 
 the PKCS#9 content-type attribute and the PKCS#9 message-digest attribute. 
 If the message-digest attribute is not included in the supplied signed attributes
 it is automatically calculated and set later during signature calculation. If the 
 content-type attribute is not included it is automatically added and set to the 
 eContentType of the SignedData EncapsulatedContentInfo. 
 However, if the signature value is already set for the SignerInfo, an Exception is 
 thrown if the content-type attribute is not included in the signed attributes. An
 Exception is also thrown if the content-type attribute is already included in the
 SignerInfo but does not match to the eContentType of the SignedData EncapsulatedContentInfo.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfo</CODE> - the SignerInfo to add
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the message digest algorithm
            used by the given SignerInfo, or if the signature value is already set for
            the SignerInfo and the ContentType attribute is not included in the signed
            attributes, or if the content-type attribute is already included in the SignerInfo
            but does not match to the eContentType of the SignedData EncapsulatedContentInfo
            (for backwards compatibility only an NoSuchAlgorithmException can be
            thrown by this method)<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string giving some information about this
 <code>SignedDataOutputStream</code> object.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="toString(boolean)"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>(boolean&nbsp;detailed)</PRE>
<DL>
<DD>Returns a string giving some - if requested - detailed information
 about this <code>SignedDataOutputStream</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>detailed</CODE> - - whether or not to give detailed information
<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/SignedDataInOutStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/SignedDataOutputStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedDataOutputStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
