<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:14 GMT 2016 -->
<TITLE>
SignedDataInOutStream (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.SignedDataInOutStream class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SignedDataInOutStream (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/SignedDataOutputStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/SignedDataInOutStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedDataInOutStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#fields_inherited_from_class_iaik.cms.SignedDataStream">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class SignedDataInOutStream</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">iaik.cms.SignedDataStream</A>
      <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.SignedDataInOutStream</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A>, <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A>, java.util.EventListener</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>SignedDataInOutStream</B><DT>extends <A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></DL>
</PRE>

<P>
SignedDataStream implementation that encodes a SignedData object again 
 during parsing is done. The SignedData object may be modified before finishing
 the encoding.
 <p>
 When <A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, java.io.OutputStream)"><CODE>creating</CODE></A>
 a <code>SignedDataInOutStream</code> object an input stream has to specified from which
 to read the encoded SignedData object, and an output stream to which to write
 the (maybe modified) SignedData object again:
 <pre>
 // input stream from which to read the already existing encoded SignedData object:
 InputStream is = ...;
 // output stream to which to write the (maybe modified) SignedData object again:
 OutputStream os = ...;
 SignedDataInOutStream signedData = new SignedDataInOutStream(is, os);
 </pre>
 Additionally an array of digest algorithm ids may be specified to be added to
 the list of digest algorithms of the already existing SignedData. Additional
 digest algorithms may be necessary when, for instance, adding a new SignerInfo
 that uses a digest algorithm that is not used by any of the already included
 SignerInfos, e.g.:
 <pre>
 // input stream from which to read the already existing encoded SignedData object:
 InputStream is = ...;
 // output stream to which to write the (maybe modified) SignedData object again:
 OutputStream os = ...;
 // we want add a SignerInfo that used SHA-256
 AlgorithmID[] additionalDigestAlgs = { AlgorithmID.sha256 };
 SignedDataInOutStream signedData = new SignedDataInOutStream(is, os, additionalDigestAlgs);
 </pre>
 It is necessary to specify any additional digest algorithm already when creating the
 <code>SignedDataInOutStream</code> object because they have to be known for the initial SignedData
 <code>digestAlgorithms</code> field.
 <p>
 The further proceeding is similar to that of parent class <code>SignedDataStream</code>
 except for using method <A HREF="../../iaik/cms/SignedDataInOutStream.html#write()"><CODE><code>write()</code></CODE></A> for finishing the SignedData
 encoding instead of using method <code>writeTo(OutputStream)</code>. Since the output
 stream is already set when <A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, java.io.OutputStream)"><CODE>creating</CODE></A>
 the SignedDataInOutStream object, it is not required as parameter for the
 final <code>write()</code> method, e.g.:
 <pre>
 // input stream from which to read the already existing encoded SignedData object:
 InputStream is = ...;
 // output stream to which to write the (maybe modified) SignedData object again:
 OutputStream os = ...;
 // we want add a SignerInfo that used SHA-256
 AlgorithmID sha256 = (AlgorithmID)AlgorithmID.sha256.clone();
 AlgorithmID[] additionalDigestAlgs = { sha256 };
 SignedDataInOutStream signedData = new SignedDataInOutStream(is, os, additionalDigestAlgs);
 
 // in explicit mode explicitly supply the content for hash computatio
 if (signedData.getMode() == SignedDataStream.EXPLICIT) {
   signed_data.setInputStream(new ByteArrayInputStream(message));
 }
 
 // get an InputStream for reading the signed content
 InputStream data = signed_data.getInputStream();
 OutputStream dataStream = ...;
 Util.copyStream(data, dataStream, new byte[4096]);
 
 // verify the signature(s) of the already included SignerInfo(s)
 SignerInfo[] signerInfos = signedData.getSignerInfos();
 int numberOfSigners = signerInfos.length;
 for (int i=0; i < numberOfSigners; i++) {
   try {
     // verify the signed data using the SignerInfo at index i
     X509Certificate signerCert = signedData.verify(i);
     // if the signature is OK the certificate of the signer is returned
     System.out.println("Signature OK from signer: "+signerCert.getSubjectDN());
   } catch (SignatureException ex) {
     // if the signature is not OK a SignatureException is thrown
     System.out.println("Signature ERROR from signer: "+signedData.getCertificate((signerInfos[i].getSignerIdentifier())).getSubjectDN());
     throw new CMSException(ex.toString());
   } 
 }
 
 // create and add a new SignerInfo using SHA-256 as digest algorithm
 X509Certificate signerCert = ...;
 PrivateKey signerKey = ...;
 SignerInfo signerInfo = new SignerInfo(new IssuerAndSerialNumber(signerCert),
                                        sha256,
                                        signerKey);
    
 // create some signed attributes (the message digest attribute is automatically added)
 Attribute[] attributes = new Attribute[2];
 // content type is data
 CMSContentType contentType = new CMSContentType(ObjectID.cms_data);
 attributes[0] = new Attribute(contentType);
 // signing time is now
 SigningTime signingTime = new SigningTime();
 attributes[1] = new Attribute(signingTime);
 // set the attributes
 signerInfo.setSignedAttributes(attributes);
 // add SignerInfo to SignedData 
 signedData.addSignerInfo(signer_info);
 // add the signer certificate
 signedData.addCertificates(new Certificate[] { signerCert });
 
 // finish the SignedData encoding
 SignedData.write(); 
 </pre>
 Note that in difference to the <code>writeTo</code> method of class <code>SignedDataStream</code>
 method <code>write</code> already wraps the SignedData into a ContentInfo.
 <p>
 Note that adding/removing/modifying attributes in already included SignerInfos has
 to be done with care when wanting to encode the SignedData anew. The encoding
 of attributes / attribute values is kept during parsing to write them unchanged
 when encoding the SignedData anew. For that reason attribute modifications of
 already existing SignerInfos may not be included in the newly encoded SignedData.
 For that reason you should explicitly call any of the Attribute <code>clearEncoded</code>
 method before changing an Attribute (value).
 <p>
 However, not only the encoding of attributes is kept (and written anew), but also the following
 components: Certificate(Choices) elements, RevocationInfoChoice elements, and the SignerInfo 
 fields version, signerIdentifier, signedAttrs, signatureAlgorithm and signature, and each
 unsigned attribute and unsigned attribute value. If you do not want to keep the encoding
 of these fields (to encode them anew in any case) just call static method <A HREF="../../iaik/cms/SignedDataInOutStream.html#setKeepComponentEncodings(boolean)"><CODE>keepComponentEncodings</CODE></A> with <code>false</code> as parameter:
 <pre>
 SignedDataInOutStream.setKeepComponentEncodings(false);
 </pre> 
 <p>
 <code>SignedDataInOutStream</code> should be used with an IAIK-JCE version &gt;&quot;5.3,
 at least an IAIK-JCE version &gt;&quot;3.16 is required.
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_iaik.cms.SignedDataStream"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class iaik.cms.<A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../iaik/cms/SignedDataStream.html#blockSize_">blockSize_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#certSet_">certSet_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#contentType_">contentType_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#crls_">crls_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#encapContentInfo_">encapContentInfo_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#EXPLICIT">EXPLICIT</A>, <A HREF="../../iaik/cms/SignedDataStream.html#IMPLICIT">IMPLICIT</A>, <A HREF="../../iaik/cms/SignedDataStream.html#inputStream_">inputStream_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#mode_">mode_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#securityProvider_">securityProvider_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#signerInfos_">signerInfos_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#thisObject_">thisObject_</A>, <A HREF="../../iaik/cms/SignedDataStream.html#version_">version_</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)">SignedDataInOutStream</A></B>(java.io.InputStream&nbsp;dataIs,
                      <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;digestAlgs,
                      <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new <code>SignedDataInOutStream</code> from an InputStream holding the content that
 has been transmitted by other means and an array specifying the hash 
 algorithms to be used for digesting.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, java.io.OutputStream)">SignedDataInOutStream</A></B>(java.io.InputStream&nbsp;is,
                      java.io.OutputStream&nbsp;out)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new <code>SignedDataInOutStream</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, java.io.OutputStream, iaik.asn1.structures.AlgorithmID[])">SignedDataInOutStream</A></B>(java.io.InputStream&nbsp;is,
                      java.io.OutputStream&nbsp;out,
                      <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;additionalDigestAlgs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new <code>SignedDataInOutStream</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, java.io.OutputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)">SignedDataInOutStream</A></B>(java.io.InputStream&nbsp;is,
                      java.io.OutputStream&nbsp;out,
                      <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;additionalDigestAlgs,
                      <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new <code>SignedDataInOutStream</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, java.io.OutputStream, iaik.cms.SecurityProvider)">SignedDataInOutStream</A></B>(java.io.InputStream&nbsp;is,
                      java.io.OutputStream&nbsp;out,
                      <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new <code>SignedDataInOutStream</code>.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#setKeepComponentEncodings(boolean)">setKeepComponentEncodings</A></B>(boolean&nbsp;keepEncodings)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decides whether to keep the encodings of some certain SignedData/SignerInfo components
 during parsing to write them unchanged when encoding the SignedData again.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#setOutputStream(java.io.OutputStream)">setOutputStream</A></B>(java.io.OutputStream&nbsp;out)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the output stream to which to encode the parsed SignedData again.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#setSDSEncodeListener(iaik.cms.SDSEncodeListener)">setSDSEncodeListener</A></B>(<A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms">SDSEncodeListener</A>&nbsp;sdsEncodeListener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets an SDSEncodeListener for this SignedDataStream, but
 throws a RuntimeException if an output stream has been set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#toASN1Object()">toASN1Object</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this SignedData as ASN1Object, but
 throws a RuntimeException if an output stream has been set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#toASN1Object(int)">toASN1Object</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this SignedData as ASN1Object where a constructed
 OCTET STRING is used for encoding the content, but
 throws a RuntimeException if an output stream has been set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#write()">write</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finishes the encoding and writes the certificates, CRLs (if set) and the 
 <code>SignerInfo</code> objects to the stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#writeTo(java.io.OutputStream)">writeTo</A></B>(java.io.OutputStream&nbsp;os)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BER encodes and writes the SignedData to the supplied output stream, but
 throws a RuntimeException if an output stream has been already set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataInOutStream.html#writeTo(java.io.OutputStream, int)">writeTo</A></B>(java.io.OutputStream&nbsp;os,
        int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BER encodes and writes the SignedData to the supplied output stream, but
 throws a RuntimeException if an output stream has been already set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_iaik.cms.SignedDataStream"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class iaik.cms.<A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../iaik/cms/SignedDataStream.html#addCertificates(java.security.cert.Certificate[])">addCertificates</A>, <A HREF="../../iaik/cms/SignedDataStream.html#addCRLs(iaik.x509.X509CRL[])">addCRLs</A>, <A HREF="../../iaik/cms/SignedDataStream.html#addDigestAlgorithm(iaik.asn1.structures.AlgorithmID)">addDigestAlgorithm</A>, <A HREF="../../iaik/cms/SignedDataStream.html#addSDSEncodeListener(iaik.cms.SDSEncodeListener)">addSDSEncodeListener</A>, <A HREF="../../iaik/cms/SignedDataStream.html#addSignerInfo(iaik.cms.SignerInfo)">addSignerInfo</A>, <A HREF="../../iaik/cms/SignedDataStream.html#clearSignatures(boolean, boolean)">clearSignatures</A>, <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)">decode</A>, <A HREF="../../iaik/cms/SignedDataStream.html#encodeCalled(iaik.asn1.ASN1Object, int)">encodeCalled</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getAttributeCertificates()">getAttributeCertificates</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getBlockSize()">getBlockSize</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getCertificate(iaik.cms.CertificateIdentifier)">getCertificate</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getCertificates()">getCertificates</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getCertificates(iaik.cms.CertificateIdentifier)">getCertificates</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getCertificateSet()">getCertificateSet</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getContentType()">getContentType</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getCRLs()">getCRLs</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getDigestAlgorithms()">getDigestAlgorithms</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getEncapsulatedContentType()">getEncapsulatedContentType</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getInputStream()">getInputStream</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getMessageDigest(iaik.asn1.structures.AlgorithmID)">getMessageDigest</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getMode()">getMode</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getRevocationInfoChoices()">getRevocationInfoChoices</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getSecurityProvider()">getSecurityProvider</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getSignedDigest(int)">getSignedDigest</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfo(iaik.cms.CertificateIdentifier)">getSignerInfo</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfo(iaik.x509.X509Certificate)">getSignerInfo</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfoIndex(iaik.x509.X509Certificate)">getSignerInfoIndex</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfos()">getSignerInfos</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getVersion()">getVersion</A>, <A HREF="../../iaik/cms/SignedDataStream.html#getX509Certificates()">getX509Certificates</A>, <A HREF="../../iaik/cms/SignedDataStream.html#notifyEOF()">notifyEOF</A>, <A HREF="../../iaik/cms/SignedDataStream.html#removeMessageDigest(iaik.asn1.structures.AlgorithmID)">removeMessageDigest</A>, <A HREF="../../iaik/cms/SignedDataStream.html#removeSignerInfo(iaik.cms.CertificateIdentifier)">removeSignerInfo</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setBlockSize(int)">setBlockSize</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setCertificates(java.security.cert.Certificate[])">setCertificates</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setCertificateSet(iaik.cms.CertificateSet)">setCertificateSet</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setCRLs(iaik.x509.X509CRL[])">setCRLs</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)">setInputStream</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setMessageDigest(iaik.asn1.structures.AlgorithmID, byte[])">setMessageDigest</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setRevocationInfoChoices(iaik.cms.RevocationInfoChoices)">setRevocationInfoChoices</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A>, <A HREF="../../iaik/cms/SignedDataStream.html#setSignerInfos(iaik.cms.SignerInfo[])">setSignerInfos</A>, <A HREF="../../iaik/cms/SignedDataStream.html#toString()">toString</A>, <A HREF="../../iaik/cms/SignedDataStream.html#toString(boolean)">toString</A>, <A HREF="../../iaik/cms/SignedDataStream.html#verify(int)">verify</A>, <A HREF="../../iaik/cms/SignedDataStream.html#verify(java.security.PublicKey, int)">verify</A>, <A HREF="../../iaik/cms/SignedDataStream.html#verify(iaik.x509.X509Certificate)">verify</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SignedDataInOutStream(java.io.InputStream, java.io.OutputStream)"><!-- --></A><H3>
SignedDataInOutStream</H3>
<PRE>
public <B>SignedDataInOutStream</B>(java.io.InputStream&nbsp;is,
                             java.io.OutputStream&nbsp;out)
                      throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                             java.io.IOException</PRE>
<DL>
<DD>Creates a new <code>SignedDataInOutStream</code>.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream from which to parse the SignedData<DD><CODE>out</CODE> - the output stream to which to write the encoded SignedData again
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs during SignedData parsing
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading/writing</DL>
</DL>
<HR>

<A NAME="SignedDataInOutStream(java.io.InputStream, java.io.OutputStream, iaik.asn1.structures.AlgorithmID[])"><!-- --></A><H3>
SignedDataInOutStream</H3>
<PRE>
public <B>SignedDataInOutStream</B>(java.io.InputStream&nbsp;is,
                             java.io.OutputStream&nbsp;out,
                             <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;additionalDigestAlgs)
                      throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                             java.io.IOException</PRE>
<DL>
<DD>Creates a new <code>SignedDataInOutStream</code>.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream from which to parse the SignedData<DD><CODE>out</CODE> - the output stream to which to write the encoded SignedData again<DD><CODE>additionalDigestAlgs</CODE> - any additional digest algorithm ids to be added
                             to the <code>digestAlgorithms</code> field
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs during SignedData parsing
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading/writing</DL>
</DL>
<HR>

<A NAME="SignedDataInOutStream(java.io.InputStream, java.io.OutputStream, iaik.cms.SecurityProvider)"><!-- --></A><H3>
SignedDataInOutStream</H3>
<PRE>
public <B>SignedDataInOutStream</B>(java.io.InputStream&nbsp;is,
                             java.io.OutputStream&nbsp;out,
                             <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                      throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                             java.io.IOException</PRE>
<DL>
<DD>Creates a new <code>SignedDataInOutStream</code>.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream from which to parse the SignedData<DD><CODE>out</CODE> - the output stream to which to write the encoded SignedData again<DD><CODE>securityProvider</CODE> - the CMS SecurityProvider to be used for cryptographic
                         operations
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs during SignedData parsing
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading/writing</DL>
</DL>
<HR>

<A NAME="SignedDataInOutStream(java.io.InputStream, java.io.OutputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)"><!-- --></A><H3>
SignedDataInOutStream</H3>
<PRE>
public <B>SignedDataInOutStream</B>(java.io.InputStream&nbsp;is,
                             java.io.OutputStream&nbsp;out,
                             <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;additionalDigestAlgs,
                             <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                      throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                             java.io.IOException</PRE>
<DL>
<DD>Creates a new <code>SignedDataInOutStream</code>.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream from which to parse the SignedData<DD><CODE>out</CODE> - the output stream to which to write the encoded SignedData again<DD><CODE>additionalDigestAlgs</CODE> - any additional digest algorithm ids to be added
                             to the <code>digestAlgorithms</code> field<DD><CODE>securityProvider</CODE> - the CMS SecurityProvider to be used for cryptographic
                         operations
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs during SignedData parsing
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading/writing</DL>
</DL>
<HR>

<A NAME="SignedDataInOutStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)"><!-- --></A><H3>
SignedDataInOutStream</H3>
<PRE>
public <B>SignedDataInOutStream</B>(java.io.InputStream&nbsp;dataIs,
                             <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;digestAlgs,
                             <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                      throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                             java.io.IOException</PRE>
<DL>
<DD>Creates a new <code>SignedDataInOutStream</code> from an InputStream holding the content that
 has been transmitted by other means and an array specifying the hash 
 algorithms to be used for digesting.
 <p>
 Do <i><b>not</b></i> use this constructor for supplying the content value
 to be signed. This constructor may be used by the recipient for initializing 
 the digest computation for an already existing explicit SignedDataStream message
 where the content data is not included (<A HREF="../../iaik/cms/SignedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A>
 mode). The actual decoding has to be performed by calling
 the <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> method just after reading the 
 data.
 <br> 
 Since the main use case of this <code>SignedDataInOutStream</code> class is to encode the 
 SignedData again when parsing it method <A HREF="../../iaik/cms/SignedDataInOutStream.html#setOutputStream(java.io.OutputStream)"><CODE>setOutputStream</CODE></A> 
 maybe used to specify the output stream to which to encode the SignedData again. 
 It is important to call method <A HREF="../../iaik/cms/SignedDataInOutStream.html#setOutputStream(java.io.OutputStream)"><CODE>setOutputStream</CODE></A>
 before calling method <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A>:
 <pre>
 // the content data provided by other means:
 InputStream dataIs = ...;
 // the digest algorithms
 AlgorithmID[] digestAlgorithms = ...;
 // initialize for digest computation:
 SignedDataInOutStream signedData = new SignedInOutDataStream(dataIs, digestAlgorithms, null);
 //read the stream thereby updating the hash values:
 dataIs = signedData.getInputStream();
 byte[] buf = new byte[4096];
 int r;
 while ((r = dataIs.read(buf)) > 0) {
   // do something useful 
 }
 
 // set the output stream to which to encode the parsed SignedData again:
 OutputStream os = ...;
 signedData.setOutputStream(os);
 
 // the stream from which to read the encoded SignedData
 InputStream signedDataIs = ...;
 // explicitly perform the decoding
 signedData.decode(signedDataIs); 
 </pre>
 Note that this constructor is only included to provide the functionality of the
 same <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)"><CODE>constructor</CODE></A> of the parent <code>SignedDataStream</code> class. It requires that
 the digest algorithm(s) for an explicit SignedData message have to be known in advance
 before actually parsing it. The <code>digestAlgs</code> field may also contain any 
 additional digest algorithm(s) that may be required when, e.g., adding a new SignerInfo.
 <p>
 When not knowing the digest algorithms of the to-be-parsed SignedData message in advance
 it will be more appropriate to create the <code>SignedDataInOutStream</code> in the accustomed way
 and subsequently call method <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A> to provide the
 content data received by other means:   
 <pre>
 // the stream from which to read the encoded SignedData
 InputStream signedDataIs = ...;
 // the output stream to which to encode the parsed SignedData again:
 OutputStream os = ...;
 SignedDataInOutStream signedData = new SignedInOutDataStream(signedDataIs, os);
 
 // in explicit mode explicitly supply the content for hash computation
 if (signed_data.getMode() == SignedDataStream.EXPLICIT) {
   // the content data provided by other means:
   InputStream dataIs = ...;  
   signedData.setInputStream(dataIs);
 }
 //read the stream thereby updating the hash values:
 InputStream dataIs = signedData.getInputStream();
 byte[] buf = new byte[4096];
 int r;
 while ((r = dataIs.read(buf)) > 0) {
   // do something useful 
 }
 .... 
 
 </pre>
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>dataIs</CODE> - the InputStream supplying the content data which has been transmitted by other means<DD><CODE>digestAlgs</CODE> - the digest algorithms used by the participated signers for digesting the
                   content data and any additional digest algorithms that may be required<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for this SignedData object; if <code>null</code>
                         the default system-wide installed SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if there is no implementation for the specified hash algorithm
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setKeepComponentEncodings(boolean)"><!-- --></A><H3>
setKeepComponentEncodings</H3>
<PRE>
public static void <B>setKeepComponentEncodings</B>(boolean&nbsp;keepEncodings)</PRE>
<DL>
<DD>Decides whether to keep the encodings of some certain SignedData/SignerInfo components
 during parsing to write them unchanged when encoding the SignedData again.
 <p>
 During parsing the encodings of the following components are kept: Certificate(Choices) 
 elements, RevocationInfoChoice elements, and the SignerInfo fields version, signerIdentifier,
 signedAttrs, signatureAlgorithm and signature, and each unsigned attribute and unsigned 
 attribute value. If you do not want to keep the encoding of these fields (to encode them
 anew in any case) just call this method with <code>false</code> as parameter:
 <pre>
 SignedDataInOutStream.setKeepComponentEncodings(false);
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keepEncodings</CODE> - whether to keep the encodings of certain components during parsing 
                      (default: <code>true</code>)</DL>
</DD>
</DL>
<HR>

<A NAME="setOutputStream(java.io.OutputStream)"><!-- --></A><H3>
setOutputStream</H3>
<PRE>
public void <B>setOutputStream</B>(java.io.OutputStream&nbsp;out)</PRE>
<DL>
<DD>Sets the output stream to which to encode the parsed SignedData again.
 <br>
 Since the output stream has to be known before starting the SignedData parsing
 this method only may be used when having created an <code>SignedDataInOutStream</code>
 object in explicit mode with the <A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)"><CODE>SignedDataInOutStream(InputStream dataIs,
 AlgorithmID[] digestAlgs, SecurityProvider securityProvider)</CODE></A> constructor from the 
 content data and later call method <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> to parse the
 SignedData:
 <pre>
 // the content data provided by other means:
 InputStream dataIs = ...;
 // the digest algorithms
 AlgorithmID[] digestAlgorithms = ...;
 // initialize for digest computation:
 SignedDataInOutStream signedData = new SignedInOutDataStream(dataIs, digestAlgorithms, null);
 //read the stream thereby updating the hash values:
 dataIs = signedData.getInputStream();
 byte[] buf = new byte[4096];
 int r;
 while ((r = dataIs.read(buf)) > 0) {
   // do something useful 
 }
 
 // set the output stream to which to encode the parsed SignedData again:
 OutputStream os = ...;
 signedData.setOutputStream(os);
 
 // the stream from which to read the encoded SignedData
 InputStream signedDataIs = ...;
 // explicitly perform the decoding
 signedData.decode(signedDataIs); 
 </pre>
 When using this method in any other case an <code>IllegalStateException</code>
 will be thrown.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>out</CODE> - the output stream to which to write the newly encoded SignedData
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalStateException</CODE> - if this method is called when SignedData parsing
                               already has occurred</DL>
</DD>
</DL>
<HR>

<A NAME="write()"><!-- --></A><H3>
write</H3>
<PRE>
public void <B>write</B>()
           throws java.io.IOException</PRE>
<DL>
<DD>Finishes the encoding and writes the certificates, CRLs (if set) and the 
 <code>SignerInfo</code> objects to the stream.
 <br>
 Since the output stream is already set when <A HREF="../../iaik/cms/SignedDataInOutStream.html#SignedDataInOutStream(java.io.InputStream, java.io.OutputStream)"><CODE>creating</CODE></A>
 the SignedDataInOutStream object, it is not required as parameter for the
 final <code>write()</code> method.
 <p>
 <b>Note</b> that in difference to the <code>writeTo</code> method of class <code>SignedDataStream</code>
 method <code>write</code> already wraps the SignedData into a ContentInfo.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs while writing to the stream</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os)
             throws java.io.IOException</PRE>
<DL>
<DD>BER encodes and writes the SignedData to the supplied output stream, but
 throws a RuntimeException if an output stream has been already set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.
 In this case method <A HREF="../../iaik/cms/SignedDataInOutStream.html#write()"><CODE>write</CODE></A> has to be used for encoding the
 SignedData (again).
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream)">writeTo</A></CODE> in class <CODE><A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this SignedDataStream shall be encoded
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs when writing to the stream</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream, int)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os,
                    int&nbsp;blockSize)
             throws java.io.IOException</PRE>
<DL>
<DD>BER encodes and writes the SignedData to the supplied output stream, but
 throws a RuntimeException if an output stream has been already set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.
 In this case method <A HREF="../../iaik/cms/SignedDataInOutStream.html#write()"><CODE>write</CODE></A> has to be used for encoding the
 SignedData (again).
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</A></CODE> in class <CODE><A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this SignedData shall be written<DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs during writing the object</DL>
</DD>
</DL>
<HR>

<A NAME="setSDSEncodeListener(iaik.cms.SDSEncodeListener)"><!-- --></A><H3>
setSDSEncodeListener</H3>
<PRE>
public void <B>setSDSEncodeListener</B>(<A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms">SDSEncodeListener</A>&nbsp;sdsEncodeListener)
                          throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Sets an SDSEncodeListener for this SignedDataStream, but
 throws a RuntimeException if an output stream has been set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SignedDataStream.html#setSDSEncodeListener(iaik.cms.SDSEncodeListener)">setSDSEncodeListener</A></CODE> in class <CODE><A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sdsEncodeListener</CODE> - the SDSEncodeListener to be set
<DT><B>Throws:</B>
<DD><CODE>if</CODE> - the SDSEncodeListener announces any not supported
            digest algorithms to be used
<DD><CODE>java.security.NoSuchAlgorithmException</CODE><DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms"><CODE>SDSEncodeListener</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object()"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>()
                        throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this SignedData as ASN1Object, but
 throws a RuntimeException if an output stream has been set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toASN1Object()">toASN1Object</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE><DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SignedDataStream.html#toASN1Object()">toASN1Object</A></CODE> in class <CODE><A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>this SignedData as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object(int)"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>(int&nbsp;blockSize)
                           throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this SignedData as ASN1Object where a constructed
 OCTET STRING is used for encoding the content, but
 throws a RuntimeException if an output stream has been set when creating
 the <code>SignedDataInOutStream</code> object or by calling method <code>setOutputStream</code>.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SignedDataStream.html#toASN1Object(int)">toASN1Object</A></CODE> in class <CODE><A HREF="../../iaik/cms/SignedDataStream.html" title="class in iaik.cms">SignedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/SignedDataOutputStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/SignedDataInOutStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedDataInOutStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#fields_inherited_from_class_iaik.cms.SignedDataStream">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
