<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:10 GMT 2016 -->
<TITLE>
AuthenticatedDataStream (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.AuthenticatedDataStream class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="AuthenticatedDataStream (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/AuthEnvelopedData.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthenticatedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthenticatedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class AuthenticatedDataStream</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.AuthenticatedDataStream</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A>, <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A>, java.util.EventListener</DD>
</DL>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../iaik/cms/AuthenticatedData.html" title="class in iaik.cms">AuthenticatedData</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>AuthenticatedDataStream</B><DT>extends java.lang.Object<DT>implements <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A></DL>
</PRE>

<P>
This class represents the stream-supporting implementation of the CMS content
 type <code>AutheticatedData</code>.
 <p>
 Each CMS content type is associated with a specific object identifier.
 The object identifier for the <code>AutheticatedData</code> content type is
 defined as:
 <p><code>
 id-ct-authData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
       us(840) rsadsi(113549) pkcs(1) pkcs-9(9) smime(16)
       ct(1) 2 }
 </code><p>
 which corresponds to the OID string "1.2.840.113549.1.9.16.1.2".
 <p>
 The Cryptographic Message Syntax (CMS) (<a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>) 
 specifies the <code>AutheticatedData</code> content type for providing a syntax for recipient-specific protecting
 the integrity of a message by means of a Message Authentication Code (MAC).
 Content of any type may be authenticated for any number of recipients in parallel. For
 each recipient a commonly at random generated symmetric mac key is
 encrypted with the particular recipient key and - together with
 recipient-specific information - collected into a <code>RecipientInfo</code>
 value. A message authentication code on the content is computed
 with the mac key and -- together with the RecipientInfos objects --
 packed into a AuthenticedData message. 
 <p>
 The <code>AutheticatedData</code> type is defined as ASN.1 SEQUENCE type
 containing the following components (see 
 <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>):
 <p><PRE>
 AuthenticatedData ::= SEQUENCE {
   version CMSVersion,
   originatorInfo [0] IMPLICIT OriginatorInfo OPTIONAL,
   recipientInfos RecipientInfos,
   macAlgorithm MessageAuthenticationCodeAlgorithm,
   digestAlgorithm [1] DigestAlgorithmIdentifier OPTIONAL,
   encapContentInfo EncapsulatedContentInfo,
   authAttrs [2] IMPLICIT AuthAttributes OPTIONAL,
   mac MessageAuthenticationCode,
   unauthAttrs [3] IMPLICIT UnauthAttributes OPTIONAL }

   AuthAttributes ::= SET SIZE (1..MAX) OF Attribute

   UnauthAttributes ::= SET SIZE (1..MAX) OF Attribute

   MessageAuthenticationCode ::= OCTET STRING
 </PRE><p>
 If the <code>digestAlgorithm</code> field is not null, authenticated attributes
 have to be present and the MAC value is calculated on the DER encoding
 of the authenticated attributes. In this case the <code>MessageDigest</code>
 attribute has to be included as authenticated attribute and has to contain
 a digest value computed on the content data. If no authenticated attributes
 are present, the MAC value is computed on the content itself.
 <p>
 A recipient, when receiving the <code>AutheticatedData</code> message,
 decrypts the corresponding encrypted mac key with his/her key and
 subsequently uses it to verify the message authentication code. 
 <p>
 See <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a> for more 
 information.
 <p>
 <hr>
 <p>
 When <A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)"><CODE>creating</CODE></A> an AuthenticatedDataStream
 object an application has to decide whether the to-be-authenticated content
 shall be incldued (<A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> mode) into the AuthenticatedData
 message or shall be transmitted by other means (<A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode):
 <pre>
 int mode = AuthenticatedDataStream.IMPLICIT; // include content
 </pre>
 or
 <pre>
 int mode = AuthenticatedDataStream.EXPLICIT; // do not include content
 </pre>
 However, in both cases the content data has to be supplied when creating the 
 <code>AuthenticatedDataStream</code> object, because it is needed for the 
 MAC computation:
 <pre>
 InputSrteam[] dataStream = ...; // the content data supplying input stream
 </pre>
 Together with transmission mode and content data the following values have to
 be specified when creating an AuthenticatedDataStream object, some of them
 are only optional:
 <ul>
 <li>content type: the type of the authenticated content (e.g. ObjectID.cms_data)
 <li>content stream: an input stream suppliyng the to-be-authenticated data
 <li>mac algorithm: the OID of the MAC algorithm to be used
 <li>mac key length (optional): the length (in bytes) of  the mac key to be generated;
                                if not specified (-1), a default value will
                                be used depending on the mac algorithm and
                                the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                                of the mac algorithm in use; otherwise it uses the
                                length of the underlying digest algorithm.
 <li>mac parameters (optional): any parameters, if required by the mac algorithm
 <li>digest algorithm: the OID of the message digest algorithm to be used for
                       hash computation if authenticated attributes are included
 <li>transmission mode: either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include the content)
                        or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
 </ul>
 Optional <A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms"><CODE>originator</CODE></A> information (if required by the
 key management technique in use} maybe set via method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setOriginatorInfo(iaik.cms.OriginatorInfo)"><CODE>setOriginatorInfo</CODE></A>, and authenticated or unauthenticated attributes maybe
 supplied by calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A>
 or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setUnauthenticatedAttributes</CODE></A>, respectively, e.g.:
 <pre>
 // the content type
 ObjectID contentType = ObjectID.cms_data;
 // the content data supplying input stream:
 InputStream dataStream = ...;
 // the mac algorithm to be used
 AlgorithmID macAlgorithm = (AlgorithmID)AlgorithmID.hMAC_SHA1.clone();
 // the length of the mac key to be generated
 int macKeyLength = 64;
 // we do not need mac algorithm parameters
 AlgorithmParameterSpec macParams = null;
 // we want to include authenticated attributes and therefore need a digest algorithm
 AlgorithmID digestAlgorithm = (AlgorithmID)AlgorithmID.sha1.clone();
 // the transmission mode (either AuthenticatedDataStream.IMPLICIT or AuthenticatedDataStream.EXPLICIT)
 int mode = ...;
 // create the AuthenticatedDataStream object:
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(contentType,
                                                                         dataStream, 
                                                                         macAlgorithm,
                                                                         macKeyLength,
                                                                         macParams,
                                                                         digestAlgorithm,
                                                                         mode);
 </pre>
 For providing origin authentication we use Static-Staic Diffie-Hellman as key management
 technique and include an OriginatorInfo containing the originator certificates:
 <pre>
 X509Certificate[] originatorCerts = ...;
 OriginatorInfo originator = new OriginatorInfo();
 originator.setCertificates(originatorCerts);
 authenticatedData.setOriginatorInfo(originator);
 </pre>
 Just for demonstration we only add one authenticated attribute (<A HREF="../../iaik/cms/attributes/CMSContentType.html" title="class in iaik.cms.attributes"><CODE>ContentType</CODE></A>):
 <pre>
 Attribute[] attributes = { new Attribute(new CMSContentType(contentType)) };
 authenticatedData.setAuthenticatedAttributes(attributes);
 </pre>
 When authenticated attributes are present they at least must contain the ContentType and the 
 (<A HREF="../../iaik/cms/attributes/CMSMessageDigest.html" title="class in iaik.cms.attributes"><CODE>MessageDigest</CODE></A>) attribute. It is not
 necessary for the application to provide the MessageDigest attribute since it is
 automatically calculated and set during the encoding procedure.
 <br>
 Recipient specific information is required to encrypt the secret mac key and
 may be supplied by calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])"><CODE>setRecipientInfos</CODE></A>.
 In our example we add two RecipientInfos (one for the the sender who wants to be able
 to verify the MAC, too, and one for the final recipient). To provide origin authentication we
 select Static-Static Diffie-Hellman as key management technique together with
 HMACwith3DESwrap (supported by IAIK-JCE 3.12 and later) for encrypting (wrapping) the HMAC key:
 <pre>
 RecipientInfo[] recipients = new RecipientInfo[1];
 // we use Static-Static DH as key management technique
 AlgorithmID keyEA = (AlgorithmID)AlgorithmID.ssdhKeyAgreement.clone();
 // key wrap algorithm is HMACwith3DESwrap:
 AlgorithmID keyWrapAlg = (AlgorithmID)CMSAlgorithmID.cms_HMACwith3DES_wrap.clone();
 // the length of the (3DES) key encryption key to be generated:
 int kekLength = 192;
 // in static-static mode we supply user keying material so that a different kek is generated
 byte[] ukm = new byte[64];
 random.nextBytes(ukm);
 // user1 is originator
 recipients[0] = new KeyAgreeRecipientInfo(originatorCert, 
                                           originatorPrivateKey,
                                           KeyIdentifier.ISSUER_AND_SERIALNUMBER,
                                           keyEA, 
                                           keyWrapAlg, 
                                           kekLength, 
                                           ukm);
 // add originator as recipient, too:
 recipients[0].addRecipient(originatorCert, CertificateIdentifier.ISSUER_AND_SERIALNUMBER);
 // add final recipient
 recipients[0].addRecipient(recipientCert, CertificateIdentifier.RECIPIENT_KEY_IDENTIFIER);
 // set the recipients of the authenticated message
 authenticatedData.setRecipientInfos(recipients);
 </pre>
 If the content shall not be included in the AuthenticatedData object (<A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode) now it is time to read away the content to transmit it by other means.
 While reading the content from the stream it is piped through a <A HREF="../../iaik/cms/InputStreamHashEngine.html" title="interface in iaik.cms"><CODE>InputStreamHashEngine</CODE></A> (since authenticated attributes
 are present) to calculate and set the value of the <A HREF="../../iaik/cms/attributes/CMSMessageDigest.html" title="class in iaik.cms.attributes"><CODE>MessageDigest</CODE></A> attribute. Later, during the encoding procedure (when calling method
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream, int)"><CODE>writeTo</CODE></A>) the mac value is calculated from the DER encoded
 authenticated attributes (if no authenticated attributes are set, an <A HREF="../../iaik/cms/InputStreamMacEngine.html" title="interface in iaik.cms"><CODE>InputStreamMacEngine</CODE></A> is used to immediately calculate
 the mac value from the content data), e.g.:
 <pre>
 // in explicit mode get the content and write it to any out-of-band place
 if (mode == AuthenticatedDataStream.EXPLICIT) {
   InputStream contentIs = authenticatedData.getInputStream();
   byte[] buf = new byte[1024];
   int r;
   while ((r = data_is.read(buf)) > 0) {
     // do something useful
   }  
 }
 </pre>
 Finally method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream, int)"><CODE>writeTo</CODE></A> has to be called for BER encoding 
 the AuthenticatedDataStream object and writing it to an output stream. It is recommended
 to specify a positive block size value for splitting the data encoding:
 <pre>
 int blockSize = ...; 
 authenticatedData.writeTo(output_stream, blockSize);
 </pre>
 respectively
 <pre>
 authenticatedData.writeTo(output_stream);
 </pre>
 It is recommended only to use the <code>writeTo</code> method where a particular 
 block size can be specified, because it is the intended purpose of this stream-supporting
 AuthenticatedData implementation to handle large amounts of data. When no block size is
 specified the whole content data is encoded as one primitive definite octet string, which  
 advantageously may be done when using the non-stream supporting <A HREF="../../iaik/cms/AuthenticatedData.html" title="class in iaik.cms"><CODE>AuthenticatedData</CODE></A> implementation. 
 When a positve block size is specified for encoding the AuthenticatedData to a stream, 
 the content data is BER encoded as indefinite constructed octet string being composed 
 of a series of definite primitive encoded octet strings of <code>blockSize</code> length,
 e.g.:
 <pre>
 0x24 0x80
           0x04 0x02 0x01 0xAB
           0x04 0x02 0x23 0x7F
           0x04 0x01 0xCA
 0x00 0x00 
 </pre>
 instead of:
 <pre>
 0x04 0x05 0x01 0xAB 0x23 0x7F 0xCA
 </pre>
 for encoding the five data bytes <code>0x01 0xAB 0x23 0x7F 0xCA</code>. 
 <p>
 <hr>
 <p>
 When receiving an AuthenticatedData message use the <A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(java.io.InputStream)"><CODE>AuthenticatedDataStream(InputStream)</CODE></A> constructor for parsing the AuthenticatedData 
 from its BER encoding:
 <pre>
 // the input stream supplying the BER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(encodedStream);
 </pre>
 If the content has been transmitted by other means (<A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode) it
 now has to be supplied by calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A>
 since it is required for MAC computation (verification):
 <pre>
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   InputStream contentIs = ...; // the content supplied from an input stream
   authenticatedData.setInputStream(contentIs);
 }
 </pre>
 In order to decrypt the encrypted MAC key the recipient has to call a proper
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, iaik.x509.X509Certificate)"><CODE>setupMac</CODE></A> method thereby specifying
 her/his key encryption key which has to be suitable for the key management
 technique that has been used. Since in our example the recipients have
 used the Static-Static DH <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>key agreement</CODE></A> technique,
 the recipient private key is required derive the key encryption key which subsequently
 is used to decrypt the encrypted mac key. The right RecipientInfo maybe identified by the 
 recipient certificate, e.g.:
 <pre>
 // the recipient certificate:
 X509Certificate recipientCert = ...; 
 // the corresponding private key
 PrivateKey recipientPrivateKey = ...;
 // setup the MAC by decrypting the secret MAC key
 autenticatedData.setupMac(recipientPrivateKey, recipientCert);
 </pre>
 After decrypting the encrypted MAC key the data can be obtained and
 read to calculate and subsequently verify the MAC value:
 <pre>
 InputStream contentIs = authenticatedData.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 } 
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT">EXPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the content is not transmitted within the AuthenticatedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT">IMPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Denotes a mode where the content is included in the AuthenticatedData.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream()">AuthenticatedDataStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default constructor for dynamic object creation.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(java.io.InputStream)">AuthenticatedDataStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AuthenticatedDataStream from a BER encoded AutheticatedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)">AuthenticatedDataStream</A></B>(java.io.InputStream&nbsp;is,
                        <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AuthenticatedDataStream from a BER encoded AutheticatedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, byte[], iaik.asn1.structures.AlgorithmID, int)">AuthenticatedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                        byte[]&nbsp;mac,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                        int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AuthenticatedDataStream from an already calculated MAC value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)">AuthenticatedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                        int&nbsp;macKeyLength,
                        java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                        int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)">AuthenticatedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                        int&nbsp;macKeyLength,
                        java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                        int&nbsp;mode,
                        <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int)">AuthenticatedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                        int&nbsp;macKeyLength,
                        java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                        int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int, iaik.cms.SecurityProvider)">AuthenticatedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                        int&nbsp;macKeyLength,
                        java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                        int&nbsp;mode,
                        <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#addRecipientInfo(iaik.cms.RecipientInfo)">addRecipientInfo</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds one recipient to the list of recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#decode(java.io.InputStream)">decode</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reads and decodes a BER encoded AutheticatedData from a the given input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#encodeCalled(iaik.asn1.ASN1Object, int)">encodeCalled</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj,
             int&nbsp;id)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method implements the EncodeListener interface.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getAuthenticatedAttribute(iaik.asn1.ObjectID)">getAuthenticatedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first authenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getAuthenticatedAttributes()">getAuthenticatedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the authenticated attributes included in this AutheticatedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getAuthenticatedDigest()">getAuthenticatedDigest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the value of the MessageDigest attribute, if 
 included in the authenticated attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getBlockSize()">getBlockSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the block size defining the length of each definite primitive
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getContentType()">getContentType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the content type this class implements.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getDigestAlgorithm()">getDigestAlgorithm</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the digest algorithm, if set.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getEncapsulatedContentType()">getEncapsulatedContentType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the content type the inherent EncapsulatetContentInfo represents.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.InputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getInputStream()">getInputStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an InputStream from where the content data can be read.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getMac()">getMac</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the MAC value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getMacAlgorithm()">getMacAlgorithm</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the MAC algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getMode()">getMode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the mode of this AuthenticatedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getOriginatorInfo()">getOriginatorInfo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the OriginatorInfo, if included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfo(iaik.cms.KeyIdentifier)">getRecipientInfo</A></B>(<A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the RecipientInfo belonging to the recipient identified by the
 given recipient identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfo(iaik.x509.X509Certificate)">getRecipientInfo</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the recipient info matching to the supplied recipient certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfos()">getRecipientInfos</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the recipient infos included in this
 <code>AutheticatedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfos(int)">getRecipientInfos</A></B>(int&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the recipient infos included in this
 <code>AutheticatedData</code> object that have the specified type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getSecurityProvider()">getSecurityProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityProvider installed for this AuthenticatedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getUnauthenticatedAttribute(iaik.asn1.ObjectID)">getUnauthenticatedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first unauthenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getUnauthenticatedAttributes()">getUnauthenticatedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the unauthenticated attributes included in this AutheticatedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getVersion()">getVersion</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the syntax version number.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#notifyEOF()">notifyEOF</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method implements the EOFListener interface for performing the final decoding.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])">setAuthenticatedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of (authenticated) attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setBlockSize(int)">setBlockSize</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the block size for defining the length of each definite primitive
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setInputStream(java.io.InputStream)">setInputStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the content suppliyng input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setOriginatorInfo(iaik.cms.OriginatorInfo)">setOriginatorInfo</A></B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the optional OriginatorInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])">setRecipientInfos</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A></B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityProvider for this AuthenticatedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])">setUnauthenticatedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of (unauthenticated) attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, int)">setupMac</A></B>(java.security.Key&nbsp;recipientKey,
         int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the mac key and setup the
 mac calculation for the requesting recipient, specified by its
 <code>recipientInfoIndex</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, iaik.cms.KeyIdentifier)">setupMac</A></B>(java.security.Key&nbsp;recipientKey,
         <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the mac key and setup the
 mac calculation for the requesting recipient, specified by the given 
 recipient identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, iaik.x509.X509Certificate)">setupMac</A></B>(java.security.Key&nbsp;recipientKey,
         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the mac key and setup the
 mac calculation for the requesting recipient, specified by the given
 recipient certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(javax.crypto.SecretKey)">setupMac</A></B>(javax.crypto.SecretKey&nbsp;macKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the given symmetric key to setup the mac calculation to verify the
 message authentication code when parsing an AuthenticatedData object .</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#toASN1Object()">toASN1Object</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this AuthenticatedDataStream as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#toASN1Object(int)">toASN1Object</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this AutheticatedData as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some information about this
 <code>AutheticatedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#toString(boolean)">toString</A></B>(boolean&nbsp;detailed)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some - if requested - detailed information
 about this <code>AutheticatedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#verifyMac()">verifyMac</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the message authentication code.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream)">writeTo</A></B>(java.io.OutputStream&nbsp;os)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BER encodes this AutheticatedData and writes the encoding to the supplied output stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</A></B>(java.io.OutputStream&nbsp;os,
        int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes the BER encoding of this AutheticatedData to the supplied output stream
 where a constructed OCTET STRING may be used for encoding the content.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="IMPLICIT"><!-- --></A><H3>
IMPLICIT</H3>
<PRE>
public static final int <B>IMPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the content is included in the AuthenticatedData.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.AuthenticatedDataStream.IMPLICIT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="EXPLICIT"><!-- --></A><H3>
EXPLICIT</H3>
<PRE>
public static final int <B>EXPLICIT</B></PRE>
<DL>
<DD>Denotes a mode where the content is not transmitted within the AuthenticatedData.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.AuthenticatedDataStream.EXPLICIT">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AuthenticatedDataStream()"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
protected <B>AuthenticatedDataStream</B>()</PRE>
<DL>
<DD>Default constructor for dynamic object creation.
 The block size is set to 2048 to enforce indefinite constructed encoding.
<P>
</DL>
<HR>

<A NAME="AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int)"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
public <B>AuthenticatedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                               int&nbsp;macKeyLength,
                               java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                               int&nbsp;mode)
                        throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream. This constructor generates
 a symmetric MAC key and uses an <A HREF="../../iaik/cms/InputStreamMacEngine.html" title="interface in iaik.cms"><CODE>InputStreamMacEngine</CODE></A> to wrap a mac calculating input stream around
 the data supplying input stream.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>is</CODE> - an input stream suppliyng the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
public <B>AuthenticatedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                               int&nbsp;macKeyLength,
                               java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                               int&nbsp;mode,
                               <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                        throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream. This constructor generates
 a symmetric MAC key and uses an <A HREF="../../iaik/cms/InputStreamMacEngine.html" title="interface in iaik.cms"><CODE>InputStreamMacEngine</CODE></A> to wrap a mac calculating input stream around
 the data supplying input stream.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>is</CODE> - an input stream suppliyng the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for any required
                         cryptographic operation
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
public <B>AuthenticatedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                               int&nbsp;macKeyLength,
                               java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                               int&nbsp;mode)
                        throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream. This constructor generates
 a symmetric MAC key. If the <code>digestAlg</code> parameter
 is not null, an <A HREF="../../iaik/cms/InputStreamHashEngine.html" title="interface in iaik.cms"><CODE>InputStreamHashEngine</CODE></A> 
 is used to wrap a hash calculating input stream around the data supplying 
 input stream. In this case authenticated attributes have to be set
 by calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A>
 and the MAC value is calculated from the DER encoded authenticated attributes
 which have to contain the -- (if not set) automatically calculated -- MessageDigest
 attribute.
 However, if the <code>digestAlg</code> parameter is null, an <A HREF="../../iaik/cms/InputStreamMacEngine.html" title="interface in iaik.cms"><CODE>InputStreamMacEngine</CODE></A> to wrap a MAC calculating
 input stream around the data supplying input stream for calculating the MAC
 value immediately from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>is</CODE> - an input stream suppliyng the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm to be used for hash computation if
                  authenticated attributes are to be included<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
public <B>AuthenticatedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                               int&nbsp;macKeyLength,
                               java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                               int&nbsp;mode,
                               <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                        throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedDataStream where the to-be-authenticated
 content data is supplied by an input stream. This constructor generates
 a symmetric MAC key. If the <code>digestAlg</code> parameter
 is not null, an <A HREF="../../iaik/cms/InputStreamHashEngine.html" title="interface in iaik.cms"><CODE>InputStreamHashEngine</CODE></A> 
 is used to wrap a hash calculating input stream around the data supplying 
 input stream. In this case authenticated attributes have to be set
 by calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A>
 and the MAC value is calculated from the DER encoded authenticated attributes
 which have to contain the -- (if not set) automatically calculated -- MessageDigest
 attribute.
 However, if the <code>digestAlg</code> parameter is null, an <A HREF="../../iaik/cms/InputStreamMacEngine.html" title="interface in iaik.cms"><CODE>InputStreamMacEngine</CODE></A> to wrap a MAC calculating
 input stream around the data supplying input stream for calculating the MAC
 value immediately from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>is</CODE> - an input stream suppliyng the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm to be used for hash computation if
                  authenticated attributes are to be included<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for any required
                         cryptographic operation
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, byte[], iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
public <B>AuthenticatedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                               byte[]&nbsp;mac,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                               int&nbsp;mode)</PRE>
<DL>
<DD>Creates an AuthenticatedDataStream from an already calculated MAC value.
 No mac or digest calculation is initialized. If <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A> are supplied, they already have to contain
 the MessageDigest attribute. Any <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])"><CODE>RecipientInfo</CODE></A> added
 to this AuthenticatedDataStream already has to contain the encrypted mac key
 (i.e. no MAC key is generated and encrypted for each recipient).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>is</CODE> - an input stream suppliyng the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm used for mac calculation<DD><CODE>mac</CODE> - the already calculated mac value<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm used for hash calculation<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataStream(java.io.InputStream)"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
public <B>AuthenticatedDataStream</B>(java.io.InputStream&nbsp;is)
                        throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                               java.io.IOException</PRE>
<DL>
<DD>Creates an AuthenticatedDataStream from a BER encoded AutheticatedData
 object which is read from the given InputStream. The encoded AutheticatedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a BER encoded CMS AutheticatedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>
<HR>

<A NAME="AuthenticatedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedDataStream</H3>
<PRE>
public <B>AuthenticatedDataStream</B>(java.io.InputStream&nbsp;is,
                               <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                        throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                               java.io.IOException</PRE>
<DL>
<DD>Creates an AuthenticatedDataStream from a BER encoded AutheticatedData
 object which is read from the given InputStream. The encoded AutheticatedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a BER encoded CMS AutheticatedData object<DD><CODE>securityProvider</CODE> - the security provider to be used; if <code>null</code> the 
                         default system-wide SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setSecurityProvider(iaik.cms.SecurityProvider)"><!-- --></A><H3>
setSecurityProvider</H3>
<PRE>
public void <B>setSecurityProvider</B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Sets the SecurityProvider for this AuthenticatedDataStream.
 <p>
 This method allows to explicitly set a SecurityProvider for this AuthenticatedDataStream.
 If no explicit SecurityProvider is set, the default system wide installed 
 SecurityProvider will be used for the required cryptographic operations.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.InputStream)"><CODE>getInputStreamHashEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamHashEngine.html" title="interface in iaik.cms"><CODE>InputStreamHashEngine</CODE></A>
     for stream based digest calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamMacEngine(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, java.io.InputStream)"><CODE>getInputStreamMacEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamMacEngine.html" title="interface in iaik.cms"><CODE>InputStreamMacEngine</CODE></A>
     for stream based mac calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateMac(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])"><CODE>calculateMac</CODE></A></code>
     for mac calculation from DER encoded authenticated attributes; if present
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric mac key
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameterSpec(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameterSpec</CODE></A></code>
     to create an AlgorithmParameterSpec from algorithm parameters (if included in a MAC
     algorithmID)
 <li>several SecurityProvider methods for key en/decryption and parsing as used by the inherent
     recipient infos
 </ul>
 An application may supply the SecurityProvider immediately when creating an AutheticatedDataStream
 object. This may be necessary on the parsing side, and also when creating a new
 AutheticatedDataStream object for MAC key generation and hash/mac computation initialization.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityProvider</CODE> - the SecurityProvider to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityProvider()"><!-- --></A><H3>
getSecurityProvider</H3>
<PRE>
public <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>getSecurityProvider</B>()</PRE>
<DL>
<DD>Gets the SecurityProvider installed for this AuthenticatedDataStream.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.InputStream)"><CODE>getInputStreamHashEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamHashEngine.html" title="interface in iaik.cms"><CODE>InputStreamHashEngine</CODE></A>
     for stream based digest calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamMacEngine(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, java.io.InputStream)"><CODE>getInputStreamMacEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamMacEngine.html" title="interface in iaik.cms"><CODE>InputStreamMacEngine</CODE></A>
     for stream based mac calculation
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateMac(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])"><CODE>calculateMac</CODE></A></code>
     for mac calculation from DER encoded authenticated attributes; if present
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric mac key
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameterSpec(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameterSpec</CODE></A></code>
     to create an AlgorithmParameterSpec from algorithm parameters (if included in a MAC
     algorithmID)
 <li>several SecurityProvider methods for key en/decryption and parsing as used by the inherent
     recipient infos
 </ul>
 If no explicit SecurityProvider has been <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)"><CODE>set</CODE></A> for this object, 
 the default system wide installed SecurityProvider will be used for the required cryptographic
 operations. However, this method will return <code>null</code> if it does not have its own
 SecurityProvider.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityProvider explicitly installed for this object, or <code>null</code> if
         this object does not have its own SecurityProvider</DL>
</DD>
</DL>
<HR>

<A NAME="decode(java.io.InputStream)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(java.io.InputStream&nbsp;is)
            throws java.io.IOException,
                   <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></PRE>
<DL>
<DD>Reads and decodes a BER encoded AutheticatedData from a the given input stream.
 The encoded AutheticatedData may (or may not) be wrapped into a ContentInfo.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#decode(java.io.InputStream)">decode</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream holding a BER encoded AutheticatedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DD>
</DL>
<HR>

<A NAME="getContentType()"><!-- --></A><H3>
getContentType</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>getContentType</B>()</PRE>
<DL>
<DD>Returns the content type this class implements.
 <p>
 Use method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getEncapsulatedContentType()"><CODE>getEncapsulatedContentType</CODE></A>
 for getting the type of the inherent (authenticated) content.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getContentType()">getContentType</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>ObjectID.cms_autheticatedData</code></DL>
</DD>
</DL>
<HR>

<A NAME="getEncapsulatedContentType()"><!-- --></A><H3>
getEncapsulatedContentType</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>getEncapsulatedContentType</B>()</PRE>
<DL>
<DD>Returns the content type the inherent EncapsulatetContentInfo represents.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the content type the inherent EncapsulatetContentInfo represents</DL>
</DD>
</DL>
<HR>

<A NAME="setOriginatorInfo(iaik.cms.OriginatorInfo)"><!-- --></A><H3>
setOriginatorInfo</H3>
<PRE>
public void <B>setOriginatorInfo</B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</PRE>
<DL>
<DD>Sets the optional OriginatorInfo.
 <p>
 The originatorInfo may be set for including certificates and/or certificate
 revocation lists for the originator if required by the key management
 algorithm used.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>originatorInfo</CODE> - the OriginatorInfo to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setRecipientInfos(iaik.cms.RecipientInfo[])"><!-- --></A><H3>
setRecipientInfos</H3>
<PRE>
public void <B>setRecipientInfos</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</PRE>
<DL>
<DD>Sets the recipient infos.
 <p>
 Any <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for en/decrypting the symmetric mac key.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipients</CODE> - a collection of per-recipient information<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addRecipientInfo(iaik.cms.RecipientInfo)"><!-- --></A><H3>
addRecipientInfo</H3>
<PRE>
public void <B>addRecipientInfo</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</PRE>
<DL>
<DD>Adds one recipient to the list of recipient infos.
 <p>
 Any <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for en/decrypting the symmetric mac key.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipient</CODE> - the RecipientInfo to be added<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setAuthenticatedAttributes</H3>
<PRE>
public void <B>setAuthenticatedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of (authenticated) attributes.
 If authenticated attributes are present, the MAC value is calculated
 from the DER encoded authenticated attributes which have to contain
 the MessageDigest attribute. In this case the <code>digestAlgorithm</code>
 field is not allowed to be null since it identifies the algorithm to
 be used for calculating a digest value from the content and set it
 as MessageDigest attribute. If the MessageDigest attribute is not
 included in the set of attributes supplied to this methode, it
 is automatically calculated and set.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the authenticated attributes to be set
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if no digest algorithm has been specified
            when creating this AuthenticatedDataStream object</DL>
</DD>
</DL>
<HR>

<A NAME="setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setUnauthenticatedAttributes</H3>
<PRE>
public void <B>setUnauthenticatedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of (unauthenticated) attributes.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the unauthenticated attributes to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setBlockSize(int)"><!-- --></A><H3>
setBlockSize</H3>
<PRE>
public void <B>setBlockSize</B>(int&nbsp;blockSize)</PRE>
<DL>
<DD>Sets the block size for defining the length of each definite primitive
 encoded octet string component.
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole content data is encoded as definite primitive octet string, otherwise
 indefinite constructed encoding is used.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#setBlockSize(int)">setBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - for defining the encoding scheme and setting the octet
        string component length, if positive</DL>
</DD>
</DL>
<HR>

<A NAME="getBlockSize()"><!-- --></A><H3>
getBlockSize</H3>
<PRE>
public int <B>getBlockSize</B>()</PRE>
<DL>
<DD>Gets the block size defining the length of each definite primitive
 encoded octet string component.
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole data is encoded as definite primitive octet string, otherwise
 indefinite constructed encoding is used.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getBlockSize()">getBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the block size defining the encoding scheme and setting the octet
        string component length, if positive</DL>
</DD>
</DL>
<HR>

<A NAME="setupMac(java.security.Key, int)"><!-- --></A><H3>
setupMac</H3>
<PRE>
public javax.crypto.SecretKey <B>setupMac</B>(java.security.Key&nbsp;recipientKey,
                                       int&nbsp;recipientInfoIndex)
                                throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                       java.security.NoSuchAlgorithmException,
                                       java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the mac key and setup the
 mac calculation for the requesting recipient, specified by its
 <code>recipientInfoIndex</code>.
 <p>
 This method first uses the given key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding <code>RecipientInfo</code>
 structure, and subsequently uses this mac key to initialize the mac calculation.
 <p>
 The mac calculation actually is done during reading the data obtained by calling 
 method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A>. So do not call method
 <code>getInputStream</code> before setting up the mac engine or behind
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#verifyMac()"><CODE>verifying</CODE></A> the mac, e.g.:
 <pre>
 // the input stream supplying the BER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   InputStream contentIs = ...; // the content supplied from an input stream
   authenticatedData.setInputStream(contentIs);
 }
 // the index into the recipientInfos field
 int recipientIndex = ...; 
 // the corresponding recipient key
 Key recipientKey = ...;
 // decrypt the encrypted MAC key with the private key of the recipient:
 autenticatedData.setupMac(recipientKey, recipientIndex);
 InputStream contentIs = authenticatedData.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 } 
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
 <p>
 <b>Note</b> that you have to know the right index into the <code>recipientInfos</code>
 field when using this method for setting up the mac calculation. You may
 search for the index by using one of the <code>getRecipientInfo</code> methods
 thereby identifying the recipient by its <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfo(iaik.cms.KeyIdentifier)"><CODE>keyIdentifier</CODE></A> or -- if suitable for the key management algorithm used -- <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfo(iaik.x509.X509Certificate)"><CODE>certificate</CODE></A>.
 <br>
 However, when having some recipient using a key agreement protocol the corresponding
 RecipientInfo is of type <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>
 which may hold encrypted mac keys for more than only one recipients 
 using the same key agreement algorithm with same domain parameters. Since this 
 <code>setupMac</code> method only can get the KeyAgreeRecipientInfo with the given
 index (but not search for the right recipient in the KeyAgreeRecipientInfo), it
 will step through any recipient included in the KeyAgreeRecipientInfo trying to
 decrypt the encrypted mac key with the supplied key. This may give
 some overhead; so it might be appropriate to use another <code>setupMac</code> method
 allowing to immediately identify the particular recipient in mind by its
 #setupMac(Key, KeyIdentifier) keyIdentifier} or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, iaik.x509.X509Certificate)"><CODE>certificate</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the key of the recipient to be used for decrypting
                     the encrypted mac key.<DD><CODE>recipientInfoIndex</CODE> - the index into the recipientInfos field
<DT><B>Returns:</B><DD>the (decrypted) secret mac key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the mac key
            or setting up the mac calculation, or no RecipientInfo
            for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the mac algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupMac(java.security.Key, iaik.cms.KeyIdentifier)"><!-- --></A><H3>
setupMac</H3>
<PRE>
public javax.crypto.SecretKey <B>setupMac</B>(java.security.Key&nbsp;recipientKey,
                                       <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)
                                throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                       java.security.NoSuchAlgorithmException,
                                       java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the mac key and setup the
 mac calculation for the requesting recipient, specified by the given 
 recipient identifier.
 <p>
 This method first uses the given key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding <code>RecipientInfo</code>
 structure, and subsequently uses this mac key to initialize the mac calculation.
 <p>
 The mac calculation actually is done during reading the data obtained by calling 
 method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A>. So do not call method
 <code>getInputStream</code> before setting up the mac engine or behind
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#verifyMac()"><CODE>verifying</CODE></A> the mac, e.g.:
 <pre>
 // the input stream supplying the BER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   InputStream contentIs = ...; // the content supplied from an input stream
   authenticatedData.setInputStream(contentIs);
 }
 // the KeyIdentifier identifying the recipient key
 KeyIdentifier recipientIdentifier = ...; 
 // the corresponding recipient key
 Key recipientKey = ...;
 // decrypt the encrypted MAC key with the private key of the recipient:
 autenticatedData.setupMac(recipientKey, recipientIdentifier);
 InputStream contentIs = authenticatedData.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 } 
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
 <p>
 This <code>setupMac</code> method can be used to setup the mac engine 
 any type of RecipientInfo. The supplied recipient identifier will be used for
 searching for the right RecipientInfo in the <code>recipientInfos</code> field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the key of the recipient to be used for decrypting
                     the encrypted mac key.<DD><CODE>recipientIdentifier</CODE> - specifies which RecipientInfo the given key belongs to
<DT><B>Returns:</B><DD>the (decrypted) secret mac key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the mac key
            or setting up the mac calculation, or no RecipientInfo
            for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the mac algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupMac(java.security.Key, iaik.x509.X509Certificate)"><!-- --></A><H3>
setupMac</H3>
<PRE>
public javax.crypto.SecretKey <B>setupMac</B>(java.security.Key&nbsp;recipientKey,
                                       <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)
                                throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                       java.security.NoSuchAlgorithmException,
                                       java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the mac key and setup the
 mac calculation for the requesting recipient, specified by the given
 recipient certificate.
 <p>
 This method first uses the given key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding <code>RecipientInfo</code>
 structure, and subsequently uses this mac key to initialize the mac calculation.
 <p>
 The mac calculation actually is done during reading the data obtained by calling 
 method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A>. So do not call method
 <code>getInputStream</code> before setting up the mac engine or behind
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#verifyMac()"><CODE>verifying</CODE></A> the mac, e.g.:
 <pre>
 // the input stream supplying the BER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   InputStream contentIs = ...; // the content supplied from an input stream
   authenticatedData.setInputStream(contentIs);
 }
 // the recipient certificate:
 X509Certificate recipientCert = ...; 
 // the corresponding private key
 PrivateKey recipientPrivateKey = ...;
 // setup the MAC by decrypting the secret MAC key
 autenticatedData.setupMac(recipientPrivateKey, recipientCert);
 InputStream contentIs = authenticatedData.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 } 
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
 <p>
 <b>Note</b> that this method only can be used for decrypting the encrypted mac key
 if the recipient in mind has a RecipientInfo of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A> using a public
 key from a certificate for its key management protocol.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the private key of the recipient to be used for decrypting
                     the encrypted mac key.<DD><CODE>recipientCertificate</CODE> - the certificate of the recipient specifying which 
        RecipientInfo the recipient private key belongs to
<DT><B>Returns:</B><DD>the (decrypted) secret mac key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the mac key
            or setting up the mac calculation, or no RecipientInfo
            for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the mac algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupMac(javax.crypto.SecretKey)"><!-- --></A><H3>
setupMac</H3>
<PRE>
public void <B>setupMac</B>(javax.crypto.SecretKey&nbsp;macKey)
              throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                     java.security.NoSuchAlgorithmException,
                     java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the given symmetric key to setup the mac calculation to verify the
 message authentication code when parsing an AuthenticatedData object .
 <p>
 The secret key supplied to this method has to be the already decrypted
 mac key.
 <p>
 The mac calculation actually is done during reading the data obtained by calling 
 method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A>. So do not call method
 <code>getInputStream</code> before setting up the mac engine or behind
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#verifyMac()"><CODE>verifying</CODE></A> the mac, e.g.:
 <pre>
 // the input stream supplying the BER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   InputStream contentIs = ...; // the content supplied from an input stream
   authenticatedData.setInputStream(contentIs);
 }
 // the may key
 Key macKey = ...;
 // setup the MAC engine
 autenticatedData.setupMac(macKey);
 InputStream contentIs = authenticatedData.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 } 
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>macKey</CODE> - the temporary symmetric key that has been used to calculate the message
               authentication code
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error when setting up the mac calculation,
            or no RecipientInfo for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the mac algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedDigest()"><!-- --></A><H3>
getAuthenticatedDigest</H3>
<PRE>
public byte[] <B>getAuthenticatedDigest</B>()
                              throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Gets the value of the MessageDigest attribute, if 
 included in the authenticated attributes.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the message digest included in the authenticated attributes
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if no message digest attribute is included</DL>
</DD>
</DL>
<HR>

<A NAME="getMode()"><!-- --></A><H3>
getMode</H3>
<PRE>
public int <B>getMode</B>()</PRE>
<DL>
<DD>Returns the mode of this AuthenticatedData.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>IMPLICIT</code> or <code>EXPLICIT</code></DL>
</DD>
</DL>
<HR>

<A NAME="verifyMac()"><!-- --></A><H3>
verifyMac</H3>
<PRE>
public boolean <B>verifyMac</B>()
                  throws <A HREF="../../iaik/cms/CMSMacException.html" title="class in iaik.cms">CMSMacException</A></PRE>
<DL>
<DD>Verifies the message authentication code. 
 <p>
 For verifying the MAC value first the mac calcualtion has to be set up
 by calling a proper <code>setupMac</code> method and the content data
 has to be <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getInputStream()"><CODE>get</CODE></A> and entirely read:
 <pre>
 // the input stream supplying the BER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   InputStream contentIs = ...; // the content supplied from an input stream
   authenticatedData.setInputStream(contentIs);
 }
 // the recipient certificate:
 X509Certificate recipientCert = ...; 
 // the corresponding private key
 PrivateKey recipientPrivateKey = ...;
 // setup the MAC by decrypting the secret MAC key
 autenticatedData.setupMac(recipientPrivateKey, recipientCert);
 InputStream contentIs = authenticatedData.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 } 
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>true</code> if the MAC verifies, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSMacException.html" title="class in iaik.cms">CMSMacException</A></CODE> - if the MAC verification process fails for some reason
            (e.g. the authenticated attributes (if incldued) cannot be parsed or 
                  the content hash does not match to value of the included MessageDigest 
                  attribute)</DL>
</DD>
</DL>
<HR>

<A NAME="getInputStream()"><!-- --></A><H3>
getInputStream</H3>
<PRE>
public java.io.InputStream <B>getInputStream</B>()</PRE>
<DL>
<DD>Returns an InputStream from where the content data can be read.
 <p>
 Attention! The stream only may be read once.
 <p>
 When having created a new <code>AuthenticatedDataStream</code> object to
 be encoded to a stream, this method should only be called in <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICT</CODE></A> mode to get and read away the content to be transmitted by other means.
 <br>
 When having decoded and parsed a received <code>AuthenticatedDataStream</code> object
 coming from some stream, this method may be used for obtaining the raw (decrypted) data
 after having setup the mac engine for mac calculation/verifation, e.g.:
 <pre>
 // the input stream supplying the BER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedDataStream authenticatedData = new AuthenticatedDataStream(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   InputStream contentIs = ...; // the content supplied from an input stream
   authenticatedData.setInputStream(contentIs);
 }
 // setup the mac calculation
 autenticatedData.setupMac(...);
 // get and read the content data
 InputStream contentIs = authenticatedData.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 } 
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an InputStream for reading the content data</DL>
</DD>
</DL>
<HR>

<A NAME="setInputStream(java.io.InputStream)"><!-- --></A><H3>
setInputStream</H3>
<PRE>
public void <B>setInputStream</B>(java.io.InputStream&nbsp;is)</PRE>
<DL>
<DD>Sets the content suppliyng input stream.
 When having created a new <code>AuthenticatedDataStream</code> object to
 be encoded to a stream, this method may be used to supply the content
 to be authenticated.
 <br>
 When having decoded and parsed a received <code>AuthenticatedDataStream</code> object
 coming from some stream, this method may be used for supplying the
 content transmitted by other means (EXPLICIT mode).
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream holding the content data to be authenticated</DL>
</DD>
</DL>
<HR>

<A NAME="getVersion()"><!-- --></A><H3>
getVersion</H3>
<PRE>
public int <B>getVersion</B>()</PRE>
<DL>
<DD>Returns the syntax version number.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the syntax version number</DL>
</DD>
</DL>
<HR>

<A NAME="getOriginatorInfo()"><!-- --></A><H3>
getOriginatorInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A> <B>getOriginatorInfo</B>()</PRE>
<DL>
<DD>Gets the OriginatorInfo, if included.
 <p>
 The originatorInfo may be set for including certificates and/or
 certificate revocation lists if required by the key management
 algorithm used.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the originatorInfo, if included; otherwise <code>null</code></DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfos()"><!-- --></A><H3>
getRecipientInfos</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[] <B>getRecipientInfos</B>()</PRE>
<DL>
<DD>Returns all the recipient infos included in this
 <code>AutheticatedData</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all the <code>RecipientInfo</code> objects
         included into this <code>AutheticatedData</code></DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfos(int)"><!-- --></A><H3>
getRecipientInfos</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[] <B>getRecipientInfos</B>(int&nbsp;type)</PRE>
<DL>
<DD>Returns all the recipient infos included in this
 <code>AutheticatedData</code> object that have the specified type.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all the <code>RecipientInfo</code> objects
         included into this <code>AutheticatedData</code> that have the 
         specified type (e.g. all KeyTransRecipientInfos); the array may
         be empty if no RecipientInfo with the requested type is included</DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfo(iaik.x509.X509Certificate)"><!-- --></A><H3>
getRecipientInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A> <B>getRecipientInfo</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</PRE>
<DL>
<DD>Returns the recipient info matching to the supplied recipient certificate.
 <p>
 This method may be used by a recipient for quering for the recipient info
 that holds the mac key encrypted with the public key of the
 given certificate. 
 <br>
 <b>Note</b> that this method only can be used for searching for RecipientInfos
 of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or
 <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, but <b>NOT</b>
 for a RecipientInfo of type <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>
 or <A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>
 which does use a certificate.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the RecipientInfo matching to the supplied recipient certificate,
         or <code>null</code> if no recipient info belonging to the given
         certificate can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfo(iaik.cms.KeyIdentifier)"><!-- --></A><H3>
getRecipientInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A> <B>getRecipientInfo</B>(<A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</PRE>
<DL>
<DD>Returns the RecipientInfo belonging to the recipient identified by the
 given recipient identifier.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientIdentifier</CODE> - the recipient identifier identifying the
                            recipient in mind
<DT><B>Returns:</B><DD>the RecipientInfo matching to the supplied recipient identifier,
         or <code>null</code> if no recipient info belonging to the given
         recipient identifier can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getMacAlgorithm()"><!-- --></A><H3>
getMacAlgorithm</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A> <B>getMacAlgorithm</B>()</PRE>
<DL>
<DD>Gets the MAC algorithm.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the MAC algorithm</DL>
</DD>
</DL>
<HR>

<A NAME="getDigestAlgorithm()"><!-- --></A><H3>
getDigestAlgorithm</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A> <B>getDigestAlgorithm</B>()</PRE>
<DL>
<DD>Gets the digest algorithm, if set.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the digest algorithm, or <code>null</code> if no digest algorithm is set</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedAttributes()"><!-- --></A><H3>
getAuthenticatedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getAuthenticatedAttributes</B>()</PRE>
<DL>
<DD>Gets the authenticated attributes included in this AutheticatedData.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the authenticated attributes; if included</DL>
</DD>
</DL>
<HR>

<A NAME="getUnauthenticatedAttributes()"><!-- --></A><H3>
getUnauthenticatedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getUnauthenticatedAttributes</B>()</PRE>
<DL>
<DD>Gets the unauthenticated attributes included in this AutheticatedData.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the unauthenticated attributes; if included</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getAuthenticatedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getAuthenticatedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first authenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the first authenticated attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="getMac()"><!-- --></A><H3>
getMac</H3>
<PRE>
public byte[] <B>getMac</B>()</PRE>
<DL>
<DD>Gets the MAC value.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the MAC value.</DL>
</DD>
</DL>
<HR>

<A NAME="getUnauthenticatedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getUnauthenticatedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getUnauthenticatedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first unauthenticated attribute matching to the given ObjectID, if 
 included in this AutheticatedData object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the first unauthenticated attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object()"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>()
                        throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this AuthenticatedDataStream as ASN1Object.
 The ASN.1 SEQUENCE returned by this  method only will contain the first
 components (version, (originatorInfo), recipientInfos, macAlgorithm,
 (digestAlgorithm) and EncapsulatedContentInfo without content) of the ASN.1
 AuthenticatedData. The remaining components (autenticated attributes, mac value
 autenticated attributes) are added later during the encoding procedure
 (when <A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> is called).
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toASN1Object()">toASN1Object</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>this <code>AuthenticatedDataStream</code> as ASN1Object.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object(int)"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>(int&nbsp;blockSize)
                           throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this AutheticatedData as ASN1Object.
 <p>
 If <blockSize> is positive a constructed
 OCTET STRING is used for encoding the content data. This method actually
 will perform the encryption of the symmetric mac key for each participated 
 recipient.
 <p>
 The ASN.1 SEQUENCE returned by this  method only will contain the first
 components (version, (originatorInfo), recipientInfos, macAlgorithm,
 (digestAlgorithm) and EncapsulatedContentInfo without content) of the ASN.1
 AuthenticatedData. The remaining components (autenticated attributes, mac value
 autenticated attributes) are added later during the encoding procedure
 (when <A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> is called).
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component; if positive
<DT><B>Returns:</B><DD>this AutheticatedData as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="encodeCalled(iaik.asn1.ASN1Object, int)"><!-- --></A><H3>
encodeCalled</H3>
<PRE>
public void <B>encodeCalled</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj,
                         int&nbsp;id)
                  throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>This method implements the EncodeListener interface.
 During the encoding process the DerCoder calls this method when
 it actually is time for encoding the attribute and mac value
 components. The message digest or mac value over the content data
 cannot be computed before the content stream entirely has been read.
 Since the content stream actually is read during the encoding procedure,
 the <code>AuthenticatedDataStream</code> registers itself as encode listener
 for the SEQUENCE representing the final ASN.1 AuthenticatedData object. After
 the content stram has been read and before attributes and mac value
 are to be encoded, this class is notified by means of the 
 IAIK-JCE <code>EncodeListener</code> utility. 
 <p>
 <b>This method shall not be called by an application!</b>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html#encodeCalled(iaik.asn1.ASN1Object, int)" title="class or interface in iaik.asn1">encodeCalled</A></CODE> in interface <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the SignedData SEQUENCE<DD><CODE>id</CODE> - the id identifying the SEQUENCE to be processed
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if an error occurs when computing/signing 
                            the message digest</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os)
             throws java.io.IOException</PRE>
<DL>
<DD>BER encodes this AutheticatedData and writes the encoding to the supplied output stream.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this AutheticatedData shall be written
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream, int)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os,
                    int&nbsp;blockSize)
             throws java.io.IOException</PRE>
<DL>
<DD>Writes the BER encoding of this AutheticatedData to the supplied output stream
 where a constructed OCTET STRING may be used for encoding the content.
 <p>
 If the a positive <code>blockSize</code> value is specified, the content
 is encoded as indefinite constructed octet string being composed of a certain number
 of definite primitive encoded octet strings of <code>blockSize</code> length:
 <pre>
 0x24 0x80
           0x04 &lt;blocksize&gt; &lt;first encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;second encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;third encrypted content block&gt;
                ...
 0x00 0x00
 </pre>
 Otherwise the whole content is encoded as definite primitive octet string:
 <pre>
  0x04 &lt;length&gt; &lt;encrypted content&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this AuthenticatedData shall be written<DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs during writing the object</DL>
</DD>
</DL>
<HR>

<A NAME="notifyEOF()"><!-- --></A><H3>
notifyEOF</H3>
<PRE>
public void <B>notifyEOF</B>()
               throws java.io.IOException</PRE>
<DL>
<DD>This method implements the EOFListener interface for performing the final decoding.
 Since attributes and mac value, if present, are located at the end of an AutheticatedData
 structure, they only can be accessed after reading the content data located before 
 the attributes/MAC value.
 For that reason, when starting the parsing of an AutheticatedData message only
 version, (originatorInfo), recipientInfos, macAlgorithm, (digestAlgorithm) and 
 EncapsulatedContentInfo fields can be parsed before reading the content data.
 Since the data is supplied from an input stream, a <code>iaik.utils.NotifyEOFInputStream
 </code>is wrapped around this content data stream
 for indicating that the parsing procedure is to be notified when the stream actually
 has been read. At that point, the programm exceuting automatically jumps to the
 <code>notifyEOF</code> method for finishing the decoding by parsing the
 remaining authenticated and unauthenticated attributes, if present, and the mac value.
 <br>
 <b>An application shall <i>not</i> call this method at all.</b> This method only is 
 qualified as public method since it implements the IAIK-JCE iaik.utils.EOFListener interface.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html#notifyEOF()" title="class or interface in iaik.utils">notifyEOF</A></CODE> in interface <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while parsing the stream</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string giving some information about this
 <code>AutheticatedData</code> object.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="toString(boolean)"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>(boolean&nbsp;detailed)</PRE>
<DL>
<DD>Returns a string giving some - if requested - detailed information
 about this <code>AutheticatedData</code> object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toString(boolean)">toString</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>detailed</CODE> - - whether or not to give detailed information
<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/AuthEnvelopedData.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthenticatedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthenticatedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
