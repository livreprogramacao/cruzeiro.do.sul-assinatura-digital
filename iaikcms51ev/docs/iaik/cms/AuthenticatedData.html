<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:10 GMT 2016 -->
<TITLE>
AuthenticatedData (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.AuthenticatedData class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="AuthenticatedData (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthCipherEngine.html" title="interface in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthenticatedData.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthenticatedData.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#fields_inherited_from_class_iaik.cms.AuthenticatedDataStream">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class AuthenticatedData</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">iaik.cms.AuthenticatedDataStream</A>
      <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.AuthenticatedData</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A>, <A HREF="../../iaik/cms/Content.html" title="interface in iaik.cms">Content</A>, <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A>, java.util.EventListener</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>AuthenticatedData</B><DT>extends <A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A><DT>implements <A HREF="../../iaik/cms/Content.html" title="interface in iaik.cms">Content</A></DL>
</PRE>

<P>
This class represents the stream-supporting implementation of the CMS content
 type <code>AutheticatedData</code>.
 <p>
 Each CMS content type is associated with a specific object identifier.
 The object identifier for the <code>AutheticatedData</code> content type is
 defined as:
 <p><code>
 id-ct-authData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
       us(840) rsadsi(113549) pkcs(1) pkcs-9(9) smime(16)
       ct(1) 2 }
 </code><p>
 which corresponds to the OID string "1.2.840.113549.1.9.16.1.2".
 <p>
 The Cryptographic Message Syntax (CMS) (<a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>)
 specifies the <code>AutheticatedData</code> content type for providing a syntax for 
 recipient-specific protecting the integrity of a message by means of a Message Authentication Code (MAC).
 Content of any type may be authenticated for any number of recipients in parallel. For
 each recipient a commonly at random generated symmetric mac key is
 encrypted with the particular recipient key and - together with
 recipient-specific information - collected into a <code>RecipientInfo</code>
 value. A message authentication code on the content is computed
 with the mac key and -- together with the RecipientInfos objects --
 packed into a AuthenticedData message. 
 <p>
 The <code>AutheticatedData</code> type is defined as ASN.1 SEQUENCE type
 containing the following components (see 
 <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>):
 <p><PRE>
 AuthenticatedData ::= SEQUENCE {
   version CMSVersion,
   originatorInfo [0] IMPLICIT OriginatorInfo OPTIONAL,
   recipientInfos RecipientInfos,
   macAlgorithm MessageAuthenticationCodeAlgorithm,
   digestAlgorithm [1] DigestAlgorithmIdentifier OPTIONAL,
   encapContentInfo EncapsulatedContentInfo,
   authAttrs [2] IMPLICIT AuthAttributes OPTIONAL,
   mac MessageAuthenticationCode,
   unauthAttrs [3] IMPLICIT UnauthAttributes OPTIONAL }

   AuthAttributes ::= SET SIZE (1..MAX) OF Attribute

   UnauthAttributes ::= SET SIZE (1..MAX) OF Attribute

   MessageAuthenticationCode ::= OCTET STRING
 </PRE><p>
 If the <code>digestAlgorithm</code> field is not null, authenticated attributes
 have to be present and the MAC value is calculated on the DER encoding
 of the authenticated attributes. In this case the <code>MessageDigest</code>
 attribute has to be included as authenticated attribute and has to contain
 a digest value computed on the content data. If no authenticated attributes
 are present, the MAC value is computed on the content itself.
 <p>
 A recipient, when receiving the <code>AutheticatedData</code> message,
 decrypts the corresponding encrypted mac key with his/her key and
 subsequently uses it to verify the message authentication code. 
 <p>
 See <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a> for more 
 information.
 <p>
 <hr>
 <p>
 When <A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)"><CODE>creating</CODE></A> an AuthenticatedData
 object an application has to decide whether the to-be-authenticated content
 shall be incldued (<A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> mode) into the AuthenticatedData
 message or shall be transmitted by other means (<A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode):
 <pre>
 int mode = AuthenticatedData.IMPLICIT; // include content
 </pre>
 or
 <pre>
 int mode = AuthenticatedData.EXPLICIT; // do not include content
 </pre>
 However, in both cases the content data has to be supplied when creating the 
 <code>AuthenticatedData</code> object, because it is needed for the 
 MAC computation:
 <pre>
 byte[] content = ...; // the content data to be authenticated
 </pre>
 Together with transmission mode and content data the following values have to
 be specified when creating an AuthenticatedData object, some of them
 are only optional:
 <ul>
 <li>content type: the type of the authenticated content (e.g. ObjectID.cms_data)
 <li>content: a byte array suppliyng the to-be-authenticated data
 <li>mac algorithm: the OID of the MAC algorithm to be used
 <li>mac key length (optional): the length (in bytes) of  the mac key to be generated;
                                if not specified (-1), a default value will
                                be used depending on the mac algorithm and
                                the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                                of the mac algorithm in use; otherwise it uses the
                                length of the underlying digest algorithm.
 <li>mac parameters (optional): any parameters, if required by the mac algorithm
 <li>digest algorithm: the OID of the message digest algorithm to be used for
                       hash computation if authenticated attributes are included
 <li>transmission mode: either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include the content)
                        or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
 </ul>
 Optional <A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms"><CODE>originator</CODE></A> information (if required by the
 key management technique in use} maybe set via method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setOriginatorInfo(iaik.cms.OriginatorInfo)"><CODE>setOriginatorInfo</CODE></A>, and authenticated or unauthenticated attributes maybe
 supplied by calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A>
 or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setUnauthenticatedAttributes</CODE></A>, respectively, e.g.:
 <pre>
 // the content type
 ObjectID contentType = ObjectID.cms_data;
 // the content data to be authenticated
 byte[] content = ...;
 // the mac algorithm to be used
 AlgorithmID macAlgorithm = (AlgorithmID)AlgorithmID.hMAC_SHA1.clone();
 // the length of the mac key to be generated
 int macKeyLength = 64;
 // we do not need mac algorithm parameters
 AlgorithmParameterSpec macParams = null;
 // we want to include authenticated attributes and therefore need a digest algorithm
 AlgorithmID digestAlgorithm = (AlgorithmID)AlgorithmID.sha1.clone();
 // the transmission mode (either AuthenticatedData.IMPLICIT or AuthenticatedData.EXPLICIT)
 int mode = ...;
 // create the AuthenticatedData object:
 AuthenticatedData authenticatedData = new AuthenticatedData(contentType,
                                                             content, 
                                                             macAlgorithm,
                                                             macKeyLength,
                                                             macParams,
                                                             digestAlgorithm,
                                                             mode);
 </pre>
 For providing origin authentication we use Static-Staic Diffie-Hellman as key management
 technique and include an OriginatorInfo containing the originator certificates:
 <pre>
 X509Certificate[] originatorCerts = ...;
 OriginatorInfo originator = new OriginatorInfo();
 originator.setCertificates(originatorCerts);
 authenticatedData.setOriginatorInfo(originator);
 </pre>
 Just for demonstration we only add one authenticated attribute (<A HREF="../../iaik/cms/attributes/CMSContentType.html" title="class in iaik.cms.attributes"><CODE>ContentType</CODE></A>):
 <pre>
 Attribute[] attributes = { new Attribute(new CMSContentType(contentType)) };
 authenticatedData.setAuthenticatedAttributes(attributes);
 </pre>
 When authenticated attributes are present they at least must contain the ContentType and the 
 (<A HREF="../../iaik/cms/attributes/CMSMessageDigest.html" title="class in iaik.cms.attributes"><CODE>MessageDigest</CODE></A>) attribute. It is not
 necessary for the application to provide the MessageDigest attribute since it is
 automatically calculated and set during the encoding procedure.
 <br>
 Recipient specific information is required to encrypt the secret mac key and
 may be supplied by calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])"><CODE>setRecipientInfos</CODE></A>.
 In our example we add two RecipientInfos (one for the the sender who wants to be able
 to verify the MAC, too, and one for the final recipient). To provide origin authentication we
 select Static-Static Diffie-Hellman as key management technique together with
 HMACwith3DESwrap (supported by IAIK-JCE 3.12 and later) for encrypting (wrapping) the HMAC key:
 <pre>
 RecipientInfo[] recipients = new RecipientInfo[1];
 // we use Static-Static DH as key management technique
 AlgorithmID keyEA = (AlgorithmID)AlgorithmID.ssdhKeyAgreement.clone();
 // key wrap algorithm is HMACwith3DESwrap:
 AlgorithmID keyWrapAlg = (AlgorithmID)CMSAlgorithmID.cms_HMACwith3DES_wrap.clone();
 // the length of the (3DES) key encryption key to be generated:
 int kekLength = 192;
 // in static-static mode we supply user keying material so that a different kek is generated
 byte[] ukm = new byte[64];
 random.nextBytes(ukm);
 // user1 is originator
 recipients[0] = new KeyAgreeRecipientInfo(originatorCert, 
                                           originatorPrivateKey,
                                           KeyIdentifier.ISSUER_AND_SERIALNUMBER,
                                           keyEA, 
                                           keyWrapAlg, 
                                           kekLength, 
                                           ukm);
 // add originator as recipient, too:
 recipients[0].addRecipient(originatorCert, CertificateIdentifier.ISSUER_AND_SERIALNUMBER);
 // add final recipient
 recipients[0].addRecipient(recipientCert, CertificateIdentifier.RECIPIENT_KEY_IDENTIFIER);
 // set the recipients of the authenticated message
 authenticatedData.setRecipientInfos(recipients);
 </pre>
 Finally the AuthenticatedData object has to be prepared for transmission by transforming 
 it into an ASN1Object or immediately DER encoding it. The former is done by calling method 
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#toASN1Object()"><CODE>toASN1Object</CODE></A>, the latter by using method <A HREF="../../iaik/cms/AuthenticatedData.html#getEncoded()"><CODE>getEncoded</CODE></A> method:
 <pre>
 ASN1Object asn1AuthData = authenticatedData.toASN1Object();
 </pre>
 or
 <pre>
 byte[] encoding = authenticatedData.getEncoded();
 </pre>
 You alternatively may use a proper <code>writeTo</code> method of the parent  
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms"><CODE>AuthenticatedDataStream</CODE></A> class for immediately
 encoding this AuthenticatedData object to an output stream. When using <code>writeTo</code> in
 implicit mode, you additionally have the possibility of specifying a particular blockSize 
 for forcing an indefinite constructed encoding of the inherent content data bytes, instead of
 of the default definite primitive encoding, e.g:
 <pre>
 0x24 0x80
           0x04 0x02 0x01 0xAB
           0x04 0x02 0x23 0x7F
           0x04 0x01 0xCA
 0x00 0x00 
 </pre>
 instead of:
 <pre>
 0x04 0x05 0x01 0xAB 0x23 0x7F 0xCA
 </pre>
 for encoding the five data bytes <code>0x01 0xAB 0x23 0x7F 0xCA</code>. 
 <p>
 <hr>
 <p>
 When receiving an AuthenticatedData message use the <A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(java.io.InputStream)"><CODE>AuthenticatedData(InputStream)</CODE></A> constructor for parsing the AuthenticatedData 
 from its DER encoding:
 <pre>
 // the input stream supplying the DER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedData authenticatedData = new AuthenticatedData(encodedStream);
 </pre>
 If the content has been transmitted by other means (<A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> mode) it
 now has to be supplied by calling method <A HREF="../../iaik/cms/AuthenticatedData.html#setContent(byte[])"><CODE>setContent</CODE></A>
 since it is required for MAC computation (verification):
 <pre>
 if (authenticatedData.getMode() == AuthenticatedData.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   byte[] content = ...; // the content received by other means
   authenticatedData.setContent(content);
 }
 </pre>
 In order to decrypt the encrypted MAC key the recipient has to call a proper
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, iaik.x509.X509Certificate)"><CODE>setupMac</CODE></A> method 
 thereby specifying her/his key encryption key which has to be suitable for the
 key management technique that has been used. Since in our example both recipients have
 used the <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>key transport</CODE></A> technique,
 a private key is required to decrypt the encrypted mac key. The right 
 RecipientInfo maybe identified by the recipient certificate, e.g.:
 <pre>
 // the recipient certificate:
 X509Certificate recipientCert = ...; 
 // the corresponding private key
 PrivateKey recipientPrivateKey = ...;
 // setup the MAC by decrypting the secret MAC key
 autenticatedData.setupMac(recipientPrivateKey, recipientCert);
 </pre>
 After decrypting the encrypted MAC key, the MAC value can be verified by
 calling method <A HREF="../../iaik/cms/AuthenticatedDataStream.html#verifyMac()"><CODE>verifyMac</CODE></A>:
 <pre>
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 </pre>
 Finally (in implicit mode) the content may be accessed by calling method
 <A HREF="../../iaik/cms/AuthenticatedData.html#getContent()"><CODE>getContent</CODE></A>:
 <pre>
 byte[] content = authenticatedData.getContent();
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_iaik.cms.AuthenticatedDataStream"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class iaik.cms.<A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT">EXPLICIT</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT">IMPLICIT</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData()">AuthenticatedData</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default constructor for dynamic object creation in ContentInfoStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(java.io.InputStream)">AuthenticatedData</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AuthenticatedData from a DER encoded AutheticatedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(java.io.InputStream, iaik.cms.SecurityProvider)">AuthenticatedData</A></B>(java.io.InputStream&nbsp;is,
                  <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AuthenticatedData from a DER encoded AutheticatedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, byte[], iaik.asn1.structures.AlgorithmID, int)">AuthenticatedData</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                  byte[]&nbsp;content,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                  byte[]&nbsp;mac,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                  int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AuthenticatedData from an already calculated MAC value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)">AuthenticatedData</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                  byte[]&nbsp;content,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                  int&nbsp;macKeyLength,
                  java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                  int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)">AuthenticatedData</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                  byte[]&nbsp;content,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                  int&nbsp;macKeyLength,
                  java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                  int&nbsp;mode,
                  <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int)">AuthenticatedData</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                  byte[]&nbsp;content,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                  int&nbsp;macKeyLength,
                  java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                  int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int, iaik.cms.SecurityProvider)">AuthenticatedData</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                  byte[]&nbsp;content,
                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                  int&nbsp;macKeyLength,
                  java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                  int&nbsp;mode,
                  <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#decode(iaik.asn1.ASN1Object)">decode</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reads and parses DER encoded AutheticatedData from a the given ASN.1 representation.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#decode(java.io.InputStream)">decode</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reads and decodes a DER encoded AutheticatedData from a the given input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#getContent()">getContent</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#getEncoded()">getEncoded</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the DER encoding of this AuthenticatedData object as byte array.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.InputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#getInputStream()">getInputStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an InputStream from where the content data can be read.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#setContent(byte[])">setContent</A></B>(byte[]&nbsp;content)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the content data to be authenticated.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#setInputStream(java.io.InputStream)">setInputStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the input stream that supplies the content data to be autenticated.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#setupMac(javax.crypto.SecretKey)">setupMac</A></B>(javax.crypto.SecretKey&nbsp;macKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the given symmetric mac key to setup the mac calculation
 to verify the message authentication code when parsing an AuthenticatedData object .</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#toASN1Object(int)">toASN1Object</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this AutheticatedData as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthenticatedData.html#verifyMac()">verifyMac</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the message authentication code.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_iaik.cms.AuthenticatedDataStream"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class iaik.cms.<A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#addRecipientInfo(iaik.cms.RecipientInfo)">addRecipientInfo</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#encodeCalled(iaik.asn1.ASN1Object, int)">encodeCalled</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getAuthenticatedAttribute(iaik.asn1.ObjectID)">getAuthenticatedAttribute</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getAuthenticatedAttributes()">getAuthenticatedAttributes</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getAuthenticatedDigest()">getAuthenticatedDigest</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getBlockSize()">getBlockSize</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getContentType()">getContentType</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getDigestAlgorithm()">getDigestAlgorithm</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getEncapsulatedContentType()">getEncapsulatedContentType</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getMac()">getMac</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getMacAlgorithm()">getMacAlgorithm</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getMode()">getMode</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getOriginatorInfo()">getOriginatorInfo</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfo(iaik.cms.KeyIdentifier)">getRecipientInfo</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfo(iaik.x509.X509Certificate)">getRecipientInfo</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfos()">getRecipientInfos</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getRecipientInfos(int)">getRecipientInfos</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getSecurityProvider()">getSecurityProvider</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getUnauthenticatedAttribute(iaik.asn1.ObjectID)">getUnauthenticatedAttribute</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getUnauthenticatedAttributes()">getUnauthenticatedAttributes</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#getVersion()">getVersion</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#notifyEOF()">notifyEOF</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])">setAuthenticatedAttributes</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setBlockSize(int)">setBlockSize</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setOriginatorInfo(iaik.cms.OriginatorInfo)">setOriginatorInfo</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])">setRecipientInfos</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])">setUnauthenticatedAttributes</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, int)">setupMac</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, iaik.cms.KeyIdentifier)">setupMac</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(java.security.Key, iaik.x509.X509Certificate)">setupMac</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#toASN1Object()">toASN1Object</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#toString()">toString</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#toString(boolean)">toString</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream)">writeTo</A>, <A HREF="../../iaik/cms/AuthenticatedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_iaik.cms.ContentStream"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface iaik.cms.<A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../iaik/cms/ContentStream.html#getBlockSize()">getBlockSize</A>, <A HREF="../../iaik/cms/ContentStream.html#getContentType()">getContentType</A>, <A HREF="../../iaik/cms/ContentStream.html#setBlockSize(int)">setBlockSize</A>, <A HREF="../../iaik/cms/ContentStream.html#toASN1Object()">toASN1Object</A>, <A HREF="../../iaik/cms/ContentStream.html#toString(boolean)">toString</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AuthenticatedData()"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
protected <B>AuthenticatedData</B>()</PRE>
<DL>
<DD>Default constructor for dynamic object creation in ContentInfoStream.
 The block size is set to -1 to enforce definite primitive encoding.
<P>
</DL>
<HR>

<A NAME="AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int)"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
public <B>AuthenticatedData</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                         byte[]&nbsp;content,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                         int&nbsp;macKeyLength,
                         java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                         int&nbsp;mode)
                  throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array. The MAC
 value will be computed immediately from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>content</CODE> - the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
public <B>AuthenticatedData</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                         byte[]&nbsp;content,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                         int&nbsp;macKeyLength,
                         java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                         int&nbsp;mode,
                         <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                  throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array. The MAC
 value will be computed immediately from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>content</CODE> - the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for any required
                         cryptographic operation
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
public <B>AuthenticatedData</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                         byte[]&nbsp;content,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                         int&nbsp;macKeyLength,
                         java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                         int&nbsp;mode)
                  throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array. This constructor generates
 a symmetric MAC key. If the <code>digestAlg</code> parameter
 is not null authenticated attributes have to be set by calling method 
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A>
 and the MAC value will be calculated from the DER encoded authenticated attributes
 which have to contain the -- (if not set) automatically calculated -- MessageDigest
 attribute.
 However, if the <code>digestAlg</code> parameter is null, the MAC
 value will be computed immediately from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>content</CODE> - the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm to be used for hash computation if
                  authenticated attributes are to be included<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, int, java.security.spec.AlgorithmParameterSpec, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
public <B>AuthenticatedData</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                         byte[]&nbsp;content,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                         int&nbsp;macKeyLength,
                         java.security.spec.AlgorithmParameterSpec&nbsp;macParams,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                         int&nbsp;mode,
                         <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                  throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates a new AuthenticatedData where the to-be-authenticated
 content data is supplied from an byte array. This constructor generates
 a symmetric MAC key. If the <code>digestAlg</code> parameter
 is not null authenticated attributes have to be set by calling method 
 <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A>
 and the MAC value will be calculated from the DER encoded authenticated attributes
 which have to contain the -- (if not set) automatically calculated -- MessageDigest
 attribute.
 However, if the <code>digestAlg</code> parameter is null, the MAC
 value will be computed immediately from the content.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>content</CODE> - the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm to be used<DD><CODE>macKeyLength</CODE> - the length (in bytes) of  the mac key to be generated;
                     if not specified (-1), a default value will
                     be used depending on the mac algorithm and
                     the implementation of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> method <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)"><CODE>generateKey</CODE></A>. The <A HREF="../../iaik/cms/IaikProvider.html" title="class in iaik.cms"><CODE>IaikProvider</CODE></A> tries to determine the block length
                     of the mac algorithm in use; otherwise it uses the
                     length of the underlying digest algorithm.<DD><CODE>macParams</CODE> - any parameters, if required by the mac algorithm<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm to be used for hash computation if
                  authenticated attributes are to be included<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for any required
                         cryptographic operation
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested digest or mac algorithm is not
                                     supported or the MAC key cannot be created</DL>
</DL>
<HR>

<A NAME="AuthenticatedData(iaik.asn1.ObjectID, byte[], iaik.asn1.structures.AlgorithmID, byte[], iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
public <B>AuthenticatedData</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                         byte[]&nbsp;content,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;macAlg,
                         byte[]&nbsp;mac,
                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg,
                         int&nbsp;mode)
                  throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Creates an AuthenticatedData from an already calculated MAC value.
 No mac or digest calculation is performed. If <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><CODE>setAuthenticatedAttributes</CODE></A> are supplied, they already have to contain
 the MessageDigest attribute. Any <A HREF="../../iaik/cms/AuthenticatedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])"><CODE>RecipientInfo</CODE></A> added
 to this AuthenticatedData object already has to contain the encrypted mac key
 (i.e. no MAC key is generated and encrypted for each recipient).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the type of the authenticated content (e.g. ObjectID.cms_data)<DD><CODE>content</CODE> - the to-be-authenticated data<DD><CODE>macAlg</CODE> - the OID of the MAC algorithm used for mac calculation<DD><CODE>mac</CODE> - the already calculated mac value<DD><CODE>digestAlg</CODE> - the OID of the digest algorithm used for hash calculation<DD><CODE>mode</CODE> - the transmissiom mode; either <A HREF="../../iaik/cms/AuthenticatedDataStream.html#IMPLICIT"><CODE>IMPLICIT</CODE></A> (to include
             the content) or <A HREF="../../iaik/cms/AuthenticatedDataStream.html#EXPLICIT"><CODE>EXPLICIT</CODE></A> to transmit it by other means
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE></DL>
</DL>
<HR>

<A NAME="AuthenticatedData(java.io.InputStream)"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
public <B>AuthenticatedData</B>(java.io.InputStream&nbsp;is)
                  throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                         java.io.IOException</PRE>
<DL>
<DD>Creates an AuthenticatedData from a DER encoded AutheticatedData
 object which is read from the given InputStream. The encoded AutheticatedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a DER encoded CMS AutheticatedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>
<HR>

<A NAME="AuthenticatedData(java.io.InputStream, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthenticatedData</H3>
<PRE>
public <B>AuthenticatedData</B>(java.io.InputStream&nbsp;is,
                         <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                  throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                         java.io.IOException</PRE>
<DL>
<DD>Creates an AuthenticatedData from a DER encoded AutheticatedData
 object which is read from the given InputStream. The encoded AutheticatedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a DER encoded CMS AutheticatedData object<DD><CODE>securityProvider</CODE> - the security provider to be used; if <code>null</code> the 
                         default system-wide SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="decode(iaik.asn1.ASN1Object)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)
            throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></PRE>
<DL>
<DD>Reads and parses DER encoded AutheticatedData from a the given ASN.1 representation.
 The ASN.1 AutheticatedData may (or may not) be wrapped into a ContentInfo.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/Content.html#decode(iaik.asn1.ASN1Object)">decode</A></CODE> in interface <CODE><A HREF="../../iaik/cms/Content.html" title="interface in iaik.cms">Content</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the ASN.1 AutheticatedData object
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the ASN.1 object</DL>
</DD>
</DL>
<HR>

<A NAME="decode(java.io.InputStream)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(java.io.InputStream&nbsp;is)
            throws java.io.IOException,
                   <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></PRE>
<DL>
<DD>Reads and decodes a DER encoded AutheticatedData from a the given input stream.
 The encoded AutheticatedData may (or may not) be wrapped into a ContentInfo.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#decode(java.io.InputStream)">decode</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE><DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#decode(java.io.InputStream)">decode</A></CODE> in class <CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream holding a DER encoded AutheticatedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DD>
</DL>
<HR>

<A NAME="setupMac(javax.crypto.SecretKey)"><!-- --></A><H3>
setupMac</H3>
<PRE>
public void <B>setupMac</B>(javax.crypto.SecretKey&nbsp;macKey)</PRE>
<DL>
<DD>Uses the given symmetric mac key to setup the mac calculation
 to verify the message authentication code when parsing an AuthenticatedData object .
 <p>
 The secret key supplied to this method has to be the already decrypted
 mac key.
 <p>
 The mac calculation actually is done when <A HREF="../../iaik/cms/AuthenticatedData.html#verifyMac()"><CODE>verifying</CODE></A> the mac, e.g.:
 <pre>
 // the input stream supplying the DER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedData authenticatedData = new AuthenticatedData(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   byte[] content = ...; // the content received by other means
   authenticatedData.setContent(content);
 }
 // supply the may key
 Key macKey = ...;
 autenticatedData.setupMac(macKey);
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 // in implicit mode get the content
 byte[] content = authenticatedData.getContent();
 </pre>
 <p>
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setupMac(javax.crypto.SecretKey)">setupMac</A></CODE> in class <CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>macKey</CODE> - the temporary symmetric key that has been used to calculate the message
               authentication code</DL>
</DD>
</DL>
<HR>

<A NAME="verifyMac()"><!-- --></A><H3>
verifyMac</H3>
<PRE>
public boolean <B>verifyMac</B>()
                  throws <A HREF="../../iaik/cms/CMSMacException.html" title="class in iaik.cms">CMSMacException</A></PRE>
<DL>
<DD>Verifies the message authentication code. 
 <p>
 For verifying the MAC value first the mac calcualtion has to be set up
 by calling a proper <code>setupMac</code> method:
 <pre>
 // the input stream supplying the DER encoded AuthenticatedData
 InputStream encodedStream = ...;
 // parse the AuthenticatedData
 AuthenticatedData authenticatedData = new AuthenticatedData(encodedStream);
 if (authenticatedData.getMode() == AuthenticatedDataStream.EXPLICIT) {
   // in explicit mode explicitly supply the content for hash/mac computation 
   byte[] content = ...; // the content received by other means
   authenticatedData.setContent(content);
 }
 // the recipient certificate:
 X509Certificate recipientCert = ...; 
 // the corresponding private key
 PrivateKey recipientPrivateKey = ...;
 // setup the MAC by decrypting the secret MAC key
 autenticatedData.setupMac(recipientPrivateKey, recipientCert);
 // verify the MAC  
 try {
   if (authenticatedData.verifyMac() == false) {
     System.out.println("Invalid MAC value!");
   }
 } catch (CMSMacException ex) {
   System.out.println("Mac verification error: " + ex.toString());
 }
 System.out.println("Mac successfully verified!");
 // in implicit mode get the content
 byte[] content = authenticatedData.getContent();
 </pre>
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#verifyMac()">verifyMac</A></CODE> in class <CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>true</code> if the MAC verifies, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSMacException.html" title="class in iaik.cms">CMSMacException</A></CODE> - if the MAC verification process fails for some reason
            (e.g. the authenticated attributes (if incldued) cannot be parsed or 
                  the content hash does not match to value of the included MessageDigest 
                  attribute)</DL>
</DD>
</DL>
<HR>

<A NAME="getContent()"><!-- --></A><H3>
getContent</H3>
<PRE>
public byte[] <B>getContent</B>()</PRE>
<DL>
<DD>Returns the content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the content as byte array</DL>
</DD>
</DL>
<HR>

<A NAME="getInputStream()"><!-- --></A><H3>
getInputStream</H3>
<PRE>
public java.io.InputStream <B>getInputStream</B>()</PRE>
<DL>
<DD>Returns an InputStream from where the content data can be read.
 <p>
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#getInputStream()">getInputStream</A></CODE> in class <CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an InputStream for reading the content data</DL>
</DD>
</DL>
<HR>

<A NAME="setInputStream(java.io.InputStream)"><!-- --></A><H3>
setInputStream</H3>
<PRE>
public void <B>setInputStream</B>(java.io.InputStream&nbsp;is)</PRE>
<DL>
<DD>Sets the input stream that supplies the content data to be autenticated.
 This method entirely reads the supplied stream.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#setInputStream(java.io.InputStream)">setInputStream</A></CODE> in class <CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream holding the content data to authenticated</DL>
</DD>
</DL>
<HR>

<A NAME="setContent(byte[])"><!-- --></A><H3>
setContent</H3>
<PRE>
public void <B>setContent</B>(byte[]&nbsp;content)</PRE>
<DL>
<DD>Sets the content data to be authenticated.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>content</CODE> - the content data to authenticated</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object(int)"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>(int&nbsp;blockSize)
                           throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this AutheticatedData as ASN1Object.
 <p>
 If <blockSize> is positive a constructed
 OCTET STRING is used for encoding the inherent content data. This method actually
 will perform the encryption of the symmetric mac key for
 each participated recipient.
 <p>
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html#toASN1Object(int)">toASN1Object</A></CODE> in class <CODE><A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms">AuthenticatedDataStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Returns:</B><DD>this AutheticatedData as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object cannot not be created</DL>
</DD>
</DL>
<HR>

<A NAME="getEncoded()"><!-- --></A><H3>
getEncoded</H3>
<PRE>
public byte[] <B>getEncoded</B>()
                  throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns the DER encoding of this AuthenticatedData object as byte array.
 
 If no positive blocksize has been yet set, any inherent content
 data bytes (implicit mode) will be encoded as primitive definite octet string. 
 Otherwise the encoding of the inherent data will be indefinte constructed (may be
 forced by using the <code>writeTo(OutputStream os, int blockSize)</code> method
 of the parent <A HREF="../../iaik/cms/AuthenticatedDataStream.html" title="class in iaik.cms"><CODE>AuthenticatedDataStream</CODE></A> class.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the DER encoding of this AuthenticatedData
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if an encoding error occurs</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthCipherEngine.html" title="interface in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/AuthenticatedDataOutputStream.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthenticatedData.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthenticatedData.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#fields_inherited_from_class_iaik.cms.AuthenticatedDataStream">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
