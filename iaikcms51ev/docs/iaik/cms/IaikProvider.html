<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:12 GMT 2016 -->
<TITLE>
IaikProvider (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.IaikProvider class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="IaikProvider (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/IaikJCECipher.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/InputStreamAuthCipherEngine.html" title="interface in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/IaikProvider.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="IaikProvider.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class IaikProvider</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">iaik.cms.SecurityProvider</A>
      <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.IaikProvider</B>
</PRE>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../iaik/cms/IaikCCProvider.html" title="class in iaik.cms">IaikCCProvider</A>, <A HREF="../../iaik/cms/ecc/IaikEccProvider.html" title="class in iaik.cms.ecc">IaikEccProvider</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>IaikProvider</B><DT>extends <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></DL>
</PRE>

<P>
This class implements a CMS SecurityProvider for the IAIK-JCE cryptographic provider "IAIK".
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#ALG_SIGNATURE_RAWRSA">ALG_SIGNATURE_RAWRSA</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant string <CODE>RawRSA</CODE>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#ALG_SIGNATURE_RAWRSASSA_PKCS1_V15">ALG_SIGNATURE_RAWRSASSA_PKCS1_V15</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant string <CODE>RawRSASSA-PKCS1-v1_5</CODE>.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_iaik.cms.SecurityProvider"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class iaik.cms.<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#ALG_CIPHER_RSA">ALG_CIPHER_RSA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_CIPHER_RSA_DECRYPT">ALG_CIPHER_RSA_DECRYPT</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_CIPHER_RSA_ENCRYPT">ALG_CIPHER_RSA_ENCRYPT</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_CIPHER_RSA_SIGN">ALG_CIPHER_RSA_SIGN</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_CIPHER_RSA_VERIFY">ALG_CIPHER_RSA_VERIFY</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_DIGEST_MD5">ALG_DIGEST_MD5</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_DIGEST_SHA">ALG_DIGEST_SHA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_HMAC_MD5">ALG_HMAC_MD5</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_HMAC_SHA">ALG_HMAC_SHA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_KEYEX_DH">ALG_KEYEX_DH</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_KEYEX_ESDH">ALG_KEYEX_ESDH</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_KEYEX_SSDH">ALG_KEYEX_SSDH</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_SIGNATURE_RAWDSA">ALG_SIGNATURE_RAWDSA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_SIGNATURE_RAWECDSA">ALG_SIGNATURE_RAWECDSA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_SIGNATURE_RAWECDSA_PLAIN">ALG_SIGNATURE_RAWECDSA_PLAIN</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_SIGNATURE_RAWRSAPSS">ALG_SIGNATURE_RAWRSAPSS</A>, <A HREF="../../iaik/cms/SecurityProvider.html#ALG_SIGNATURE_SHADSA">ALG_SIGNATURE_SHADSA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#CIPHER_DECRYPT">CIPHER_DECRYPT</A>, <A HREF="../../iaik/cms/SecurityProvider.html#CIPHER_ENCRYPT">CIPHER_ENCRYPT</A>, <A HREF="../../iaik/cms/SecurityProvider.html#CIPHER_NONE">CIPHER_NONE</A>, <A HREF="../../iaik/cms/SecurityProvider.html#CIPHER_UNWRAP">CIPHER_UNWRAP</A>, <A HREF="../../iaik/cms/SecurityProvider.html#CIPHER_WRAP">CIPHER_WRAP</A>, <A HREF="../../iaik/cms/SecurityProvider.html#COMPRESS">COMPRESS</A>, <A HREF="../../iaik/cms/SecurityProvider.html#DECOMPRESS">DECOMPRESS</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_DSA">IMPLEMENTATION_NAME_DSA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_ECDSA">IMPLEMENTATION_NAME_ECDSA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_ECDSA_PLAIN">IMPLEMENTATION_NAME_ECDSA_PLAIN</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_PBKDF2">IMPLEMENTATION_NAME_PBKDF2</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_PWRI_KEK">IMPLEMENTATION_NAME_PWRI_KEK</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_RSA">IMPLEMENTATION_NAME_RSA</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_RSA_OAEP">IMPLEMENTATION_NAME_RSA_OAEP</A>, <A HREF="../../iaik/cms/SecurityProvider.html#IMPLEMENTATION_NAME_RSA_PSS">IMPLEMENTATION_NAME_RSA_PSS</A>, <A HREF="../../iaik/cms/SecurityProvider.html#providerName_">providerName_</A>, <A HREF="../../iaik/cms/SecurityProvider.html#random_">random_</A>, <A HREF="../../iaik/cms/SecurityProvider.html#SIGNATURE_NONE">SIGNATURE_NONE</A>, <A HREF="../../iaik/cms/SecurityProvider.html#SIGNATURE_SIGN">SIGNATURE_SIGN</A>, <A HREF="../../iaik/cms/SecurityProvider.html#SIGNATURE_VERIFY">SIGNATURE_VERIFY</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#IaikProvider()">IaikProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default Constructor.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])">calculateSignatureFromHash</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                           java.security.PrivateKey&nbsp;privateKey,
                           byte[]&nbsp;digest)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates the signature value for a CMS SignerInfo over the given digest 
 value with the given algorithm using the supplied private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])">calculateSignatureFromSignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                       <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                       java.security.PrivateKey&nbsp;privateKey,
                                       byte[]&nbsp;signedAttributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates the signature value for a CMS SignerInfo over the given signed 
 attributes with the given algorithm using the supplied private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#checkDomainParameters(java.security.PrivateKey, java.security.PublicKey)">checkDomainParameters</A></B>(java.security.PrivateKey&nbsp;myKey,
                      java.security.PublicKey&nbsp;otherKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if the given private and public key agreement keys have the same domain
 parameters.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#createSharedKeyEncryptionKey(iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, int, byte[], java.lang.String)">createSharedKeyEncryptionKey</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;keyAgreeAlg,
                             java.security.PrivateKey&nbsp;myKey,
                             java.security.PublicKey&nbsp;otherKey,
                             <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
                             int&nbsp;kekLength,
                             byte[]&nbsp;ukm,
                             java.lang.String&nbsp;kekName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a shared secret key encryption key for the given key agree algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#decryptKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.lang.String)">decryptKey</A></B>(byte[]&nbsp;encryptedKey,
           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
           java.security.PrivateKey&nbsp;recipientKey,
           java.lang.String&nbsp;cekAlgorithmName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the given encrypted content encryption key for a <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.Key</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#deriveKey(char[], iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)">deriveKey</A></B>(char[]&nbsp;password,
          <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;keyDerivationAlg,
          java.security.spec.AlgorithmParameterSpec&nbsp;paramSpec)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the requested key derivation function to create a secret key from
 the supplied password.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)">generateKey</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;algorithm,
            int&nbsp;keyLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generates a SecretKey for the requested algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.KeyPair</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#generateKeyAgreementKeyPair(iaik.asn1.structures.AlgorithmID, java.security.PublicKey)">generateKeyAgreementKeyPair</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;keyAgreeAlgorithm,
                            java.security.PublicKey&nbsp;otherKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generates a key pair with same domain parameters as the given public key
 for the given key agreement method.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.spec.AlgorithmParameterSpec</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#getAlgorithmParameterSpec(iaik.asn1.structures.AlgorithmID)">getAlgorithmParameterSpec</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;algID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets algorithm parameter specification from the given AlgorithmID.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#getASN1OriginatorPublicKey(java.security.PublicKey)">getASN1OriginatorPublicKey</A></B>(java.security.PublicKey&nbsp;originatorPublicKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets an ASN.1 representation of the provided originator public key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.Key</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#getPBEKey(char[], iaik.asn1.structures.AlgorithmID)">getPBEKey</A></B>(char[]&nbsp;password,
          <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;pbeAlg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates secret key from the supplied password using the specified
 PBE algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.SecureRandom</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#getSecureRandom()">getSecureRandom</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an instance of the default SecureRandom class set in 
 <CODE>iaik.security.random.SecRandom</CODE>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.spec.AlgorithmParameterSpec</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#setIv(java.security.AlgorithmParameters, byte[])">setIv</A></B>(java.security.AlgorithmParameters&nbsp;params,
      byte[]&nbsp;iv)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an AlgorithmParameterSpec containing any parameters from
 the given AlgorithmParameters object and the given iv.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#turnOffIAIKProviderVersionCheck()">turnOffIAIKProviderVersionCheck</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the IAIK crypto provider is used but its version is not appropriate for
 this version of IAIK-CMS, an warning message is printed to System.out to
 use a more recent version of IAIK-JCE.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#unwrapKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.AlgorithmParameters, java.lang.String)">unwrapKey</A></B>(byte[]&nbsp;wrappedCek,
          <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
          java.security.Key&nbsp;kek,
          java.security.AlgorithmParameters&nbsp;params,
          java.lang.String&nbsp;cekAlgName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unwraps the given wrapped (encrypted) secret content encryption key for a 
 <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#verifySignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])">verifySignatureFromHash</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                        java.security.PublicKey&nbsp;publicKey,
                        byte[]&nbsp;digest,
                        byte[]&nbsp;signatureValue)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the signature value of a CMS SignerInfo object with the given algorithm
 using the supplied public key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#verifySignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])">verifySignatureFromSignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                    java.security.PublicKey&nbsp;publicKey,
                                    byte[]&nbsp;signedAttributes,
                                    byte[]&nbsp;signatureValue)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the signature value of a CMS SignerInfo calculated over the given signed 
 attributes with the given algorithm using the supplied public key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/IaikProvider.html#wrapKey(javax.crypto.SecretKey, iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.AlgorithmParameters)">wrapKey</A></B>(javax.crypto.SecretKey&nbsp;cek,
        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
        java.security.Key&nbsp;kek,
        java.security.AlgorithmParameters&nbsp;params)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wraps the given secret content encryption key for a 
 <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, or <A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_iaik.cms.SecurityProvider"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class iaik.cms.<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#calculateMac(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])">calculateMac</A>, <A HREF="../../iaik/cms/SecurityProvider.html#calculateSharedSecret(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.Key, java.security.spec.AlgorithmParameterSpec)">calculateSharedSecret</A>, <A HREF="../../iaik/cms/SecurityProvider.html#compress(iaik.asn1.structures.AlgorithmID, byte[], int)">compress</A>, <A HREF="../../iaik/cms/SecurityProvider.html#convertCipherMode(int)">convertCipherMode</A>, <A HREF="../../iaik/cms/SecurityProvider.html#decryptKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.PrivateKey)">decryptKey</A>, <A HREF="../../iaik/cms/SecurityProvider.html#encryptKey(javax.crypto.SecretKey, iaik.asn1.structures.AlgorithmID, java.security.PublicKey)">encryptKey</A>, <A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)">generateKey</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameters(iaik.asn1.structures.AlgorithmID)">getAlgorithmParameters</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameters(iaik.asn1.structures.AlgorithmID, java.lang.String)">getAlgorithmParameters</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameters(java.lang.String)">getAlgorithmParameters</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters, byte[])">getAuthCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])">getAuthCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters, byte[])">getByteArrayAuthCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])">getByteArrayAuthCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters)">getByteArrayCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getByteArrayCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getCipher(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters)">getCipher</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getCipher(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getCipher</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getCipher(java.lang.String, int, java.security.Key, java.security.AlgorithmParameters)">getCipher</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getCipher(java.lang.String, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getCipher</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])">getHash</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters, byte[])">getInputStreamAuthCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])">getInputStreamAuthCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters)">getInputStreamCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getInputStreamCipherEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamCompressEngine(iaik.asn1.structures.AlgorithmID, java.io.InputStream, int, int)">getInputStreamCompressEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.InputStream)">getInputStreamHashEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamMacEngine(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, java.io.InputStream)">getInputStreamMacEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyAgreement(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getKeyAgreement</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyFactory(iaik.asn1.structures.AlgorithmID)">getKeyFactory</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyGenerator(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)">getKeyGenerator</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyGenerator(iaik.asn1.structures.AlgorithmID, int)">getKeyGenerator</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyLength(java.security.Key)">getKeyLength</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyLength(java.security.PrivateKey)">getKeyLength</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyLength(java.security.PublicKey)">getKeyLength</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getKeyPairGenerator(iaik.asn1.structures.AlgorithmID)">getKeyPairGenerator</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getMac(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getMac</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getMac(java.lang.String, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getMac</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getMessageDigest(iaik.asn1.structures.AlgorithmID)">getMessageDigest</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getMessageDigest(java.lang.String)">getMessageDigest</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getMicAlgs(java.lang.String)">getMicAlgs</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getOriginatorPublicKey(iaik.asn1.ASN1Object)">getOriginatorPublicKey</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamCompressEngine(iaik.asn1.structures.AlgorithmID, java.io.OutputStream, int)">getOutputStreamCompressEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.OutputStream)">getOutputStreamHashEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getOutputStreamMacEngine(iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.spec.AlgorithmParameterSpec, java.io.OutputStream)">getOutputStreamMacEngine</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getProviderName()">getProviderName</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getSecretKeyFactory(iaik.asn1.structures.AlgorithmID)">getSecretKeyFactory</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getSecurityProvider()">getSecurityProvider</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getSignature(iaik.asn1.structures.AlgorithmID, int, java.security.Key)">getSignature</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getSignature(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getSignature</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getSignature(java.lang.String, int, java.security.Key)">getSignature</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getSignature(java.lang.String, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getSignature</A>, <A HREF="../../iaik/cms/SecurityProvider.html#getSignatureParameters(java.security.Signature)">getSignatureParameters</A>, <A HREF="../../iaik/cms/SecurityProvider.html#setSecureRandom(java.security.SecureRandom)">setSecureRandom</A>, <A HREF="../../iaik/cms/SecurityProvider.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A>, <A HREF="../../iaik/cms/SecurityProvider.html#setSignatureParameters(java.security.Signature, java.security.spec.AlgorithmParameterSpec)">setSignatureParameters</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="ALG_SIGNATURE_RAWRSA"><!-- --></A><H3>
ALG_SIGNATURE_RAWRSA</H3>
<PRE>
public static final java.lang.String <B>ALG_SIGNATURE_RAWRSA</B></PRE>
<DL>
<DD>Constant string <CODE>RawRSA</CODE>. Used by this provider with <CODE>getSignature()</CODE>.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.IaikProvider.ALG_SIGNATURE_RAWRSA">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="ALG_SIGNATURE_RAWRSASSA_PKCS1_V15"><!-- --></A><H3>
ALG_SIGNATURE_RAWRSASSA_PKCS1_V15</H3>
<PRE>
public static final java.lang.String <B>ALG_SIGNATURE_RAWRSASSA_PKCS1_V15</B></PRE>
<DL>
<DD>Constant string <CODE>RawRSASSA-PKCS1-v1_5</CODE>. Used by this provider with <CODE>getSignature()</CODE>.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.IaikProvider.ALG_SIGNATURE_RAWRSASSA_PKCS1_V15">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="IaikProvider()"><!-- --></A><H3>
IaikProvider</H3>
<PRE>
public <B>IaikProvider</B>()</PRE>
<DL>
<DD>Default Constructor. Tries to add the provider IAIK.
<P>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><!-- --></A><H3>
calculateSignatureFromSignedAttributes</H3>
<PRE>
public byte[] <B>calculateSignatureFromSignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                                     java.security.PrivateKey&nbsp;privateKey,
                                                     byte[]&nbsp;signedAttributes)
                                              throws java.security.NoSuchAlgorithmException,
                                                     java.security.InvalidKeyException,
                                                     java.security.SignatureException</PRE>
<DL>
<DD>Calculates the signature value for a CMS SignerInfo over the given signed 
 attributes with the given algorithm using the supplied private key.
 <p>
 Each <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> included in a CMS SignedData
 object may calculate the signature value differently depending on the
 presence of signed attributes:
 <p>
 <ul>
 <li>If signed attributes are present the signature is calculated over
     the DER encoding of the signed attributes. 
 <li>If signed attributes are NOT present, the signature is calculated
     over the content data itsself.
 </ul>
 This method is called by class <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> for
 calculating the signature when signed attributes are present. 
 <p>
 When writing your own SecurityProvider and overriding
 this method, be aware that only the -- yet NOT hashed -- DER encoding of
 the signed attributes is supplied to this method. For that reason this
 method can be overriden for use with smartcards requiring to do the 
 digest calculation theirselves: ensure that your <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> contains signed attributes and override this method in a way
 to pass the given DER encoding of the signed attributes to your smartcard
 for doing the signature (and digest) calculation.
 <p>
 Since this method requires to calculate the digest value over the DER encoded
 signed attributes as part of the signature calculation, it uses a 
 ordinary JCA Signature engine.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])">calculateSignatureFromSignedAttributes</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureAlgorithm</CODE> - signatureAlgorithm the signature algorithm to be
        used, e.g. rsaEncryption, DSA<DD><CODE>digestAlgorithm</CODE> - the digest algorithm to be used for hash computation (e.g.
        SHA-1,..., SHA-512); may be necessary for some signature schemes (e.g.
        to be included as a DigestInfo in a PKCS#1 RSA signature)<DD><CODE>privateKey</CODE> - the private key of the signer (i.e. the one supplied when
        creating a <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> object; may be
        some kind of "dummy" key when used for smartcards<DD><CODE>signedAttributes</CODE> - the DER encoding of the signed attributes over which 
        the signature shall be calculated
<DT><B>Returns:</B><DD>the signature value calculated from the given DER encoded signed
         attributes
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if no Signature engine is available for the requested algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>if</CODE> - signature calculation fails
<DD><CODE>java.security.SignatureException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><!-- --></A><H3>
calculateSignatureFromHash</H3>
<PRE>
public byte[] <B>calculateSignatureFromHash</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                         java.security.PrivateKey&nbsp;privateKey,
                                         byte[]&nbsp;digest)
                                  throws java.security.NoSuchAlgorithmException,
                                         java.security.InvalidKeyException,
                                         java.security.SignatureException</PRE>
<DL>
<DD>Calculates the signature value for a CMS SignerInfo over the given digest 
 value with the given algorithm using the supplied private key.
 <p>
 Each <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> included in a CMS SignedData
 object may calculate the signature value differently depending on the
 presence of signed attributes:
 <p>
 <ul>
 <li>If signed attributes are present the signature is calculated over
     the DER encoding of the signed attributes. 
 <li>If signed attributes are NOT present, the signature is calculated
     over the content data itsself.
 </ul>
 This method is called by class <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> for
 calculating the signature when no signed attributes are present. Since
 the data to be signed may be of arbitrary size this method expects the
 already hashed data to only calculate the signature value on it (for
 instance, by doing the digest encrypting when using RSA for signing).
 <p>
 For that reason, when writing your own SecurityProvider and overriding
 this method, you will need some kind of <i>RAW</i> signature (respectively
 digest encryption) mechanism only expecting the already hashed data (e.g.
 a "RawDSA" signature engine when using DSA repectively a Cipher engine
 when using RSA). 
 <p>
 If you want to override this method for use with smartcards, please be sure
 that your smartcard is able to do the signature (respectively digest 
 encryption) operation only. However, if your smartcard requires to supply
 the whole data for doing the hash calcualtion itself, you may ensure that
 your <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> contains signed attributes
 and override method <A HREF="../../iaik/cms/IaikProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes</CODE></A> for calculating the signature over
 the DER encoding of the signed attributes (thereby doing the hash 
 computation, too).
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])">calculateSignatureFromHash</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureAlgorithm</CODE> - signatureAlgorithm the signature algorithm to be
        used, e.g. rsaEncryption, DSA<DD><CODE>digestAlgorithm</CODE> - the digest algorithm used for hash computation (e.g.
        SHA-1, ..., SHA-512); may be necessary for some signature schemes (e.g.
        to be included as a DigestInfo in a PKCS#1 RSA signature)<DD><CODE>privateKey</CODE> - the private key of the signer (i.e. the one supplied when
        creating a <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> object; may be
        some kind of "dummy" key when used for smartcards<DD><CODE>digest</CODE> - the digest value over which the signature shall be calculated
<DT><B>Returns:</B><DD>the signature value calculated from the given digest value
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if any of the required algorithms is not supported
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>java.security.SignatureException</CODE> - if signature verification fails because of some crypto related error</DL>
</DD>
</DL>
<HR>

<A NAME="verifySignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])"><!-- --></A><H3>
verifySignatureFromSignedAttributes</H3>
<PRE>
public boolean <B>verifySignatureFromSignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                                   <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                                   java.security.PublicKey&nbsp;publicKey,
                                                   byte[]&nbsp;signedAttributes,
                                                   byte[]&nbsp;signatureValue)
                                            throws java.security.NoSuchAlgorithmException,
                                                   java.security.InvalidKeyException,
                                                   java.security.SignatureException</PRE>
<DL>
<DD>Verifies the signature value of a CMS SignerInfo calculated over the given signed 
 attributes with the given algorithm using the supplied public key.
 <p>
 Each <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> included in a CMS SignedData
 object may calculate the signature value differently depending on the
 presence of signed attributes:
 <p>
 <ul>
 <li>If signed attributes are present the signature is calculated over
     the DER encoding of the signed attributes. For verifying the 
     signature first a hash over the data content has to be compared
     with the signed MessageDigest attribute. Second the signature value
     has to be verified against a hash independently computed over the 
     DER encoding of the signed attributes.
 <li>If signed attributes are NOT present, the signature is calculated
     over the content data itsself. For verifying the signature the signature 
     value has to be verified against a hash independently computed over the 
     content data.
 </ul>
 This method is called by class <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> for
 verifying the signature when no signed attributes are present.
 <p>
 When writing your own SecurityProvider and overriding this method, be aware
 that only the -- yet NOT hashed -- DER encoding of the signed attributes is 
 supplied to this method. Although generally for public key operations  
 smartcards may not be used, this method can be overriden for use
 with smartcards requiring to do the digest calculation theirselves: ensure that
 your <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> contains signed attributes and 
 override this method in a way to pass the given DER encoding of the signed 
 attributes to your smartcard for doing the signature verification (including
 any digest calculation required).
 <p>
 Since this method requires to calculate the digest value over the DER encoded
 signed attributes as part of the signature verification, it uses a 
 oridinary JCA Signature engine.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#verifySignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])">verifySignatureFromSignedAttributes</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureAlgorithm</CODE> - signatureAlgorithm the signature algorithm to be
        used, e.g. rsaEncryption, DSA<DD><CODE>digestAlgorithm</CODE> - the digest algorithm to be used for hash computation (e.g.
        SHA-1, ..., SHA-512);<DD><CODE>publicKey</CODE> - the public key of the signer<DD><CODE>signedAttributes</CODE> - the DER encoding of the signed attributes over which 
        the signature has been calculated<DD><CODE>signatureValue</CODE> - the signatureValue the signature value to be verified
<DT><B>Returns:</B><DD><code>true</code> if the signature is ok, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if any of the required algorithms is not supported
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>java.security.SignatureException</CODE> - if signature verification fails because of some computation error</DL>
</DD>
</DL>
<HR>

<A NAME="verifySignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])"><!-- --></A><H3>
verifySignatureFromHash</H3>
<PRE>
public boolean <B>verifySignatureFromHash</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                       <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                       java.security.PublicKey&nbsp;publicKey,
                                       byte[]&nbsp;digest,
                                       byte[]&nbsp;signatureValue)
                                throws java.security.NoSuchAlgorithmException,
                                       java.security.InvalidKeyException,
                                       java.security.SignatureException</PRE>
<DL>
<DD>Verifies the signature value of a CMS SignerInfo object with the given algorithm
 using the supplied public key.
 <p>
 Each <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> included in a CMS SignedData
 object may calculate the signature value differently depending on the
 presence of signed attributes:
 <p>
 <ul>
 <li>If signed attributes are present the signature is calculated over
     the DER encoding of the signed attributes. For verifying the 
     signature first a hash over the data content has to be compared
     with the signed MessageDigest attribute. Second the signature value
     has to be verified against a hash independently computed over the 
     DER encoding of the signed attributes.
 <li>If signed attributes are NOT present, the signature is calculated
     over the content data itsself. For verifying the signature the signature 
     value has to be verified against a hash independently computed over the 
     content data.
 </ul>
 This method is called by class <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> for
 verifying the signature when no signed attributes are present. Since
 the data to be verified may be of arbitrary size this method expects the
 already hashed data to only be verified against the signature value.
 <p>
 For that reason, when writing your own SecurityProvider and overriding
 this method, you will need some kind of <i>RAW</i> signature (respectively
 "encrypted digest decryption") mechanism only expecting the already hashed 
 data (e.g. a "RawDSA" signature engine when using DSA or "RawRSA" signature
 engine when using RSA). 
 <p>
 Although generally for public key operations smartcards may not be used,
 when overriding this method for use with smartcards, please be sure
 that your smartcard is able to do the signature verification operation only. 
 However, if your smartcard requires to supply the whole data for doing the 
 hash calcualtion itself, you may ensure that your <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> contains signed attributes and override method <A HREF="../../iaik/cms/IaikProvider.html#verifySignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])"><CODE>verifySignatureFromSignedAttributes</CODE></A> 
 for verifying the signature calculated from the DER encoding of the signed 
 attributes (thereby doing the hash computation, too).
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#verifySignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])">verifySignatureFromHash</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureAlgorithm</CODE> - signatureAlgorithm the signature algorithm to be
        used for verification, e.g. rsaEncryption, DSA<DD><CODE>digestAlgorithm</CODE> - the digest algorithm that has been used for hash 
        computation (e.g. SHA-1, ..., SHA-512); may be necessary for some signature 
        schemes (e.g. to be check against a DigestInfo in a PKCS#1 RSA signature)<DD><CODE>publicKey</CODE> - the public key of the signer<DD><CODE>digest</CODE> - the digest value to be verified
<DT><B>Returns:</B><DD><code>true</code> if the signature is ok, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if any of the required algorithms is not supported
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>java.security.SignatureException</CODE> - if signature verification fails because 
                               of some crypto related or parsing error</DL>
</DD>
</DL>
<HR>

<A NAME="decryptKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.lang.String)"><!-- --></A><H3>
decryptKey</H3>
<PRE>
public javax.crypto.SecretKey <B>decryptKey</B>(byte[]&nbsp;encryptedKey,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
                                         java.security.PrivateKey&nbsp;recipientKey,
                                         java.lang.String&nbsp;cekAlgorithmName)
                                  throws java.security.NoSuchAlgorithmException,
                                         java.security.InvalidKeyException,
                                         javax.crypto.NoSuchPaddingException,
                                         javax.crypto.BadPaddingException</PRE>
<DL>
<DD>Decrypts the given encrypted content encryption key for a <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>.
 <p>
 CMS <code>EnvelopedData</code> uses the <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> type for
 encrypting the secret content encryption key with the public key of
 the recipient. Currently in general RSA PKCS#1v1.5 is used for key
 transport. If rsaEncryption is requested as key encryption algorithm
 this method uses a RSA Cipher ("RSA/ECB/PKCS1Padding/Encrypt") for
 decrypting the encrypted content encryption key with the supplied 
 private key of the recipient. If another algorithm than RSA is requested,
 this method throws a NoSuchAlgorithmException. An application wishing to
 support another algorithm may override this method.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#decryptKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.lang.String)">decryptKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encryptedKey</CODE> - the encrypted content encryption key to be decrypted<DD><CODE>kea</CODE> - the key encryption alglorithm to be used, e.g. rsaEncryption<DD><CODE>recipientKey</CODE> - the private key of the recipient to be used for decrypting
                     the encrypted content encryption key<DD><CODE>cekAlgorithmName</CODE> - the name of the content encryption key (e.g. "DES") to be set for the
                         SecretKey object created by this method
<DT><B>Returns:</B><DD>the decrypted content encryption key
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested algorithm is not available
<DD><CODE>java.security.InvalidKeyException</CODE> - if the decryption key is not valid
<DD><CODE>javax.crypto.NoSuchPaddingException</CODE> - if the required padding scheme is not supported
<DD><CODE>javax.crypto.BadPaddingException</CODE> - if an padding error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createSharedKeyEncryptionKey(iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, int, byte[], java.lang.String)"><!-- --></A><H3>
createSharedKeyEncryptionKey</H3>
<PRE>
public javax.crypto.SecretKey <B>createSharedKeyEncryptionKey</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;keyAgreeAlg,
                                                           java.security.PrivateKey&nbsp;myKey,
                                                           java.security.PublicKey&nbsp;otherKey,
                                                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
                                                           int&nbsp;kekLength,
                                                           byte[]&nbsp;ukm,
                                                           java.lang.String&nbsp;kekName)
                                                    throws java.security.NoSuchAlgorithmException,
                                                           java.security.InvalidKeyException,
                                                           java.security.InvalidAlgorithmParameterException</PRE>
<DL>
<DD>Create a shared secret key encryption key for the given key agree algorithm.
 <p> 
 Creating a shared key encryption key is required when a key agreement algorithm
 is used as key management protocol for the recipient of an EnvelopedData or
 AuthenticatedData object. The shared key encryption key will be used by an
 <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A> to encrypt
 the secret content encryption key or Mac key.
 <p>
 This method only works for Ephemeral and Static Static Difiie Hellman (ESDH, SSDH).
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#createSharedKeyEncryptionKey(iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, int, byte[], java.lang.String)">createSharedKeyEncryptionKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyAgreeAlg</CODE> - the key agreement algorithm<DD><CODE>myKey</CODE> - the private key agreement key of the one party<DD><CODE>otherKey</CODE> - the public key agreement key of the other party<DD><CODE>kea</CODE> - the key ancryption algorithm (may be required for kek generation)<DD><CODE>kekLength</CODE> - the length of the shared key encryption key to be generated<DD><CODE>ukm</CODE> - any user keying material that may be required for kek generation<DD><CODE>kekName</CODE> - the name of the key encryption algorithm
<DT><B>Returns:</B><DD>the shared key encryption key generated
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested algorithm is not available
<DD><CODE>java.security.InvalidKeyException</CODE> - if there is a key related problem
<DD><CODE>java.security.InvalidAlgorithmParameterException</CODE> - if the parameters are invalid</DL>
</DD>
</DL>
<HR>

<A NAME="checkDomainParameters(java.security.PrivateKey, java.security.PublicKey)"><!-- --></A><H3>
checkDomainParameters</H3>
<PRE>
public void <B>checkDomainParameters</B>(java.security.PrivateKey&nbsp;myKey,
                                  java.security.PublicKey&nbsp;otherKey)
                           throws java.security.InvalidParameterException</PRE>
<DL>
<DD>Checks if the given private and public key agreement keys have the same domain
 parameters.
 <p>
 If the supplied keys are ESDH keys the parameters are checked.
 Otherwiese <code>super.checkDomainParameters</code> is called.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#checkDomainParameters(java.security.PrivateKey, java.security.PublicKey)">checkDomainParameters</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>myKey</CODE> - the private key of the first party<DD><CODE>otherKey</CODE> - the public key of the other party
<DT><B>Throws:</B>
<DD><CODE>InvalidParameterEyception</CODE> - if the domain parameters do not match
<DD><CODE>java.security.InvalidParameterException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="generateKeyAgreementKeyPair(iaik.asn1.structures.AlgorithmID, java.security.PublicKey)"><!-- --></A><H3>
generateKeyAgreementKeyPair</H3>
<PRE>
public java.security.KeyPair <B>generateKeyAgreementKeyPair</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;keyAgreeAlgorithm,
                                                         java.security.PublicKey&nbsp;otherKey)
                                                  throws java.security.NoSuchAlgorithmException,
                                                         java.security.InvalidKeyException,
                                                         java.security.InvalidAlgorithmParameterException</PRE>
<DL>
<DD>Generates a key pair with same domain parameters as the given public key
 for the given key agreement method.
 <p>
 This method is called by the library for creating the originator key pair if
 the <A HREF="../../iaik/cms/OriginatorPublicKey.html" title="class in iaik.cms"><CODE>OriginatorPublicKey</CODE></A> alternative is used
 for representing the public key of the originator within a <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>. The public key supplied
 to this method is the one of the recipient and the key pair returned by this
 method must have domain parameters matching to those of the given recipient public
 key. Note that ephemeral static Diffie Hellmean (ESDH) is the default key
 agreement method used by the CMS types <code>EnvelopedData</code> and
 <code>AuthenticatedData</code>. According <i>RFC 5652</i> the 
 <code>OriginatorPublicKey</code> has to be used for representing the public
 key of the originator if ESDH is used as key agreement algorithm.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#generateKeyAgreementKeyPair(iaik.asn1.structures.AlgorithmID, java.security.PublicKey)">generateKeyAgreementKeyPair</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyAgreeAlgorithm</CODE> - the key agreement algorithm to be used<DD><CODE>otherKey</CODE> - the public key of the other party
<DT><B>Returns:</B><DD>the originator key pair with domain parameters matching to those of
         the supplied key of the other party
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested algorithm is not available
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not appropriate for the key agreement algorithm
<DD><CODE>java.security.InvalidAlgorithmParameterException</CODE> - if the parameters are invalid</DL>
</DD>
</DL>
<HR>

<A NAME="getASN1OriginatorPublicKey(java.security.PublicKey)"><!-- --></A><H3>
getASN1OriginatorPublicKey</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>getASN1OriginatorPublicKey</B>(java.security.PublicKey&nbsp;originatorPublicKey)
                                      throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Gets an ASN.1 representation of the provided originator public key.
 <p>
 For some key agree algorithms CMS may require a special key encoding for the <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A> <A HREF="../../iaik/cms/OriginatorPublicKey.html" title="class in iaik.cms"><CODE>OriginatorPublicKey</CODE></A> choice. According to <a href = http://www.ietf.org/rfc/rfc3370.txt" target="_blank">
 RFC&nbsp;3370</a> (Cryptographic Message Syntax Algorithms), ESDH public keys have to
 be encoded with absent parameters in their AlgorithmID field when encoded as originator
 public keys:
 <pre>
 The originatorKey algorithm field MUST contain the dh-public-number
 object identifier with absent parameters.  The originatorKey
 publicKey field MUST contain the sender's ephemeral public key.
 </pre>
 If the supplied key is an ESDH key this method returns an ASN.1 representation with
 absent parameters. Otherwise it simply calls super.getASN1OriginatorPublicKey.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#getASN1OriginatorPublicKey(java.security.PublicKey)">getASN1OriginatorPublicKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>originatorPublicKey</CODE> - the originator public key from which to get an ASN.1 representation
<DT><B>Returns:</B><DD>the ASN.1 representation of the originator public key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the key cannot be ASN.1 represented</DL>
</DD>
</DL>
<HR>

<A NAME="getAlgorithmParameterSpec(iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
getAlgorithmParameterSpec</H3>
<PRE>
public java.security.spec.AlgorithmParameterSpec <B>getAlgorithmParameterSpec</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;algID)
                                                                    throws java.security.spec.InvalidParameterSpecException</PRE>
<DL>
<DD>Gets algorithm parameter specification from the given AlgorithmID.
 <p>
 The IaikProvider uses this method to get paramaters from an RSA-PSS signature
 algorithm id. If PSS parameters are included, they are returned as
 <code>iaik.pkcs.pkcs1.RSAPssParameterSpec</code> object; otherwise (for
 any other algorithm) this method returns <code>null</code>.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameterSpec(iaik.asn1.structures.AlgorithmID)">getAlgorithmParameterSpec</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>algID</CODE> - the AlgorithmID from which to get the parameter specification
<DT><B>Returns:</B><DD>a RSAPssParameterSpec object, if the supplied AlgorithmID specifies the
         RSA-PSS signature algorithm (with included parameters); <code>null</code>
         for any other algorithm
<DT><B>Throws:</B>
<DD><CODE>java.security.InvalidParameterException</CODE> - if an error occurs when trying to fetch the algorithm parameter
            specification
<DD><CODE>java.security.spec.InvalidParameterSpecException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPBEKey(char[], iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
getPBEKey</H3>
<PRE>
public java.security.Key <B>getPBEKey</B>(char[]&nbsp;password,
                                   <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;pbeAlg)
                            throws java.security.NoSuchAlgorithmException,
                                   java.security.spec.InvalidKeySpecException</PRE>
<DL>
<DD>Creates secret key from the supplied password using the specified
 PBE algorithm.

 If a PKCS#5 PBE algorithm is used, a PBEKey is created, otherwise
 (for PKCS#12 PBE algorithms) a PBEKeyBMP.
 (pbeWithMD5AndDES_CBC (PKCS#5) needs a PBEKey and
 all the pbe ciphers defined in PKCS#12 need a PBEKeyBMP).
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#getPBEKey(char[], iaik.asn1.structures.AlgorithmID)">getPBEKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>password</CODE> - the password for creating the secret key<DD><CODE>pbeAlg</CODE> - the PBE algorithm to be used
<DT><B>Returns:</B><DD>the secret key as instance of PBEKey or PBEKeyBMP
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested algorithm is not available
<DD><CODE>java.security.spec.InvalidKeySpecException</CODE> - if the key cannot be created from the password specification</DL>
</DD>
</DL>
<HR>

<A NAME="deriveKey(char[], iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><!-- --></A><H3>
deriveKey</H3>
<PRE>
public java.security.Key <B>deriveKey</B>(char[]&nbsp;password,
                                   <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;keyDerivationAlg,
                                   java.security.spec.AlgorithmParameterSpec&nbsp;paramSpec)
                            throws java.security.NoSuchAlgorithmException,
                                   java.security.InvalidAlgorithmParameterException</PRE>
<DL>
<DD>Uses the requested key derivation function to create a secret key from
 the supplied password.
 This method only is implemented for the PKCS#5 key derivation function
 PBKDF2. For any other key derivation algorithm the <A HREF="../../iaik/cms/SecurityProvider.html#deriveKey(char[], iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>deriveKey</CODE></A> method of the super
 <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> class is called.
 If PBKDF2 is used, the parameters may be suppled as IAIK-JCE
 <code>iaik.security.spec.PBEKeyAndParameterSpec</code> (password,
 salt, iteration count, derived key length) or as <code>
 javax.crypto.spec.PBEParameterSpec</code> (salt, iteration count).
 If the parameters are given as <code>PBEKeyAndParameterSpec</code>
 the application has take care to ensure that the passwords supplied
 by the <code>password</code> parameter and in the <code>PBEKeyAndParameterSpec</code>
 parameter are identical (i.e. this method does not look if
 they are the same). If no parameters are supplied they maybe
 parsed from the key derivation algorithm id.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#deriveKey(char[], iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)">deriveKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>password</CODE> - the password for creating the secret key<DD><CODE>keyDerivationAlg</CODE> - the key derivation function to be used<DD><CODE>paramSpec</CODE> - any required algorithm parameters; may be null
                  if no parameters are required or the parameters
                  are supplied via the AlgorithmID; may also 
                  contain the password in which case the <code>
                  password</code> parameter maybe null;
<DT><B>Returns:</B><DD>the secret key
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested key derivation function is not available
<DD><CODE>java.security.InvalidAlgorithmParameterException</CODE> - if the parameters are invalid or cannot be
                                               parsed from the algorithmID</DL>
</DD>
</DL>
<HR>

<A NAME="wrapKey(javax.crypto.SecretKey, iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.AlgorithmParameters)"><!-- --></A><H3>
wrapKey</H3>
<PRE>
public byte[] <B>wrapKey</B>(javax.crypto.SecretKey&nbsp;cek,
                      <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
                      java.security.Key&nbsp;kek,
                      java.security.AlgorithmParameters&nbsp;params)
               throws java.security.NoSuchAlgorithmException,
                      java.security.InvalidKeyException,
                      java.security.InvalidAlgorithmParameterException,
                      javax.crypto.IllegalBlockSizeException,
                      javax.crypto.BadPaddingException</PRE>
<DL>
<DD>Wraps the given secret content encryption key for a 
 <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, or <A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>.
 <p>
 This method only is implemented for wrapping a content encryption
 key with the PWRI-KEK ("1.2.840.113549.1.9.16.3.9") algorithm presented
 in <a href = http://www.ietf.org/rfc/rfc3211>RFC 3211</a> (Password-based 
 Encryption for CMS), section 2.3.1:
 <pre>
 The key wrap algorithm is performed in two phases, a first phase which
 formats the CEK into a form suitable for encryption by the KEK, and a
 second phase which wraps the formatted CEK using the KEK.

 Key formatting: Create a formatted CEK block consisting of the
 following:

  1. A one-byte count of the number of bytes in the CEK.

  2. A check value containing the bitwise complement of the first
     three bytes of the CEK.

  3. The CEK.

  4. Enough random padding data to make the CEK data block a
     multiple of the KEK block length and at least two KEK cipher
     blocks long (the fact that 32 bits of count+check value are
     used means that even with a 40-bit CEK, the resulting data size
     will always be at least two (64-bit) cipher blocks long).  The
     padding data does not have to be cryptographically strong,
     although unpredictability helps.  Note that PKCS #5 padding is
     not used, since the length of the data is already known.

 The formatted CEK block then looks as follows:

  CEK byte count || check value || CEK || padding (if required)

 Key wrapping:

  1. Encrypt the padded key using the KEK.
  2. Without resetting the IV (that is, using the last ciphertext
     block as the IV), encrypt the encrypted padded key a second
     time.

 The resulting double-encrypted data is the EncryptedKey.
 </pre>
 For any other key encryption algorithm (kea) method
 <code>wrapKey</code> of super class <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> is called.
 <p>
 For PWRI-KEK this method expects that the <A HREF="../../iaik/cms/CMSAlgorithmID.html#pwri_kek"><CODE>kea</CODE></A> algorithm ID contains the kek encryption algorithm (and any associated
 parameters) to be used. Any parameters supplied by <code>params</code>
 are ignored. The supplied <code>kek</code> key encryption key already 
 has to be the one derived from a password (if PBE is used).
 <P>
 Since PWRI-KEK requires the usage of initialization vectors it only may
 work properly with kek ciphers and modes using theiselves an iv (e.g.
 TripleDES in CBC mode.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#wrapKey(javax.crypto.SecretKey, iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.AlgorithmParameters)">wrapKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cek</CODE> - the secret content encryption key to be wrapped (encrypted)<DD><CODE>kea</CODE> - the key wrap (encryption) alglorithm to be used, PWRI-KEK<DD><CODE>kek</CODE> - the key encryption key to be used for encrypting the content 
            encryption key<DD><CODE>params</CODE> - any algorithm parameters required for initializing the
               key encryption cipher; ignored for PWRI-KEK
<DT><B>Returns:</B><DD>the wrapped (encrypted) content encryption key as byte array
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested algorithm is not available
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key encryption key is not valid
<DD><CODE>java.security.InvalidAlgorithmParameterException</CODE> - if the parameters cannot be parsed from
                                               the kea algorithm id or are not valid
<DD><CODE>javax.crypto.IllegalBlockSizeException</CODE> - if the cipherblock size is not correct
<DD><CODE>javax.crypto.BadPaddingException</CODE> - if an padding error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="unwrapKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.AlgorithmParameters, java.lang.String)"><!-- --></A><H3>
unwrapKey</H3>
<PRE>
public javax.crypto.SecretKey <B>unwrapKey</B>(byte[]&nbsp;wrappedCek,
                                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
                                        java.security.Key&nbsp;kek,
                                        java.security.AlgorithmParameters&nbsp;params,
                                        java.lang.String&nbsp;cekAlgName)
                                 throws java.security.NoSuchAlgorithmException,
                                        java.security.InvalidKeyException,
                                        java.security.InvalidAlgorithmParameterException</PRE>
<DL>
<DD>Unwraps the given wrapped (encrypted) secret content encryption key for a 
 <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>.
 <p>
 <p>
 This method only is implemented for unwrapping an encrypted content encryption
 key with the PWRI-KEK ("1.2.840.113549.1.9.16.3.9") algorithm presented
 in <a href = http://www.ietf.org/rfc/rfc3211>RFC 3211</a> (Password-based 
 Encryption for CMS), section 2.3.2:
 <pre>
 2.3.2 Key Unwrap
 
 Key unwrapping:
 
    1. Using the n-1'th ciphertext block as the IV, decrypt the n'th
       ciphertext block.
 
    2. Using the decrypted n'th ciphertext block as the IV, decrypt
       the 1st ... n-1'th ciphertext blocks.  This strips the outer
       layer of encryption.
 
    3. Decrypt the inner layer of encryption using the KEK.
 
 Key format verification:
 
   1a. If the CEK byte count is less than the minimum allowed key
       size (usually 5 bytes for 40-bit keys) or greater than the
       wrapped CEK length or not valid for the CEK algorithm (eg not
       16 or 24 bytes for triple DES), the KEK was invalid.
 
   1b. If the bitwise complement of the key check value doesn't match
       the first three bytes of the key, the KEK was invalid.
 </pre>
 For any other key encryption algorithm (kea) method
 <code>unwrapKey</code> of super class <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A> is called.
 <p>
 For PWRI-KEK this method expects that the <A HREF="../../iaik/cms/CMSAlgorithmID.html#pwri_kek"><CODE>kea</CODE></A> algorithm ID contains the kek encryption algorithm (and any associated
 parameters) to be used. Any parameters supplied by <code>params</code>
 are ignored. The supplied <code>kek</code> key encryption key already 
 has to be the one derived from a password (if PBE is used).
 <P>
 Since PWRI-KEK requires the usage of initialization vectors it only may
 work properly with kek ciphers and modes using theirselves an iv (e.g.
 TripleDES in CBC mode). For that reason it is not possible to implement
 PWRI-KEK in really algorithm independet manner. For instance, the RC2
 algorithm not only uses an iv, but also a second parameter from which 
 the effective key length is calculated. So a RC2 cipher in CBC mode
 has to be initialized with iv and the effective key length parameters.
 As seen from above, the PWRI-KEK algorithm initializes decryption
 algorithm three times, but only the last (innermost)
 decryption phase uses the iv included in the kek algorithm id. For
 RC2 this means that the RC2 Cipher engine has to be initialized
 three times with same effective key length (derived from the
 kek AlgorithmID parameters) but different iv (only the last got
 from the AlgorithmID parameters). For that reason this method
 gets the algorithm parameters from the kek AlgorithmID and then
 calls method <A HREF="../../iaik/cms/IaikProvider.html#setIv(java.security.AlgorithmParameters, byte[])"><CODE>setIv</CODE></A> to convert the (RC2) AlgorithmParameters
 into a (RC2) AlgorithmParameterSpec object containing the requested iv:
 <pre>
 ...
 AlgorithmParameters kekParams = kekEncrAlgID.getAlgorithmParameters();
 byte[] iv = ...;
 AlgorithmParameterSpec kekParamSpec = setIv(kekParams, iv)
 </pre>
 For algorithms that only use an iv as parameter, method <code>setIv</code>
 simply returns an <code>IvParameterSpec</code> object with the
 given iv.
 <p>
 Also unwrap step 1a from the key format verification cannot be implemented in
 algorithm independet manner:
 <pre>
   1a. If the CEK byte count is less than the minimum allowed key
       size (usually 5 bytes for 40-bit keys) or greater than the
       wrapped CEK length or not valid for the CEK algorithm (eg not
       16 or 24 bytes for triple DES), the KEK was invalid.
 </pre>
 Ckecking if the CEK byte count is greater than the wrapped CEK is quite
 easy, however looking if the CEK byte count is less than the minimum allowed key
 size or not valid for the CEK algorithm requires information of the
 kek algorithm itself. However, a violatoin of any of these two requirements
 will be detected later when attemping to use the unwrapped CEK with
 the cooresponding Cipher engine. Thus checking this could be omitted here.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#unwrapKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.AlgorithmParameters, java.lang.String)">unwrapKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>wrappedCek</CODE> - the wrapped secret content encryption key to be unwrapped (decrypted)<DD><CODE>kea</CODE> - the key (un)wrap (en/decryption) alglorithm to be used, PWRI-KEK<DD><CODE>kek</CODE> - the key encryption key to be used for decrypting the encrypted content 
            encryption key<DD><CODE>params</CODE> - any algorithm parameters required for initializing the cipher;
               ignored for PWRI-KEK<DD><CODE>cekAlgName</CODE> - the name of the content encryption cipher (required by
                   the <code>unwrap</code> method of a JCE cipher engine)
<DT><B>Returns:</B><DD>the unwrapped (decrypted) content encryption key
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested algorithm is not available
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key encryption key is not valid
<DD><CODE>java.security.InvalidAlgorithmParameterException</CODE> - if the parameters cannot be parsed
                                               or are not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setIv(java.security.AlgorithmParameters, byte[])"><!-- --></A><H3>
setIv</H3>
<PRE>
public java.security.spec.AlgorithmParameterSpec <B>setIv</B>(java.security.AlgorithmParameters&nbsp;params,
                                                       byte[]&nbsp;iv)
                                                throws java.security.spec.InvalidParameterSpecException</PRE>
<DL>
<DD>Creates an AlgorithmParameterSpec containing any parameters from
 the given AlgorithmParameters object and the given iv.
 This method is called by method <A HREF="../../iaik/cms/IaikProvider.html#unwrapKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.Key, java.security.AlgorithmParameters, java.lang.String)"><CODE>unwrapKey</CODE></A> for
 obtaining an algorithm dependent parameter specification containing
 the iv required by the <A HREF="../../iaik/cms/CMSAlgorithmID.html#pwri_kek"><CODE>PWRI-KEK</CODE></A> unwrap algorithm as specified in <a href =
 http://www.ietf.org/rfc/rfc3211>RFC 3211</a> (Password-based 
 Encryption for CMS), section 2.3.2:
 <pre>
 2.3.2 Key Unwrap
 
 Key unwrapping:
 
    1. Using the n-1'th ciphertext block as the IV, decrypt the n'th
       ciphertext block.
 
    2. Using the decrypted n'th ciphertext block as the IV, decrypt
       the 1st ... n-1'th ciphertext blocks.  This strips the outer
       layer of encryption.
 
    3. Decrypt the inner layer of encryption using the KEK.
 
 Key format verification:
 
   1a. If the CEK byte count is less than the minimum allowed key
       size (usually 5 bytes for 40-bit keys) or greater than the
       wrapped CEK length or not valid for the CEK algorithm (eg not
       16 or 24 bytes for triple DES), the KEK was invalid.
 
   1b. If the bitwise complement of the key check value doesn't match
       the first three bytes of the key, the KEK was invalid.
 </pre>
 <p>
 Since PWRI-KEK requires the usage of initialization vectors it only may
 work properly with kek ciphers and modes using theirselves an iv (e.g.
 TripleDES in CBC mode). For that reason it is not possible to implement
 PWRI-KEK in really algorithm independet manner. For instance, the RC2
 algorithm not only uses an iv, but also a second parameter from which 
 the effective key length is calculated. So a RC2 cipher in CBC mode
 has to be initialized with iv and the effective key length parameters.
 As seen from above, the PWRI-KEK algorithm initializes decryption
 algorithm three times, but only the last (innermost)
 decryption phase uses the iv included in the kek algorithm id. For
 RC2 this means that the RC2 Cipher engine has to be initialized
 three times with same effective key length (derived from the
 kek AlgorithmID parameters) but different iv (only the last got
 from the AlgorithmID parameters). For that reason this method
 is used to convert the (RC2) AlgorithmParameters got from the KEK
 algorithmID into a (RC2) AlgorithmParameterSpec object containing the
 requested iv:
 <pre>
 ...
 AlgorithmParameters kekParams = kekEncrAlgID.getAlgorithmParameters();
 byte[] iv = ...;
 AlgorithmParameterSpec kekParamSpec = setIv(kekParams, iv)
 </pre>
 For algorithms that only use an iv as parameter,this method
 simply returns an <code>IvParameterSpec</code> object with the
 given iv.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>params</CODE> - the AlgorithmParameters (CAST128Parameters, RC2Parameters, RC5Parameters,
                                        IvParameters, etc., or <code>null</code><DD><CODE>iv</CODE> - the iv to be set
<DT><B>Returns:</B><DD>an AlgorithmParameterSpec object with the given iv and any other
         parameter values obtained from the supplied AlgorithmParameters (i.e.
         a CAST128ParameterSpec, RC2ParameterSpec, or RC5ParameterSpec
         object for CAST128, RC2, or RC5 parameters, or an IvParameterSpec
         object in any other case
<DT><B>Throws:</B>
<DD><CODE>java.security.spec.InvalidParameterSpecException</CODE> - if the parameter specification cannot
                                          be built</DL>
</DD>
</DL>
<HR>

<A NAME="getSecureRandom()"><!-- --></A><H3>
getSecureRandom</H3>
<PRE>
public java.security.SecureRandom <B>getSecureRandom</B>()</PRE>
<DL>
<DD>Returns an instance of the default SecureRandom class set in 
 <CODE>iaik.security.random.SecRandom</CODE>. By default this method 
 returns a new SecureRandom anytime when called. However, when a 
 SecureRandom has been explicitly set by calling method <A HREF="../../iaik/cms/SecurityProvider.html#setSecureRandom(java.security.SecureRandom)"><CODE>setSecureRandom</CODE></A>, this SecureRandom is returned.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#getSecureRandom()">getSecureRandom</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the SecureRandom</DL>
</DD>
</DL>
<HR>

<A NAME="generateKey(iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
generateKey</H3>
<PRE>
public javax.crypto.SecretKey <B>generateKey</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;algorithm,
                                          int&nbsp;keyLength)
                                   throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Generates a SecretKey for the requested algorithm.
 <P>
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, int)">generateKey</A></CODE> in class <CODE><A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>algorithm</CODE> - the requested algorithm<DD><CODE>keyLength</CODE> - the length of the key to be generated, may be required for
                  algorithms with variable key size
<DT><B>Returns:</B><DD>the generated secret key
<DT><B>Throws:</B>
<DD><CODE>NoSuchSuchAlgorithmException</CODE> - if the key for the requested
                                         algorithm cannot be created
<DD><CODE>java.security.NoSuchAlgorithmException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="turnOffIAIKProviderVersionCheck()"><!-- --></A><H3>
turnOffIAIKProviderVersionCheck</H3>
<PRE>
public static void <B>turnOffIAIKProviderVersionCheck</B>()</PRE>
<DL>
<DD>If the IAIK crypto provider is used but its version is not appropriate for
 this version of IAIK-CMS, an warning message is printed to System.out to
 use a more recent version of IAIK-JCE. This warning message can be turned off
 when calling this method.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/IaikJCECipher.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/InputStreamAuthCipherEngine.html" title="interface in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/IaikProvider.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="IaikProvider.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
