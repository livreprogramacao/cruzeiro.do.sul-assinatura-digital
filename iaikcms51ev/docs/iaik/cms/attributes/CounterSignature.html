<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:14 GMT 2016 -->
<TITLE>
CounterSignature (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.attributes.CounterSignature class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="CounterSignature (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../iaik/cms/attributes/CMSMessageDigest.html" title="class in iaik.cms.attributes"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../iaik/cms/attributes/SigningTime.html" title="class in iaik.cms.attributes"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?iaik/cms/attributes/CounterSignature.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CounterSignature.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms.attributes</FONT>
<BR>
Class CounterSignature</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">iaik.asn1.structures.AttributeValue</A>
      <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.attributes.CounterSignature</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Type.html" title="class or interface in iaik.asn1">ASN1Type</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>CounterSignature</B><DT>extends <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A></DL>
</PRE>

<P>
The CMS CounterSignature attribute.
 <p>
 The Cryptographic Message Syntax (CMS) (<a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>) 
 specifies the <code>CounterSignature</code> attribute to may be included as an unsigned attribute into a 
 <A HREF="../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> for counter signing (signing in serial) the signature 
 value of a SignerInfo included in a SignedData. 
 The value of a CounterSignature attribute itself is a SignerInfo:
 <pre>
 CounterSignature ::= SignerInfo

 id-countersignature OBJECT IDENTIFIER ::= { iso(1) member-body(2)
         us(840) rsadsi(113549) pkcs(1) pkcs9(9) 6 }
 </pre>
 <p>
 Since being itself a SignerInfo, CounterSignature objects may be created and supplied
 with attributes -- note, that the content-type attribute is not required since a
 counter signature has no content type -- in similar way as done for ordinary 
 <A HREF="../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfos</CODE></A>. However, whereas signing and verifying of ordinary
 SignerInfos usually is controlled from the SignedData(Stream) object they belong to, 
 an application explicitly has to call proper <code>counterSign</code> or <code>verify</code>
 methods thereby specifying the <A HREF="../../../iaik/cms/attributes/CounterSignature.html#counterSign(byte[])"><CODE>signature value</CODE></A>, 
 <A HREF="../../../iaik/cms/attributes/CounterSignature.html#counterSign(iaik.cms.SignerInfo)"><CODE>SignerInfo</CODE></A> or other <A HREF="../../../iaik/cms/attributes/CounterSignature.html#counterSign(iaik.cms.attributes.CounterSignature)"><CODE>CounterSignature</CODE></A> object to be counter signed, e.g.:
 <pre>
 // the SignerInfo to be counter signed:
 SignerInfo signerInfo = ...;
 // the cert of the counter signer
 X509Certificate counterCert = ...;
 // the private key of the counter signer:
 PrivateKey counterKey = ...;
 // create a CounterSignature for the counter signer:
 CounterSignature counterSignature = 
    new CounterSignature(new IssuerAndSerialNumber(counterCert), AlgorithmID.sha1, counterKey);
 ...
 // add any attributes, if required
 ...
 // now counter sign the SignerInfo
 counterSignature.counterSign(signerInfo);
 // and add the counter signature as unsigned attribute
 Attribute[] unsignedAttributes = new Attribute[] { new Attribute(counterSignature) };
 signerInfo.addUnsignedAttributes(unsignedAttributes);
 ...
 </pre>
 On the verification end get the CounterSignature unsigned attribute and
 call a proper <code>verify</code> method thereby specifying the <A HREF="../../../iaik/cms/attributes/CounterSignature.html#verify(java.security.PublicKey, byte[])"><CODE>signature value</CODE></A>, 
 <A HREF="../../../iaik/cms/attributes/CounterSignature.html#verify(java.security.PublicKey, iaik.cms.SignerInfo)"><CODE>SignerInfo</CODE></A> or other <A HREF="../../../iaik/cms/attributes/CounterSignature.html#verify(java.security.PublicKey, iaik.cms.attributes.CounterSignature)"><CODE>CounterSignature</CODE></A> object to be "counter" verified, e.g.:
 <pre>
 // the SignerInfo parsed from a SignedData
 SignerInfo signerInfo = ...;
 // look for a CounterSignature attribute
 Attribute counterSignatureAttribute = signerInfo.getUnsignedAttribute(ObjectID.countersignature);
 if (counterSignatureAttribute != null) {
   // check for any included CounterSignature
   AttributeValue[] counterSignatures = counterSignatureAttribute.getAttributeValues();
   System.out.println("This SignerInfo is counter signed from: ");
   // may have more than one values
   for (int j = 0; j < counterSignatures.length; j++) {
     CounterSignature counterSignature = (CounterSignature)counterSignatures[i];
     try {
       if (counterSignature.verify(counterCert.getPublicKey(), signerInfo)) {
         System.out.println("Signature OK from counter signer: "+counterSignature.getSignerIdentifier());  
       } else {
         System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
       }  
     } catch (SignatureException ex) {
       System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
     }  
   }
 }
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A>, 
<A HREF="../../../iaik/cms/SignedDataStream.html" title="class in iaik.cms"><CODE>SignedDataStream</CODE></A>, 
<A HREF="../../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#oid">oid</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The attributeType object identifier of the CMS CounterSignature attribute.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#CounterSignature()">CounterSignature</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default constructor.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#CounterSignature(iaik.asn1.ASN1Object)">CounterSignature</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>CounterSignature</code> from an ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#CounterSignature(iaik.cms.CertificateIdentifier, iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey)">CounterSignature</A></B>(<A HREF="../../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier,
                 <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                 <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                 java.security.PrivateKey&nbsp;privateKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new CounterSignature from given signerIdentifier,
 and digestAlgorithm ID, signature algorithmID, and the 
 signer private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#CounterSignature(iaik.cms.CertificateIdentifier, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey)">CounterSignature</A></B>(<A HREF="../../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier,
                 <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                 java.security.PrivateKey&nbsp;privateKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new CounterSignature from given SignerIdentifier,
 digestAlgorithm ID, and the counter signer private key.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#addSignedAttribute(iaik.asn1.structures.Attribute)">addSignedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>&nbsp;attribute)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given attribute to the set of signed attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#addSignedAttributes(iaik.asn1.structures.Attribute[])">addSignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given attributes to the set of signed attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#addUnsignedAttribute(iaik.asn1.structures.Attribute)">addUnsignedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>&nbsp;attribute)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given attribute to the set of unsigned attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#addUnsignedAttributes(iaik.asn1.structures.Attribute[])">addUnsignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given attributes to the set of unsigned attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#counterSign(byte[])">counterSign</A></B>(byte[]&nbsp;signatureToBeCounterSigned)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counter signs the given signature value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#counterSign(iaik.cms.attributes.CounterSignature)">counterSign</A></B>(<A HREF="../../../iaik/cms/attributes/CounterSignature.html" title="class in iaik.cms.attributes">CounterSignature</A>&nbsp;counterSignature)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counter signs the given CounterSignature.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#counterSign(iaik.cms.SignerInfo)">counterSign</A></B>(<A HREF="../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counter signs the given SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#decode(iaik.asn1.ASN1Object)">decode</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decodes the given ASN.1 <code>CounterSignature</code> object for parsing
 the internal structure.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getAttributeType()">getAttributeType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the OID identifying the CMS CounterSignature attribute type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getDigestAlgorithm()">getDigestAlgorithm</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the AlgorithmID of the message-digest algorithm that has
 been used for digesting the content and any signed attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSecurityProvider()">getSecurityProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityProvider installed for this CounterSignature.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignatureAlgorithm()">getSignatureAlgorithm</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the signature algorithm used for calculating the signature
 and associated information with the signer private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignatureValue()">getSignatureValue</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the signature value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignedAttribute(iaik.asn1.ObjectID)">getSignedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first signed attribute matching to the given ObjectID, if 
 included in this CounterSignature object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignedAttributes()">getSignedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a set of attributes that are signed by the signer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignedAttributes(iaik.asn1.ObjectID)">getSignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all signed attributes matching to the given attribute type, if 
 included in this CounterSignature object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignedAttributeValue(iaik.asn1.ObjectID)">getSignedAttributeValue</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the attribute value of a single valued signed attribute with the given type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignedDigest()">getSignedDigest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the message digest included in the signed attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignerIdentifier()">getSignerIdentifier</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns information about the signer certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess">SigningCertificate</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSigningCertificateAttribute()">getSigningCertificateAttribute</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SigningCertificate attribute, if included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../iaik/smime/ess/SigningCertificateV2.html" title="class in iaik.smime.ess">SigningCertificateV2</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSigningCertificateV2Attribute()">getSigningCertificateV2Attribute</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SigningCertificateV2 attribute, if included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getUnsignedAttribute(iaik.asn1.ObjectID)">getUnsignedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first unsigned attribute matching to the given ObjectID, if 
 included in this CounterSignature object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getUnsignedAttributes()">getUnsignedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a set of attributes that are <i>not</i> signed by the signer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getUnsignedAttributes(iaik.asn1.ObjectID)">getUnsignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all unsigned attributes matching to the given attribute type, if 
 included in this CounterSignature object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getUnsignedAttributeValue(iaik.asn1.ObjectID)">getUnsignedAttributeValue</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the attribute value of a single valued unsigned attribute with the given type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#getVersion()">getVersion</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the synatx version number (1 or 3).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#isSignerCertificate(iaik.x509.X509Certificate)">isSignerCertificate</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks whether the supplied certificate actually is the certificate
 of the signer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#removeSignedAttribute(iaik.asn1.ObjectID)">removeSignedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;attributeType)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes all signed attributes with the given attribute type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#removeUnsignedAttribute(iaik.asn1.ObjectID)">removeUnsignedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;attributeType)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes all unsigned attributes with the given attribute type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A></B>(<A HREF="../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityProvider for this CounterSignature.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#setSignatureValue(byte[])">setSignatureValue</A></B>(byte[]&nbsp;signatureValue)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the signature value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#setSignedAttributes(iaik.asn1.structures.Attribute[])">setSignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of attributes to be signed along with the content 
 to be signed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#setUnsignedAttributes(iaik.asn1.structures.Attribute[])">setUnsignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of attributes that are <i>not</i> signed by the signer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#toASN1Object()">toASN1Object</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this <code>CounterSignature</code> as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some information about this
 <code>CounterSignature</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#toString(boolean)">toString</A></B>(boolean&nbsp;detailed)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some - if requested - detailed information 
 about this <code>CounterSignature</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#verify(java.security.PublicKey, byte[])">verify</A></B>(java.security.PublicKey&nbsp;publicKey,
       byte[]&nbsp;signatureThatWasCounterSigned)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the counter signature of the given signature value with the given public key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#verify(java.security.PublicKey, iaik.cms.attributes.CounterSignature)">verify</A></B>(java.security.PublicKey&nbsp;publicKey,
       <A HREF="../../../iaik/cms/attributes/CounterSignature.html" title="class in iaik.cms.attributes">CounterSignature</A>&nbsp;counterSignature)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the counter signature of the given CounterSiganture with the given public key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../iaik/cms/attributes/CounterSignature.html#verify(java.security.PublicKey, iaik.cms.SignerInfo)">verify</A></B>(java.security.PublicKey&nbsp;publicKey,
       <A HREF="../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the counter signature of the given SignerInfo with the given public key.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_iaik.asn1.structures.AttributeValue"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class iaik.asn1.structures.<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html#getName()" title="class or interface in iaik.asn1.structures">getName</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html#multipleAllowed()" title="class or interface in iaik.asn1.structures">multipleAllowed</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="oid"><!-- --></A><H3>
oid</H3>
<PRE>
public static final <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>oid</B></PRE>
<DL>
<DD>The attributeType object identifier of the CMS CounterSignature attribute.
 The corresponding OID string is "1.2.840.113549.1.9.6".
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="CounterSignature()"><!-- --></A><H3>
CounterSignature</H3>
<PRE>
public <B>CounterSignature</B>()</PRE>
<DL>
<DD>Default constructor. Creates an empty <code>CounterSignature</code>
 object and sets the SignerInfo version number to 1, and the signature
 algorithm ID to rsaEncryption.
<P>
</DL>
<HR>

<A NAME="CounterSignature(iaik.cms.CertificateIdentifier, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey)"><!-- --></A><H3>
CounterSignature</H3>
<PRE>
public <B>CounterSignature</B>(<A HREF="../../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                        java.security.PrivateKey&nbsp;privateKey)</PRE>
<DL>
<DD>Creates a new CounterSignature from given SignerIdentifier,
 digestAlgorithm ID, and the counter signer private key.
 <p>
 The <code>signerIdentifier</code> identifies the signer certificate either 
 by <A HREF="../../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>issuer distinguished name and 
 issuer-specific serial number</CODE></A> or by <A HREF="../../../iaik/cms/SubjectKeyID.html" title="class in iaik.cms"><CODE>SubjectKeyIdentifier</CODE></A>. The digestAlgorithm ID specifies the message digest
 algorithm used for calculating the digest of the content and any signed 
 information. The private key is used for calculating the signature.
 When using this constructor, the signature is calculated with the PKCS#1 
 <i>rsaEncryption</i> method.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>signerIdentifier</CODE> - information about the counter signer certificate.<DD><CODE>digestAlgorithm</CODE> - the AlgorithmID of the message-digest algorithm<DD><CODE>privateKey</CODE> - the counter signer private key to be used for signing
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the supplied signerIdentifier is not a 
                                     SubjectKeyID or IssuerAndSerialNumber</DL>
</DL>
<HR>

<A NAME="CounterSignature(iaik.cms.CertificateIdentifier, iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey)"><!-- --></A><H3>
CounterSignature</H3>
<PRE>
public <B>CounterSignature</B>(<A HREF="../../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                        java.security.PrivateKey&nbsp;privateKey)</PRE>
<DL>
<DD>Creates a new CounterSignature from given signerIdentifier,
 and digestAlgorithm ID, signature algorithmID, and the 
 signer private key.
 <p>
 The <code>signerIdentifier</code> identifies the signer certificate either 
 by <A HREF="../../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>issuer distinguished name and 
 issuer-specific serial number</CODE></A> or by <A HREF="../../../iaik/cms/SubjectKeyID.html" title="class in iaik.cms"><CODE>SubjectKeyIdentifier</CODE></A>. The digestAlgorithm ID specifies the message digest 
 algorithm used for calculating the digest of the content and any signed 
 information. The private key is used for calculating the signature with
 the given signature algorithm.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>signerIdentifier</CODE> - information about the counter igner certificate.<DD><CODE>digestAlgorithm</CODE> - the AlgorithmID of the message-digest algorithm<DD><CODE>signatureAlgorithm</CODE> - the algorithm to be used for signature calculation<DD><CODE>privateKey</CODE> - the counter signer private key to be used for signing
<DT><B>Throws:</B>
<DD><CODE>if</CODE> - the supplied signerIdentifier is not a SubjectKeyID or
            IssuerAndSerialNumber</DL>
</DL>
<HR>

<A NAME="CounterSignature(iaik.asn1.ASN1Object)"><!-- --></A><H3>
CounterSignature</H3>
<PRE>
public <B>CounterSignature</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)
                 throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>Creates a CMS <code>CounterSignature</code> from an ASN1Object.
 <p>
 The ASN1Object supplied to this constructor represents an 
 already exisiting <code>CounterSignature</code> object that may 
 have been created by calling <A HREF="../../../iaik/cms/attributes/CounterSignature.html#toASN1Object()"><CODE>toASN1Object</CODE></A>.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the CMS CounterSignature as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if the object can not be parsed</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setSecurityProvider(iaik.cms.SecurityProvider)"><!-- --></A><H3>
setSecurityProvider</H3>
<PRE>
public void <B>setSecurityProvider</B>(<A HREF="../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Sets the SecurityProvider for this CounterSignature.
 <p>
 This method allows to explicitly set a SecurityProvider for this CounterSignature.
 If no explicit SecurityProvider is set, the default system wide installed 
 SecurityProvider will be used for the required cryptographic operations.
 <p>
 This class may use the following method(s) of the <A HREF="../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../../iaik/cms/SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes()</CODE></A></code>
     to calculate the signature value from the encoding of the signed attributes
 <li><code><A HREF="../../../iaik/cms/SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromHash()</CODE></A></code>
     to calculate the signature value from the message hash
 <li><code><A HREF="../../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])"><CODE>getHash()</CODE></A></code>
     as may be required for cert hash calculation when querying for included <A HREF="../../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> attributes
 </ul>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityProvider</CODE> - the SecurityProvider to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityProvider()"><!-- --></A><H3>
getSecurityProvider</H3>
<PRE>
public <A HREF="../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>getSecurityProvider</B>()</PRE>
<DL>
<DD>Gets the SecurityProvider installed for this CounterSignature.
 <p>
 This class uses the following method(s) of the <A HREF="../../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../../iaik/cms/SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes()</CODE></A></code>
     to calculate the signature value from the encoding of the signed attributes
 <li><code><A HREF="../../../iaik/cms/SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromHash()</CODE></A></code>
     to calculate the signature value from the message hash
 <li><code><A HREF="../../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])"><CODE>getHash()</CODE></A></code>
     as may be required for cert hash calculation when querying for included <A HREF="../../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> or <A HREF="../../../iaik/smime/ess/SigningCertificateV2.html" title="class in iaik.smime.ess"><CODE>SigningCertificateV2</CODE></A> attributes
 </ul>
 If no explicit SecurityProvider has been <A HREF="../../../iaik/cms/attributes/CounterSignature.html#setSecurityProvider(iaik.cms.SecurityProvider)"><CODE>set</CODE></A> for this object, 
 the default system wide installed SecurityProvider will be used for the required cryptographic
 operations. However, this method will return <code>null</code> if it does not have its own
 SecurityProvider.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityProvider explicitly installed for this object, or <code>null</code> if
         this object does not have its own SecurityProvider</DL>
</DD>
</DL>
<HR>

<A NAME="decode(iaik.asn1.ASN1Object)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj)
            throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>Decodes the given ASN.1 <code>CounterSignature</code> object for parsing
 the internal structure.
 <p>
 This method internally is called when creating a CMS <code>SignerInfo
 </code>object from an already existing <code>CounterSignature</code> object, 
 supplied as ASN1Object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the CMS CounterSignature as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if the object can not be parsed</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object()"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>()
                        throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>Returns this <code>CounterSignature</code> as ASN1Object.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>this CounterSignature as ASN1Object.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="getAttributeType()"><!-- --></A><H3>
getAttributeType</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>getAttributeType</B>()</PRE>
<DL>
<DD>Returns the OID identifying the CMS CounterSignature attribute type.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html#getAttributeType()" title="class or interface in iaik.asn1.structures">getAttributeType</A></CODE> in class <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the OID identifying the CMS CounterSignature attribute type.</DL>
</DD>
</DL>
<HR>

<A NAME="setSignedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setSignedAttributes</H3>
<PRE>
public void <B>setSignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of attributes to be signed along with the content 
 to be signed.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - a set of attributes to be signed along with the content 
                   to be signed.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the given attributes contain a ContentType attribute
                                     (not allowed for CounterSignatures)</DL>
</DD>
</DL>
<HR>

<A NAME="addSignedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
addSignedAttributes</H3>
<PRE>
public void <B>addSignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Adds the given attributes to the set of signed attributes.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the attributes to be added to the signed attributes
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the given attributes contain a ContentType attribute
                                     (not allowed for CounterSignatures)</DL>
</DD>
</DL>
<HR>

<A NAME="addSignedAttribute(iaik.asn1.structures.Attribute)"><!-- --></A><H3>
addSignedAttribute</H3>
<PRE>
public void <B>addSignedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>&nbsp;attribute)</PRE>
<DL>
<DD>Adds the given attribute to the set of signed attributes.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attribute</CODE> - the attribute to be added to the signed attributes
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the given attribute is a ContentType attribute 
                                  (not allowed for CounterSignatures)</DL>
</DD>
</DL>
<HR>

<A NAME="removeSignedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
removeSignedAttribute</H3>
<PRE>
public void <B>removeSignedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;attributeType)</PRE>
<DL>
<DD>Removes all signed attributes with the given attribute type.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributeType</CODE> - the OID identifying the attribute to be removed</DL>
</DD>
</DL>
<HR>

<A NAME="getSigningCertificateAttribute()"><!-- --></A><H3>
getSigningCertificateAttribute</H3>
<PRE>
public <A HREF="../../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess">SigningCertificate</A> <B>getSigningCertificateAttribute</B>()
                                                  throws <A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Gets the SigningCertificate attribute, if included.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the SigningCertificate attribute, or <code>null</code> if
         not included
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if an error occurs while parsing for the
            SigningCertificate attribute</DL>
</DD>
</DL>
<HR>

<A NAME="getSigningCertificateV2Attribute()"><!-- --></A><H3>
getSigningCertificateV2Attribute</H3>
<PRE>
public <A HREF="../../../iaik/smime/ess/SigningCertificateV2.html" title="class in iaik.smime.ess">SigningCertificateV2</A> <B>getSigningCertificateV2Attribute</B>()
                                                      throws <A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Gets the SigningCertificateV2 attribute, if included.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the SigningCertificateV2 attribute, or <code>null</code> if
         not included
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if an error occurs while parsing for the
            SigningCertificateV2 attribute</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedDigest()"><!-- --></A><H3>
getSignedDigest</H3>
<PRE>
public byte[] <B>getSignedDigest</B>()
                       throws <A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns the message digest included in the signed attributes.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the message digest included in the signed attributes, or <code>null</code>
         if not present
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setUnsignedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setUnsignedAttributes</H3>
<PRE>
public void <B>setUnsignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of attributes that are <i>not</i> signed by the signer.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - a set of attributes that are <i>not</i> signed by the signer</DL>
</DD>
</DL>
<HR>

<A NAME="addUnsignedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
addUnsignedAttributes</H3>
<PRE>
public void <B>addUnsignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Adds the given attributes to the set of unsigned attributes.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the attributes to be added to the unsigned attributes</DL>
</DD>
</DL>
<HR>

<A NAME="addUnsignedAttribute(iaik.asn1.structures.Attribute)"><!-- --></A><H3>
addUnsignedAttribute</H3>
<PRE>
public void <B>addUnsignedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>&nbsp;attribute)</PRE>
<DL>
<DD>Adds the given attribute to the set of unsigned attributes.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attribute</CODE> - the attribute to be added to the unsigned attributes</DL>
</DD>
</DL>
<HR>

<A NAME="removeUnsignedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
removeUnsignedAttribute</H3>
<PRE>
public void <B>removeUnsignedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;attributeType)</PRE>
<DL>
<DD>Removes all unsigned attributes with the given attribute type.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributeType</CODE> - the OID identifying the attribute to be removed</DL>
</DD>
</DL>
<HR>

<A NAME="getVersion()"><!-- --></A><H3>
getVersion</H3>
<PRE>
public int <B>getVersion</B>()</PRE>
<DL>
<DD>Returns the synatx version number (1 or 3).
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the version number</DL>
</DD>
</DL>
<HR>

<A NAME="getSignerIdentifier()"><!-- --></A><H3>
getSignerIdentifier</H3>
<PRE>
public <A HREF="../../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A> <B>getSignerIdentifier</B>()</PRE>
<DL>
<DD>Returns information about the signer certificate.
 <p>
 The information is returned as <A HREF="../../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms"><CODE>CertificateIdentifier</CODE></A> object specifying the signer certificate either 
 by <A HREF="../../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>issuer distinguished name and 
 issuer-specific serial number</CODE></A> or by <A HREF="../../../iaik/cms/SubjectKeyID.html" title="class in iaik.cms"><CODE>SubjectKeyIdentifier</CODE></A>.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>information about the signer certificate</DL>
</DD>
</DL>
<HR>

<A NAME="isSignerCertificate(iaik.x509.X509Certificate)"><!-- --></A><H3>
isSignerCertificate</H3>
<PRE>
public boolean <B>isSignerCertificate</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;cert)
                            throws <A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Checks whether the supplied certificate actually is the certificate
 of the signer.
 <p>
 This method first checks if the the signerIdentifier of this CounterSignature
 identifies the supplied certificate via IssuerAndSerialNumber or 
 SubjectKeyIdentifier. If this check is successful, this method then looks 
 if the <A HREF="../../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> 
 and/or the <A HREF="../../../iaik/smime/ess/SigningCertificateV2.html" title="class in iaik.smime.ess"><CODE>SigningCertificateV2</CODE></A> are
 present and identify the given certificate as cert of the signer. If both
 SigningCertificate attributes are present this method accepts the
 given certificate as signer certificate only if it is identified by
 both SigningCertificate attributes.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the certificate to be checked of being the one of the signer
<DT><B>Returns:</B><DD><code>true</code> if the supplied certificate is the signer
         certificate, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the check cannot be completed because an error occurs
            when parsing the SigningCertificate or SigningCertificate attribute
            or a hash algorithm (required for calculating the cert hash) is not
            supported by the installed cryptographic providers</DL>
</DD>
</DL>
<HR>

<A NAME="getDigestAlgorithm()"><!-- --></A><H3>
getDigestAlgorithm</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A> <B>getDigestAlgorithm</B>()</PRE>
<DL>
<DD>Returns the AlgorithmID of the message-digest algorithm that has
 been used for digesting the content and any signed attributes.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the AlgorithmID of the message-digest algorithm</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedAttributes()"><!-- --></A><H3>
getSignedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getSignedAttributes</B>()</PRE>
<DL>
<DD>Returns a set of attributes that are signed by the signer.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>a set of attributes that are signed by the signer</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getSignedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getSignedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first signed attribute matching to the given ObjectID, if 
 included in this CounterSignature object.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the first signed attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedAttributes(iaik.asn1.ObjectID)"><!-- --></A><H3>
getSignedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getSignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns all signed attributes matching to the given attribute type, if 
 included in this CounterSignature object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>oid</CODE> - the attribute type to look for
<DT><B>Returns:</B><DD>all signed attributes matching to the given attribute type, or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedAttributeValue(iaik.asn1.ObjectID)"><!-- --></A><H3>
getSignedAttributeValue</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A> <B>getSignedAttributeValue</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)
                                       throws <A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns the attribute value of a single valued signed attribute with the given type.
 <p>
 This method provides the possibility to immediately access the value of an
 attribute with the given type. This method may be used for getting the value
 of the first included attribute of requested type or -- more appropriate --
 the only one value of a single valued signed attribute of requested type. In this way, 
 this method can be seen as an alternative to method <A HREF="../../../iaik/cms/attributes/CounterSignature.html#getSignedAttribute(iaik.asn1.ObjectID)"><CODE>getSignedAttribute</CODE></A> for providing immediate access to the attribute value, e.g.:
 <pre>
 SigningCertificate signingCertificate = (SigningCertificate)counterSignature.getSignedAttributeValue(SigningCertficate.oid);
 if (signingCertificate != null) {
   ...
 }
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>oid</CODE> - the object identifier representing the type of the attribute for which to get the value
<DT><B>Returns:</B><DD>the attribute value of <code>null</code> if no attribute of given type is included
<DT><B>Throws:</B>
<DD><CODE>if</CODE> - the ASN.1 representation of the attribute value cannot be parsed
<DD><CODE><A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getSignatureAlgorithm()"><!-- --></A><H3>
getSignatureAlgorithm</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A> <B>getSignatureAlgorithm</B>()</PRE>
<DL>
<DD>Returns the signature algorithm used for calculating the signature
 and associated information with the signer private key.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the signature algorithm</DL>
</DD>
</DL>
<HR>

<A NAME="getSignatureValue()"><!-- --></A><H3>
getSignatureValue</H3>
<PRE>
public byte[] <B>getSignatureValue</B>()</PRE>
<DL>
<DD>Returns the signature value.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the signature value, as byte array</DL>
</DD>
</DL>
<HR>

<A NAME="setSignatureValue(byte[])"><!-- --></A><H3>
setSignatureValue</H3>
<PRE>
public void <B>setSignatureValue</B>(byte[]&nbsp;signatureValue)</PRE>
<DL>
<DD>Sets the signature value.
 This method may be used for calculating the signature value outside and 
 explicitly setting it.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureValue</CODE> - the signature value, calculated from outside</DL>
</DD>
</DL>
<HR>

<A NAME="getUnsignedAttributes()"><!-- --></A><H3>
getUnsignedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getUnsignedAttributes</B>()</PRE>
<DL>
<DD>Returns a set of attributes that are <i>not</i> signed by the signer.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>a set of attributes that are <i>not</i> signed by the signer</DL>
</DD>
</DL>
<HR>

<A NAME="getUnsignedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getUnsignedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getUnsignedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first unsigned attribute matching to the given ObjectID, if 
 included in this CounterSignature object.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the first unsigned attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="getUnsignedAttributes(iaik.asn1.ObjectID)"><!-- --></A><H3>
getUnsignedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getUnsignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns all unsigned attributes matching to the given attribute type, if 
 included in this CounterSignature object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>oid</CODE> - the attribute type to look for
<DT><B>Returns:</B><DD>all unsigned attributes matching to the given attribute type, or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="getUnsignedAttributeValue(iaik.asn1.ObjectID)"><!-- --></A><H3>
getUnsignedAttributeValue</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A> <B>getUnsignedAttributeValue</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)
                                         throws <A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns the attribute value of a single valued unsigned attribute with the given type.
 <p>
 This method provides the possibility to immediately access the value of an unsigned
 attribute with the given type. This method may be used for getting the value
 of the first included unsigned attribute of requested type or -- more appropriate --
 the only one value of a single valued unsigned attribute of requested type. In this way, 
 this method can be seen as an alternative to method <A HREF="../../../iaik/cms/attributes/CounterSignature.html#getUnsignedAttribute(iaik.asn1.ObjectID)"><CODE>getUnsignedAttribute</CODE></A> for providing immediate access to the attribute value, e.g.:
 <pre>
 SigningTime signingTime = 
   (SigningTime)counterSignature.getUnsignedAttributeValue(SigningTime.oid);
 if (signingTime != null) {
   ...
 }
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>oid</CODE> - the object identifier representing the type of the attribute for which to get the value
<DT><B>Returns:</B><DD>the attribute value of <code>null</code> if no attribute of given type is included
<DT><B>Throws:</B>
<DD><CODE>if</CODE> - the ASN.1 representation of the attribute value cannot be parsed
<DD><CODE><A HREF="../../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string giving some information about this
 <code>CounterSignature</code> object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html#toString()" title="class or interface in iaik.asn1.structures">toString</A></CODE> in class <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AttributeValue.html" title="class or interface in iaik.asn1.structures">AttributeValue</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="toString(boolean)"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>(boolean&nbsp;detailed)</PRE>
<DL>
<DD>Returns a string giving some - if requested - detailed information 
 about this <code>CounterSignature</code> object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>detailed</CODE> - - whether or not to give detailed information
<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="counterSign(iaik.cms.SignerInfo)"><!-- --></A><H3>
counterSign</H3>
<PRE>
public void <B>counterSign</B>(<A HREF="../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)
                 throws java.security.SignatureException</PRE>
<DL>
<DD>Counter signs the given SignerInfo.

 After counter signing the SignerInfo you must explicitly set the CounterSignature
 attribute, e.g.:
 <pre>
 ...
 counterSignature.counterSign(signerInfo);
 // and add the counter signature as unsigned attribute
 Attribute[] unsignedAttributes = new Attribute[] { new Attribute(counterSignature) };
 signerInfo.addUnsignedAttributes(unsignedAttributes);
 ...
 </pre>

 Please <b>note</b> that one single CounterSignature object only can sign one
 single signature. So do not repeatedly call this method for signing
 more than one signatures; rather create a new CounterSignature object for
 any new signature to be counter signed.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfo</CODE> - the SignerInfo to be counter signed
<DT><B>Throws:</B>
<DD><CODE>java.security.SignatureException</CODE> - if signing fails for some reason</DL>
</DD>
</DL>
<HR>

<A NAME="counterSign(iaik.cms.attributes.CounterSignature)"><!-- --></A><H3>
counterSign</H3>
<PRE>
public void <B>counterSign</B>(<A HREF="../../../iaik/cms/attributes/CounterSignature.html" title="class in iaik.cms.attributes">CounterSignature</A>&nbsp;counterSignature)
                 throws java.security.SignatureException</PRE>
<DL>
<DD>Counter signs the given CounterSignature.
 <p>
 This method may be used for counter signing another CounterSognature.
 After counter signing the CounterSignature you must explicitly set the CounterSignature
 attribute, e.g.:
 <pre>
 ...
 counterSignature.counterSign(firstCounterSignature);
 // and add the counter signature as unsigned attribute
 Attribute[] unsignedAttributes = new Attribute[] { new Attribute(counterSignature) };
 firstCounterSignature.addUnsignedAttributes(unsignedAttributes);
 ...
 </pre>
 Please <b>note</b> that one single CounterSignature object only can sign one
 single signature. So do not repeatedly call this method for signing
 more than one signatures; rather create a new CounterSignature object for
 any new signature to be counter signed.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>counterSignature</CODE> - the CounterSignature to be counter signed
<DT><B>Throws:</B>
<DD><CODE>java.security.SignatureException</CODE> - if signing fails for some reason</DL>
</DD>
</DL>
<HR>

<A NAME="counterSign(byte[])"><!-- --></A><H3>
counterSign</H3>
<PRE>
public void <B>counterSign</B>(byte[]&nbsp;signatureToBeCounterSigned)
                 throws java.security.SignatureException</PRE>
<DL>
<DD>Counter signs the given signature value.

 After counter signing the SignerInfo you must explicitly set the CounterSignature
 attribute, e.g.:
 <pre>
 ...
 counterSignature.counterSign(signerInfo.getSignatureValue());
 // and add the counter signature as unsigned attribute
 Attribute[] unsignedAttributes = new Attribute[] { new Attribute(counterSignature) };
 signerInfo.addUnsignedAttributes(unsignedAttributes);
 ...
 </pre>

 Please <b>note</b> that one single CounterSignature object only can sign one
 single signature. So do not repeatedly call this method for signing
 more than one signatures; rather create a new CounterSignature object for
 any new signature to be counter signed.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureToBeCounterSigned</CODE> - the signature value to be counter signed
<DT><B>Throws:</B>
<DD><CODE>java.security.SignatureException</CODE> - if signing fails for some reason</DL>
</DD>
</DL>
<HR>

<A NAME="verify(java.security.PublicKey, iaik.cms.SignerInfo)"><!-- --></A><H3>
verify</H3>
<PRE>
public boolean <B>verify</B>(java.security.PublicKey&nbsp;publicKey,
                      <A HREF="../../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)
               throws java.security.SignatureException</PRE>
<DL>
<DD>Verifies the counter signature of the given SignerInfo with the given public key.
 <p>
 The given SignerInfo represents the SignerInfo that has been counter signed, e.g.:
 <pre>
 try {
   if (counterSignature.verify(counterCert.getPublicKey(), signerInfo)) {
     System.out.println("Signature OK from counter signer: "+counterSignature.getSignerIdentifier());  
   } else {
     System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
   }  
 } catch (SignatureException ex) {
   System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
 }  
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>publicKey</CODE> - the public key of the counter signer<DD><CODE>signerInfo</CODE> - SignerInfo the SignerInfo that has been counter signed
<DT><B>Returns:</B><DD><code>true</code> if the signature verifies, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE>java.security.SignatureException</CODE> - signature verification process fails</DL>
</DD>
</DL>
<HR>

<A NAME="verify(java.security.PublicKey, iaik.cms.attributes.CounterSignature)"><!-- --></A><H3>
verify</H3>
<PRE>
public boolean <B>verify</B>(java.security.PublicKey&nbsp;publicKey,
                      <A HREF="../../../iaik/cms/attributes/CounterSignature.html" title="class in iaik.cms.attributes">CounterSignature</A>&nbsp;counterSignature)
               throws java.security.SignatureException</PRE>
<DL>
<DD>Verifies the counter signature of the given CounterSiganture with the given public key.
 <p>
 CounterSignatures may be applied recursively, i.e. one CounterSignature may be
 counter signed by another. The given CounterSignature represents the CounterSignature
 that has been counter signed, e.g.:
 <pre>
 try {
   if (counterSignature.verify(counterCert.getPublicKey(), counterSignature)) {
     System.out.println("Signature OK from counter signer: "+counterSignature.getSignerIdentifier());  
   } else {
     System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
   }  
 } catch (SignatureException ex) {
   System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
 }  
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>publicKey</CODE> - the public key of the counter signer<DD><CODE>counterSignature</CODE> - CounterSignature the CounterSignature that has been counter signed
<DT><B>Returns:</B><DD><code>true</code> if the signature verifies, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE>java.security.SignatureException</CODE> - signature verification process fails</DL>
</DD>
</DL>
<HR>

<A NAME="verify(java.security.PublicKey, byte[])"><!-- --></A><H3>
verify</H3>
<PRE>
public boolean <B>verify</B>(java.security.PublicKey&nbsp;publicKey,
                      byte[]&nbsp;signatureThatWasCounterSigned)
               throws java.security.SignatureException</PRE>
<DL>
<DD>Verifies the counter signature of the given signature value with the given public key.
 <p>
 The given signature value may be the one of the SignerInfo that has been counter signed, e.g.:
 <pre>
 try {
   if (counterSignature.verify(counterCert.getPublicKey(), signerInfo.getSignatureValue())) {
     System.out.println("Signature OK from counter signer: "+counterSignature.getSignerIdentifier());  
   } else {
     System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
   }  
 } catch (SignatureException ex) {
   System.out.println("Signature ERROR from counter signer: "+counterSignature.getSignerIdentifier());  
 }  
 </pre>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>publicKey</CODE> - the public key of the counter signer<DD><CODE>signatureThatWasCounterSigned</CODE> - the siganture that has been counter signed
<DT><B>Returns:</B><DD><code>true</code> if the signature verifies, <code>false</code> if not
<DT><B>Throws:</B>
<DD><CODE>java.security.SignatureException</CODE> - if the signature verification process fails for some reason
<DD><CODE><A HREF="../../../iaik/cms/InvalidContentHashException.html" title="class in iaik.cms">InvalidContentHashException</A></CODE> - if the signature verification process fails because the
                                        content hash does not match to value of the included MessageDigest 
                                        attribute
<DD><CODE><A HREF="../../../iaik/cms/InvalidContentTypeException.html" title="class in iaik.cms">InvalidContentTypeException</A></CODE> - if the signed attributes contain a ContentType attribute
                                        (not allowed for CounterSignature)</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../iaik/cms/attributes/CMSMessageDigest.html" title="class in iaik.cms.attributes"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../iaik/cms/attributes/SigningTime.html" title="class in iaik.cms.attributes"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?iaik/cms/attributes/CounterSignature.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CounterSignature.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../../siclogo.jpg> <IMG SRC=../../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
