<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:10 GMT 2016 -->
<TITLE>
AuthEnvelopedDataStream (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.AuthEnvelopedDataStream class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="AuthEnvelopedDataStream (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthEnvelopedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/ByteArrayAuthCipherEngine.html" title="interface in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthEnvelopedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthEnvelopedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class AuthEnvelopedDataStream</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.AuthEnvelopedDataStream</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A>, <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A>, java.util.EventListener</DD>
</DL>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../iaik/cms/AuthEnvelopedData.html" title="class in iaik.cms">AuthEnvelopedData</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>AuthEnvelopedDataStream</B><DT>extends java.lang.Object<DT>implements <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A></DL>
</PRE>

<P>
This class represents the stream-supporting implementation of the CMS content
 type <code>AuthEnvelopedData</code> as defined in <a href = 
 "http://www.ietf.org/rfc/rfc5083.txt" target="_blank">RFC 5083</a>.
 <p>
 The <code>AuthEnvelopedData</code> content type is identified by the following
 object identifier (see RFC 5083):
 <PRE>
 id-ct-authEnvelopedData OBJECT IDENTIFIER ::= { iso(1)
      member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
      smime(16) ct(1) 23 }
 </PRE>
 which corresponds to the OID string "1.2.840.113549.1.9.16.1.23".
 <p>
 <a href = "http://www.ietf.org/rfc/rfc5083.txt" target="_blank">RFC 5083</a>
 specifies the <code>AuthEnvelopedData</code> content type for use with 
 authenticated cipher modes like AES-CCM or AES-GCM (RFC 5084). Using
 authenticated encryption the data is not only encrypted but also integrity
 protected by a message authentication code. Similar to the EnvelopedData
 and AuthenticatedData types content of any type may be authenticated 
 enveloped for any number of recipients in parallel. For each recipient, a 
 commonly at random generated content-authenticated-encryption key is
 encrypted with the particular recipient key and - together with
 recipient-specific information - collected into a <code>RecipientInfo</code>
 value. Using a authenticated encryption method the content is authenticated
 and encrypted with the content-authenticated-encryption key. All <code>RecipientInfo</code>
 values are collected together with the authenticated encrypted content into an<code>
 AuthEnvelopedData</code> object to be sent to each intended recipients.
 The <code>AuthEnvelopedData</code> may also contain authenticated attributes
 (which are authenticated but not encrypted) and unauthenticated attributes
 (which are neither encrypted nor authenticated), (see <a href = 
 "http://www.ietf.org/rfc/rfc5083.txt" target="_blank">RFC&nbsp;5083</a>:
 <PRE>
 AuthEnvelopedData ::= SEQUENCE {
      version CMSVersion,
      originatorInfo [0] IMPLICIT OriginatorInfo OPTIONAL,
      recipientInfos RecipientInfos,
      authEncryptedContentInfo EncryptedContentInfo,
      authAttrs [1] IMPLICIT AuthAttributes OPTIONAL,
      mac MessageAuthenticationCode,
      unauthAttrs [2] IMPLICIT UnauthAttributes OPTIONAL }

 </PRE>
 </PRE><p>
 The <code>recipientInfos</code> field is a non-empty collection of
 per-recipient information. The <code>authEncryptedContentInfo</code> field
 specifies the type of the content being authenticated encrypted,
 the content-authenticated-encryption algorithm (the same for all recipients)
 used for authenticated encrypting the content, and the result of the 
 content authenticated encryption. 
 <br>
 CMS provides five alternatives for authenticated encrypting the content depending
 on the key management algorithm used to protect the content-authenticated-encryption 
 key for a specific recipient:
 <ul>
 <li>key transport: the content-authenticated-encryption key is encrypted with the public
                    key of the recipient. This technique is used
                    when creating a RecipientInfo of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> for the public key of the recipient 
                    certificate, identified by <A HREF="../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>IssuerAndSerialNumber</CODE></A>. 
 <li>key agreement: the recipient public key and the sender private key are
                    used to generate a pairwise symmetric key, then the content-authenticated-encryption
                    key is encrypted with the pairwise symmetric key.
                    Each RecipientInfo of type <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A> may transfer the encrypted content-authenticated-encryption 
                    key to one or more recipient using the same key
                    agreement algorithm and domain parameters for that algorithm.
 <li>symmetric key-encryption keys: the content-authenticated-encryption key is encrypted with
                   a previously distributed symmetric key-encryption key. The
                   RecipientInfo is of type <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A> using a CMS key wrap algorithm like
                   Triple-DES key wrap or RC2 key wrap.
 <li>password based encryption: the content-authenticated-encryption key is encrypted with a
                   secret key derived from a password. The RecipientInfo is of
                   type <A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PassowrdRecipientInfo</CODE></A>
                   using a CMS key wrap algorithm like PWRI-KEK (<a href = 
                   "http://www.ietf.org/rfc/rfc3211.txt" target="_blank">RFC 3211</a>).
 <li>user defined key management. The RecipientInfo is of type <A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A>.
 </ul>
 The optional <code>originatorInfo</code> field may be used to include certificate/crl 
 information about the originator if required by the key managemant protocol.
 The <code>unauthAttrs</code> field may contain some attributes that are authenticated
 but not encrypted, the <code>unauthAttrs</code> may provide some attributes that are
 not protected.
 <p>
 A recipient, when receiving the <code>AuthEnvelopedData</code> message,
 decrypts the corresponding encrypted content-authenticated-encryption key with his/her
 key according the right key management protocol for subsequently decrypting the
 encrypted content and verifying the mac value using the content-authenticated-encryption 
 key just recovered. The recipient key is referenced by proper <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms"><CODE>KeyIdentifier</CODE></A> included in the corresponding <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> object.
 <p>
 See <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a> for more information.
 <p>
 <hr>
 <p>
 When creating a new <code>AuthEnvelopedDataStream</code> object for the data to be authenticated
 enveloped the symmetric algorithm has to be specified to be used for content-authenticated-encryption.
 After setting the recipients, the AuthEnvelopedDataStream object may be encoded and written to an 
 output stream by using a proper <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#writeTo(java.io.OutputStream, int)"><CODE>writeTo</CODE></A> method, e.g.:
 <ol>
 <li>Create a new AuthEnvelopedDataStream object and specify the content authenticated 
     encryption algorithm to be used by means of the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>AuthEnvelopedDataStream(InputStream is, AlgorithmID contentAuthEncAlg)</CODE></A>
     constructor.  When using this constructor automatically a temporary symmetric key for 
     authenticated content encryption will be generated. If you want to use a 
     content-authenticated-encryption algorithm allowing keys of different size, you may specify 
     the key length by using the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><CODE>AuthEnvelopedDataStream(InputStream is, AlgorithmID contentAuthEncAlg, int keyLength)</CODE></A> 
     constructor.
     <pre>
     //the data to be auth-enveloped supplied from an input stream:
     InputStream dataStream = ...;
     //use AES-GCM mode for authenticated encrypting the content
     AuthEnvelopedDataStream authEnvelopedData = new AuthEnvelopedDataStream(dataStream, (AlgorithmID)AlgorithmID.aes128_GCM.clone());
     </pre>
 <li>For each intended recipient, create a <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> object of requested type (<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>,
     or <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>), and add all RecipientInfos 
     to the AuthEnvelopedDataStream object by calling the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])"><CODE>setRecipientInfos</CODE></A> method, e.g.
     (assuming to use KeyTransRecipientInfos for two recipients with corresponding 
     certificates <code>cert1</code> and <code>cert2</code>):
     <pre>
     RecipientInfo[] recipients = new RecipientInfo[2];
     recipients[0] = new KeyTransRecipientInfo(cert1, (AlgorithmID)AlgorithmID.rsaEncryption.clone());
     recipients[1] = new KeyTransRecipientInfo(cert2, (AlgorithmID)AlgorithmID.rsaEncryption.clone());
     authEnvelopedData.setRecipientInfos(recipients);
     </pre>
 <li>Use a proper <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#writeTo(java.io.OutputStream, int)"><CODE>writeTo</CODE></A> method for BER encoding the
     AuthEnvelopedData object and writing it to an output stream. You optionally may specify
     a particular block size for splitting the encoding of encrypted content. This step
     also will perform generation and encryption of the symmetric content-authenticated-encryption
     key for each participated recipient.
     <pre>
     int blockSize = ...;
     OutputStream encodedStream = ...;
     authEnvelopedData.writeTo(encoded_stream, blockSize);
     </pre>
     respectively
     <pre>
     authEnvelopedData.writeTo(encodedStream);
     </pre>
 </ol>
 A recipient, when receiving an AuthEnvelopedData encoding, uses the
 <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream)"><CODE>AuthEnvelopedDataStream(InputStream is)</CODE></A>
 constructor for parsing the internal structure. Before reading the recovered content by
 means of the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method, the cipher has to be
 initialized for decryption and mac verification with the particular recipient key by 
 calling one of the following <code>setupCipher</code> methods:
 <ul>
 <li><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key, int)"><CODE>setupCipher(Key recipientKey, int recipientInfoIndex)</CODE></A>:
     This method can be used for decrypting the encrypted content-authenticated-encryption key for 
     a RecipientInfo of any type; however, you must know the right index into the 
     <code>recipientInfo</code> field. The recovered content-authenticated-encryption key is used
     for setting up the cipher to decrypt the encrypted content and verify the message authentication
     code.
 <li><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key, iaik.cms.KeyIdentifier)"><CODE>setupCipher(Key recipientKey,
     KeyIdentifier recipientKeyIdentifier)</CODE></A>: This method can be used for decrypting the
     encrypted content-authenticated-encryption key for a RecipientInfo of any type; the recipient is
     identified by its <A HREF="../../iaik/cms/RecipientKeyIdentifier.html" title="class in iaik.cms"><CODE>RecipientKeyIdentifier</CODE></A>.
     The recovered content-authenticated-encryption key is used for setting up the cipher to decrypt
     the encrypted content and verify the message authentication code.
 <li><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key, iaik.x509.X509Certificate)"><CODE>setupCipher(Key recipientKey,
     X509Certificate recipientCertificate)</CODE></A>: This method only can be used for decrypting
     the encrypted content-authenticated-encryption key for a RecipientInfo of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>; the recipient is
     identified by its public key certficate. The recovered content-authenticated-encryption key is used
     for setting up the cipher to decrypt the encrypted content and verify the message authentication
     code.
 <li><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key)"><CODE>setupCipher(Key)</CODE></A>: In contrast to the three <code>setupCipher</code>
     above you have to supply the already decrypted content-authenticated-encryption key when setting
     up the cipher for content decryption and mac verification using this <code>setupCipher</code> method.
 </ul>
 Since in our example both recipients use a RecipientInfo of type <code>KeyTransRecipientInfo</code>,
 we can use any of the <code>setupCipher</code> methods to setup the cipher for
 decrypting the encrypted content-authenticated-encryption key, decrypting the encrypted content
 and verifying the message authenitication code:
 <ol>
 <li>Create an AuthEnvelopedDataStream structure from the supplied encoding, decode and parse
     the internal structure:
     <pre>
     InputStream encodedStream = ...;
     AuthEnvelopedDataStream authEnvelopedData = new AuthEnvelopedDataStream(encodedStream);
     </pre>
 <li>Get information about the inherent EncryptedContentInfo:
     <pre>
     EncryptedContentInfoStream eci = (EncryptedContentInfoStream)authEnvelopedData.getEncryptedContentInfo();
     System.out.println("Content type: "+eci.getContentType().getName());
     System.out.println("content authenticated encryption algorithm: "+eci.getContentEncryptionAlgorithm().getName());
     </pre>
 <li>Get information about the included RecipientInfos:
     <pre>
     RecipientInfo[] recipients = authEnvelopedData.getRecipientInfos();
     System.out.println("Included RecipientInfos:");
     for (int i=0; i < recipients.length; i++) {
        System.out.print("Recipient "+(i+1)+":");
        System.out.println(recipients[i]);
     }
     </pre>
 <li>Use some recipient specific key to decrypt the inherent encrypted
     secret key to be used for initializing the cipher for encrypted-content decryption
     and mac verification:
     <pre>
     // the private key of recipient 1:
     Key privateKey = ...;
     //setup cipher for recipient 1:
     int recipientInfoIndex = 0;
     authEnvelopedData.setupCipher(privateKey, recipientInfoIndex);
     </pre>
     Unlike the non-stream supporting <A HREF="../../iaik/cms/AuthEnvelopedData.html" title="class in iaik.cms"><CODE>AuthEnvelopedData</CODE></A> class where the encrypted-content decryption
     already is performed inside the <code>setupCipher</code> method, the cipher
     will be only initialized for decryption in this class. The encrypted-content
     decryption actually is done during reading the data obtained by calling the
     <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> method. So do not call
     <code>getInputStream</code> before setting up the cipher!
     <p>
 <li>Get and read the recovered content:
     <pre>
     InputStream dataIs = authEnvelopedData.getInputStream();
     byte[] buf = new byte[1024];
     int r;
     while ((r = dataIs.read(buf)) > 0) {
        // do something useful
     }
     </pre>
 </ol>
 <p>
 <b>Note:</b> <a href = "http://www.ietf.org/rfc/rfc5084.txt" target="_blank">RFC 5084</a>
 specifies the usage of the <code>AuthEnvelopedData</code> type for the 
 AES-CCM and AES-GCM authenticated encryption algorithms, both are supported
 by this implementation when used with IAIK-JCE, version &gt; 3.17. 
 Unfortunately the structure 
 of the <code>AuthEnvelopedData</code> type does not allow one-pass processing
 when parsing an <code>AuthEnvelopedData</code> object that uses AES-CCM or AES-GCM
 for authenticated content encryption. Both AES-CCM and AES-GCM require to know
 the additional authenticated data (authenticated attributes) before processing the
 content data. However, the <code>authAttrs</code> field is located behind the
 <code>authEncryptedContentInfo</code> field. Thus the content must be read before
 having access to the authenticated attributes which are needed as additional
 authenticated data input for AES-CCM and AES-GCM. For that reason a non-stream
 <A HREF="../../iaik/cms/EncryptedContentInfo.html" title="class in iaik.cms"><CODE>EncryptedContentInfo</CODE></A> is used by this AuthenticatedDataStream
 implementation for parsing the encrypted content of AuthEnvelopedData objects
 that have AES-CCM or AES-GCM as content-authenticated encryption algorithm.
 <br>
 AES-CCM furthermore needs to know the size of the to-be-auth-encrypted content in advance
 when creating an AuthEnvelopedData object. If you know to data input length
 (e.g. the size of a data file) you may set it by calling method <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setInputLength(long)"><CODE>setInputLength</CODE></A>, otherwise tha data has to be internally buffered before starting
 the authentication-encryption process. 
 <p>
 <b>Note:</b> This class does not provide a <code>verifyMac</code> method. For
 authenticated encryption modes like CCM and GCM Mac verification is part of
 the decryption/verification procedure. When using some other content authentication
 encryption method that follows a different verification strategy, be sure
 to implement corresponding 
 <A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])"><CODE>authentication cipher engines</CODE></A>.
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream()">AuthEnvelopedDataStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default constructor for dynamic object creation in ContentInfoStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream)">AuthEnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthEnvelopedDataStream from a BER encoded AuthEnvelopedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)">AuthEnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthEnvelopedDataStream object where the content to be authenticated 
 enveloped is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)">AuthEnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg,
                        int&nbsp;keyLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthEnvelopedDataStream object where the content to be authenticated
 enveloped is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)">AuthEnvelopedDataStream</A></B>(java.io.InputStream&nbsp;is,
                        <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthEnvelopedDataStream from a BER encoded AuthEnvelopedData
 object which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)">AuthEnvelopedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthEnvelopedDataStream object to be authenticated 
 enveloped is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)">AuthEnvelopedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg,
                        int&nbsp;keyLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthEnvelopedDataStream object where the content to be authenticated 
 enveloped is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)">AuthEnvelopedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        java.io.InputStream&nbsp;is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg,
                        int&nbsp;keyLength,
                        <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new AuthEnvelopedDataStream object where the content to be authenticated
 enveloped is read from the supplied InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.cms.RecipientInfo[], iaik.cms.EncryptedContentInfoStream)">AuthEnvelopedDataStream</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients,
                        <A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A>&nbsp;encryptedContentInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructs an AuthEnvelopedDataStream object with an already
 created EncryptedContentInfoStream.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#addRecipientInfo(iaik.cms.RecipientInfo)">addRecipientInfo</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds one recipient to the list of recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#decode(java.io.InputStream)">decode</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reads and decodes an BER encoded AuthEnvelopedData from a the given input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#encodeCalled(iaik.asn1.ASN1Object, int)">encodeCalled</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj,
             int&nbsp;id)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method implements the EncodeListener interface.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getAuthenticatedAttribute(iaik.asn1.ObjectID)">getAuthenticatedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first authenticated attribute matching to the given ObjectID, if 
 included in this AuthEnvelopedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getAuthenticatedAttributes()">getAuthenticatedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the authenticated attributes included in this AuthEnvelopedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getBlockSize()">getBlockSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the block size defining the length of each definite primitive
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getContentType()">getContentType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the content type this class implements.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getEncryptedContentInfo()">getEncryptedContentInfo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the EncryptedContentInfo included in this <code>AuthEnvelopedDataStream</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.InputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getInputStream()">getInputStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an InputStream from where the decrypted data can be read.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getMac()">getMac</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the MAC value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getOriginatorInfo()">getOriginatorInfo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the OriginatorInfo, if included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getRecipientInfo(iaik.cms.KeyIdentifier)">getRecipientInfo</A></B>(<A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the RecipientInfo belonging to the recipient identified by the
 given recipient identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getRecipientInfo(iaik.x509.X509Certificate)">getRecipientInfo</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the recipient info matching to the supplied recipient certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getRecipientInfos()">getRecipientInfos</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the recipient infos included in this
 <code>AuthEnvelopedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getRecipientInfos(int)">getRecipientInfos</A></B>(int&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the recipient infos included in this
 <code>AuthEnvelopedData</code> object that have the specified type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getSecurityProvider()">getSecurityProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityProvider installed for this EncryptedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getUnauthenticatedAttribute(iaik.asn1.ObjectID)">getUnauthenticatedAttribute</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the first unauthenticated attribute matching to the given ObjectID, if 
 included in this AuthEnvelopedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getUnauthenticatedAttributes()">getUnauthenticatedAttributes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the unauthenticated attributes included in this AuthEnvelopedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getVersion()">getVersion</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the syntax version number.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#notifyEOF()">notifyEOF</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method implements the EOFListener interface for performing the final decoding
 of the attributes and mac field components.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])">setAuthenticatedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of authenticated attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setBlockSize(int)">setBlockSize</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the block size for defining the length of each definite primitive
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setInputLength(long)">setInputLength</A></B>(long&nbsp;inputLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the length of input data.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setInputStream(java.io.InputStream)">setInputStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the input stream that supplies the content data to be authenticated encrypted.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setMac(byte[])">setMac</A></B>(byte[]&nbsp;mac)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the MAC value (if calculated outside).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setOriginatorInfo(iaik.cms.OriginatorInfo)">setOriginatorInfo</A></B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the optional OriginatorInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setRecipientInfos(iaik.cms.RecipientInfo[])">setRecipientInfos</A></B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the recipient infos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A></B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityProvider for this AuthEnvelopedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])">setUnauthenticatedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of unauthenticated attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key)">setupCipher</A></B>(java.security.Key&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the given symmetric key to setup the cipher for decrypting the content
 and verifying the message authentication code.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key, int)">setupCipher</A></B>(java.security.Key&nbsp;recipientKey,
            int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the content-authenticated-encryption key to setup the
 cipher for decrypting the encrypted content and verifying the mac of this 
 <code>AuthEnvelopedDataStream</code> object for the requesting recipient, specified by
 its <code>recipientInfoIndex</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key, iaik.cms.KeyIdentifier)">setupCipher</A></B>(java.security.Key&nbsp;recipientKey,
            <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the content-authenticated-encryption key to setup the
 cipher for decrypting the encrypted content and verifying the mac of this 
 <code>AuthEnvelopedDataStream</code> object for the requesting recipient, specified 
 by the given recipient identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key, iaik.x509.X509Certificate)">setupCipher</A></B>(java.security.Key&nbsp;recipientKey,
            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the specified key for decrypting the content-authenticated-encryption key to setup the
 cipher for decrypting the encrypted content and verifying the mac of this 
 <code>AuthEnvelopedDataStream</code> object for the requesting recipient, specified by 
 the given recipient certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#toASN1Object()">toASN1Object</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this AuthEnvelopedDataStream as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#toASN1Object(int)">toASN1Object</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this AuthEnvelopedData as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some information about this
 <code>AuthEnvelopedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#toString(boolean)">toString</A></B>(boolean&nbsp;detailed)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some - if requested - detailed information
 about this <code>AuthEnvelopedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#writeTo(java.io.OutputStream)">writeTo</A></B>(java.io.OutputStream&nbsp;os)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes this AuthEnvelopedData BER encoded to the supplied output stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</A></B>(java.io.OutputStream&nbsp;os,
        int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes this AuthEnvelopedData BER encoded to the supplied output stream
 where a constructed OCTET STRING may be used for encoding the content.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AuthEnvelopedDataStream()"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
protected <B>AuthEnvelopedDataStream</B>()</PRE>
<DL>
<DD>Default constructor for dynamic object creation in ContentInfoStream.
 The block size is set to 2048 to enforce indefinite constructed encoding.
<P>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</PRE>
<DL>
<DD>Creates a new AuthEnvelopedDataStream object where the content to be authenticated 
 enveloped is read from the supplied InputStream.
 <p>
 The content type is set to CMS <code>Data</code>.
 <p>
 When using this constructor, automatically a temporary symmetric key for authenticated content
 encryption will be generated. If you want to use a content-authenticated-encryption algorithm 
 allowing keys of different size, you may specify the key length by using the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><CODE>AuthEnvelopedDataStream(InputStream is, AlgorithmID contentAuthEncAlg, int keyLength)</CODE></A>
 constructor.
 <br>
 Note that the supplied <code>contentAuthEncAlg</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying the data to be authenticated enveloped<DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm</DL>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</PRE>
<DL>
<DD>Creates a new AuthEnvelopedDataStream object to be authenticated 
 enveloped is read from the supplied InputStream.
 <p>
 When using this constructor, automatically a temporary symmetric key for authenticated content
 encryption will be generated. If you want to use a content-authenticated-encryption algorithm 
 allowing keys of different size, you may specify the key length by using the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><CODE>AuthEnvelopedDataStream(ObjectID contentType, InputStream is, AlgorithmID contentAuthEncAlg, int keyLength)</CODE></A>
 constructor.
 <br>
 Note that the supplied <code>contentAuthEncAlg</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the content type of the content to be authenticated enveloped<DD><CODE>is</CODE> - the InputStream containing the data to be authenticated enveloped<DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm</DL>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg,
                               int&nbsp;keyLength)</PRE>
<DL>
<DD>Creates a new AuthEnvelopedDataStream object where the content to be authenticated
 enveloped is read from the supplied InputStream.
 <br>
 The content type is set to CMS <b>Data</b>.
 <p>
 When using this constructor, automatically a symmetric key for authenticated content
 encryption will be generated. If the specified content authenticated encryption algorithm 
 supports variable key lengths, a particular key length may be set by means of the 
 <code>keyLength</code> parameter.
 If no length is specified, the defined default key length will be used. If the
 algorithm only works with keys of fixed-size length, the keyLength parameter
 may be set to -1 or the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>AuthEnvelopedDataStream(InputStream is, AlgorithmID contentAuthEncAlg)</CODE></A> constructor may be used.
 <br>
 Note that the supplied <code>contentAuthEncAlg</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream containing the data to be authenticated enveloped<DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm<DD><CODE>keyLength</CODE> - the length of the content-authenticated-encryption key to be generated
                  (when using a content-authenticated-encryption algorithm that supports
                  variable key lengths)</DL>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg,
                               int&nbsp;keyLength)</PRE>
<DL>
<DD>Creates a new AuthEnvelopedDataStream object where the content to be authenticated 
 enveloped is read from the supplied InputStream.
 <p>
 When using this constructor, automatically a symmetric key for authenticated content
 encryption is generated.
 If the specified content authenticated encryption algorithm supports variable key lengths, a
 particular key length may be set by means of the <code>keyLength</code> parameter.
 If no length is specified, the defined default key length will be used. If the
 algorithm only works with keys of fixed-size length, the keyLength parameter
 may be set to -1 or the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>AuthEnvelopedDataStream(ObjectID contentType, InputStream is, AlgorithmID contentAuthEncAlg)</CODE></A> 
 constructor may be used.
 <br>
 Note that the supplied <code>contentAuthEncAlg</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the content type of the content to be authenticated enveloped<DD><CODE>is</CODE> - the InputStream containing the data to be authenticated enveloped<DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm<DD><CODE>keyLength</CODE> - the length of the content-authenticated-encryption key to be generated
                  (when using a content-authenticated-encryption algorithm that supports
                  variable key lengths)</DL>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                               java.io.InputStream&nbsp;is,
                               <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg,
                               int&nbsp;keyLength,
                               <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Creates a new AuthEnvelopedDataStream object where the content to be authenticated
 enveloped is read from the supplied InputStream.
 <p>
 When using this constructor, automatically a symmetric key for authenticated 
 content encryption will be generated.
 If the specified content authenticated encryption algorithm supports variable key lengths, a
 particular key length may be set by means of the <code>keyLength</code> parameter.
 If no length is specified, the defined default key length will be used. If the
 algorithm only works with keys of fixed-size length, the keyLength parameter
 may be set to -1 or the <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><CODE>AuthEnvelopedDataStream(ObjectID contentType, InputStream is, AlgorithmID contentAuthEncAlg)</CODE></A> 
 constructor may be used.
 <br>
 Note that the supplied <code>contentAuthEncAlg</code> AlgorithmID internally is cloned.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the content type of the content to be authenticated enveloped<DD><CODE>is</CODE> - the InputStream containing the data to be authenticated enveloped<DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm<DD><CODE>keyLength</CODE> - the length of the content-authenticated-encryption key to be generated
                  (when using a content-authenticated-encryption algorithm that supports
                  variable key lengths)<DD><CODE>securityProvider</CODE> - the security provider to be used; if <code>null</code> the 
                         default system-wide SecurityProvider is used</DL>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(iaik.cms.RecipientInfo[], iaik.cms.EncryptedContentInfoStream)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients,
                               <A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A>&nbsp;encryptedContentInfo)</PRE>
<DL>
<DD>Constructs an AuthEnvelopedDataStream object with an already
 created EncryptedContentInfoStream.
 <p>
 The given array of <code>RecipientInfo</code> specifies a collection of
 per-recipient information, and the given <code>EncryptedContentInfoStream</code>
 is responsible for authentictad content encryption.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>recipients</CODE> - information about the recipients<DD><CODE>encryptedContentInfo</CODE> - the EncryptedContentInfo</DL>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(java.io.InputStream)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(java.io.InputStream&nbsp;is)
                        throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                               java.io.IOException</PRE>
<DL>
<DD>Creates a new AuthEnvelopedDataStream from a BER encoded AuthEnvelopedData
 object which is read from the given InputStream. The encoded AuthEnvelopedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a BER encoded CMS AuthEnvelopedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>
<HR>

<A NAME="AuthEnvelopedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)"><!-- --></A><H3>
AuthEnvelopedDataStream</H3>
<PRE>
public <B>AuthEnvelopedDataStream</B>(java.io.InputStream&nbsp;is,
                               <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                        throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                               java.io.IOException</PRE>
<DL>
<DD>Creates a new AuthEnvelopedDataStream from a BER encoded AuthEnvelopedData
 object which is read from the given InputStream. The encoded AuthEnvelopedData may
 (or may not) be wrapped into a ContentInfo.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream supplying a BER encoded CMS AuthEnvelopedData object<DD><CODE>securityProvider</CODE> - the security provider to be used; if <code>null</code> the 
                         default system-wide SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setSecurityProvider(iaik.cms.SecurityProvider)"><!-- --></A><H3>
setSecurityProvider</H3>
<PRE>
public void <B>setSecurityProvider</B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Sets the SecurityProvider for this AuthEnvelopedDataStream.
 <p>
 This method allows to explicitly set a SecurityProvider for this AuthEnvelopedDataStream.
 If no explicit SecurityProvider is set, the default system wide installed 
 SecurityProvider will be used for the required cryptographic operations.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])"><CODE>getInputStreamAuthCipherEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamAuthCipherEngine.html" title="interface in iaik.cms"><CODE>InputStreamAuthCipherEngine</CODE></A>
     for stream based authenticated content en/decryption as used by the inherent EncryptedContentInfoStream
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters, byte[])"><CODE>getByteArrayAuthCipherEngine</CODE></A></code>
     methods to get a <A HREF="../../iaik/cms/ByteArrayAuthCipherEngine.html" title="interface in iaik.cms"><CODE>ByteArrayAuthCipherEngine</CODE></A>
     for authentictaed content en/decryption for non-stream <A HREF="../../iaik/cms/AuthEnvelopedData.html" title="class in iaik.cms"><CODE>AuthEnvelopedData</CODE></A> objects
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric content-authenticated-encryption key as used by the 
     inherent EncryptedContentInfo
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameters(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameters</CODE></A></code>
     to parse algorithm parameters from an AlgorithmID as used by the inherent EncryptedContentInfo
 <li>several SecurityProvider methods for key en/decryption and parsing as used by the inherent 
     recipient infos
 </ul>
 An application may supply the SecurityProvider immediately when creating an AuthEnvelopedData object.
 This may be preferable on the parsing side, and also when creating a new AuthEnvelopedData object
 where the EncryptedContentInfo and the RecipientInfos are have to be <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#AuthEnvelopedDataStream(iaik.asn1.ObjectID, java.io.InputStream, iaik.asn1.structures.AlgorithmID, int, iaik.cms.SecurityProvider)"><CODE>created</CODE></A> by 
 this class.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityProvider</CODE> - the SecurityProvider to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityProvider()"><!-- --></A><H3>
getSecurityProvider</H3>
<PRE>
public <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>getSecurityProvider</B>()</PRE>
<DL>
<DD>Gets the SecurityProvider installed for this EncryptedDataStream.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec, byte[])"><CODE>getInputStreamAuthCipherEngine</CODE></A></code>
     methods to get an <A HREF="../../iaik/cms/InputStreamAuthCipherEngine.html" title="interface in iaik.cms"><CODE>InputStreamAuthCipherEngine</CODE></A>
     for stream based authenticated content en/decryption as used by the inherent EncryptedContentInfoStream
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getByteArrayAuthCipherEngine(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.AlgorithmParameters, byte[])"><CODE>getByteArrayAuthCipherEngine</CODE></A></code>
     methods to get a <A HREF="../../iaik/cms/ByteArrayAuthCipherEngine.html" title="interface in iaik.cms"><CODE>ByteArrayAuthCipherEngine</CODE></A>
     for authentictaed content en/decryption for non-stream <A HREF="../../iaik/cms/AuthEnvelopedData.html" title="class in iaik.cms"><CODE>AuthEnvelopedData</CODE></A> objects
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#generateKey(iaik.asn1.structures.AlgorithmID, java.security.spec.AlgorithmParameterSpec)"><CODE>generateKey</CODE></A></code>
     to generate the symmetric content-authenticated-encryption key as used by the 
     inherent EncryptedContentInfo
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getAlgorithmParameters(iaik.asn1.structures.AlgorithmID)"><CODE>getAlgorithmParameters</CODE></A></code>
     to parse algorithm parameters from an AlgorithmID as used by the inherent EncryptedContentInfo
 <li>several SecurityProvider methods for key en/decryption and parsing as used by the inherent 
     recipient infos
 </ul>
 If no explicit SecurityProvider has been <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)"><CODE>set</CODE></A> for this object, 
 the default system wide installed SecurityProvider will be used for the required cryptographic
 operations. However, this method will return <code>null</code> if it does not have its own
 SecurityProvider.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityProvider explicitly installed for this object, or <code>null</code> if
         this object does not have its own SecurityProvider</DL>
</DD>
</DL>
<HR>

<A NAME="decode(java.io.InputStream)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(java.io.InputStream&nbsp;is)
            throws java.io.IOException,
                   <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></PRE>
<DL>
<DD>Reads and decodes an BER encoded AuthEnvelopedData from a the given input stream.
 The encoded AuthEnvelopedData may (or may not) be wrapped into a ContentInfo.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#decode(java.io.InputStream)">decode</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream holding a BER encoded AuthEnvelopedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DD>
</DL>
<HR>

<A NAME="getContentType()"><!-- --></A><H3>
getContentType</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>getContentType</B>()</PRE>
<DL>
<DD>Returns the content type this class implements.
 <p>
 Use <code>getEncryptedContentInfo().getContentType()</code> for getting the
 type the authenticated encrypted content represents.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getContentType()">getContentType</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>ObjectID.cms_authEnvelopedData</code></DL>
</DD>
</DL>
<HR>

<A NAME="setOriginatorInfo(iaik.cms.OriginatorInfo)"><!-- --></A><H3>
setOriginatorInfo</H3>
<PRE>
public void <B>setOriginatorInfo</B>(<A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A>&nbsp;originatorInfo)</PRE>
<DL>
<DD>Sets the optional OriginatorInfo.
 <p>
 The originatorInfo may be set for including certificates and/or certificate
 revocation lists for the originator if required by the key management
 algorithm used.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>originatorInfo</CODE> - the OriginatorInfo to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setRecipientInfos(iaik.cms.RecipientInfo[])"><!-- --></A><H3>
setRecipientInfos</H3>
<PRE>
public void <B>setRecipientInfos</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[]&nbsp;recipients)</PRE>
<DL>
<DD>Sets the recipient infos.
 <p>
 Any <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for authenticated en/decrypting the content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipients</CODE> - a collection of per-recipient information<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addRecipientInfo(iaik.cms.RecipientInfo)"><!-- --></A><H3>
addRecipientInfo</H3>
<PRE>
public void <B>addRecipientInfo</B>(<A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>&nbsp;recipient)</PRE>
<DL>
<DD>Adds one recipient to the list of recipient infos.
 <p>
 Any <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A> added supplies 
 recipient-specific information used for identifying the key of
 the recipient to be used for authenticated en/decrypting the content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipient</CODE> - the RecipientInfo to be added<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms"><CODE>RecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/PasswordRecipientInfo.html" title="class in iaik.cms"><CODE>PasswordRecipientInfo</CODE></A>, 
<A HREF="../../iaik/cms/OtherRecipientInfo.html" title="class in iaik.cms"><CODE>OtherRecipientInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setAuthenticatedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setAuthenticatedAttributes</H3>
<PRE>
public void <B>setAuthenticatedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of authenticated attributes.
 These attributed will be authenticated only, but not encrypted.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the authenticated attributes to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setUnauthenticatedAttributes(iaik.asn1.structures.Attribute[])"><!-- --></A><H3>
setUnauthenticatedAttributes</H3>
<PRE>
public void <B>setUnauthenticatedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[]&nbsp;attributes)</PRE>
<DL>
<DD>Sets a set of unauthenticated attributes.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attributes</CODE> - the unauthenticated attributes to be set</DL>
</DD>
</DL>
<HR>

<A NAME="setBlockSize(int)"><!-- --></A><H3>
setBlockSize</H3>
<PRE>
public void <B>setBlockSize</B>(int&nbsp;blockSize)</PRE>
<DL>
<DD>Sets the block size for defining the length of each definite primitive
 encoded octet string component.
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole encrypted data is encoded as definite primitive octet string.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#setBlockSize(int)">setBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - for defining the encoding scheme and setting the octet
        string component length, if positive</DL>
</DD>
</DL>
<HR>

<A NAME="getBlockSize()"><!-- --></A><H3>
getBlockSize</H3>
<PRE>
public int <B>getBlockSize</B>()</PRE>
<DL>
<DD>Gets the block size defining the length of each definite primitive
 encoded octet string component.
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole data is encoded as definite primitive octet string.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getBlockSize()">getBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the block size defining the encoding scheme and setting the octet
        string component length, if positive</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key, int)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public javax.crypto.SecretKey <B>setupCipher</B>(java.security.Key&nbsp;recipientKey,
                                          int&nbsp;recipientInfoIndex)
                                   throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                          java.security.NoSuchAlgorithmException,
                                          java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the content-authenticated-encryption key to setup the
 cipher for decrypting the encrypted content and verifying the mac of this 
 <code>AuthEnvelopedDataStream</code> object for the requesting recipient, specified by
 its <code>recipientInfoIndex</code>.
 <p>
 This method has to be called before reading the decrypted content. 
 method. So do not call method  <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> before 
 setting up the cipher!
 <p>
 <b>Note</b> that you have to know the right index into the <code>recipientInfos</code>
 field when using this method for setting up the cipher for decryption. You may
 search for the index by using one of the <code>getRecipientInfo</code> methods
 thereby identifying the recipient by its <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getRecipientInfo(iaik.cms.KeyIdentifier)"><CODE>keyIdentifier</CODE></A> or -- if suitable for the key management algorithm used -- <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getRecipientInfo(iaik.x509.X509Certificate)"><CODE>certificate</CODE></A>.
 <br>
 However, when having some recipient using a key agreement protocol the corresponding
 RecipientInfo is of type <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>
 which may hold encrypted content-authenticated-encryption keys for more than only one recipients 
 using the same key agreement algorithm with same domain parameters. Since this 
 <code>setupCipher</code> method only can get the KeyAgreeRecipientInfo with the given
 index (but not search for the right recipient in the KeyAgreeRecipientInfo), it
 will step through any recipient included in the KeyAgreeRecipientInfo trying to
 decrypt the encrypted content-authenticated-encryption key with the supplied key. This may give
 some overhead and it might be more appropriate to use another <code>setupCipher</code> method
 allowing to immediately identify the particular recipient in mind by its
 #setupCipher(Key, KeyIdentifier) keyIdentifier} or <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#setupCipher(java.security.Key, iaik.x509.X509Certificate)"><CODE>certificate</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the key of the recipient to be used for decrypting
                     the encrypted content-authenticated-encryption key.<DD><CODE>recipientInfoIndex</CODE> - the index into the recipientInfos field
<DT><B>Returns:</B><DD>the (decrypted) secret content authenticated encryption key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the content-authenticated-encryption key
            or setting up the cipher for decrypting the content
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the content-authenticated-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key, iaik.cms.KeyIdentifier)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public javax.crypto.SecretKey <B>setupCipher</B>(java.security.Key&nbsp;recipientKey,
                                          <A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)
                                   throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                          java.security.NoSuchAlgorithmException,
                                          java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the content-authenticated-encryption key to setup the
 cipher for decrypting the encrypted content and verifying the mac of this 
 <code>AuthEnvelopedDataStream</code> object for the requesting recipient, specified 
 by the given recipient identifier.
 <p>
 This method has to be called before reading the decrypted content. 
 method. So do not call method  <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> before 
 setting up the cipher!
 <p>
 This <code>setupCipher</code> can be used to setup the cipher for decryption for
 any type of RecipientInfo. The supplied recipient identifier will be used for
 searching for the right RecipientInfo in the <code>recipientInfos</code> field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the key of the recipient to be used for decrypting
                     the encrypted content-authenticated-encryption key.<DD><CODE>recipientIdentifier</CODE> - specifies which RecipientInfo the given key belongs to
<DT><B>Returns:</B><DD>the (decrypted) secret content authenticated encryption key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the content-authenticated-encryption key
            or setting up the cipher for decrypting the content, or no RecipientInfo
            for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the content-authenticated-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key, iaik.x509.X509Certificate)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public javax.crypto.SecretKey <B>setupCipher</B>(java.security.Key&nbsp;recipientKey,
                                          <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)
                                   throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                                          java.security.NoSuchAlgorithmException,
                                          java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the specified key for decrypting the content-authenticated-encryption key to setup the
 cipher for decrypting the encrypted content and verifying the mac of this 
 <code>AuthEnvelopedDataStream</code> object for the requesting recipient, specified by 
 the given recipient certificate.
 <p>
 This method has to be called before reading the decrypted content. 
 method. So do not call method  <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> before 
 setting up the cipher!
 <p>
 <b>Note</b> that this method only can be used for decrypting the encrypted content
 if the recipient in mind has a RecipientInfo of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A> using a public
 key from a certificate for its key management protocol.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientKey</CODE> - the private key of the recipient to be used for decrypting
                     the encrypted content-authenticated-encryption key.<DD><CODE>recipientCertificate</CODE> - the certificate of the recipient specifying which 
        RecipientInfo the recipient private key belongs to
<DT><B>Returns:</B><DD>the (decrypted) secret content authenticated encryption key
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while decrypting the content-authenticated-encryption key
            or setting up the cipher for decrypting the content, or no RecipientInfo
            for the requested recipient is included
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation of the content-authenticated-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified private key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="setupCipher(java.security.Key)"><!-- --></A><H3>
setupCipher</H3>
<PRE>
public void <B>setupCipher</B>(java.security.Key&nbsp;key)
                 throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A>,
                        java.security.NoSuchAlgorithmException,
                        java.security.InvalidKeyException</PRE>
<DL>
<DD>Uses the given symmetric key to setup the cipher for decrypting the content
 and verifying the message authentication code.
 <p>
 The secret key supplied to this method has to be the already decrypted
 content authenticated encryption key.
 <p>
 This method has to be called before reading the decrypted content. 
 method. So do not call method  <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#getInputStream()"><CODE>getInputStream</CODE></A> before 
 setting up the cipher!
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - the temporary symmetric key that has been used to encrypt the content,
            and now is used for decrypting it again
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if there occurs an error while setting up the cipher for decrypting the content
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the content-authenticated-encryption algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the specified key is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="getInputStream()"><!-- --></A><H3>
getInputStream</H3>
<PRE>
public java.io.InputStream <B>getInputStream</B>()</PRE>
<DL>
<DD>Returns an InputStream from where the decrypted data can be read.
 <p>
 Attention! The stream only may be read once.
 <p>
 When having created a new <code>AuthEnvelopedDataStream</code> object to
 be encoded to a stream, this method should not be called at all, since the stream
 automatically will be read during performing the encoding (which is done
 when calling a <A HREF="../../iaik/cms/AuthEnvelopedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> method).
 <br>
 When having decoded and parsed a received <code>AuthEnvelopedDataStream</code> object
 comimg from some stream, this method may be used for obtaining the raw (decrypted) data
 after having setup the cipher for decrypting the content and verifying the mac.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an InputStream for reading the decrypted data</DL>
</DD>
</DL>
<HR>

<A NAME="setInputStream(java.io.InputStream)"><!-- --></A><H3>
setInputStream</H3>
<PRE>
public void <B>setInputStream</B>(java.io.InputStream&nbsp;is)</PRE>
<DL>
<DD>Sets the input stream that supplies the content data to be authenticated encrypted.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the input stream holding the content data to authenticated and encrypt</DL>
</DD>
</DL>
<HR>

<A NAME="setInputLength(long)"><!-- --></A><H3>
setInputLength</H3>
<PRE>
public void <B>setInputLength</B>(long&nbsp;inputLength)
                    throws java.lang.IllegalArgumentException</PRE>
<DL>
<DD>Sets the length of input data.
 The input data length may be required for stream-processing CCM which needs to
 know the data input length in advance.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>inputLength</CODE> - the length (number of bytes) of the input data
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the specified input length is not valid</DL>
</DD>
</DL>
<HR>

<A NAME="getVersion()"><!-- --></A><H3>
getVersion</H3>
<PRE>
public int <B>getVersion</B>()</PRE>
<DL>
<DD>Returns the syntax version number.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the syntax version number</DL>
</DD>
</DL>
<HR>

<A NAME="getOriginatorInfo()"><!-- --></A><H3>
getOriginatorInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/OriginatorInfo.html" title="class in iaik.cms">OriginatorInfo</A> <B>getOriginatorInfo</B>()</PRE>
<DL>
<DD>Gets the OriginatorInfo, if included.
 <p>
 The originatorInfo may be set for including certificates and/or
 certificate revocation lists if required by the key management
 algorithm used.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the originatorInfo, if included; otherwise <code>null</code></DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfos()"><!-- --></A><H3>
getRecipientInfos</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[] <B>getRecipientInfos</B>()</PRE>
<DL>
<DD>Returns all the recipient infos included in this
 <code>AuthEnvelopedData</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all the <code>RecipientInfo</code> objects
         included into this <code>AuthEnvelopedData</code></DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfos(int)"><!-- --></A><H3>
getRecipientInfos</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A>[] <B>getRecipientInfos</B>(int&nbsp;type)</PRE>
<DL>
<DD>Returns all the recipient infos included in this
 <code>AuthEnvelopedData</code> object that have the specified type.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all the <code>RecipientInfo</code> objects
         included into this <code>AuthEnvelopedData</code> that have the 
         specified type (e.g. all KeyTransRecipientInfos); the array may
         be empty if no RecipientInfo with the requested type is included</DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfo(iaik.x509.X509Certificate)"><!-- --></A><H3>
getRecipientInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A> <B>getRecipientInfo</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCertificate)</PRE>
<DL>
<DD>Returns the recipient info matching to the supplied recipient certificate.
 <p>
 This method may be used by a recipient for quering for the recipient info
 that holds the content authenticated encryption key encrypted with the public key of the
 given certificate. 
 <br>
 <b>Note</b> that this method only can be used for searching for RecipientInfos
 of type <A HREF="../../iaik/cms/KeyTransRecipientInfo.html" title="class in iaik.cms"><CODE>KeyTransRecipientInfo</CODE></A> or
 <A HREF="../../iaik/cms/KeyAgreeRecipientInfo.html" title="class in iaik.cms"><CODE>KeyAgreeRecipientInfo</CODE></A>, but <b>NOT</b>
 for a RecipientInfo of type <A HREF="../../iaik/cms/KEKRecipientInfo.html" title="class in iaik.cms"><CODE>KEKRecipientInfo</CODE></A>
 which does use a certificate.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the RecipientInfo matching to the supplied recipient certificate,
         or <code>null</code> if no recipient info belonging to the given
         certificate can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getRecipientInfo(iaik.cms.KeyIdentifier)"><!-- --></A><H3>
getRecipientInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/RecipientInfo.html" title="class in iaik.cms">RecipientInfo</A> <B>getRecipientInfo</B>(<A HREF="../../iaik/cms/KeyIdentifier.html" title="interface in iaik.cms">KeyIdentifier</A>&nbsp;recipientIdentifier)</PRE>
<DL>
<DD>Returns the RecipientInfo belonging to the recipient identified by the
 given recipient identifier.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recipientIdentifier</CODE> - the recipient identifier identifying the
                            recipient in mind
<DT><B>Returns:</B><DD>the RecipientInfo matching to the supplied recipient identifier,
         or <code>null</code> if no recipient info belonging to the given
         recipient identifier can be found</DL>
</DD>
</DL>
<HR>

<A NAME="getEncryptedContentInfo()"><!-- --></A><H3>
getEncryptedContentInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/EncryptedContentInfoStream.html" title="class in iaik.cms">EncryptedContentInfoStream</A> <B>getEncryptedContentInfo</B>()</PRE>
<DL>
<DD>Returns the EncryptedContentInfo included in this <code>AuthEnvelopedDataStream</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the inherent EncryptedContentInfo</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedAttributes()"><!-- --></A><H3>
getAuthenticatedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getAuthenticatedAttributes</B>()</PRE>
<DL>
<DD>Gets the authenticated attributes included in this AuthEnvelopedData.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the authenticated attributes; if included</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getAuthenticatedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getAuthenticatedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first authenticated attribute matching to the given ObjectID, if 
 included in this AuthEnvelopedData object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the first authenticated attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="getMac()"><!-- --></A><H3>
getMac</H3>
<PRE>
public byte[] <B>getMac</B>()</PRE>
<DL>
<DD>Gets the MAC value.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the MAC value.</DL>
</DD>
</DL>
<HR>

<A NAME="setMac(byte[])"><!-- --></A><H3>
setMac</H3>
<PRE>
public void <B>setMac</B>(byte[]&nbsp;mac)</PRE>
<DL>
<DD>Sets the MAC value (if calculated outside).
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>mac</CODE> - the MAC value.</DL>
</DD>
</DL>
<HR>

<A NAME="getUnauthenticatedAttributes()"><!-- --></A><H3>
getUnauthenticatedAttributes</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A>[] <B>getUnauthenticatedAttributes</B>()</PRE>
<DL>
<DD>Gets the unauthenticated attributes included in this AuthEnvelopedData.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the unauthenticated attributes; if included</DL>
</DD>
</DL>
<HR>

<A NAME="getUnauthenticatedAttribute(iaik.asn1.ObjectID)"><!-- --></A><H3>
getUnauthenticatedAttribute</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/Attribute.html" title="class or interface in iaik.asn1.structures">Attribute</A> <B>getUnauthenticatedAttribute</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;oid)</PRE>
<DL>
<DD>Returns the first unauthenticated attribute matching to the given ObjectID, if 
 included in this AuthEnvelopedData object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the first unauthenticated attribute belonging to the given ObjectID or 
         <code>null</code> if there is no attribute for the given OID.</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object()"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>()
                        throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this AuthEnvelopedDataStream as ASN1Object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toASN1Object()">toASN1Object</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>this <code>AuthEnvelopedDataStream</code> as ASN1Object.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object(int)"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>(int&nbsp;blockSize)
                           throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this AuthEnvelopedData as ASN1Object.
 <p>
 If <blockSize> is positive a constructed
 OCTET STRING is used for encoding the encrypted content. This method actually
 will perform the encryption of the symmetric content-authenticated-encryption key for
 each participated recipient.
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Returns:</B><DD>this AuthEnvelopedData as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os)
             throws java.io.IOException</PRE>
<DL>
<DD>Writes this AuthEnvelopedData BER encoded to the supplied output stream.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this AuthEnvelopedData shall be written
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream, int)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os,
                    int&nbsp;blockSize)
             throws java.io.IOException</PRE>
<DL>
<DD>Writes this AuthEnvelopedData BER encoded to the supplied output stream
 where a constructed OCTET STRING may be used for encoding the content.
 <p>
 When encoding the content data to the given stream it is piped through a
 cipher stream thereby performing the content authenticated encryption.
 <p>
 If the a positive <code>blockSize</code> value is specified, the encrypted content
 is encoded as indefinite constructed octet string being composed of a certain number
 of definite primitive encoded octet strings of <code>blockSize</code> length:
 <pre>
 0x24 0x80
           0x04 &lt;blocksize&gt; &lt;first encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;second encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;third encrypted content block&gt;
                ...
 0x00 0x00
 </pre>
 Otherwise, whole the encrypted content is encoded
 as definite primitive octet string:
 <pre>
  0x04 &lt;length&gt; &lt;encrypted content&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this SignedData shall be written<DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs during writing the object</DL>
</DD>
</DL>
<HR>

<A NAME="encodeCalled(iaik.asn1.ASN1Object, int)"><!-- --></A><H3>
encodeCalled</H3>
<PRE>
public void <B>encodeCalled</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj,
                         int&nbsp;id)
                  throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>This method implements the EncodeListener interface.
 During the encoding process the DerCoder calls this method when
 it actually is time for encoding the attributes and mac value
 components.  
 <p>
 <b>This method shall not be called by an application!</b>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html#encodeCalled(iaik.asn1.ASN1Object, int)" title="class or interface in iaik.asn1">encodeCalled</A></CODE> in interface <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the AuthEnvelopedData SEQUENCE<DD><CODE>id</CODE> - the id identifying the SEQUENCE to be processed
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if an error occurs when computing/signing 
                            the message digest</DL>
</DD>
</DL>
<HR>

<A NAME="notifyEOF()"><!-- --></A><H3>
notifyEOF</H3>
<PRE>
public void <B>notifyEOF</B>()
               throws java.io.IOException</PRE>
<DL>
<DD>This method implements the EOFListener interface for performing the final decoding
 of the attributes and mac field components.
 <br>
 <b>An application shall <i>not</i> call this method!</b> This method only is qualified
 as public method since it implements the IAIK-JCE iaik.utils.EOFListener interface.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html#notifyEOF()" title="class or interface in iaik.utils">notifyEOF</A></CODE> in interface <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while parsing the stream</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string giving some information about this
 <code>AuthEnvelopedData</code> object.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="toString(boolean)"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>(boolean&nbsp;detailed)</PRE>
<DL>
<DD>Returns a string giving some - if requested - detailed information
 about this <code>AuthEnvelopedData</code> object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toString(boolean)">toString</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>detailed</CODE> - - whether or not to give detailed information
<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/AuthEnvelopedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/ByteArrayAuthCipherEngine.html" title="interface in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/AuthEnvelopedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthEnvelopedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
