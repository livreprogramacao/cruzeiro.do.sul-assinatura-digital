<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:14 GMT 2016 -->
<TITLE>
SignedDataStream (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="iaik.cms.SignedDataStream class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SignedDataStream (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/SignedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/SignerIdentifier.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/SignedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
iaik.cms</FONT>
<BR>
Class SignedDataStream</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>iaik.cms.SignedDataStream</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A>, <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A>, java.util.EventListener</DD>
</DL>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms">SignedData</A>, <A HREF="../../iaik/cms/SignedDataInOutStream.html" title="class in iaik.cms">SignedDataInOutStream</A>, <A HREF="../../iaik/smime/SMimeSigned.html" title="class in iaik.smime">SMimeSigned</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>SignedDataStream</B><DT>extends java.lang.Object<DT>implements <A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A>, <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A></DL>
</PRE>

<P>
This class represents the stream-implementation of the CMS content type 
 <code>SignedData</code>.
 <p>
 Each CMS content type is associated with a specific object identifier,
 derived from PKCS#7:
 <p><PRE>
 pkcs-7 OBJECT IDENTIFIER ::=
   { iso(1) member-body(2) US(840) rsadsi(113549)
       pkcs(1) 7 }
 </PRE><p>
 The object identifier for the <code>SignedData</code> content type is
 defined as:
 <p><code>
 signedData OBJECT IDENTIFIER ::= { pkcs-7 2 }
 </code><p>
 which corresponds to the OID string "1.2.840.113549.1.7.2".
 <p>
 The Cryptographic Message Syntax (CMS) (<a href = "http://www.ietf.org/rfc/rfc5652.txt" 
 target="_blank"> RFC 5652</a>) specifies the <code>SignedData</code>
 content type for providing a syntax for building digital signatures. Content
 of any type may be signed by any number of signers in parallel. For each
 signer, a signature is computed on the content (and any additional
 authenticating information) and -- together with some signer-specific 
 information -- collected into a <code>SignerInfo</code> object. Finally 
 all created <code>SignerInfo</code> objects are collected together with the 
 content for forming a <code>SignedData</code> structure.
 <p>
 This class implements the <code>SignedData</code> structure resulting from
 the last step described above. The <code>SignedData</code> type is defined
 as ASN.1 SEQUENCE type containing the following components (see  
 <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>):
 <p><PRE>
 SignedData ::= SEQUENCE {
   version CMSVersion,
   digestAlgorithms DigestAlgorithmIdentifiers,
   encapContentInfo EncapsulatedContentInfo,
   certificates [0] IMPLICIT CertificateSet OPTIONAL,
   crls [1] IMPLICIT RevocationInfoChoices OPTIONAL,
   signerInfos SignerInfos }

 <br>
 DigestAlgorithmIdentifiers ::= SET OF DigestAlgorithmIdentifier
 <br>
 CertificateSet ::= SET OF CertificateChoices

 CertificateChoices ::= CHOICE {
   certificate Certificate,
   extendedCertificate [0] IMPLICIT ExtendedCertificate, -- Obsolete
   v1AttrCert [1] IMPLICIT AttributeCertificateV1,       -- Obsolete
   v2AttrCert [2] IMPLICIT AttributeCertificateV2,
   other [3] IMPLICIT OtherCertificateFormat }

   OtherCertificateFormat ::= SEQUENCE {
     otherCertFormat OBJECT IDENTIFIER,
     otherCert ANY DEFINED BY otherCertFormat }
 <br>
 RevocationInfoChoices ::= SET OF RevocationInfoChoice

 RevocationInfoChoice ::= CHOICE {
   crl CertificateList,
   other [1] IMPLICIT OtherRevocationInfoFormat }

 OtherRevocationInfoFormat ::= SEQUENCE {
   otherRevInfoFormat OBJECT IDENTIFIER,
   otherRevInfo ANY DEFINED BY otherRevInfoFormat }
 <br>
 SignerInfos ::= SET OF SignerInfo
 </PRE><p>
 The <code>digestAlgorithms</code> field contains the object identifiers of
 the message digest algorithms used by the several signers for digesting the
 content that is supplied in the <code>contentInfo</code> field. The
 optional <code>certificates</code> field shall contain certificate chains
 for all the signers of the <code>signerInfos</code> field; attribute
 certificates or other certificates maybe included. The optional <code>crls</code>
 field may supply information (e.g. by means of X.509 crls or other revocation
 infos) about the revocation status of the certificates
 specified in the <code>certificates</code> field.
 And finally, the <code>signerInfos</code> field collects per-signer
 information for all parciticipated signers including the including the 
 signer-specific digital signatures of the content.
 <p>
 If there are no signers on the content, the signed-data content type may be
 used for disseminating certificates and certificate-revocation lists.
 <p>
 Verifying some received signature(s) is done according to the signature 
 algorithm used (rsaEncryption or DSA).
 <p>
 For more information see <a href = "http://www.ietf.org/rfc/rfc5652.txt" target="_blank"> RFC 5652</a>.
 <p>
 <hr>
 <p>
 When creating a <code>SignedDataStream</code> object for the content to be signed by using
 the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, int)"><CODE>SignedDataStream(InputStream is, int mode)</CODE></A>
 constructor, the transimission mode has to be specified. You may use an alternative 
 <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.ObjectID, int)"><CODE>constructor</CODE></A> for additionally 
 specifying the content type of the inherent EncapsulatedContentInfo; default is
 id-data. If the mode is set to <i>SignedDataStream.IMPLICIT</i> the content data will be 
 included in the <code>SignedData</code> message to be transmitted, but it will be 
 not included if the mode is set to <i>SignedDataStream.EXPLICIT</i>.
 However, in both cases the content data has to be supplied when creating the 
 <code>SignedDataStream</code> object, because it is needed for the digest computation:
 <pre>
 InputSrteam[] data_stream = ...; // the content data supplying input stream
 SignedDataStream signed_data = new SignedDataStream(data_stream, SignedDataStream.IMPLICIT);
 </pre>
 respectively
 <pre>
 SignedDataStream signed_data_stream = new SignedDataStream(data_stream, SignedDataStream.EXPLICIT);
 </pre>
 In contrast to the non-stream-variant of the CMS SignedData type (implemented by the 
 <A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A> class), 
 where explicit and implicit mode can be handled in the same way when creating a SignedData
 object, they require a different proceeding for the stream-supporting <code>SignedDataStream</code> class. 
 In this way, the steps for creating a <code>SignedDataStream</code> object and preparing it for transmission 
 can be summarized as followed (to simplify matters, we will assume not to include
 certificate revocation lists):
 <ol>
 <li>Create a new <code>SignedDataStream</code> object thereby supplying the content data
     to be signed as input stream and specifying the transmission mode to be used (either 
     <i>SignedDataStream.IMPLICIT</i> or <i>SignedDataStream.EXPLICIT</i>):
     <pre>
     InputStream data_stream = ...;
     int mode = ...;
     SignedDataStream signed_data = new SignedDataStream(data_stream, mode);
     </pre>
 <li>Set the certificates of all the signers by calling the  
     <A HREF="../../iaik/cms/SignedDataStream.html#setCertificates(java.security.cert.Certificate[])"><CODE>setCertificates</CODE></A> method.
     The certificates are supplied as array of instances 
     iaik.x509.X509Certificate (and/or iaik.x509.attr.AttributeCertificate and/or iaik.cms.OtherCertificate):
     <pre>
     signed_data.setCertificates(certificates);
     </pre>
 <li>For each participated signer, create a <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A>
     object, optionally supply it with attributes, and add it to the SignedDataStream structure
     by calling the <A HREF="../../iaik/cms/SignedDataStream.html#addSignerInfo(iaik.cms.SignerInfo)"><CODE>addSignerInfo</CODE></A> method:
     <pre>
     SignerInfo signer1 = ...;
     signed_data.addSignerInfo(signer1);
     SignerInfo signer2 = ...;
     signed_data.addSignerInfo(signer2);
      ...
     </pre>
     You alternatively may collectively add all signers by utilizing the  
     <A HREF="../../iaik/cms/SignedDataStream.html#setSignerInfos(iaik.cms.SignerInfo[])"><CODE>setSignerInfos</CODE></A>
     method.
     <br>
     When actually adding a SignerInfo the digest computation is initialized by wrapping a
     digest stream for the digest algorithm of the SignerInfo around the data carrying
     input stream.
     <p>
 <li>If the mode chosen in step 1 when creating the SignedDataStream object has been 
     <i>SignedDataStream.EXPLICIT</i>, now get and read the data from the data carrying 
     input stream. Since in explicit mode the content data is not included in the SignedData
     message, the stream has to be read before actually performing the encoding. When 
     reading the stream, the data is piped to all the signer specific digest streams for
     updating the hash computation. 
     <pre>
     if (mode == SignedDataStream.EXPLICIT) {
       InputStream data_is = signed_data.getInputStream();
       byte[] buf = new byte[1024];
       int r;
       while ((r = data_is.read(buf)) > 0) {
         // do something useful 
       }
     }
     </pre>
     When using the implicit mode, do <i>not</i> explicitly read data from the input stream 
     at all! This will be done automatically during the last step when performing the encoding.
     <p>
 <li>Use a proper <A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream, int)"><CODE>writeTo</CODE></A> method for BER encoding the 
     the SignedDataStream object and writing it to an output stream. You optionally may specify
     a particular block size for splitting the data encoding:
     <pre>
     int blockSize = ...; 
     signed_data.writeTo(output_stream, blockSize);
     </pre>
     respectively
     <pre>
     signed_data.writeTo(output_stream);
     </pre>
     It is recommended only to use the <code>writeTo</code> method where a particular 
     block size can be specified, because it is the intended purpose of this stream-supporting
     SignedData implementation to handle large amounts of data. When no block size is
     specified whole the content data is encoded as one primitive definite octet string, which  
     advantageously may be done when using the non-stream supporting  
     <A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A> implementation.
     When a positve block size is specified for encoding the SignedData to a stream, 
     the content data is BER encoded as indefinite constructed octet string being composed 
     of a series of definite primitive encoded octet strings of <code>blockSize</code> length,
     e.g.:
     <pre>
     0x24 0x80
               0x04 0x02 0x01 0xAB
               0x04 0x02 0x23 0x7F
               0x04 0x01 0xCA
     0x00 0x00 
     </pre>
     instead of:
     <pre>
     0x04 0x05 0x01 0xAB 0x23 0x7F 0xCA
     </pre>
     for encoding the five data bytes <code>0x01 0xAB 0x23 0x7F 0xCA</code>. 
 </ol>
 <p>
 Again, it has to be distinguished between IMPLICIT and EXPLICIT mode when using the <code>
 SignedDataStream</code> implementation for parsing a received
 SignedData message. 
 <br>
 When operating in IMPLICIT mode, the content data is included in 
 the received SignedData object, and so the parsing immediately may be 
 performed when creating a <code>SignedDataStream</code> object from the DER encoded
 SignedData object by calling the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)"><CODE>SignedDataStream(InputStream is)</CODE></A> constructor. 
 <br>
 On the other side, when the content data has been transmitted outside the SignedData
 message (EXPLICIT mode) there are two alternative ways for parsing the SignedData and 
 verifying the signature(s):
 <ul>
 <li>If the hash algorithms are known in advance (e.g. when parsing an S/MIME multipart/signed
     message), the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[])"><CODE>SignedDataStream(InputStream data_is, AlgorithmID[] hashAlgorithms)</CODE></A> constructor
     may be used for initializing the new SignedDataStream object with content data and
     hash algorithms to be used for digest computation; and the decoding has to be performed
     explicitly by calling the <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> method. 
     The initialization is necessary for preparing the digest computation on the content data 
     for the digest algorithms of all participated signers. Later, during signature verification the
     digest value computation is finished and the results are used for checking the signatures
     with the public key(s) of the signer(s). 
 <li>If both -- SignedData encoding and content data -- are accessible at the same time, the
     SignedDataStream object may be created in the same way as in IMPLICIT mode by using the
     <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)"><CODE>SignedDataStream(InputStream is)</CODE></A> constructor, and
     the content data maybe supplied by calling method <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A>.
     As above the content data is required for hash computation initialization.
 </ul>
 <p>
 The individual steps necessary for parsing a received SignedData message and verifying the
 signatures may be summarized as follows:
 <ol>
 <li>If the InputStream supplies the BER encoding of an implicit SignedData
     object, use the  
     <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)"><CODE>SignedDataStream(InputStream is)</CODE></A> 
     constructor for creating a SignedDataStream object and implicitly performing the
     decoding:
     <pre>
     SignedDataStream signedData = new SignedDataStream(encoded_stream);
     </pre>
     On the other hand, if the BER encoding represents an 
     explicit SignedData object, use one of the following alternatives: 
     <ul>
     <li>(a) Use the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[])"><CODE>SignedDataStream(InputStream data_is, AlgorithmID[] hashAlgorithms)</CODE></A> 
         constructor for initializing a new SignedDataStream object with content data and 
         digest algorithms for hash computation (assuming that two hash algorithms
         are used: SHA and RIPEMD-160):
         <pre>
         AlgorithmID[] algIDs = { AlgorithmID.sha1, AlgorithmID.ripeMd160 };
         SignedDataStream signedData = new SignedDataStream(data_is, algIDs);
         </pre>
     <li>(b)Create the SignedDataStream in the same way as in implicit mode by
         using the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)"><CODE>SignedDataStream(InputStream is)</CODE></A>
         constructor and subsequently supply the content data (transmitted by other means)
         by calling method <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A>:
         <pre>
         SignedDataStream signedData = new SignedDataStream(encoded_stream);
         signedData.setInputStream(data_is);
         </pre> 
     </ul>
 <li>Get the data carrying input stream and entirely read the data from the stream.
     This has to be performed for both implicit and explicit modes at exactly this state
     of the parsing procedure. In both cases the constructor has initialized the 
     digest computation by wrapping digest streams around the content data stream for
     all participated digest algorithms, either implicitly parsed from the supplied
     SignedData object, or explicitly supplied as an array of hash algorithm IDs. When 
     now reading the stream, the data is piped through the digest streams for updating the
     hash computation:
     <pre>
     InputStream dataIs = signedData.getInputStream();
     byte[] buf = new byte[1024];
     int r;
     while ((r = dataIs.read(buf)) > 0) {
       // do something useful 
     }
     </pre>
 <li>When dealing with an explicit message and using alternative 1(a) from above now explicitly
     perform the decoding by calling the <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> method:
     <pre>
     signedData.decode(encoded_stream);
     </pre>
 <li>Get the SignerInfos from the SignedData object and perform the signature
     verification:
     <pre>
     // get the signer infos
     SignerInfo[] signer_infos = signed_data.getSignerInfos();
     // verify the signatures
     for (int i=0; i < signer_infos.length; i++) {
       try {
          // verify the signature for SignerInfo at index i
          X509Certificate signer_cert = signed_data.verify(i);
          // if the signature is OK the certificate of the signer is returned
          System.out.println("Signature OK from signer: "+signer_cert.getSubjectDN());
       } catch (SignatureException ex) {
          // if the signature is not OK a SignatureException is thrown
          System.out.println("Signature ERROR from signer: "+signed_data.getCertificate(signer_infos[i].getSignerIdentifier()).getSubjectDN());
       }
     } 
     </pre>
 </ol>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms"><CODE>ContentStream</CODE></A>, 
<A HREF="../../iaik/cms/ContentInfoStream.html" title="class in iaik.cms"><CODE>ContentInfoStream</CODE></A>, 
<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A>, 
<A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#blockSize_">blockSize_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The block size for block oriented stream encoding.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#certSet_">certSet_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Repository for the signer certificates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#contentType_">contentType_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The content type of the to-be-signed content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#crls_">crls_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Repository for any included CRLs.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../iaik/cms/EncapsulatedContentInfoStream.html" title="class in iaik.cms">EncapsulatedContentInfoStream</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#encapContentInfo_">encapContentInfo_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The inherent EncapsualtedContentInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#EXPLICIT">EXPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mode where the signed content is NOT included in the SignedData object 
 (the content is transferred by other means).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#IMPLICIT">IMPLICIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mode where the signed content is included in the SignedData object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.io.InputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#inputStream_">inputStream_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An InputStream holding the data.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#mode_">mode_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mode specifying if the signed message is included in the Signature
 (IMPLICIT), or if is not transported within the Signature (EXPLICIT).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#securityProvider_">securityProvider_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The SecurityProvider to be used.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.Vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#signerInfos_">signerInfos_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Repository for the SignerInfos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/DerInputStream.html" title="class or interface in iaik.asn1">DerInputStream</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#thisObject_">thisObject_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An InputStream from which a DER encoded SignedData object is read.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#version_">version_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The version number, default 1.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream()">SignedDataStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default constructor for dynamic object creation in ContentInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)">SignedDataStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataStream from a BER encoded SignedData object
 which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[])">SignedDataStream</A></B>(java.io.InputStream&nbsp;data_is,
                 <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;hashAlgorithms)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataStream from an InputStream holding the content that
 has been transmitted by other means, and an array specifying the hash 
 algorithms to be used for digesting.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)">SignedDataStream</A></B>(java.io.InputStream&nbsp;data_is,
                 <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;hashAlgorithms,
                 <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataStream from an InputStream holding the content that
 has been transmitted by other means, and an array specifying the hash 
 algorithms to be used for digesting.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, int)">SignedDataStream</A></B>(java.io.InputStream&nbsp;data_is,
                 int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedDataStream object from an input stream supplying the data to be
 signed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.ObjectID, int)">SignedDataStream</A></B>(java.io.InputStream&nbsp;data_is,
                 <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                 int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a SignedDataStream object from an input stream supplying the data to be
 signed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)">SignedDataStream</A></B>(java.io.InputStream&nbsp;is,
                 <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataStream from a BER encoded SignedData object
 which is read from the given InputStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(iaik.asn1.ObjectID)">SignedDataStream</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new SignedDataStream object without any content.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#addCertificates(java.security.cert.Certificate[])">addCertificates</A></B>(java.security.cert.Certificate[]&nbsp;certificates)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given certificates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#addCRLs(iaik.x509.X509CRL[])">addCRLs</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the given certificate-revocation information objects.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#addDigestAlgorithm(iaik.asn1.structures.AlgorithmID)">addDigestAlgorithm</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a digest algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#addSDSEncodeListener(iaik.cms.SDSEncodeListener)">addSDSEncodeListener</A></B>(<A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms">SDSEncodeListener</A>&nbsp;sdsEncodeListener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds an SDSEncodeListener for this SignedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#addSignerInfo(iaik.cms.SignerInfo)">addSignerInfo</A></B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a SignerInfo object to this SignedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#clearSignatures(boolean, boolean)">clearSignatures</A></B>(boolean&nbsp;applicationSet,
                boolean&nbsp;clearMessageDigestAttributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clears the signature values of all included SignerInfos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)">decode</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reads and decodes the a BER encoded SignedData from the given input stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#encodeCalled(iaik.asn1.ASN1Object, int)">encodeCalled</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj,
             int&nbsp;id)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method implements the EncodeListener interface.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/attr/AttributeCertificate.html" title="class or interface in iaik.x509.attr">AttributeCertificate</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getAttributeCertificates()">getAttributeCertificates</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the attribute certificates included in this SignedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getBlockSize()">getBlockSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the block size defining the length of each definite primitive
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getCertificate(iaik.cms.CertificateIdentifier)">getCertificate</A></B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tries to find the signer certificate specified by the given CertificateIdentidier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.cert.Certificate[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getCertificates()">getCertificates</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all certificates included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getCertificates(iaik.cms.CertificateIdentifier)">getCertificates</A></B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tries to find the signer certificate chain specified by the given CertificateIdentidier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getCertificateSet()">getCertificateSet</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the certificateSet holding all certificates included in this SignedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getContentType()">getContentType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the content type this class implements.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getCRLs()">getCRLs</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the cerificate-revocation lists included in this
 <code>SignedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getDigestAlgorithms()">getDigestAlgorithms</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a collection of message-digest algorithm identifiers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getEncapsulatedContentType()">getEncapsulatedContentType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the content type the inherent EncapsulatetContentInfo represents.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.InputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getInputStream()">getInputStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an InputStream from where the signed content may be read.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getMessageDigest(iaik.asn1.structures.AlgorithmID)">getMessageDigest</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the message digest calculated for a specific algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getMode()">getMode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the mode of this SignedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getRevocationInfoChoices()">getRevocationInfoChoices</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the crls (RevocationInfoChoices) included in this SignedData.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getSecurityProvider()">getSecurityProvider</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SecurityProvider installed for this SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getSignedDigest(int)">getSignedDigest</A></B>(int&nbsp;signerInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the message digest included in the authenticated attributes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfo(iaik.cms.CertificateIdentifier)">getSignerInfo</A></B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searches for the SignerInfo identified by the given signer id.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfo(iaik.x509.X509Certificate)">getSignerInfo</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searches for the SignerInfo identified by the given certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfoIndex(iaik.x509.X509Certificate)">getSignerInfoIndex</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searches for the index of the signerInfo belonging to the given signer certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getSignerInfos()">getSignerInfos</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns all the signer infos included in this
 <code>SignedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getVersion()">getVersion</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the syntax version number (1 or 3 or 4).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#getX509Certificates()">getX509Certificates</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the X.509 public key certificates included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#notifyEOF()">notifyEOF</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method implements the EOFListener interface for performing the final decoding.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#removeMessageDigest(iaik.asn1.structures.AlgorithmID)">removeMessageDigest</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method can be used to remove a message digest.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#removeSignerInfo(iaik.cms.CertificateIdentifier)">removeSignerInfo</A></B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes the SignerInfo(s) with the given id from the SignerInfo list.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setBlockSize(int)">setBlockSize</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the block size for defining the length of each definite primitive 
 encoded octet string component.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setCertificates(java.security.cert.Certificate[])">setCertificates</A></B>(java.security.cert.Certificate[]&nbsp;certificates)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the certificates of the several signers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setCertificateSet(iaik.cms.CertificateSet)">setCertificateSet</A></B>(<A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A>&nbsp;certSet)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the certificateSet to be included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setCRLs(iaik.x509.X509CRL[])">setCRLs</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a set of certificate-revocation information objects.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)">setInputStream</A></B>(java.io.InputStream&nbsp;is)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the InputStream which holds the content to sign/verify.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setMessageDigest(iaik.asn1.structures.AlgorithmID, byte[])">setMessageDigest</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                 byte[]&nbsp;digest)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method can be used to set an externally calculated message digest.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setRevocationInfoChoices(iaik.cms.RevocationInfoChoices)">setRevocationInfoChoices</A></B>(<A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A>&nbsp;crls)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the crls (RevocationInfoChoices) to be included.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setSDSEncodeListener(iaik.cms.SDSEncodeListener)">setSDSEncodeListener</A></B>(<A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms">SDSEncodeListener</A>&nbsp;sdsEncodeListener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets an SDSEncodeListener for this SignedDataStream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)">setSecurityProvider</A></B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the SecurityProvider for this SignerInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#setSignerInfos(iaik.cms.SignerInfo[])">setSignerInfos</A></B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[]&nbsp;signerInfos)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets a collection of per-signer information.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#toASN1Object()">toASN1Object</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this SignedData as ASN1Object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#toASN1Object(int)">toASN1Object</A></B>(int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns this SignedData as ASN1Object where a constructed
 OCTET STRING is used for encoding the content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some information about this
 <code>SignedDataStream</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#toString(boolean)">toString</A></B>(boolean&nbsp;detailed)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string giving some - if requested - detailed information
 about this <code>SignedDataStream</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#verify(int)">verify</A></B>(int&nbsp;signerInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies the signature that has been created by the signer at <code>signerInfoIndex</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#verify(java.security.PublicKey, int)">verify</A></B>(java.security.PublicKey&nbsp;publicKey,
       int&nbsp;signerInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the provided public key for verifying the signature that has been created by 
 the signer at index <code>signerInfoIndex</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#verify(iaik.x509.X509Certificate)">verify</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the provided signer certificate for verifying the signature that has been created
 by the signer being owner of the certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream)">writeTo</A></B>(java.io.OutputStream&nbsp;os)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BER encodes and writes this object to the supplied output stream.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</A></B>(java.io.OutputStream&nbsp;os,
        int&nbsp;blockSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writes this object to the supplied output stream where a constructed
 OCTET STRING is used for encoding the content.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="IMPLICIT"><!-- --></A><H3>
IMPLICIT</H3>
<PRE>
public static final int <B>IMPLICIT</B></PRE>
<DL>
<DD>Mode where the signed content is included in the SignedData object.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.SignedDataStream.IMPLICIT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="EXPLICIT"><!-- --></A><H3>
EXPLICIT</H3>
<PRE>
public static final int <B>EXPLICIT</B></PRE>
<DL>
<DD>Mode where the signed content is NOT included in the SignedData object 
 (the content is transferred by other means).
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#iaik.cms.SignedDataStream.EXPLICIT">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="version_"><!-- --></A><H3>
version_</H3>
<PRE>
protected int <B>version_</B></PRE>
<DL>
<DD>The version number, default 1.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="contentType_"><!-- --></A><H3>
contentType_</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>contentType_</B></PRE>
<DL>
<DD>The content type of the to-be-signed content.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="encapContentInfo_"><!-- --></A><H3>
encapContentInfo_</H3>
<PRE>
protected <A HREF="../../iaik/cms/EncapsulatedContentInfoStream.html" title="class in iaik.cms">EncapsulatedContentInfoStream</A> <B>encapContentInfo_</B></PRE>
<DL>
<DD>The inherent EncapsualtedContentInfo.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="certSet_"><!-- --></A><H3>
certSet_</H3>
<PRE>
protected <A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A> <B>certSet_</B></PRE>
<DL>
<DD>Repository for the signer certificates.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="crls_"><!-- --></A><H3>
crls_</H3>
<PRE>
protected <A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A> <B>crls_</B></PRE>
<DL>
<DD>Repository for any included CRLs.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="signerInfos_"><!-- --></A><H3>
signerInfos_</H3>
<PRE>
protected java.util.Vector <B>signerInfos_</B></PRE>
<DL>
<DD>Repository for the SignerInfos.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="thisObject_"><!-- --></A><H3>
thisObject_</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/DerInputStream.html" title="class or interface in iaik.asn1">DerInputStream</A> <B>thisObject_</B></PRE>
<DL>
<DD>An InputStream from which a DER encoded SignedData object is read.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="inputStream_"><!-- --></A><H3>
inputStream_</H3>
<PRE>
protected java.io.InputStream <B>inputStream_</B></PRE>
<DL>
<DD>An InputStream holding the data.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mode_"><!-- --></A><H3>
mode_</H3>
<PRE>
protected int <B>mode_</B></PRE>
<DL>
<DD>The mode specifying if the signed message is included in the Signature
 (IMPLICIT), or if is not transported within the Signature (EXPLICIT).
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="blockSize_"><!-- --></A><H3>
blockSize_</H3>
<PRE>
protected int <B>blockSize_</B></PRE>
<DL>
<DD>The block size for block oriented stream encoding.
 (Default: 2048 to enforce indefinite constructed encoding).
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="securityProvider_"><!-- --></A><H3>
securityProvider_</H3>
<PRE>
protected <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>securityProvider_</B></PRE>
<DL>
<DD>The SecurityProvider to be used.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SignedDataStream()"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
protected <B>SignedDataStream</B>()</PRE>
<DL>
<DD>Default constructor for dynamic object creation in ContentInfo.
 Shall not be used by an application for creating a SignedDataStream
 object.
 The block size is set to 2048 to enforce indefinite constructed encoding.
<P>
</DL>
<HR>

<A NAME="SignedDataStream(iaik.asn1.ObjectID)"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
public <B>SignedDataStream</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType)</PRE>
<DL>
<DD>Creates a new SignedDataStream object without any content.

 The content value to be signed has to be of the given content type
 and has to be supplied by other means.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>contentType</CODE> - the contentType of the data</DL>
</DL>
<HR>

<A NAME="SignedDataStream(java.io.InputStream, int)"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
public <B>SignedDataStream</B>(java.io.InputStream&nbsp;data_is,
                        int&nbsp;mode)</PRE>
<DL>
<DD>Creates a SignedDataStream object from an input stream supplying the data to be
 signed.
 The given mode specifies the way the content data is transmitted. If the mode is
 <i>SignedDataStream.IMPLICIT</i>, the content data is included in the SignedData 
 message to be transmitted. If the mode is <i>SignedDataStream.EXPLICIT</i>, the
 content data is not included in the SignedData object. The content type of the 
 inherent EncapsulatedContentInfo is set to CMS (PKCS#7) id-data.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>data_is</CODE> - a stream holding the data to sign<DD><CODE>mode</CODE> - IMPLICIT if the message shall be included in the DER encoding,
             EXPLICIT otherwise</DL>
</DL>
<HR>

<A NAME="SignedDataStream(java.io.InputStream, iaik.asn1.ObjectID, int)"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
public <B>SignedDataStream</B>(java.io.InputStream&nbsp;data_is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A>&nbsp;contentType,
                        int&nbsp;mode)</PRE>
<DL>
<DD>Creates a SignedDataStream object from an input stream supplying the data to be
 signed.
 The given mode specifies the way the content data is transmitted. If the mode is
 <i>SignedDataStream.IMPLICIT</i>, the content data is included in the SignedData 
 message to be transmitted. If the mode is <i>SignedDataStream.EXPLICIT</i>, the
 content data is not included in the SignedData object. 
 <p>
 Use this constructor for signing content having any other type than CMS (PKCS#7) id-data.
 In such cases typically the given InputStream will supply the DER encoding of a particular 
 content object to be signed. The PKIX Time Stamp protocol, for instance, defines a 
 TSTInfo structure to be signed by using a CMS SignedData object. Assuming to 
 read a DER encoded <code>TSTInfo</code> from an input stream it may be
 supplied to a SignedDataStream-object in a way similar to:
 <pre>
 // the input stream supplying the DER encoded TSTInfo:
 InputStream encodedTSTInfo = ...;
 // now sign the TSTInfo:
 ObjectID oid = ObjectID.tstInfo;
 int mode = SignedDataStream.IMPLICIT;
 SignedDataStream signedData = new SignedDataStream(enodedTSTInfo, oid, mode);
 ...
 </pre>
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>data_is</CODE> - a stream holding the data to sign<DD><CODE>contentType</CODE> - the contentType for the inherent EncapsulatedContentInfo<DD><CODE>mode</CODE> - MPLICIT if the message shall be included in the DER encoding,
              EXPLICIT otherwise</DL>
</DL>
<HR>

<A NAME="SignedDataStream(java.io.InputStream)"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
public <B>SignedDataStream</B>(java.io.InputStream&nbsp;is)
                 throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                        java.io.IOException</PRE>
<DL>
<DD>Creates a new SignedDataStream from a BER encoded SignedData object
 which is read from the given InputStream.  The encoded SignedData may 
 (or may not) be wrapped into a ContentInfo. 
 <p>
 Do <i><b>not</b></i> use this constructor for supplying the content data
 to be signed. This constructor may be used by the recipient for parsing an
 already exisiting <code>SignedDataStream</code> object, supplied as DER encoding 
 from an input stream, and may have been created by one of the 
 <A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> methods.
 <p>
 Use the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, int)"><CODE>SignedDataStream(InputStream data_is, int mode)</CODE></A> or
 <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.ObjectID, int)"><CODE>SignedDataStream(InputStream data_is, ObjectID contentType, int mode)</CODE></A>
 constructors for supplying the content data to be signed when creating a
 <code>SignedDataStream</code> object.
 <p>
 This constructor only shall be used for decoding a SignedData object with 
 included content data (<i>implicit</i> mode) or in explicit mode (where
 the content data is not included) when subsequently supplying the content data
 by calling method <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A>. In explicit mode
 alternatively the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[])"><CODE>SignedDataStream(InputStream data_is, AlgorithmID[] hashAlgorithms)</CODE></A>
 constructor maybe used to initialize the hash computation with content data
 and hash algorithms, and the decoding may be explicitly performed by calling the  
 <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> method.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream holding a DER encoded CMS SignedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>
<HR>

<A NAME="SignedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
public <B>SignedDataStream</B>(java.io.InputStream&nbsp;is,
                        <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                 throws <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A>,
                        java.io.IOException</PRE>
<DL>
<DD>Creates a new SignedDataStream from a BER encoded SignedData object
 which is read from the given InputStream.  The encoded SignedData may 
 (or may not) be wrapped into a ContentInfo. 
 <p>
 Do <i><b>not</b></i> use this constructor for supplying the content data
 to be signed. This constructor may be used by the recipient for parsing an
 already existing <code>SignedDataStream</code> object, supplied as DER encoding 
 from an input stream, and may have been created by one of the 
 <A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> methods.
 <p>
 Use the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, int)"><CODE>SignedDataStream(InputStream data_is, int mode)</CODE></A> or
 <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.ObjectID, int)"><CODE>SignedDataStream(InputStream data_is, ObjectID contentType, int mode)</CODE></A>
 constructors for supplying the content data to be signed when creating a
 <code>SignedDataStream</code> object.
 <p>
 This constructor only shall be used for decoding a SignedData object with 
 included content data (<i>implicit</i> mode) or in explicit mode (where
 the content data is not included) when subsequently supplying the content data
 by calling method <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A>. In explicit mode
 alternatively the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)"><CODE>SignedDataStream(InputStream data_is, AlgorithmID[] hashAlgorithms, SecurityProvider
 securityProvider)</CODE></A> constructor maybe used to initialize the hash computation with content data
 and hash algorithms, and the decoding may be explicitly performed by calling the  
 <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> method.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream holding a DER encoded CMS SignedData object<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for this SignedData object; if <code>null</code>
                         the default system-wide installed SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DL>
<HR>

<A NAME="SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[])"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
public <B>SignedDataStream</B>(java.io.InputStream&nbsp;data_is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;hashAlgorithms)
                 throws java.io.IOException</PRE>
<DL>
<DD>Creates a new SignedDataStream from an InputStream holding the content that
 has been transmitted by other means, and an array specifying the hash 
 algorithms to be used for digesting.
 <p>
 Do <i><b>not</b></i> use this constructor for supplying the content value
 to be signed. This constructor may be used by the recipient for initializing 
 the digest computation for an already existing explicit SignedDataStream message
 where the content data is not included. The initialization is done by wrapping a digest
 stream around the supplied content data stream for any specified hash algorithm.
 Subsequently the hash values will be updated when reading the stream thereby 
 piping the data through the digest streams. 
 <br>
 For an explicit message the actual decoding has to be performed by calling
 the <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> method just after reading the 
 data:
 <pre>
 // initialize for hash computation:
 SignedDataStream signedData = new SignedDataStream(data_is, hashAlgorithms);
 //read the stream thereby updating the hash values:
 InputStream dataIs = signed_data.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = dataIs.read(buf)) > 0) {
   // do something useful 
 }
 // explicitly perform the decoding
 signedData.decode(encoded_stream);
 </pre>
 <p>
 A sender shall use the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, int)"><CODE>SignedDataStream(InputStream data_is, int mode)</CODE></A>
 constructor for supplying the content to be signed when creating a
 <code>SignedDataStream</code> object.
 <p>
 For decoding an implicit SignedDataStream message, use the  
 <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)"><CODE>SignedDataStream(InputStream is)</CODE></A> constructor.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>data_is</CODE> - the InputStream supplying the content data which has been transmitted by other means<DD><CODE>hashAlgorithms</CODE> - the hash algorithms used by the participated signers for digesting the
                       content data
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if there is no implementation for the specified hash algorithm</DL>
</DL>
<HR>

<A NAME="SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)"><!-- --></A><H3>
SignedDataStream</H3>
<PRE>
public <B>SignedDataStream</B>(java.io.InputStream&nbsp;data_is,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[]&nbsp;hashAlgorithms,
                        <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)
                 throws java.io.IOException</PRE>
<DL>
<DD>Creates a new SignedDataStream from an InputStream holding the content that
 has been transmitted by other means, and an array specifying the hash 
 algorithms to be used for digesting.
 <p>
 Do <i><b>not</b></i> use this constructor for supplying the content value
 to be signed. This constructor may be used by the recipient for initializing 
 the digest computation for an already existing explicit SignedDataStream message
 where the content data is not included. The initialization is done by wrapping a digest
 stream around the supplied content data stream for any specified hash algorithm.
 Subsequently the hash values will be updated when reading the stream thereby 
 piping the data through the digest streams. 
 <br>
 For an explicit message the actual decoding has to be performed by calling
 the <A HREF="../../iaik/cms/SignedDataStream.html#decode(java.io.InputStream)"><CODE>decode</CODE></A> method just after reading the 
 data:
 <pre>
 // initialize for hash computation:
 SignedDataStream signedData = new SignedDataStream(data_is, hashAlgorithms);
 //read the stream thereby updating the hash values:
 InputStream dataIs = signed_data.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = dataIs.read(buf)) > 0) {
   // do something useful 
 }
 // explicitly perform the decoding
 signedData.decode(encoded_stream);
 </pre>
 Using this constructor requires that the digest algorithms for an explicit SignedData 
 message have to be known in advance before actually parsing it. 
 <br>
 When not knowing the digest algorithm(s) of the to-be-parsed SignedData message in advance
 it will be more appropriate to create the SignedDataStream with the 
 <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)"><CODE>SignedDataStream(InputStream is)</CODE></A>  constructor
 and subsequently call method <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A> to provide the
 content data received by other means:   
 <pre>
 // the stream from which to read the encoded SignedData
 InputStream encoded_stream = ...;
 SignedDataStream signedData = new SignedDataStream(encoded_stream);
 
 // in explicit mode explicitly supply the content for hash computation
 if (signed_data.getMode() == SignedDataStream.EXPLICIT) {
   // the content data provided by other means:
   InputStream dataIs = ...;  
   signedData.setInputStream(dataIs);
 }
 //read the stream thereby updating the hash values:
 InputStream dataIs = signedData.getInputStream();
 byte[] buf = new byte[4096];
 int r;
 while ((r = dataIs.read(buf)) > 0) {
   // do something useful 
 }
 .... 
 
 </pre>

 
 
 <p>
 A sender shall use the <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, int)"><CODE>SignedDataStream(InputStream data_is, int mode)</CODE></A>
 constructor for supplying the content to be signed when creating a
 <code>SignedDataStream</code> object.
 <p>
 For decoding an implicit SignedDataStream message, use the  
 <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream)"><CODE>SignedDataStream(InputStream is)</CODE></A> constructor.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>data_is</CODE> - the InputStream supplying the content data which has been transmitted by other means<DD><CODE>hashAlgorithms</CODE> - the hash algorithms used by the participated signers for digesting the
                       content data<DD><CODE>securityProvider</CODE> - the SecurityProvider to be used for this SignedData object; if <code>null</code>
                         the default system-wide installed SecurityProvider is used
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if there is no implementation for the specified hash algorithm</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="setSecurityProvider(iaik.cms.SecurityProvider)"><!-- --></A><H3>
setSecurityProvider</H3>
<PRE>
public void <B>setSecurityProvider</B>(<A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A>&nbsp;securityProvider)</PRE>
<DL>
<DD>Sets the SecurityProvider for this SignerInfo.
 <p>
 This method allows to explicitly set a SecurityProvider for this SignerInfo.
 If no explicit SecurityProvider is set, the default system wide installed 
 SecurityProvider will be used for the required cryptographic operations.
 <p>
 This class may use the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.InputStream)"><CODE>getInputStreamHashEngine()</CODE></A></code>
     to get an InputStreamHashEngine through which the data is to be piped for hash value calculation
 </ul>
 And the following methods may be used by the inherent <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> objects:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes()</CODE></A></code>
     to calculate the signature value from the encoding of the signed attributes
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromHash()</CODE></A></code>
     to calculate the signature value from the message hash
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#verifySignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])"><CODE>verifySignatureFromSignedAttributes()</CODE></A></code>
     to verify the signature value calculated from the encoding of the signed attributes
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#verifySignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])"><CODE>verifySignatureFromHash()</CODE></A></code>
     to verify the signature value calculated from the message hash
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])"><CODE>getHash()</CODE></A></code>
     as may be required for cert hash calculation when querying for included <A HREF="../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> attributes
 </ul>
 On the parsing side, an application may prefer to supply the SecurityProvider immediately when creating
 an <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.cms.SecurityProvider)"><CODE>implicit</CODE></A> or <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[], iaik.cms.SecurityProvider)"><CODE>explicit</CODE></A> SignedDataStream object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>securityProvider</CODE> - the SecurityProvider to be set</DL>
</DD>
</DL>
<HR>

<A NAME="getSecurityProvider()"><!-- --></A><H3>
getSecurityProvider</H3>
<PRE>
public <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms">SecurityProvider</A> <B>getSecurityProvider</B>()</PRE>
<DL>
<DD>Gets the SecurityProvider installed for this SignerInfo.
 <p>
 This class uses the following method(s) of the <A HREF="../../iaik/cms/SecurityProvider.html" title="class in iaik.cms"><CODE>SecurityProvider</CODE></A>, which may be overriden by an application, if required:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getInputStreamHashEngine(iaik.asn1.structures.AlgorithmID, java.io.InputStream)"><CODE>getInputStreamHashEngine()</CODE></A></code>
     to get an InputStreamHashEngine through which the data is to be piped for hash value calculation
 </ul>
 And the following methods may be used by the inherent <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> objects:
 <ul>
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes()</CODE></A></code>
     to calculate the signature value from the encoding of the signed attributes
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromHash()</CODE></A></code>
     to calculate the signature value from the message hash
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#verifySignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])"><CODE>verifySignatureFromSignedAttributes()</CODE></A></code>
     to verify the signature value calculated from the encoding of the signed attributes
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#verifySignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PublicKey, byte[], byte[])"><CODE>verifySignatureFromHash()</CODE></A></code>
     to verify the signature value calculated from the message hash
 <li><code><A HREF="../../iaik/cms/SecurityProvider.html#getHash(iaik.asn1.structures.AlgorithmID, byte[])"><CODE>getHash()</CODE></A></code>
     as may be required for cert hash calculation when querying for included <A HREF="../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> attributes
 </ul>
 If no explicit SecurityProvider has been <A HREF="../../iaik/cms/SignedDataStream.html#setSecurityProvider(iaik.cms.SecurityProvider)"><CODE>set</CODE></A> for this object, 
 the default system wide installed SecurityProvider will be used for the required cryptographic
 operations. However, this method will return <code>null</code> if it does not have its own
 SecurityProvider.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the SecurityProvider explicitly installed for this object, or <code>null</code> if
         this object does not have its own SecurityProvider</DL>
</DD>
</DL>
<HR>

<A NAME="decode(java.io.InputStream)"><!-- --></A><H3>
decode</H3>
<PRE>
public void <B>decode</B>(java.io.InputStream&nbsp;is)
            throws java.io.IOException,
                   <A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></PRE>
<DL>
<DD>Reads and decodes the a BER encoded SignedData from the given input stream.
 The given SignedData may (or may not) be wrapped into a ContentInfo. 
 <p>
 This method implicitly is called from inside the corresponding constructor for
 decoding an received implicit SignedDataStream object where the content data is 
 included.
 This method has to be explicitly called for decoding a received explicit 
 SignedDataStream object where the content data is not included. Before calling 
 this method for decoding an explicit message, a new SignedDataStream object
 has to be created by means of the 
 <A HREF="../../iaik/cms/SignedDataStream.html#SignedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID[])"><CODE>SignedDataStream(InputStream data_is, AlgorithmID[] hashAlgorithms)</CODE></A> 
 constructor for initializing it for hash computation, and the data has to be
 read from the stream for upadating the hash values:
 <pre>
 // initialize for hash computation:
 SignedDataStream signedData = new SignedDataStream(data_is, hashAlgorithms);
 //read the stream thereby updating the hash values:
 InputStream dataIs = signed_data.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = dataIs.read(buf)) > 0) {
   // do something useful 
 }
 // explicitly perform the decoding
 signedData.decode(encoded_stream);
 </pre>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#decode(java.io.InputStream)">decode</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - the InputStream holding a DER encoded CMS SignedData object
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs during reading from the InputStream
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - if an error occurs while parsing the object</DL>
</DD>
</DL>
<HR>

<A NAME="notifyEOF()"><!-- --></A><H3>
notifyEOF</H3>
<PRE>
public void <B>notifyEOF</B>()
               throws java.io.IOException</PRE>
<DL>
<DD>This method implements the EOFListener interface for performing the final decoding.
 Since the certificates, crls, and signerInfos fields are located at the end 
 of a SignedData structure, they only can be accessed after reading the data stream.
 For that reason, when starting the parsing of an implicit SignedData message only
 version, digestAlgorithms, and ContentInfo fields can be parsed before reading the data.
 Since the data is supplied from an input stream, a <code>iaik.utils.NotifyEOFInputStream
 </code>is wrapped around this content data stream
 for indicating that the parsing procedure is to be notified when the stream actually
 has been read. At that point, the programm exceuting automatically jumps to the
 actual <code>notifyEOF</code> method for finishing the decoding by parsing the
 remaining certificates, crls and signerInfos fields.
 <br>
 <b>For any application it is strongly recommended recommended <i>not</i> to explicitly
 call this method.</b> This method only is qualified as public method since it implements
 the <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils"><CODE>iaik.utils.EOFListener</CODE></A>
 interface.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html#notifyEOF()" title="class or interface in iaik.utils">notifyEOF</A></CODE> in interface <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils">EOFListener</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs while parsing the stream<DT><B>See Also:</B><DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/EOFListener.html" title="class or interface in iaik.utils"><CODE>EOFListener</CODE></A>, 
<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/utils/NotifyEOFInputStream.html" title="class or interface in iaik.utils"><CODE>NotifyEOFInputStream</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="encodeCalled(iaik.asn1.ASN1Object, int)"><!-- --></A><H3>
encodeCalled</H3>
<PRE>
public void <B>encodeCalled</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A>&nbsp;obj,
                         int&nbsp;id)
                  throws <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></PRE>
<DL>
<DD>This method implements the EncodeListener interface.
 During the encoding process the DerCoder calls this method when
 it actually is time for encoding certificates, crls and SignerInfos
 components. Before each SignerInfo is encoded its signature value
 is calculated. The message digest calculated over the content data
 cannot be computed before the content stream entirely has been read.
 Since the content stream actually is read during the encoding procedure,
 the <code>SignerDataStream</code> registers itself as encode listener
 for the SEQUENCE representing the final ASN.1 SignedData object. After
 the content stream has been read and before certificates, crls and
 SignerInfos are to be encoded, this class is notified by means of the 
 <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1"><CODE>EncodeListener</CODE></A> utility.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html#encodeCalled(iaik.asn1.ASN1Object, int)" title="class or interface in iaik.asn1">encodeCalled</A></CODE> in interface <CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/EncodeListener.html" title="class or interface in iaik.asn1">EncodeListener</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>obj</CODE> - the SignedData SEQUENCE<DD><CODE>id</CODE> - the id identifying the SEQUENCE to be processed
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/CodingException.html" title="class or interface in iaik.asn1">CodingException</A></CODE> - if an error occurs when computing/signing 
                            the message digest</DL>
</DD>
</DL>
<HR>

<A NAME="getMode()"><!-- --></A><H3>
getMode</H3>
<PRE>
public int <B>getMode</B>()</PRE>
<DL>
<DD>Returns the mode of this SignedData.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>IMPLICIT</code> or <code>EXPLICIT</code></DL>
</DD>
</DL>
<HR>

<A NAME="getMessageDigest(iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
getMessageDigest</H3>
<PRE>
public byte[] <B>getMessageDigest</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm)
                        throws java.security.NoSuchAlgorithmException,
                               <A HREF="../../iaik/cms/CMSRuntimeException.html" title="class in iaik.cms">CMSRuntimeException</A></PRE>
<DL>
<DD>Returns the message digest calculated for a specific algorithm. This method
 implements the <CODE>DigestProvider</CODE>
 interface, and therefore has to be qualified as <i>public</i> method. However, there should
 be no necessity for an application to utilize this method. This method only is called
 from inside the <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A> class
 for obtaining the digest calculated on the content for the specified hash algorithm.
 <p>
 <b>It is strongly recommended <i>not</i> to explicitly call this method,
 since it actually finshes the digest computation for all hash values resulting
 from piping the data through the digest streams. This only has to be performed
 once and is done from inside the <code>SignerInfo</code> class!</b>
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the hash algorithm to be used for digest computation
<DT><B>Returns:</B><DD>the message digest calculated on the content for the given hash algorithm
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no message digest for the specified algorithm
<DD><CODE><A HREF="../../iaik/cms/CMSRuntimeException.html" title="class in iaik.cms">CMSRuntimeException</A></CODE> - if an error occurs because of some kind of initiailization problem
                                (e.g. the data to be digested has not been supplied)</DL>
</DD>
</DL>
<HR>

<A NAME="setMessageDigest(iaik.asn1.structures.AlgorithmID, byte[])"><!-- --></A><H3>
setMessageDigest</H3>
<PRE>
public void <B>setMessageDigest</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                             byte[]&nbsp;digest)
                      throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>This method can be used to set an externally calculated message digest.
 When having created a new SignedDataStream for signing some content, this
 method has to be called after having <A HREF="../../iaik/cms/SignedDataStream.html#setSignerInfos(iaik.cms.SignerInfo[])"><CODE>added</CODE></A> the
 SignerInfos. If none of the SignerInfos uses the specified digest algorithm
 a NoSuchAlgorithmException is thrown and the digest cannot be added. 
 On the parsing side a digest value can be set for any of the digest 
 algorithms that are parsed from the digestAlgorithms field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the hash algorithm for which the digest shall be set<DD><CODE>digest</CODE> - the new value for the messsage digest
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the specified digest algorithm is not
                                     by any of the SignerInfos of this SignedData</DL>
</DD>
</DL>
<HR>

<A NAME="removeMessageDigest(iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
removeMessageDigest</H3>
<PRE>
public boolean <B>removeMessageDigest</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm)</PRE>
<DL>
<DD>This method can be used to remove a message digest.
 <p>
 When calling this method please be sure that the MessageDigest
 is not required by any of the included SignerInfos.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlgorithm</CODE> - the hash algorithm to be removed
<DT><B>Returns:</B><DD><code>true</code> if the MessageDigest entry has been removed,
         <code>false</code> if it has been not removed or no entry
         with the given hash algorithm was present</DL>
</DD>
</DL>
<HR>

<A NAME="setBlockSize(int)"><!-- --></A><H3>
setBlockSize</H3>
<PRE>
public void <B>setBlockSize</B>(int&nbsp;blockSize)</PRE>
<DL>
<DD>Sets the block size for defining the length of each definite primitive 
 encoded octet string component. 
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole data is encoded as definite primitive octet string.
 This method may be used for enforcing block encoding when wrapping the
 SignedData into a ContentInfo.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#setBlockSize(int)">setBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - for defining the encoding scheme and setting the octet
        string component length, if positive<DT><B>See Also:</B><DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/OCTET_STRING.html" title="class or interface in iaik.asn1"><CODE>OCTET_STRING</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getBlockSize()"><!-- --></A><H3>
getBlockSize</H3>
<PRE>
public int <B>getBlockSize</B>()</PRE>
<DL>
<DD>Gets the block size defining the length of each definite primitive
 encoded octet string component.
 If the value of <code>blockSize</code> is smaller or equal to zero the
 whole data is encoded as definite primitive octet string.
 This method may be used for enforcing block encoding when wrapping the
 EncryptedData into a ContentInfo.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getBlockSize()">getBlockSize</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>blockSize defining the encoding scheme and setting the octet
        string component length, if positive<DT><B>See Also:</B><DD><A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/OCTET_STRING.html" title="class or interface in iaik.asn1"><CODE>OCTET_STRING</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setInputStream(java.io.InputStream)"><!-- --></A><H3>
setInputStream</H3>
<PRE>
public void <B>setInputStream</B>(java.io.InputStream&nbsp;is)</PRE>
<DL>
<DD>Sets the InputStream which holds the content to sign/verify.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>is</CODE> - InputSteam holding the content to sign/verify</DL>
</DD>
</DL>
<HR>

<A NAME="getInputStream()"><!-- --></A><H3>
getInputStream</H3>
<PRE>
public java.io.InputStream <B>getInputStream</B>()</PRE>
<DL>
<DD>Returns an InputStream from where the signed content may be read.
 <p>
 Attention! The stream only may be read once.
 <p>
 When having created a new <code>SignedDataStream</code> object to
 be encoded to a stream, this method should only be called in <A HREF="../../iaik/cms/SignedDataStream.html#EXPLICIT"><CODE>EXPLICT</CODE></A> mode to get and read away the content to be transmitted by other means.
 In <A HREF="../../iaik/cms/SignedDataStream.html#IMPLICIT"><CODE>IMPLICT</CODE></A> mode this method shall not be called at all since
 the content has to be included in the SignedData message (and
 therefore should not be read "away").
 <br>
 When having decoded and parsed a received <code>SignedData</code> object
 coming from some stream, this method may be used for obtaining the raw 
 content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an InputSteam holding the signed content</DL>
</DD>
</DL>
<HR>

<A NAME="getContentType()"><!-- --></A><H3>
getContentType</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>getContentType</B>()</PRE>
<DL>
<DD>Returns the content type this class implements.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#getContentType()">getContentType</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>ObjectID.cms_signedData</code></DL>
</DD>
</DL>
<HR>

<A NAME="getEncapsulatedContentType()"><!-- --></A><H3>
getEncapsulatedContentType</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ObjectID.html" title="class or interface in iaik.asn1">ObjectID</A> <B>getEncapsulatedContentType</B>()</PRE>
<DL>
<DD>Returns the content type the inherent EncapsulatetContentInfo represents.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the content type the inherent EncapsulatetContentInfo represents</DL>
</DD>
</DL>
<HR>

<A NAME="setCertificates(java.security.cert.Certificate[])"><!-- --></A><H3>
setCertificates</H3>
<PRE>
public void <B>setCertificates</B>(java.security.cert.Certificate[]&nbsp;certificates)</PRE>
<DL>
<DD>Sets the certificates of the several signers.
 <p>
 <b>Attention!</b> Only X.509 public key certificates (instances of
 <code>iaik.x509.X509Certificate</code>) or X.509 attribute certificates 
 (instances of <code>iaik.x509.attr.AttributeCertificate</code>) or other
 certificates (instances of <code>iaik.cms.OtherCertificate</code>) can be
 added to this CertificateSet; PKCS#6 extended certificates are obsolete
 and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certificates</CODE> - the certificates to be set
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied certificates
            is not a <code>iaik.x509.X509Certificate</code> or 
            <code>iaik.x509.attr.AttributeCertificate</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="addCertificates(java.security.cert.Certificate[])"><!-- --></A><H3>
addCertificates</H3>
<PRE>
public void <B>addCertificates</B>(java.security.cert.Certificate[]&nbsp;certificates)</PRE>
<DL>
<DD>Adds the given certificates.
 <p>
 <b>Attention!</b> Only X.509 public key certificates (instances of
 <code>iaik.x509.X509Certificate</code>) or X.509 attribute certificates 
 (instances of <code>iaik.x509.attr.AttributeCertificate</code>) or other
 certificates (instances of <code>iaik.cms.OtherCertificate</code>) can be
 added to this CertificateSet; PKCS#6 extended certificates are obsolete
 and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certificates</CODE> - the certificates to be added
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied certificates
            is not a <code>iaik.x509.X509Certificate</code> or 
            <code>iaik.x509.attr.AttributeCertificate</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="setCertificateSet(iaik.cms.CertificateSet)"><!-- --></A><H3>
setCertificateSet</H3>
<PRE>
public void <B>setCertificateSet</B>(<A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A>&nbsp;certSet)</PRE>
<DL>
<DD>Sets the certificateSet to be included.
 This method provides an alternative way to set the certificates by immediately
 supplying a <A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms"><CODE>CertificateSet</CODE></A> that may hold any
 number of X.509 public key and/or attribute certificates.
 <br>
 <b>Attention!</b> Only X.509 public key certificates (instances of
 <code>iaik.x509.X509Certificate</code>) or X.509 attribute certificates 
 (instances of <code>iaik.x509.attr.AttributeCertificate</code>) or other
 certificates (instances of <code>iaik.cms.OtherCertificate</code>) can be
 added to this CertificateSet; PKCS#6 extended certificates are obsolete
 and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certSet</CODE> - the certificate set to be added
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied certificates
            is not a <code>iaik.x509.X509Certificate</code> or 
            <code>iaik.x509.attr.AttributeCertificate</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="setRevocationInfoChoices(iaik.cms.RevocationInfoChoices)"><!-- --></A><H3>
setRevocationInfoChoices</H3>
<PRE>
public void <B>setRevocationInfoChoices</B>(<A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A>&nbsp;crls)</PRE>
<DL>
<DD>Sets the crls (RevocationInfoChoices) to be included.
 This method provides an alternative way to set the crls by immediately
 supplying a <A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms"><CODE>RevocationInfoChoices</CODE></A> set that may hold any
 number of X.509 or other crls.
 <br>
 <b>Attention!</b> Only X.509 crls (instances of
 <code>iaik.x509.X509CRL</code>) or other revocation infos
 (instances of <code>iaik.cms.OtherRevocationInfo</code>) can be
 included in the given RevocationInfoChoices set.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>crls</CODE> - the RevocationInfoChoices to be set
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied revocation
            infos is not a <code>iaik.x509.X509CRL</code> or 
            <code>iaik.cms.OtherCertificate</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="setCRLs(iaik.x509.X509CRL[])"><!-- --></A><H3>
setCRLs</H3>
<PRE>
public void <B>setCRLs</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</PRE>
<DL>
<DD>Sets a set of certificate-revocation information objects.
 <p>
 The given CRLs supply information about the revocation status of the
 certificates specified in the <code>certificates</code> field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>crls</CODE> - the certificate-revocation information objects as array of CRL
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied RevocationInfos
         is not a <code>iaik.x509.X509CRL</code> or 
         <code>iaik.cms.OtherRevocationInfo</code>, <code>iaik.cms.OCSPRevocationInfo</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="addCRLs(iaik.x509.X509CRL[])"><!-- --></A><H3>
addCRLs</H3>
<PRE>
public void <B>addCRLs</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[]&nbsp;crls)</PRE>
<DL>
<DD>Adds the given certificate-revocation information objects.
 <p>
 The given CRLs supply information about the revocation status of the
 certificates specified in the <code>certificates</code> field.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>crls</CODE> - the certificate-revocation information objects to be added
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any of the supplied RevocationInfos
         is not a <code>iaik.x509.X509CRL</code> or 
         <code>iaik.cms.OtherRevocationInfo</code>, <code>iaik.cms.OCSPRevocationInfo</code> object</DL>
</DD>
</DL>
<HR>

<A NAME="setSignerInfos(iaik.cms.SignerInfo[])"><!-- --></A><H3>
setSignerInfos</H3>
<PRE>
public void <B>setSignerInfos</B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[]&nbsp;signerInfos)
                    throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Sets a collection of per-signer information.
 <p>
 There may be any number of elements in the collection, including zero.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfos</CODE> - a collection of per-signer information
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the message digest algorithm
            specified in one signerInfo<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addSignerInfo(iaik.cms.SignerInfo)"><!-- --></A><H3>
addSignerInfo</H3>
<PRE>
public void <B>addSignerInfo</B>(<A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>&nbsp;signerInfo)
                   throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Adds a SignerInfo object to this SignedData.
 <p>
 This method not only adds the given SignerInfo, but also
 initializes the hash computation by wrapping a digest stream
 for the hash algorithm of the SignerInfo around the data carrying input stream.
 <br>
 If the given SignerInfo contains signed attributes, it must include 
 the PKCS#9 content-type attribute and the PKCS#9 message-digest attribute. 
 If the message-digest attribute is not included in the supplied signed attributes
 it is automatically calculated and set later during signature calculation. If the 
 content-type attribute is not included it is automatically added and set to the 
 eContentType of the SignedData EncapsulatedContentInfo. 
 However, if the signature value is already set for the SignerInfo, an Exception is 
 thrown if the content-type attribute is not included in the signed attributes. An
 Exception is also thrown if the content-type attribute is already included in the
 SignerInfo but does not match to the eContentType of the SignedData EncapsulatedContentInfo.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfo</CODE> - the SignerInfo to add
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the message digest algorithm
            specified in the signerInfo, or if the signature value is already set for
            the SignerInfo and the ContentType attribute is not included in the signed
            attributes, or if the content-type attribute is already included in the SignerInfo
            but does not match to the eContentType of the SignedData EncapsulatedContentInfo
            (for backwards compatibility only an NoSuchAlgorithmException can be
            thrown by this method)<DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addDigestAlgorithm(iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
addDigestAlgorithm</H3>
<PRE>
public void <B>addDigestAlgorithm</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlg)
                        throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Adds a digest algorithm.
 <p>
 Usually any digest algorithm required by any SignerInfo is automatically
 added when <A HREF="../../iaik/cms/SignedDataStream.html#addSignerInfo(iaik.cms.SignerInfo)"><CODE>adding</CODE></A> a SignerInfo.
 <br>
 This method provides the possibility to add a digest algorithm that
 may be needed for calculating a digest over the data that may be required
 for other purposes than SignerInfo signature calculation.
 <br>
 <b>Attention</b>This method has to be called before the content data
 is processed (which is done either implicitly when the SignedData is
 encoded or explicitly when reading the content data in EXPLICIT mode).
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestAlg</CODE> - the digest algorithm to add
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if there is no implementation for the message digest algorithm
            available</DL>
</DD>
</DL>
<HR>

<A NAME="removeSignerInfo(iaik.cms.CertificateIdentifier)"><!-- --></A><H3>
removeSignerInfo</H3>
<PRE>
public boolean <B>removeSignerInfo</B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)</PRE>
<DL>
<DD>Removes the SignerInfo(s) with the given id from the SignerInfo list.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerIdentifier</CODE> - the id of the SignerInfo to be removed
<DT><B>Returns:</B><DD><code>true</code> if the SignerInfo has been successfully 
         removed, <code>false</code> if it has not been removed</DL>
</DD>
</DL>
<HR>

<A NAME="setSDSEncodeListener(iaik.cms.SDSEncodeListener)"><!-- --></A><H3>
setSDSEncodeListener</H3>
<PRE>
public void <B>setSDSEncodeListener</B>(<A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms">SDSEncodeListener</A>&nbsp;sdsEncodeListener)
                          throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Sets an SDSEncodeListener for this SignedDataStream.
 <p>
 An <A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms"><CODE>SDSEncodeListener</CODE></A> allows an
 application to update a SignedDataStream object during it is
 encoded. This may be useful for adding SignerInfos/certificates/crls
 or adding SignerInfo attributes before or after the signatures
 are computed (e.g. when encoding an already exisiting and 
 currently parsed SignedDataStream again). Since any SignerInfo to
 be added during the encoding process may use some digest algorithm 
 not used by any already included SignerInfo, the SDSEncodeListener
 may announce the corresponding digest algorihtm(s) when it is 
 bound to the SignedDataStream by calling this <code>setSDSEncodeListener</code>
 method. 
 <br>
 An SDSEncodeListener can only be set for this stream
 version of the SignedData content type implementation, 
 but not for the non-stream <A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A>
 implementation, which does not need and SDSEncodeListener
 and simply will ignore it.
 <p>
 Any already set EncodeListener will be removed.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sdsEncodeListener</CODE> - the SDSEncodeListener to be set
<DT><B>Throws:</B>
<DD><CODE>if</CODE> - the SDSEncodeListener announces any not supported
            digest algorithms to be used
<DD><CODE>java.security.NoSuchAlgorithmException</CODE><DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms"><CODE>SDSEncodeListener</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="addSDSEncodeListener(iaik.cms.SDSEncodeListener)"><!-- --></A><H3>
addSDSEncodeListener</H3>
<PRE>
public void <B>addSDSEncodeListener</B>(<A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms">SDSEncodeListener</A>&nbsp;sdsEncodeListener)
                          throws java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>Adds an SDSEncodeListener for this SignedDataStream.
 <p>
 An <A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms"><CODE>SDSEncodeListener</CODE></A> allows an
 application to update a SignedDataStream object during it is
 encoded. This may be useful for adding SignerInfos/certificates/crls
 or adding SignerInfo attributes before or after the signatures
 are computed (e.g. when encoding an already exisiting and 
 currently parsed SignedDataStream again). Since any SignerInfo to
 be added during the encoding process may use some digest algorithm 
 not used by any already included SignerInfo, the SDSEncodeListener
 may announce the corresponding digest algorihtm(s) when it is 
 bound to the SignedDataStream by calling this <code>setSDSEncodeListener</code>
 method. 
 <br>
 An SDSEncodeListener can only be set for this stream
 version of the SignedData content type implementation, 
 but not for the non-stream <A HREF="../../iaik/cms/SignedData.html" title="class in iaik.cms"><CODE>SignedData</CODE></A>
 implementation, which does not need and SDSEncodeListener
 and simply will ignore it.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sdsEncodeListener</CODE> - the SDSEncodeListener to be added
<DT><B>Throws:</B>
<DD><CODE>if</CODE> - the SDSEncodeListener announces any not supported
            digest algorithms to be used
<DD><CODE>java.security.NoSuchAlgorithmException</CODE><DT><B>See Also:</B><DD><A HREF="../../iaik/cms/SDSEncodeListener.html" title="class in iaik.cms"><CODE>SDSEncodeListener</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getVersion()"><!-- --></A><H3>
getVersion</H3>
<PRE>
public int <B>getVersion</B>()</PRE>
<DL>
<DD>Returns the syntax version number (1 or 3 or 4).
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the version number</DL>
</DD>
</DL>
<HR>

<A NAME="getDigestAlgorithms()"><!-- --></A><H3>
getDigestAlgorithms</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>[] <B>getDigestAlgorithms</B>()</PRE>
<DL>
<DD>Returns a collection of message-digest algorithm identifiers.
 <p>
 There may be any number of elements in the collection, including zero.
 The returned OIDs identify the digest algorithms used by the several
 signers.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the message-digest AlgorithmIDs</DL>
</DD>
</DL>
<HR>

<A NAME="getCertificates()"><!-- --></A><H3>
getCertificates</H3>
<PRE>
public java.security.cert.Certificate[] <B>getCertificates</B>()</PRE>
<DL>
<DD>Returns all certificates included.
 <p>
 Any certificate returned by this method either may be an 
 X.509 public key certificate (<code>iaik.x509.X509Certificate</code>)
 or an X.509 attribute certificate (<code>iaik.x509.attr.AttributeCertificate</code>).
 PKCS#6 extended certificates are obsolete and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>all certificates included; the array may be empty if no certificates
         are included</DL>
</DD>
</DL>
<HR>

<A NAME="getX509Certificates()"><!-- --></A><H3>
getX509Certificates</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[] <B>getX509Certificates</B>()</PRE>
<DL>
<DD>Returns the X.509 public key certificates included.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the X.509 public key certificates; the array may be empty if no X.509 certificates
         are included</DL>
</DD>
</DL>
<HR>

<A NAME="getAttributeCertificates()"><!-- --></A><H3>
getAttributeCertificates</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/attr/AttributeCertificate.html" title="class or interface in iaik.x509.attr">AttributeCertificate</A>[] <B>getAttributeCertificates</B>()</PRE>
<DL>
<DD>Returns the attribute certificates included in this SignedData.
 <p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all attribute certificates included in this 
         SignedData; the array may be empty if no attribute certificates
         are included</DL>
</DD>
</DL>
<HR>

<A NAME="getCertificateSet()"><!-- --></A><H3>
getCertificateSet</H3>
<PRE>
public <A HREF="../../iaik/cms/CertificateSet.html" title="class in iaik.cms">CertificateSet</A> <B>getCertificateSet</B>()</PRE>
<DL>
<DD>Gets the certificateSet holding all certificates included in this SignedData.

 This method never returns <code>null</code>, however the retrieved 
 certificateSet maybe empty. If not empty, the CertificateSet returned
 may contain X.509 public key certificate (<code>iaik.x509.X509Certificate</code>
 objects) and/or or an X.509 attribute certificate (<code>iaik.x509.attr.AttributeCertificate</code>
 objects); PKCS#6 extended certificates are obsolete and therefore not supported.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the certificateSet holding the certificates of this SignedData</DL>
</DD>
</DL>
<HR>

<A NAME="verify(java.security.PublicKey, int)"><!-- --></A><H3>
verify</H3>
<PRE>
public void <B>verify</B>(java.security.PublicKey&nbsp;publicKey,
                   int&nbsp;signerInfoIndex)
            throws <A HREF="../../iaik/cms/CMSSignatureException.html" title="class in iaik.cms">CMSSignatureException</A></PRE>
<DL>
<DD>Uses the provided public key for verifying the signature that has been created by 
 the signer at index <code>signerInfoIndex</code>.
 <p>
 Note that this method does not perform any certificate verification.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfoIndex</CODE> - the index into the SignerInfos array for identifying the
        SignerInfo belonging to the signer whose signature has to be verified<DD><CODE>publicKey</CODE> - the public key of the signer to verify the message
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSSignatureException.html" title="class in iaik.cms">CMSSignatureException</A></CODE> - if the signature verification fails for some reason
<DD><CODE><A HREF="../../iaik/cms/InvalidContentHashException.html" title="class in iaik.cms">InvalidContentHashException</A></CODE> - if the signature verification process fails because the
                                        content hash does not match to value of the included MessageDigest 
                                        attribute
<DD><CODE><A HREF="../../iaik/cms/InvalidSignatureValueException.html" title="class in iaik.cms">InvalidSignatureValueException</A></CODE> - if the signature verification process fails because the
                                        signature value is invalid</DL>
</DD>
</DL>
<HR>

<A NAME="verify(int)"><!-- --></A><H3>
verify</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A> <B>verify</B>(int&nbsp;signerInfoIndex)
                       throws <A HREF="../../iaik/cms/CMSSignatureException.html" title="class in iaik.cms">CMSSignatureException</A></PRE>
<DL>
<DD>Verifies the signature that has been created by the signer at <code>signerInfoIndex</code>.
 <p>
 The signature is verified by using the public key of the specified signer, which is
 got from the signer certificate, derived from the <code>certificates
 </code>field.
 <p>
 Verifying the signatures of all the signers included into some
 specific SignedData object may be done by "looping" through all
 the included SignerInfos, e.g.:
 <p><PRE>
 SignerInfo[] signerInfos = signed_data.getSignerInfos();
 for (int i=0; i&lt;signerInfos.length; i++) {
     try {
       // verify the signed data using the SignerInfo at index i
       X509Certificate signer_cert = signed_data.verify(i);
       // if the signature is OK the certificate of the signer is returned
       System.out.println("Signature OK from signer: "+signer_cert.getSubjectDN());
     } catch (SignatureException ex) {
       // if the signature is not OK a SignatureException is thrown
       System.out.println("Signature ERROR from signer: "
                           + signed_data.getCertificate(signerInfos[i].getSignerIdentifier()).getSubjectDN());
     }
 }
 </PRE><p>
 Note that this method does not perform any certificate verification.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfoIndex</CODE> - the index into the SignerInfos array for identifying the
                        SignerInfo belonging to the signer whose signature has
                        to be verified
<DT><B>Returns:</B><DD>the certificate of the signer, if its signature turns out to be correct;
                                        otherwise a SignaturException is thrown
<DT><B>Throws:</B>
<DD><CODE>java.security.SignatureException</CODE> - if the signature verification fails for some reason
<DD><CODE><A HREF="../../iaik/cms/CertificateNotFoundException.html" title="class in iaik.cms">CertificateNotFoundException</A></CODE> - if the certificate of the signer is not included in this SignedData object
<DD><CODE><A HREF="../../iaik/cms/InvalidContentHashException.html" title="class in iaik.cms">InvalidContentHashException</A></CODE> - if the signature verification process fails because the
                                        content hash does not match to value of the included MessageDigest 
                                        attribute
<DD><CODE><A HREF="../../iaik/cms/InvalidSignatureValueException.html" title="class in iaik.cms">InvalidSignatureValueException</A></CODE> - if the signature verification process fails because the
                                        signature value is invalid
<DD><CODE><A HREF="../../iaik/cms/CMSSignatureException.html" title="class in iaik.cms">CMSSignatureException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="verify(iaik.x509.X509Certificate)"><!-- --></A><H3>
verify</H3>
<PRE>
public <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A> <B>verify</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate)
                  throws <A HREF="../../iaik/cms/CMSSignatureException.html" title="class in iaik.cms">CMSSignatureException</A></PRE>
<DL>
<DD>Uses the provided signer certificate for verifying the signature that has been created
 by the signer being owner of the certificate.
 This method may be used for verifying the signature of a signer in situations where there 
 are no certificates sent with the SignedData object. Of course, it also may be used
 when the <code>certificate</code> is not empty. However, take in mind that you
 should not step through the entries of the <code>certificates</code> field for
 calling <code>verify(cert)</code> for any certificate presented there since
 there also may (shall) be included issuer certificates and certificate chains
 leading to some trusted root.
 <p>
 Note that this method does not perform any certificate verification.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerCertificate</CODE> - the certificate of the signer whose signature should 
        be verified
<DT><B>Returns:</B><DD>the signerInfo belonging to the signer being owner of the given certificate
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSSignatureException.html" title="class in iaik.cms">CMSSignatureException</A></CODE> - if the signature turns out to be incorrect or there is no signer with 
            the given certificate or the certifcate
<DD><CODE><A HREF="../../iaik/cms/InvalidContentHashException.html" title="class in iaik.cms">InvalidContentHashException</A></CODE> - if the signature verification process fails because the
                                        content hash does not match to value of the included MessageDigest 
                                        attribute
<DD><CODE><A HREF="../../iaik/cms/InvalidSignatureValueException.html" title="class in iaik.cms">InvalidSignatureValueException</A></CODE> - if the signature verification process fails because the
                                        signature value is invalid</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedDigest(int)"><!-- --></A><H3>
getSignedDigest</H3>
<PRE>
public byte[] <B>getSignedDigest</B>(int&nbsp;signerInfoIndex)
                       throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns the message digest included in the authenticated attributes. If the signed content
 is not included in the SignedData ASN.1 object this method can be used to get to message
 digest of the signed content.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerInfoIndex</CODE> - the index into the SignerInfos array for identifying the
                        SignerInfo belonging to the signer whose message digest
                        shall be returned
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getCertificate(iaik.cms.CertificateIdentifier)"><!-- --></A><H3>
getCertificate</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A> <B>getCertificate</B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)
                               throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Tries to find the signer certificate specified by the given CertificateIdentidier.
 <p>
 This method searches the <code>certificates</code> field of this SignedData
 for a certificate identified by the given SignerIdentifier (either an
 <A HREF="../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>IssuerAndSerialNumber</CODE></A> or <A HREF="../../iaik/cms/SubjectKeyID.html" title="class in iaik.cms"><CODE>SubjectKeyIdentifier</CODE></A>). If you additionally want to check
 if the certificate found is identified as signer certificate by means of
 a <A HREF="../../iaik/smime/ess/SigningCertificate.html" title="class in iaik.smime.ess"><CODE>SigningCertificate</CODE></A> attribute,
 you may use method <A HREF="../../iaik/cms/SignerInfo.html#isSignerCertificate(iaik.x509.X509Certificate)"><CODE>isSignerCertificate</CODE></A> of class <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms"><CODE>SignerInfo</CODE></A>,
 e.g.:
 <pre>
 try {
   SignerInfo signerInfo = signedData.getSignerInfos()[0];
   CertificateIdentifier signerIdentifier = signerInfo.getSignerIdentifier();
   X509Certificate signerCert = signedData.getCertificate(signerIdentifier);
   if (signerInfo.isSigningCertificate(signerCert)) {
     System.out.println("Signer certificate: " + signerCert);
   } else {
     System.out.pritnln("Signer certificate not included!");
   }
 } catch (CMSException ex) {
   System.out.println("Signer certificate not included!");
 }
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerIdentifier</CODE> - the signerIdentifier <A HREF="../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>IssuerAndSerialNumber</CODE></A> or <A HREF="../../iaik/cms/SubjectKeyID.html" title="class in iaik.cms"><CODE>SubjectKeyIdentifier</CODE></A>) 
        identifying the certificate to search for
<DT><B>Returns:</B><DD>the X509Certificate belonging to the given SignerIdentifier, if
                             included; otherwise a CMSException is thrown
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the requested certificate cannot be found
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - may be thrown if any of the included certificates
                                has not been parsed so far and has an invalid ASN.1
                                structure</DL>
</DD>
</DL>
<HR>

<A NAME="getCertificates(iaik.cms.CertificateIdentifier)"><!-- --></A><H3>
getCertificates</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>[] <B>getCertificates</B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)
                                  throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Tries to find the signer certificate chain specified by the given CertificateIdentidier.
 <p>
 This method searches the <code>certificates</code> field of this SignedData
 for the certificate chain belonging to the signer identified by the given 
 SignerIdentifier (either an <A HREF="../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>IssuerAndSerialNumber</CODE></A> 
 or <A HREF="../../iaik/cms/SubjectKeyID.html" title="class in iaik.cms"><CODE>SubjectKeyIdentifier</CODE></A>), e.g.:
 <pre>
 try {
   SignerInfo signerInfo = signedData.getSignerInfos()[0];
   CertificateIdentifier signerIdentifier = signerInfo.getSignerIdentifier();
   X509Certificate[] signerCertChain = signedData.getCertificates(signerIdentifier);
 } catch (CMSException ex) {
   System.out.println("Signer certificate not included!");
 }
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerIdentifier</CODE> - the signerIdentifier <A HREF="../../iaik/cms/IssuerAndSerialNumber.html" title="class in iaik.cms"><CODE>IssuerAndSerialNumber</CODE></A> or <A HREF="../../iaik/cms/SubjectKeyID.html" title="class in iaik.cms"><CODE>SubjectKeyIdentifier</CODE></A>) 
        identifying the signer for which to search the certificate chain
<DT><B>Returns:</B><DD>the certificate chain belonging to the given SignerIdentifier, if
         included; otherwise a CMSException is thrown
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the requested certificate chain cannot be found
<DD><CODE><A HREF="../../iaik/cms/CMSParsingException.html" title="class in iaik.cms">CMSParsingException</A></CODE> - may be thrown if any of the included certificates
                                has not been parsed so far and has an invalid ASN.1
                                structure</DL>
</DD>
</DL>
<HR>

<A NAME="getCRLs()"><!-- --></A><H3>
getCRLs</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509CRL.html" title="class or interface in iaik.x509">X509CRL</A>[] <B>getCRLs</B>()</PRE>
<DL>
<DD>Returns all the cerificate-revocation lists included in this
 <code>SignedData</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing the cerificate-revocation lists included
         into this SignedData object; the array may be empty if there are
         no CRLs included
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSRuntimeException.html" title="class in iaik.cms">CMSRuntimeException</A></CODE> - may be thrown if any of the included RevocationInfos
                             has not been parsed so far and has an invalid ASN.1
                             structure</DL>
</DD>
</DL>
<HR>

<A NAME="getRevocationInfoChoices()"><!-- --></A><H3>
getRevocationInfoChoices</H3>
<PRE>
public <A HREF="../../iaik/cms/RevocationInfoChoices.html" title="class in iaik.cms">RevocationInfoChoices</A> <B>getRevocationInfoChoices</B>()</PRE>
<DL>
<DD>Gets the crls (RevocationInfoChoices) included in this SignedData.

 This method never returns <code>null</code>, however the retrieved 
 RevocationInfoChoices maybe empty. If not empty, the RevocationInfoChoices returned
 may contain X.509 crls (<code>iaik.x509.X509CRL</code>
 objects) and/or or other crls (<code>iaik.cms.OtherRevocationInfo</code>
 objects);
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the RevocationInfoChoices holding the crls of this SignedData</DL>
</DD>
</DL>
<HR>

<A NAME="getSignerInfos()"><!-- --></A><H3>
getSignerInfos</H3>
<PRE>
public <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A>[] <B>getSignerInfos</B>()</PRE>
<DL>
<DD>Returns all the signer infos included in this
 <code>SignedData</code> object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>an array containing all the <code>SignerInfo</code> objects included
         into this <code>SignedData</code>; the array may be empty if there are
         no signers specified</DL>
</DD>
</DL>
<HR>

<A NAME="getSignerInfoIndex(iaik.x509.X509Certificate)"><!-- --></A><H3>
getSignerInfoIndex</H3>
<PRE>
public int <B>getSignerInfoIndex</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate)</PRE>
<DL>
<DD>Searches for the index of the signerInfo belonging to the given signer certificate.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerCertificate</CODE> - the certificate of the signer
<DT><B>Returns:</B><DD>the index of the signerInfo or -1 if there is no signerInfo matching to the
         given certificate</DL>
</DD>
</DL>
<HR>

<A NAME="getSignerInfo(iaik.x509.X509Certificate)"><!-- --></A><H3>
getSignerInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A> <B>getSignerInfo</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;signerCertificate)</PRE>
<DL>
<DD>Searches for the SignerInfo identified by the given certificate.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerCertificate</CODE> - the certificate of the signer
<DT><B>Returns:</B><DD>the SignerInfo identified by the given certificate or <code>null</code>
         if no SignerInfo for the given Certificate is included</DL>
</DD>
</DL>
<HR>

<A NAME="getSignerInfo(iaik.cms.CertificateIdentifier)"><!-- --></A><H3>
getSignerInfo</H3>
<PRE>
public <A HREF="../../iaik/cms/SignerInfo.html" title="class in iaik.cms">SignerInfo</A> <B>getSignerInfo</B>(<A HREF="../../iaik/cms/CertificateIdentifier.html" title="interface in iaik.cms">CertificateIdentifier</A>&nbsp;signerIdentifier)</PRE>
<DL>
<DD>Searches for the SignerInfo identified by the given signer id.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signerIdentifier</CODE> - the id of the signer
<DT><B>Returns:</B><DD>the SignerInfo identified by the given id or <code>null</code>
         if no SignerInfo for the given id is included</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object()"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
public <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>()
                        throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this SignedData as ASN1Object.
 The ASN.1 SEQUENCE returned by this  method only will contain the first
 components (version, message digest algorithms, EncapsulatedContentInfo
 without content) of the ASN.1 SignedData. The remaining components (content,
 certificates, crls, SignerInfos) are added later during the encoding procedure
 (when <A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> is called).
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toASN1Object()">toASN1Object</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>this SignedData as ASN1Object
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="toASN1Object(int)"><!-- --></A><H3>
toASN1Object</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/ASN1Object.html" title="class or interface in iaik.asn1">ASN1Object</A> <B>toASN1Object</B>(int&nbsp;blockSize)
                           throws <A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></PRE>
<DL>
<DD>Returns this SignedData as ASN1Object where a constructed
 OCTET STRING is used for encoding the content.
 The ASN.1 SEQUENCE returned by this  method only will contain the first
 components (version, message digest algorithms, EncapsulatedContentInfo
 without content) of the ASN.1 SignedData. The remaining components (content,
 certificates, crls, SignerInfos) are added later during the encoding procedure
 (when <A HREF="../../iaik/cms/SignedDataStream.html#writeTo(java.io.OutputStream)"><CODE>writeTo</CODE></A> is called).
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../iaik/cms/CMSException.html" title="class in iaik.cms">CMSException</A></CODE> - if the ASN1Object could not be created</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os)
             throws java.io.IOException</PRE>
<DL>
<DD>BER encodes and writes this object to the supplied output stream.
 In implicit mode, whole the inherent data is encoded as one 
 single primitive definite octet string:
 <pre>
 0x04 &lt;length&gt; &lt;data&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this SignedDataStream shall be encoded
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs when writing to the stream</DL>
</DD>
</DL>
<HR>

<A NAME="writeTo(java.io.OutputStream, int)"><!-- --></A><H3>
writeTo</H3>
<PRE>
public void <B>writeTo</B>(java.io.OutputStream&nbsp;os,
                    int&nbsp;blockSize)
             throws java.io.IOException</PRE>
<DL>
<DD>Writes this object to the supplied output stream where a constructed
 OCTET STRING is used for encoding the content.

 If block size has a value > 0, in implicit mode the inherent content data is encoded
 as constructed OCTET STRING. In this case the encoding is splitted according to 
 the defined block size:
 <pre>
 0x24 0x80
           0x04 &lt;blocksize&gt; &lt;data&gt;
           0x04 &lt;blocksize&gt; &lt;data&gt;
           0x04 &lt;blocksize&gt; &lt;data&gt;
                ...
 0x00 0x00
 </pre> 
 If the block size is not positive, whole the inherent data is encoded as one 
 single primitive definite octet string:
 <pre>
 0x04 &lt;length&gt; &lt;data&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>os</CODE> - the output stream to which this SignedData shall be written<DD><CODE>blockSize</CODE> - the block size defining the encoding scheme - and specifying the
                  length of each primitive encoded octet string component, if positive
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an error occurs during writing the object</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Returns a string giving some information about this
 <code>SignedDataStream</code> object.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="toString(boolean)"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>(boolean&nbsp;detailed)</PRE>
<DL>
<DD>Returns a string giving some - if requested - detailed information
 about this <code>SignedDataStream</code> object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../iaik/cms/ContentStream.html#toString(boolean)">toString</A></CODE> in interface <CODE><A HREF="../../iaik/cms/ContentStream.html" title="interface in iaik.cms">ContentStream</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>detailed</CODE> - - whether or not to give detailed information
<DT><B>Returns:</B><DD>the string representation</DL>
</DD>
</DL>
<HR>

<A NAME="clearSignatures(boolean, boolean)"><!-- --></A><H3>
clearSignatures</H3>
<PRE>
public void <B>clearSignatures</B>(boolean&nbsp;applicationSet,
                            boolean&nbsp;clearMessageDigestAttributes)</PRE>
<DL>
<DD>Clears the signature values of all included SignerInfos.
 Clearing all signature values may be desired when supplying a new content
 to be signed by means of method <A HREF="../../iaik/cms/SignedDataStream.html#setInputStream(java.io.InputStream)"><CODE>setInputStream</CODE></A>.
 If the signature values are not cleared, they would not be calculated anew.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>applicationSet</CODE> - whether to clear signature values that have been explicitly
                       set by the application by calling signerInfo.setSignatureValue<DD><CODE>clearMessageDigestAttributes</CODE> - whether to clear MessageDigest attributes, too</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../iaik/cms/SignedDataOutputStream.html" title="class in iaik.cms"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../iaik/cms/SignerIdentifier.html" title="class in iaik.cms"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?iaik/cms/SignedDataStream.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SignedDataStream.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../siclogo.jpg> <IMG SRC=../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
