<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:23 GMT 2016 -->
<TITLE>
IaikPkcs11SecurityProvider (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="demo.cms.pkcs11.IaikPkcs11SecurityProvider class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="IaikPkcs11SecurityProvider (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../demo/cms/pkcs11/ExplicitSignedDataStreamDemo.html" title="class in demo.cms.pkcs11"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../demo/cms/pkcs11/ImplicitSignedDataStreamDemo.html" title="class in demo.cms.pkcs11"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?demo/cms/pkcs11/IaikPkcs11SecurityProvider.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="IaikPkcs11SecurityProvider.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
demo.cms.pkcs11</FONT>
<BR>
Class IaikPkcs11SecurityProvider</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by ">iaik.cms.SecurityProvider
      <IMG SRC="../../../resources/inherit.gif" ALT="extended by ">iaik.cms.IaikProvider
          <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>demo.cms.pkcs11.IaikPkcs11SecurityProvider</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>IaikPkcs11SecurityProvider</B><DT>extends iaik.cms.IaikProvider</DL>
</PRE>

<P>
This class implements a <code>SecurityProvider</code> for the IAIK-CMS
 toolkit. This <code>SecurityProvider</code> can handle
 <code>IAIKPKCS11Key</code> objects and is thus suitable for use with the
 PKCS#11 provider. The demos in this package use this class to get the
 IAIK-CMS library to use a PKCS#11 module instead of pure software crypto.
 <p>
 To install this security provider call:
 <pre>
 IAIKPkcs11 iaikPkcs11Provider = ...;
 IaikPkcs11SecurityProvider pkcs11CmsSecurityProvider = new IaikPkcs11SecurityProvider(iaikPkcs11Provider);
 SecurityProvider.setSecurityProvider(pkcs11CmsSecurityProvider);
 </pre>
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://javadoc.iaik.tugraz.at/pkcs11_provider/current/iaik/pkcs/pkcs11/provider/IAIKPkcs11.html" title="class or interface in iaik.pkcs.pkcs11.provider">IAIKPkcs11</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#iaikPkcs11Provider_">iaikPkcs11Provider_</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reference to the installed PKCS#11 provider instance.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_iaik.cms.IaikProvider"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class iaik.cms.IaikProvider</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>ALG_SIGNATURE_RAWRSA, ALG_SIGNATURE_RAWRSASSA_PKCS1_V15</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_iaik.cms.SecurityProvider"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class iaik.cms.SecurityProvider</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>ALG_CIPHER_RSA, ALG_CIPHER_RSA_DECRYPT, ALG_CIPHER_RSA_ENCRYPT, ALG_CIPHER_RSA_SIGN, ALG_CIPHER_RSA_VERIFY, ALG_DIGEST_MD5, ALG_DIGEST_SHA, ALG_HMAC_MD5, ALG_HMAC_SHA, ALG_KEYEX_DH, ALG_KEYEX_ESDH, ALG_KEYEX_SSDH, ALG_SIGNATURE_RAWDSA, ALG_SIGNATURE_RAWECDSA, ALG_SIGNATURE_RAWECDSA_PLAIN, ALG_SIGNATURE_RAWRSAPSS, ALG_SIGNATURE_SHADSA, CIPHER_DECRYPT, CIPHER_ENCRYPT, CIPHER_NONE, CIPHER_UNWRAP, CIPHER_WRAP, COMPRESS, DECOMPRESS, IMPLEMENTATION_NAME_DSA, IMPLEMENTATION_NAME_ECDSA, IMPLEMENTATION_NAME_ECDSA_PLAIN, IMPLEMENTATION_NAME_PBKDF2, IMPLEMENTATION_NAME_PWRI_KEK, IMPLEMENTATION_NAME_RSA, IMPLEMENTATION_NAME_RSA_OAEP, IMPLEMENTATION_NAME_RSA_PSS, providerName_, random_, SIGNATURE_NONE, SIGNATURE_SIGN, SIGNATURE_VERIFY</CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#IaikPkcs11SecurityProvider(iaik.pkcs.pkcs11.provider.IAIKPkcs11)">IaikPkcs11SecurityProvider</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/pkcs11_provider/current/iaik/pkcs/pkcs11/provider/IAIKPkcs11.html" title="class or interface in iaik.pkcs.pkcs11.provider">IAIKPkcs11</A>&nbsp;iaikPkcs11Provider)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The given PKCS#11 provider instance must already be installed in the JCA 
 framework.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])">calculateSignatureFromHash</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                           java.security.PrivateKey&nbsp;privateKey,
                           byte[]&nbsp;digest)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates the signature value for a CMS SignerInfo over the given digest
 value with the given algorithm using the supplied private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])">calculateSignatureFromSignedAttributes</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                       <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                       java.security.PrivateKey&nbsp;privateKey,
                                       byte[]&nbsp;signedAttributes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates the signature value for a CMS SignerInfo over the given signed 
 attributes with the given algorithm using the supplied private key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.crypto.SecretKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#decryptKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.lang.String)">decryptKey</A></B>(byte[]&nbsp;encryptedKey,
           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
           java.security.PrivateKey&nbsp;recipientKey,
           java.lang.String&nbsp;cekAlgorithmName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the given encrypted content encryption key for a <CODE>KeyTransRecipientInfo</CODE>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.Signature</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#getSignature(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)">getSignature</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;algorithm,
             int&nbsp;mode,
             java.security.Key&nbsp;key,
             java.security.spec.AlgorithmParameterSpec&nbsp;paramSpec)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method returns the desired Signature object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.Signature</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#getSignature(java.lang.String, int, java.security.Key)">getSignature</A></B>(java.lang.String&nbsp;algorithm,
             int&nbsp;mode,
             java.security.Key&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method returns the desired Signature object which uses the PKCS#11
 provider if the key is a PKCS#11 key.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_iaik.cms.IaikProvider"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class iaik.cms.IaikProvider</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>checkDomainParameters, createSharedKeyEncryptionKey, deriveKey, generateKey, generateKeyAgreementKeyPair, getAlgorithmParameterSpec, getASN1OriginatorPublicKey, getPBEKey, getSecureRandom, setIv, turnOffIAIKProviderVersionCheck, unwrapKey, verifySignatureFromHash, verifySignatureFromSignedAttributes, wrapKey</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_iaik.cms.SecurityProvider"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class iaik.cms.SecurityProvider</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>calculateMac, calculateSharedSecret, compress, convertCipherMode, decryptKey, encryptKey, generateKey, getAlgorithmParameters, getAlgorithmParameters, getAlgorithmParameters, getAuthCipherEngine, getAuthCipherEngine, getByteArrayAuthCipherEngine, getByteArrayAuthCipherEngine, getByteArrayCipherEngine, getByteArrayCipherEngine, getCipher, getCipher, getCipher, getCipher, getHash, getInputStreamAuthCipherEngine, getInputStreamAuthCipherEngine, getInputStreamCipherEngine, getInputStreamCipherEngine, getInputStreamCompressEngine, getInputStreamHashEngine, getInputStreamMacEngine, getKeyAgreement, getKeyFactory, getKeyGenerator, getKeyGenerator, getKeyLength, getKeyLength, getKeyLength, getKeyPairGenerator, getMac, getMac, getMessageDigest, getMessageDigest, getMicAlgs, getOriginatorPublicKey, getOutputStreamCompressEngine, getOutputStreamHashEngine, getOutputStreamMacEngine, getProviderName, getSecretKeyFactory, getSecurityProvider, getSignature, getSignature, getSignatureParameters, setSecureRandom, setSecurityProvider, setSignatureParameters</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="iaikPkcs11Provider_"><!-- --></A><H3>
iaikPkcs11Provider_</H3>
<PRE>
protected <A HREF="http://javadoc.iaik.tugraz.at/pkcs11_provider/current/iaik/pkcs/pkcs11/provider/IAIKPkcs11.html" title="class or interface in iaik.pkcs.pkcs11.provider">IAIKPkcs11</A> <B>iaikPkcs11Provider_</B></PRE>
<DL>
<DD>Reference to the installed PKCS#11 provider instance.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="IaikPkcs11SecurityProvider(iaik.pkcs.pkcs11.provider.IAIKPkcs11)"><!-- --></A><H3>
IaikPkcs11SecurityProvider</H3>
<PRE>
public <B>IaikPkcs11SecurityProvider</B>(<A HREF="http://javadoc.iaik.tugraz.at/pkcs11_provider/current/iaik/pkcs/pkcs11/provider/IAIKPkcs11.html" title="class or interface in iaik.pkcs.pkcs11.provider">IAIKPkcs11</A>&nbsp;iaikPkcs11Provider)</PRE>
<DL>
<DD>The given PKCS#11 provider instance must already be installed in the JCA 
 framework.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>iaikPkcs11Provider</CODE> - The PKCS#11 provider instance to use in this CMS
                           security provider.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="calculateSignatureFromHash(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><!-- --></A><H3>
calculateSignatureFromHash</H3>
<PRE>
public byte[] <B>calculateSignatureFromHash</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                         java.security.PrivateKey&nbsp;privateKey,
                                         byte[]&nbsp;digest)
                                  throws java.security.NoSuchAlgorithmException,
                                         java.security.InvalidKeyException,
                                         java.security.SignatureException</PRE>
<DL>
<DD>Calculates the signature value for a CMS SignerInfo over the given digest
 value with the given algorithm using the supplied private key.
 <p>
 Each <CODE>SignerInfo</CODE> included in a CMS SignedData
 object may calculate the signature value differently depending on the
 presence of signed attributes:
 <p>
 <ul>
 <li>If signed attributes are present the signature is calculated over
     the DER encoding of the signed attributes.
 <li>If signed attributes are NOT present, the signature is calculated
     over the content data itsself.
 </ul>
 This method is called by class <CODE>SignerInfo</CODE> for
 calculating the signature when no signed attributes are present. Since
 the data to be signed may be of arbitrary size this method expects the
 already hashed data to only calculate the signature value on it (for
 instance, by doing the digest encrypting when using RSA for signing).
 <p>
 For that reason, when writing your own SecurityProvider and overriding
 this method, you will need some kind of <i>RAW</i> signature (respectively
 digest encryption) mechanism only expecting the already hashed data (e.g.
 a "RawDSA" signature engine when using DSA repectively a Cipher engine
 when using RSA).
 <p>
 If you want to override this method for use with smartcards, please be sure
 that your smartcard is able to do the signature (respectively digest
 encryption) operation only. However, if your smartcard requires to supply
 the whole data for doing the hash calcualtion itself, you may ensure that
 your <CODE>SignerInfo</CODE> contains signed attributes
 and override method <A HREF="../../../demo/cms/pkcs11/IaikPkcs11SecurityProvider.html#calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><CODE>calculateSignatureFromSignedAttributes</CODE></A> for calculating the signature over
 the DER encoding of the signed attributes (thereby doing the hash
 computation, too).
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>calculateSignatureFromHash</CODE> in class <CODE>iaik.cms.IaikProvider</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureAlgorithm</CODE> - signatureAlgorithm the signature algorithm to be
        used, e.g. rsaEncryption, DSA<DD><CODE>digestAlgorithm</CODE> - the digest algorithm used for hash computation (e.g.
        SHA-1 or MD5); may be necessary for some signature schemes (e.g.
        to be included as a DigestInfo in a PKCS#1 RSA signature)<DD><CODE>privateKey</CODE> - the private key of the signer (i.e. the one supplied when
        creating a <CODE>SignerInfo</CODE> object; may be
        some kind of "dummy" key when used for smartcards<DD><CODE>digest</CODE> - the digest value over which the signature shall be calculated
<DT><B>Returns:</B><DD>the signature value calculated from the given digest value
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if any of the required algorithms is not supported
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>java.security.SignatureException</CODE> - if signature verification fails because of some crypto related error</DL>
</DD>
</DL>
<HR>

<A NAME="calculateSignatureFromSignedAttributes(iaik.asn1.structures.AlgorithmID, iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, byte[])"><!-- --></A><H3>
calculateSignatureFromSignedAttributes</H3>
<PRE>
public byte[] <B>calculateSignatureFromSignedAttributes</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;signatureAlgorithm,
                                                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;digestAlgorithm,
                                                     java.security.PrivateKey&nbsp;privateKey,
                                                     byte[]&nbsp;signedAttributes)
                                              throws java.security.NoSuchAlgorithmException,
                                                     java.security.InvalidKeyException,
                                                     java.security.SignatureException</PRE>
<DL>
<DD>Calculates the signature value for a CMS SignerInfo over the given signed 
 attributes with the given algorithm using the supplied private key.
 <p>
 Each <CODE>SignerInfo</CODE> included in a CMS SignedData
 object may calculate the signature value differently depending on the
 presence of signed attributes:
 <p>
 <ul>
 <li>If signed attributes are present the signature is calculated over
     the DER encoding of the signed attributes. 
 <li>If signed attributes are NOT present, the signature is calculated
     over the content data itsself.
 </ul>
 This method is called by class <CODE>SignerInfo</CODE> for
 calculating the signature when signed attributes are present. 
 <p>
 When writing your own SecurityProvider and overriding
 this method, be aware that only the -- yet NOT hashed -- DER encoding of
 the signed attributes is supplied to this method. For that reason this
 method can be overriden for use with smartcards requiring to do the 
 digest calculation theirselves: ensure that your <CODE>SignerInfo</CODE> contains signed attributes and override this method in a way
 to pass the given DER encoding of the signed attributes to your smartcard
 for doing the signature (and digest) calculation.
 <p>
 Since this method requires to calculate the digest value over the DER encoded
 signed attributes as part of the signature calculation, it uses a 
 ordinary JCA Signature engine.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>calculateSignatureFromSignedAttributes</CODE> in class <CODE>iaik.cms.IaikProvider</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signatureAlgorithm</CODE> - signatureAlgorithm the signature algorithm to be
        used, e.g. rsaEncryption, DSA<DD><CODE>digestAlgorithm</CODE> - the digest algorithm to be used for hash computation (e.g.
        SHA-1,..., SHA-512); may be necessary for some signature schemes (e.g.
        to be included as a DigestInfo in a PKCS#1 RSA signature)<DD><CODE>privateKey</CODE> - the private key of the signer (i.e. the one supplied when
        creating a <CODE>SignerInfo</CODE> object; may be
        some kind of "dummy" key when used for smartcards<DD><CODE>signedAttributes</CODE> - the DER encoding of the signed attributes over which 
        the signature shall be calculated
<DT><B>Returns:</B><DD>the signature value calculated from the given DER encoded signed
         attributes
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if no Signature engine is available for the requested algorithm
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>if</CODE> - signature calculation fails
<DD><CODE>java.security.SignatureException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getSignature(java.lang.String, int, java.security.Key)"><!-- --></A><H3>
getSignature</H3>
<PRE>
public java.security.Signature <B>getSignature</B>(java.lang.String&nbsp;algorithm,
                                            int&nbsp;mode,
                                            java.security.Key&nbsp;key)
                                     throws java.security.InvalidKeyException,
                                            java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>This method returns the desired Signature object which uses the PKCS#11
 provider if the key is a PKCS#11 key.

 If the mode parameter is <CODE>SIGNATURE_SIGN</CODE> or 
 <CODE>SIGNATURE_VERIFY</CODE> the signature object has to be
 initialized with the provided key in the respective mode.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>getSignature</CODE> in class <CODE>iaik.cms.SecurityProvider</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>algorithm</CODE> - the name of the Signature algorithm<DD><CODE>mode</CODE> - the mode indicating if the engine has to be initialized<DD><CODE>key</CODE> - the key for initializing the Signature engine
<DT><B>Returns:</B><DD>the (if requested initialized) Signature engine
<DT><B>Throws:</B>
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if no Signature engine is
            available for the requested algorithm</DL>
</DD>
</DL>
<HR>

<A NAME="getSignature(iaik.asn1.structures.AlgorithmID, int, java.security.Key, java.security.spec.AlgorithmParameterSpec)"><!-- --></A><H3>
getSignature</H3>
<PRE>
public java.security.Signature <B>getSignature</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;algorithm,
                                            int&nbsp;mode,
                                            java.security.Key&nbsp;key,
                                            java.security.spec.AlgorithmParameterSpec&nbsp;paramSpec)
                                     throws java.security.InvalidKeyException,
                                            java.security.NoSuchAlgorithmException</PRE>
<DL>
<DD>This method returns the desired Signature object.

 If the mode parameter is <CODE>SIGNATURE_SIGN</CODE> or 
 <CODE>SIGNATURE_VERIFY</CODE> the signature object is to be
 initialized with the provided key in the respective mode.
 If algorithm parameters are specified they are set for the
 Signature engine.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>getSignature</CODE> in class <CODE>iaik.cms.SecurityProvider</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>algorithm</CODE> - the AlgorithmID of the Signature algorithm<DD><CODE>mode</CODE> - the mode indicating if the engine has to be initialized<DD><CODE>key</CODE> - the key for initializing the Signature engine<DD><CODE>paramSpec</CODE> - any parameters to be set for the Signature engine, if not <code>null</code>
<DT><B>Returns:</B><DD>the (if requested initialized) Signature engine
<DT><B>Throws:</B>
<DD><CODE>java.security.InvalidKeyException</CODE> - if the key is not valid
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if no Signature engine is
            available for the requested algorithm</DL>
</DD>
</DL>
<HR>

<A NAME="decryptKey(byte[], iaik.asn1.structures.AlgorithmID, java.security.PrivateKey, java.lang.String)"><!-- --></A><H3>
decryptKey</H3>
<PRE>
public javax.crypto.SecretKey <B>decryptKey</B>(byte[]&nbsp;encryptedKey,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;kea,
                                         java.security.PrivateKey&nbsp;recipientKey,
                                         java.lang.String&nbsp;cekAlgorithmName)
                                  throws java.security.NoSuchAlgorithmException,
                                         java.security.InvalidKeyException,
                                         javax.crypto.NoSuchPaddingException,
                                         javax.crypto.BadPaddingException</PRE>
<DL>
<DD>Decrypts the given encrypted content encryption key for a <CODE>KeyTransRecipientInfo</CODE>.
 <p>
 CMS <code>EnvelopedData</code> uses the <CODE>KeyTransRecipientInfo</CODE> type for
 encrypting the secret content encryption key with the public key of
 the recipient. Currently in general RSA PKCS#1v1.5 is used for key
 transport. If rsaEncryption is requested as key encryption algorithm
 this method uses a RSA Cipher ("RSA/ECB/PKCS1Padding/Encrypt") for
 decrypting the encrypted content encryption key with the supplied 
 private key of the recipient. If another algorithm than RSA is requested,
 this method throws a NoSuchAlgorithmException. An application wishing to
 support another algorithm may override this method.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>decryptKey</CODE> in class <CODE>iaik.cms.IaikProvider</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encryptedKey</CODE> - the encrypted content encryption key to be decrypted<DD><CODE>kea</CODE> - the key encryption alglorithm to be used, e.g. rsaEncryption<DD><CODE>recipientKey</CODE> - the private key of the recipient to be used for decrypting
                     the encrypted content encryption key<DD><CODE>cekAlgorithmName</CODE> - the name of the content encryption key (e.g. "DES") to be set for the
                         SecretKey object created by this method
<DT><B>Returns:</B><DD>the decrypted content encryption key
<DT><B>Throws:</B>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE> - if the requested algorithm is not available
<DD><CODE>java.security.InvalidKeyException</CODE> - if the decryption key is not valid
<DD><CODE>javax.crypto.NoSuchPaddingException</CODE> - if the required padding scheme is not supported
<DD><CODE>javax.crypto.BadPaddingException</CODE> - if an padding error occurs</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../demo/cms/pkcs11/ExplicitSignedDataStreamDemo.html" title="class in demo.cms.pkcs11"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../demo/cms/pkcs11/ImplicitSignedDataStreamDemo.html" title="class in demo.cms.pkcs11"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?demo/cms/pkcs11/IaikPkcs11SecurityProvider.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="IaikPkcs11SecurityProvider.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../../siclogo.jpg> <IMG SRC=../../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
