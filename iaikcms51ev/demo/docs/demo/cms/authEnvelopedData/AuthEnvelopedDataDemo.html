<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:22 GMT 2016 -->
<TITLE>
AuthEnvelopedDataDemo (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="demo.cms.authEnvelopedData.AuthEnvelopedDataDemo class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="AuthEnvelopedDataDemo (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataOutputStreamDemo.html" title="class in demo.cms.authEnvelopedData"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthEnvelopedDataDemo.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
demo.cms.authEnvelopedData</FONT>
<BR>
Class AuthEnvelopedDataDemo</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>demo.cms.authEnvelopedData.AuthEnvelopedDataDemo</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>AuthEnvelopedDataDemo</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
Demonstrates the usage of class <CODE>AuthEnvelopedDataStream</CODE> and
 <CODE>AuthEnvelopedData</CODE> for authenticated encrypting data using the 
 CMS type AuthEnvelopedData according to <a href = "http://www.ietf.org/rfc/rfc5083.txt"
 target="_blank">RFC 5083</a>.
 <p>
 This demo uses the AES-CCM and AES-GCM authenticated encryption algorithms
 as specified by <a href = "http://www.ietf.org/rfc/rfc5084.txt" target="_blank">RFC 5084</a>.
 The demo creates an AuthEnvelopedData object and subsequently shows several
 ways that may be used for decrypting the content and verifying the message
 authentication code for some particular recipient.
 <br>
 Since AES-CCM and AES-GCM are not implemented by IAIK-JCE versions prior 3.17, this demo
 at least may require IAIK-JCE 3.17 as cryptographic service provider. 
 <p>
 Keys and certificates are retrieved from the demo KeyStore ("cms.keystore") 
 which has to be located in your current working directory and may be
 created by running the <A HREF="../../../demo/keystore/SetupCMSKeyStore.html" title="class in demo.keystore"><CODE>SetupCMSKeyStore</CODE></A> program.
 <p>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><CODE>AuthEnvelopedDataStream</CODE>, 
<CODE>AuthEnvelopedData</CODE>, 
<CODE>RecipientInfo</CODE>, 
<CODE>KeyTransRecipientInfo</CODE>, 
<CODE>KeyAgreeRecipientInfo</CODE>, 
<CODE>KEKRecipientInfo</CODE></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#AuthEnvelopedDataDemo()">AuthEnvelopedDataDemo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setup the demo certificate chains.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#createAuthEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID)">createAuthEnvelopedData</A></B>(byte[]&nbsp;message,
                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>AuthEnvelopedData</code> message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#createAuthEnvelopedDataStream(byte[], iaik.asn1.structures.AlgorithmID)">createAuthEnvelopedDataStream</A></B>(byte[]&nbsp;message,
                              <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>AuthEnvelopedDataStream</code> message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;iaik.cms.RecipientInfo[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#createRecipients()">createRecipients</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates the RecipientInfos.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#getAuthEnvelopedData(byte[], java.security.Key, int)">getAuthEnvelopedData</A></B>(byte[]&nbsp;enc,
                     java.security.Key&nbsp;key,
                     int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its index into the recipientInfos field and verifies
 the message authentication code.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#getAuthEnvelopedData(byte[], java.security.Key, iaik.cms.KeyIdentifier)">getAuthEnvelopedData</A></B>(byte[]&nbsp;enc,
                     java.security.Key&nbsp;key,
                     iaik.cms.KeyIdentifier&nbsp;recipientID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by recipient identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#getAuthEnvelopedData(byte[], java.security.Key, iaik.x509.X509Certificate, byte[])">getAuthEnvelopedData</A></B>(byte[]&nbsp;enc,
                     java.security.Key&nbsp;key,
                     <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCert,
                     byte[]&nbsp;kekID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its recipient certificate or keyID.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#getAuthEnvelopedDataStream(byte[], java.security.Key, int)">getAuthEnvelopedDataStream</A></B>(byte[]&nbsp;encoding,
                           java.security.Key&nbsp;key,
                           int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its index into the recipientInfos field and verifies
 the message authentication code.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#getAuthEnvelopedDataStream(byte[], java.security.Key, iaik.cms.KeyIdentifier)">getAuthEnvelopedDataStream</A></B>(byte[]&nbsp;encoding,
                           java.security.Key&nbsp;key,
                           iaik.cms.KeyIdentifier&nbsp;recipientID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given <code>EnvelopedData</code> object for
 the recipient identified by recipient identifier and verifies the message 
 authentication code.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#getAuthEnvelopedDataStream(byte[], java.security.Key, iaik.x509.X509Certificate, byte[])">getAuthEnvelopedDataStream</A></B>(byte[]&nbsp;encoding,
                           java.security.Key&nbsp;key,
                           <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCert,
                           byte[]&nbsp;kekID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its recipient certificate or kekID and verifies the message 
 authentication code.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#main(java.lang.String[])">main</A></B>(java.lang.String[]&nbsp;argv)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Main method.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#parseAuthEnvelopedDataWithRecipientCertOrKEKId(boolean, byte[])">parseAuthEnvelopedDataWithRecipientCertOrKEKId</A></B>(boolean&nbsp;stream,
                                               byte[]&nbsp;encodedAuthEnvelopedData)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses an AuthEnvelopedData and decrypts the content for all test recipients
 using their recipient certificate (for RecipientInfos of type KeyTransRecipientInfo
 or KeyAgreeRecipientInfo) or key id (for RecipientInfos of type KEKRecipientInfo)
 for identifying the recipient.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#parseAuthEnvelopedDataWithRecipientIdentifier(boolean, byte[])">parseAuthEnvelopedDataWithRecipientIdentifier</A></B>(boolean&nbsp;stream,
                                              byte[]&nbsp;encodedAuthEnvelopedData)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses an AuthEnvelopedData and decrypts the content for all test recipients
 using their recipient identifiers for identifying the recipient.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#parseAuthEnvelopedDataWithRecipientInfoIndex(boolean, byte[])">parseAuthEnvelopedDataWithRecipientInfoIndex</A></B>(boolean&nbsp;stream,
                                             byte[]&nbsp;encodedAuthEnvelopedData)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses an AuthEnvelopedData and decrypts the content for all test recipients
 using the index into the recipientInfos field for identifying the recipient.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#start()">start</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Starts the test.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html#start(iaik.asn1.structures.AlgorithmID)">start</A></B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Starts the test for the given content-authenticated encryption algorithm.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AuthEnvelopedDataDemo()"><!-- --></A><H3>
AuthEnvelopedDataDemo</H3>
<PRE>
public <B>AuthEnvelopedDataDemo</B>()
                      throws java.io.IOException</PRE>
<DL>
<DD>Setup the demo certificate chains.

 Keys and certificates are retrieved from the demo KeyStore ("cms.keystore")
 file which has to be located in your current working directory and may be
 created by running <A HREF="../../../demo/keystore/SetupCMSKeyStore.html" title="class in demo.keystore"><CODE>SetupCMSKeyStore</CODE></A>.
<P>
<DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an file read error occurs</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="createAuthEnvelopedDataStream(byte[], iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
createAuthEnvelopedDataStream</H3>
<PRE>
public byte[] <B>createAuthEnvelopedDataStream</B>(byte[]&nbsp;message,
                                            <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)
                                     throws iaik.cms.CMSException,
                                            java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>AuthEnvelopedDataStream</code> message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be authenticated-enveloped, as byte representation<DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm
<DT><B>Returns:</B><DD>the BER encoding of the <code>AuthEnvelopedData</code> object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>AuthEnvelopedData</code> object cannot
                          be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthEnvelopedDataStream(byte[], java.security.Key, int)"><!-- --></A><H3>
getAuthEnvelopedDataStream</H3>
<PRE>
public byte[] <B>getAuthEnvelopedDataStream</B>(byte[]&nbsp;encoding,
                                         java.security.Key&nbsp;key,
                                         int&nbsp;recipientInfoIndex)
                                  throws iaik.cms.CMSException,
                                         java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its index into the recipientInfos field and verifies
 the message authentication code.
 <p>
 This way of decrypting the content may be used for any type of RecipientInfo
 (KeyTransRecipientInfo, KeyAgreeRecipientInfo, KEKRecipientInfo), but requires to
 know at what index of the recipientInfo field the RecipientInfo for the 
 particular recipient in mind can be found. If the recipient in mind uses
 a RecipientInfo of type KeyAgreeRecipientInfo some processing overhead may
 take place because a KeyAgreeRecipientInfo may contain encrypted content-encryption
 keys for more than only one recipient; since the recipientInfoIndex only
 specifies the RecipientInfo but not the encrypted content encryption key 
 -- if there are more than only one -- repeated decryption runs may be
 required as long as the decryption process completes successfully.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the <code>AuthEnvelopedData</code> object as DER encoded byte array<DD><CODE>key</CODE> - the key to decrypt the message<DD><CODE>recipientInfoIndex</CODE> - the index into the <code>RecipientInfo</code> array
                        to which the specified key belongs
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered or MAC verification fails
<DD><CODE>java.io.IOException</CODE> - if a stream read/write error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthEnvelopedDataStream(byte[], java.security.Key, iaik.cms.KeyIdentifier)"><!-- --></A><H3>
getAuthEnvelopedDataStream</H3>
<PRE>
public byte[] <B>getAuthEnvelopedDataStream</B>(byte[]&nbsp;encoding,
                                         java.security.Key&nbsp;key,
                                         iaik.cms.KeyIdentifier&nbsp;recipientID)
                                  throws iaik.cms.CMSException,
                                         java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given <code>EnvelopedData</code> object for
 the recipient identified by recipient identifier and verifies the message 
 authentication code.
 <p>
 This way of decrypting the content may be used for any type of RecipientInfo
 (KeyTransRecipientInfo, KeyAgreeRecipientInfo, KEKRecipientInfo). The 
 recipient in mind is identified by its recipient identifier.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the <code>AuthEnvelopedData</code> object as BER encoded byte array<DD><CODE>key</CODE> - the key to decrypt the message<DD><CODE>recipientID</CODE> - the recipient identifier uniquely identifying the key of the
        recipient
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if a stream read/write error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthEnvelopedDataStream(byte[], java.security.Key, iaik.x509.X509Certificate, byte[])"><!-- --></A><H3>
getAuthEnvelopedDataStream</H3>
<PRE>
public byte[] <B>getAuthEnvelopedDataStream</B>(byte[]&nbsp;encoding,
                                         java.security.Key&nbsp;key,
                                         <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCert,
                                         byte[]&nbsp;kekID)
                                  throws iaik.cms.CMSException,
                                         java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its recipient certificate or kekID and verifies the message 
 authentication code.
 <p>
 Since recipient certificates only may be used for for RecipientInfos of type
 KeyTransRecipientInfo or KeyAgreeRecipientInfo, a key id has to be supplied
 for decrypting the content for a recipient using a KEKRecipientInfo.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the <code>AuthEnvelopedData</code> object as BER encoded byte array<DD><CODE>key</CODE> - the key to decrypt the message<DD><CODE>recipientCert</CODE> - the certificate of the recipient having a RecipientInfo of
                      type KeyTransRecipientInfo or KeyAgreeRecipientInfo<DD><CODE>kekID</CODE> - the kekID identifying the recipient key when using a RecipientInfo
              of type KEKRecipientInfo
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if a stream read/write error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createAuthEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
createAuthEnvelopedData</H3>
<PRE>
public byte[] <B>createAuthEnvelopedData</B>(byte[]&nbsp;message,
                                      <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)
                               throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates a CMS <code>AuthEnvelopedData</code> message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be enveloped, as byte representation<DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm
<DT><B>Returns:</B><DD>the encoded <code>AuthEnvelopedData</code>, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>AuthEnvelopedData</code> object cannot
                          be created</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthEnvelopedData(byte[], java.security.Key, int)"><!-- --></A><H3>
getAuthEnvelopedData</H3>
<PRE>
public byte[] <B>getAuthEnvelopedData</B>(byte[]&nbsp;enc,
                                   java.security.Key&nbsp;key,
                                   int&nbsp;recipientInfoIndex)
                            throws iaik.cms.CMSException,
                                   java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its index into the recipientInfos field and verifies
 the message authentication code.
 <p>
 This way of decrypting the content may be used for any type of RecipientInfo
 (KeyTransRecipientInfo, KeyAgreeRecipientInfo, KEKRecipientInfo), but requires to
 know at what index of the recipientInfo field the RecipientInfo for the 
 particular recipient in mind can be found. If the recipient in mind uses
 a RecipientInfo of type KeyAgreeRecipientInfo some processing overhead may
 take place because a KeyAgreeRecipientInfo may contain encrypted content-encryption
 keys for more than only one recipient; since the recipientInfoIndex only
 specifies the RecipientInfo but not the encrypted content encryption key 
 -- if there are more than only one -- repeated decryption runs may be
 required as long as the decryption process completes successfully.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>enc</CODE> - the encoded <code>AuthEnvelopedData</code><DD><CODE>key</CODE> - the key to decrypt the message<DD><CODE>recipientInfoIndex</CODE> - the index into the <code>RecipientInfo</code> array
                    to which the specified key belongs
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthEnvelopedData(byte[], java.security.Key, iaik.cms.KeyIdentifier)"><!-- --></A><H3>
getAuthEnvelopedData</H3>
<PRE>
public byte[] <B>getAuthEnvelopedData</B>(byte[]&nbsp;enc,
                                   java.security.Key&nbsp;key,
                                   iaik.cms.KeyIdentifier&nbsp;recipientID)
                            throws iaik.cms.CMSException,
                                   java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by recipient identifier.
 <p>
 This way of decrypting the content may be used for any type of RecipientInfo
 (KeyTransRecipientInfo, KeyAgreeRecipientInfo, KEKRecipientInfo). The 
 recipient in mind is identified by its recipient identifier.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>enc</CODE> - the BER encoded <code>AuthEnvelopedData</code> ASN.1 object<DD><CODE>key</CODE> - the key to decrypt the message<DD><CODE>recipientID</CODE> - the recipient identifier uniquely identifying the key of the
        recipient
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthEnvelopedData(byte[], java.security.Key, iaik.x509.X509Certificate, byte[])"><!-- --></A><H3>
getAuthEnvelopedData</H3>
<PRE>
public byte[] <B>getAuthEnvelopedData</B>(byte[]&nbsp;enc,
                                   java.security.Key&nbsp;key,
                                   <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/x509/X509Certificate.html" title="class or interface in iaik.x509">X509Certificate</A>&nbsp;recipientCert,
                                   byte[]&nbsp;kekID)
                            throws iaik.cms.CMSException,
                                   java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given <code>AuthEnvelopedData</code> object for
 the recipient identified by its recipient certificate or keyID.
 <p>
 Since recipient certificates only may be used for for RecipientInfos of type
 KeyTransRecipientInfo or KeyAgreeRecipientInfo, a key id has to be supplied
 for decrypting the content for a recipient using a KEKRecipientInfo.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>enc</CODE> - the BER encoded <code>AuthEnvelopedData</code> ASN.1 object<DD><CODE>key</CODE> - the key to decrypt the message<DD><CODE>recipientCert</CODE> - the certificate of the recipient having a RecipientInfo of
                      type KeyTransRecipientInfo or KeyAgreeRecipientInfo<DD><CODE>kekID</CODE> - the kekID identifying the recipient key when using a RecipientInfo
              of type KEKRecipientInfo
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="createRecipients()"><!-- --></A><H3>
createRecipients</H3>
<PRE>
public iaik.cms.RecipientInfo[] <B>createRecipients</B>()
                                          throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates the RecipientInfos.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the RecipientInfos created, two KeyTransRecipientInfos, one
         KeyAgreeRecipientInfo (for two recipients with same domain
         parameters), and one KEKRecipientInfo
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if an error occurs when creating the recipient infos</DL>
</DD>
</DL>
<HR>

<A NAME="parseAuthEnvelopedDataWithRecipientInfoIndex(boolean, byte[])"><!-- --></A><H3>
parseAuthEnvelopedDataWithRecipientInfoIndex</H3>
<PRE>
public void <B>parseAuthEnvelopedDataWithRecipientInfoIndex</B>(boolean&nbsp;stream,
                                                         byte[]&nbsp;encodedAuthEnvelopedData)
                                                  throws java.lang.Exception</PRE>
<DL>
<DD>Parses an AuthEnvelopedData and decrypts the content for all test recipients
 using the index into the recipientInfos field for identifying the recipient.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>stream</CODE> - whether to use AuthEnvelopedDataStream or AuthEnvelopedData<DD><CODE>encodedAuthEnvelopedData</CODE> - the encoded AuthEnvelopedData object
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - if some error occurs during decoding/decryption</DL>
</DD>
</DL>
<HR>

<A NAME="parseAuthEnvelopedDataWithRecipientIdentifier(boolean, byte[])"><!-- --></A><H3>
parseAuthEnvelopedDataWithRecipientIdentifier</H3>
<PRE>
public void <B>parseAuthEnvelopedDataWithRecipientIdentifier</B>(boolean&nbsp;stream,
                                                          byte[]&nbsp;encodedAuthEnvelopedData)
                                                   throws java.lang.Exception</PRE>
<DL>
<DD>Parses an AuthEnvelopedData and decrypts the content for all test recipients
 using their recipient identifiers for identifying the recipient.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>stream</CODE> - whether to use AuthEnvelopedDataStream or AuthEnvelopedData<DD><CODE>encodedAuthEnvelopedData</CODE> - the encoded AuthEnvelopedData object
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - if some error occurs during decoding/decryption</DL>
</DD>
</DL>
<HR>

<A NAME="parseAuthEnvelopedDataWithRecipientCertOrKEKId(boolean, byte[])"><!-- --></A><H3>
parseAuthEnvelopedDataWithRecipientCertOrKEKId</H3>
<PRE>
public void <B>parseAuthEnvelopedDataWithRecipientCertOrKEKId</B>(boolean&nbsp;stream,
                                                           byte[]&nbsp;encodedAuthEnvelopedData)
                                                    throws java.lang.Exception</PRE>
<DL>
<DD>Parses an AuthEnvelopedData and decrypts the content for all test recipients
 using their recipient certificate (for RecipientInfos of type KeyTransRecipientInfo
 or KeyAgreeRecipientInfo) or key id (for RecipientInfos of type KEKRecipientInfo)
 for identifying the recipient.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>stream</CODE> - whether to use AuthEnvelopedDataStream or AuthEnvelopedData<DD><CODE>encodedAuthEnvelopedData</CODE> - the encoded AuthEnvelopedData object
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - if some error occurs during decoding/decryption</DL>
</DD>
</DL>
<HR>

<A NAME="start()"><!-- --></A><H3>
start</H3>
<PRE>
public void <B>start</B>()</PRE>
<DL>
<DD>Starts the test.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="start(iaik.asn1.structures.AlgorithmID)"><!-- --></A><H3>
start</H3>
<PRE>
public void <B>start</B>(<A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;contentAuthEncAlg)</PRE>
<DL>
<DD>Starts the test for the given content-authenticated encryption algorithm.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>contentAuthEncAlg</CODE> - the id of the content-authenticated encryption algorithm</DL>
</DD>
</DL>
<HR>

<A NAME="main(java.lang.String[])"><!-- --></A><H3>
main</H3>
<PRE>
public static void <B>main</B>(java.lang.String[]&nbsp;argv)
                 throws java.lang.Exception</PRE>
<DL>
<DD>Main method.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs when reading required keys
            and certificates from files
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../demo/cms/authEnvelopedData/AuthEnvelopedDataOutputStreamDemo.html" title="class in demo.cms.authEnvelopedData"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?demo/cms/authEnvelopedData/AuthEnvelopedDataDemo.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AuthEnvelopedDataDemo.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../../siclogo.jpg> <IMG SRC=../../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
