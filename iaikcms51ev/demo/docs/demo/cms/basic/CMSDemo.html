<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_09) on Wed Nov 02 19:19:21 GMT 2016 -->
<TITLE>
CMSDemo (IAIK-CMS 5.1 API Documentation)
</TITLE>

<META NAME="keywords" CONTENT="demo.cms.basic.CMSDemo class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="CMSDemo (IAIK-CMS 5.1 API Documentation)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?demo/cms/basic/CMSDemo.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CMSDemo.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
demo.cms.basic</FONT>
<BR>
Class CMSDemo</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>demo.cms.basic.CMSDemo</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>CMSDemo</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
This class shows some CMS examples where the content types are
 wrapped into a ContentInfo.
 <p>
 All keys and certificates are read from a keystore created by the
 SetupCMSKeyStore program.
 <p>
 This class demonstrates how to wrap the several CMS types into ContentInfos:
 <p><ul>
 <li>Data
 <li>AuthenticatedData
 <li>EncryptedData for PBE encrypting the content
 <li>EnvelopedData
 <li>DigestedData including the message
 <li>DigestedData without message
 <li>SignedData including the message
 <li>SignedData without message
 </ul><p>
 Additionally, a <i>SignedAndEncryptedData</i> test is performed, which
 is a sequential combination of signed and enveloped data content types.
 <p>
 All sub-tests use the same proceeding: A test message is properly
 processed to give the requested content type object, which subsequently
 is encoded to be "sent" to some recipient, who parses it for the
 inherent structures.
<P>

<P>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#CMSDemo()">CMSDemo</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setup the demo certificate chains.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createAuthenticatedData(byte[], boolean, int)">createAuthenticatedData</A></B>(byte[]&nbsp;message,
                        boolean&nbsp;includeAuthAttrs,
                        int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>AuthenticatedData</code> for the given message message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createAuthenticatedDataStream(byte[], boolean, int)">createAuthenticatedDataStream</A></B>(byte[]&nbsp;message,
                              boolean&nbsp;includeAuthAttrs,
                              int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>AuthenticatedDataStream</code> for the given message message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createData(byte[])">createData</A></B>(byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>Data</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createDataStream(byte[])">createDataStream</A></B>(byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>Data</code> object and wraps it into a ContentInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createDigestedData(byte[], int)">createDigestedData</A></B>(byte[]&nbsp;message,
                   int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>DigestedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createDigestedDataStream(byte[], int)">createDigestedDataStream</A></B>(byte[]&nbsp;message,
                         int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>DigestedData</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createEncryptedData(byte[], iaik.asn1.structures.AlgorithmID, char[])">createEncryptedData</A></B>(byte[]&nbsp;message,
                    <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;pbeAlgorithm,
                    char[]&nbsp;password)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>EncryptedData</code> message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createEncryptedDataStream(byte[], iaik.asn1.structures.AlgorithmID, char[])">createEncryptedDataStream</A></B>(byte[]&nbsp;message,
                          <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;pbeAlgorithm,
                          char[]&nbsp;password)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>EncryptedDataStream</code> message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createEnvelopedData(byte[])">createEnvelopedData</A></B>(byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>EnvelopedData</code> message and wraps it into a ContentInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createEnvelopedDataStream(byte[])">createEnvelopedDataStream</A></B>(byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>EnvelopedData</code> and wraps it into a ContentInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createSignedAndEncryptedData(byte[])">createSignedAndEncryptedData</A></B>(byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a <i>SignedAndEncrypted</i> (i.e. sequential combination of <code>
 SignedData</code> and <code>EnvelopedData</code>) object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createSignedAndEncryptedDataStream(byte[])">createSignedAndEncryptedDataStream</A></B>(byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a <i>SignedAndEncrypted</i> (i.e. sequential combination of <code>
 SignedData</code> and <code>EnvelopedData</code>).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createSignedData(byte[], int)">createSignedData</A></B>(byte[]&nbsp;message,
                 int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>SignedData</code> object and wraps it into a ContentInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#createSignedDataStream(byte[], int)">createSignedDataStream</A></B>(byte[]&nbsp;message,
                       int&nbsp;mode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a CMS <code>SignedData</code> object ans wraps it into a ContentInfo.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getAuthenticatedData(byte[], byte[], java.security.PrivateKey, int)">getAuthenticatedData</A></B>(byte[]&nbsp;encoding,
                     byte[]&nbsp;message,
                     java.security.PrivateKey&nbsp;key,
                     int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted MAC key for the recipient identified by its index
 into the recipientInfos field and uses the MAC key to verify
 the authenticated data.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getAuthenticatedDataStream(byte[], byte[], java.security.PrivateKey, int)">getAuthenticatedDataStream</A></B>(byte[]&nbsp;encoding,
                           byte[]&nbsp;message,
                           java.security.PrivateKey&nbsp;key,
                           int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted MAC key for the recipient identified by its index
 into the recipientInfos field and uses the MAC key to verify
 the authenticated data.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getData(byte[])">getData</A></B>(byte[]&nbsp;encoding)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses a CMS <code>Data</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getDataStream(byte[])">getDataStream</A></B>(byte[]&nbsp;data)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses a CMS <code>Data</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getDigestedData(byte[], byte[])">getDigestedData</A></B>(byte[]&nbsp;encoding,
                byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses a CMS <code>DigestedData</code> object and verifies the hash value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getDigestedDataStream(byte[], byte[])">getDigestedDataStream</A></B>(byte[]&nbsp;digestedData,
                      byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses a CMS <code>DigestedData</code> object and verifies the hash.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getEncryptedData(byte[], char[])">getEncryptedData</A></B>(byte[]&nbsp;encoding,
                 char[]&nbsp;password)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the PBE-encrypted content of the given <code>EncryptedData</code> object
 using the specified password and returns the decrypted (= original) message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getEncryptedDataStream(byte[], char[])">getEncryptedDataStream</A></B>(byte[]&nbsp;encoding,
                       char[]&nbsp;password)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the PBE-encrypted content of the given <code>EncryptedData</code> object
 using the specified password and returns the decrypted (= original) message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getEnvelopedData(byte[], java.security.PrivateKey, int)">getEnvelopedData</A></B>(byte[]&nbsp;encoding,
                 java.security.PrivateKey&nbsp;privateKey,
                 int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given <code>EnvelopedData</code> object for the
 specified recipient and returns the decrypted (= original) message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getEnvelopedDataStream(byte[], java.security.PrivateKey, int)">getEnvelopedDataStream</A></B>(byte[]&nbsp;encoding,
                       java.security.PrivateKey&nbsp;privateKey,
                       int&nbsp;recipientInfoIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the encrypted content of the given EnvelopedData object for the
 specified recipient and returns the decrypted (= original) message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getSignedAndEncryptedData(byte[])">getSignedAndEncryptedData</A></B>(byte[]&nbsp;encoding)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recovers the original message and verifies the signature.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getSignedAndEncryptedDataStream(byte[])">getSignedAndEncryptedDataStream</A></B>(byte[]&nbsp;in)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recovers the original message and verifies the signature.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getSignedData(byte[], byte[])">getSignedData</A></B>(byte[]&nbsp;encoding,
              byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses a CMS <code>SignedData</code> object and verifies the signatures
 for all participated signers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#getSignedDataStream(byte[], byte[])">getSignedDataStream</A></B>(byte[]&nbsp;signedData,
                    byte[]&nbsp;message)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parses a CMS <code>SignedData</code> object and verifies the signatures
 for all participated signers.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#main(java.lang.String[])">main</A></B>(java.lang.String[]&nbsp;argv)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Starts the CMS content type implementation tests.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../demo/cms/basic/CMSDemo.html#start()">start</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tests the CMS content type implementations <code>Data</code>, <code>EnvelopedData</code>,
 <code>SignedData</code>, <code>DigestedData</code>, <code>EncryptedData</code>.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="CMSDemo()"><!-- --></A><H3>
CMSDemo</H3>
<PRE>
public <B>CMSDemo</B>()
        throws java.io.IOException</PRE>
<DL>
<DD>Setup the demo certificate chains.

 Keys and certificate are retrieved from the demo KeyStore.
<P>
<DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if an file read error occurs</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="createDataStream(byte[])"><!-- --></A><H3>
createDataStream</H3>
<PRE>
public byte[] <B>createDataStream</B>(byte[]&nbsp;message)
                        throws iaik.cms.CMSException,
                               java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>Data</code> object and wraps it into a ContentInfo.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be sent, as byte representation
<DT><B>Returns:</B><DD>the encoded ContentInfo containing the <code>Data</code> object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>Data</code> object cannot
                          be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getDataStream(byte[])"><!-- --></A><H3>
getDataStream</H3>
<PRE>
public byte[] <B>getDataStream</B>(byte[]&nbsp;data)
                     throws iaik.cms.CMSException,
                            java.io.IOException</PRE>
<DL>
<DD>Parses a CMS <code>Data</code> object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>data</CODE> - the encoded ContentInfo holding the <code>Data</code>
<DT><B>Returns:</B><DD>the inherent message as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if an parsing exception occurs
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createEnvelopedDataStream(byte[])"><!-- --></A><H3>
createEnvelopedDataStream</H3>
<PRE>
public byte[] <B>createEnvelopedDataStream</B>(byte[]&nbsp;message)
                                 throws iaik.cms.CMSException,
                                        java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>EnvelopedData</code> and wraps it into a ContentInfo.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be enveloped, as byte representation
<DT><B>Returns:</B><DD>the encoded ContentInfo containing the EnvelopedData object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>EnvelopedData</code> object cannot
                          be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getEnvelopedDataStream(byte[], java.security.PrivateKey, int)"><!-- --></A><H3>
getEnvelopedDataStream</H3>
<PRE>
public byte[] <B>getEnvelopedDataStream</B>(byte[]&nbsp;encoding,
                                     java.security.PrivateKey&nbsp;privateKey,
                                     int&nbsp;recipientInfoIndex)
                              throws iaik.cms.CMSException,
                                     java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given EnvelopedData object for the
 specified recipient and returns the decrypted (= original) message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the encoded ContentInfo containing an EnvelopedData object<DD><CODE>privateKey</CODE> - the private key to decrypt the message<DD><CODE>recipientInfoIndex</CODE> - the index into the <code>RecipientInfo</code> array
                           to which the specified private key belongs
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createSignedDataStream(byte[], int)"><!-- --></A><H3>
createSignedDataStream</H3>
<PRE>
public byte[] <B>createSignedDataStream</B>(byte[]&nbsp;message,
                                     int&nbsp;mode)
                              throws iaik.cms.CMSException,
                                     java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>SignedData</code> object ans wraps it into a ContentInfo.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be signed, as byte representation<DD><CODE>mode</CODE> - the mode indicating whether to include the content 
        (SignedDataStream.IMPLICIT) or not (SignedDataStream.EXPLICIT)
<DT><B>Returns:</B><DD>the encoding of the ContentInfo holding the <code>SignedData</code> object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>SignedData</code> object cannot
                          be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedDataStream(byte[], byte[])"><!-- --></A><H3>
getSignedDataStream</H3>
<PRE>
public byte[] <B>getSignedDataStream</B>(byte[]&nbsp;signedData,
                                  byte[]&nbsp;message)
                           throws iaik.cms.CMSException,
                                  java.io.IOException</PRE>
<DL>
<DD>Parses a CMS <code>SignedData</code> object and verifies the signatures
 for all participated signers.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signedData</CODE> - the ContentInfo with inherent SignedData, as BER encoded byte array<DD><CODE>message</CODE> - the the message which was transmitted out-of-band (explicit signed)
<DT><B>Returns:</B><DD>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>SignedData</code>
         object
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if any signature does not verify
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createSignedAndEncryptedDataStream(byte[])"><!-- --></A><H3>
createSignedAndEncryptedDataStream</H3>
<PRE>
public byte[] <B>createSignedAndEncryptedDataStream</B>(byte[]&nbsp;message)
                                          throws iaik.cms.CMSException,
                                                 java.io.IOException</PRE>
<DL>
<DD>Creates a <i>SignedAndEncrypted</i> (i.e. sequential combination of <code>
 SignedData</code> and <code>EnvelopedData</code>).
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be signed and encrypted, as byte representation
<DT><B>Returns:</B><DD>the encoded ContentInfo holding the signed and encrypted message object
         just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the the <code>SignedData</code> or
                          <code>EnvelopedData</code> object cannot be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedAndEncryptedDataStream(byte[])"><!-- --></A><H3>
getSignedAndEncryptedDataStream</H3>
<PRE>
public byte[] <B>getSignedAndEncryptedDataStream</B>(byte[]&nbsp;in)
                                       throws iaik.cms.CMSException,
                                              java.io.IOException</PRE>
<DL>
<DD>Recovers the original message and verifies the signature.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>in</CODE> - the encoded CMS object
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createDigestedDataStream(byte[], int)"><!-- --></A><H3>
createDigestedDataStream</H3>
<PRE>
public byte[] <B>createDigestedDataStream</B>(byte[]&nbsp;message,
                                       int&nbsp;mode)
                                throws iaik.cms.CMSException,
                                       java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>DigestedData</code> object.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be digested, as byte representation
<DT><B>Returns:</B><DD>the encoded ContentInfo containing the DigestedData object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>DigestedData</code> object cannot
                          be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getDigestedDataStream(byte[], byte[])"><!-- --></A><H3>
getDigestedDataStream</H3>
<PRE>
public byte[] <B>getDigestedDataStream</B>(byte[]&nbsp;digestedData,
                                    byte[]&nbsp;message)
                             throws iaik.cms.CMSException,
                                    java.io.IOException</PRE>
<DL>
<DD>Parses a CMS <code>DigestedData</code> object and verifies the hash.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>digestedData</CODE> - the encoded ContentInfo holding a DigestedData object<DD><CODE>message</CODE> - the the message which was transmitted out-of-band
<DT><B>Returns:</B><DD>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>DigestedData</code>
         object
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if any signature does not verify
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createEncryptedDataStream(byte[], iaik.asn1.structures.AlgorithmID, char[])"><!-- --></A><H3>
createEncryptedDataStream</H3>
<PRE>
public byte[] <B>createEncryptedDataStream</B>(byte[]&nbsp;message,
                                        <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;pbeAlgorithm,
                                        char[]&nbsp;password)
                                 throws iaik.cms.CMSException,
                                        java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>EncryptedDataStream</code> message.
 <p>
 The supplied content is PBE-encrypted using the specified password.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be encrypted, as byte representation<DD><CODE>pbeAlgorithm</CODE> - the PBE algorithm to be used<DD><CODE>password</CODE> - the password
<DT><B>Returns:</B><DD>the DER encoding of the ContentInfo holding the <code>EncryptedData</code> object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>EncryptedData</code> object cannot
                          be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getEncryptedDataStream(byte[], char[])"><!-- --></A><H3>
getEncryptedDataStream</H3>
<PRE>
public byte[] <B>getEncryptedDataStream</B>(byte[]&nbsp;encoding,
                                     char[]&nbsp;password)
                              throws iaik.cms.CMSException,
                                     java.io.IOException</PRE>
<DL>
<DD>Decrypts the PBE-encrypted content of the given <code>EncryptedData</code> object
 using the specified password and returns the decrypted (= original) message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the encoded ContentInfo holding an <code>EncryptedData</code> object<DD><CODE>password</CODE> - the password to decrypt the message
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createAuthenticatedDataStream(byte[], boolean, int)"><!-- --></A><H3>
createAuthenticatedDataStream</H3>
<PRE>
public byte[] <B>createAuthenticatedDataStream</B>(byte[]&nbsp;message,
                                            boolean&nbsp;includeAuthAttrs,
                                            int&nbsp;mode)
                                     throws iaik.cms.CMSException,
                                            java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>AuthenticatedDataStream</code> for the given message message.
 <p>
 <b>Attention:</b> This AuthenticatedData demo uses RSA as key management technique.
 In practice (see RFC 5652) a key management technique that provides data origin
 authentication should be used like, for instance, Static-Static Diffie-Hellman when
 both the originator and recipient public keys are bound to appropriate identities 
 in X.509 certificates, see, for instance, <A HREF="../../../demo/cms/authenticatedData/AuthenticatedDataDemo.html" title="class in demo.cms.authenticatedData"><CODE>AuthenticatedDataDemo</CODE></A>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be authenticated, as byte representation<DD><CODE>includeAuthAttrs</CODE> - whether to include authenticated attributes<DD><CODE>mode</CODE> - the mode indicating whether to include the content 
        (AuthenticatedDataStream.IMPLICIT) or not (AuthenticatedDataStream.EXPLICIT)
<DT><B>Returns:</B><DD>the BER encoding of the <code>AuthenticatedData</code> object, wrapped in a ContentInfo
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>AuthenticatedData</code> object cannot
                         be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedDataStream(byte[], byte[], java.security.PrivateKey, int)"><!-- --></A><H3>
getAuthenticatedDataStream</H3>
<PRE>
public byte[] <B>getAuthenticatedDataStream</B>(byte[]&nbsp;encoding,
                                         byte[]&nbsp;message,
                                         java.security.PrivateKey&nbsp;key,
                                         int&nbsp;recipientInfoIndex)
                                  throws iaik.cms.CMSException,
                                         java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted MAC key for the recipient identified by its index
 into the recipientInfos field and uses the MAC key to verify
 the authenticated data.
 <p>
 This way of decrypting the MAC key and verifying the content may be used for 
 any type of RecipientInfo (KeyTransRecipientInfo, KeyAgreeRecipientInfo, 
 KEKRecipientInfo), but requires to know at what index of the recipientInfos
 field the RecipientInfo for the particular recipient in mind can be found. 
 If the recipient in mind uses a RecipientInfo of type KeyAgreeRecipientInfo
 some processing overhead may take place because a KeyAgreeRecipientInfo may
 contain encrypted mac keys for more than only one recipient; since the
 recipientInfoIndex only specifies the RecipientInfo but not the encrypted
 mac key -- if there are more than only one -- repeated decryption runs may be
 required as long as the decryption process completes successfully.
 <p>
 <b>Attention:</b> This AuthenticatedData demo uses RSA as key management technique.
 In practice (see RFC 5652) a key management technique that provides data origin
 authentication should be used like, for instance, Static-Static Diffie-Hellman when
 both the originator and recipient public keys are bound to appropriate identities 
 in X.509 certificates, see, for instance, <A HREF="../../../demo/cms/authenticatedData/AuthenticatedDataDemo.html" title="class in demo.cms.authenticatedData"><CODE>AuthenticatedDataDemo</CODE></A>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the BER encoded ContentInfo holding the <code>AuthenticatedData</code> object<DD><CODE>message</CODE> - the content message, if transmitted by other means (explicit mode)<DD><CODE>key</CODE> - the key to decrypt the mac key<DD><CODE>recipientInfoIndex</CODE> - the index of the right <code>RecipientInfo</code> to 
                           which the given key belongs
<DT><B>Returns:</B><DD>the verified message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the authenticated data cannot be verified
<DD><CODE>java.io.IOException</CODE> - if a stream read/write error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createData(byte[])"><!-- --></A><H3>
createData</H3>
<PRE>
public byte[] <B>createData</B>(byte[]&nbsp;message)
                  throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates a CMS <code>Data</code> object.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be sent, as byte representation
<DT><B>Returns:</B><DD>the DER encoded ContentInfo holding the <code>Data</code> object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>Data</code> object cannot
                          be created</DL>
</DD>
</DL>
<HR>

<A NAME="getData(byte[])"><!-- --></A><H3>
getData</H3>
<PRE>
public byte[] <B>getData</B>(byte[]&nbsp;encoding)
               throws iaik.cms.CMSException,
                      java.io.IOException</PRE>
<DL>
<DD>Parses a CMS <code>Data</code> object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the DER encoded ContentInfo holding with inherent <code>Data</code>
<DT><B>Returns:</B><DD>the inherent message as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if an parsing exception occurs
<DD><CODE>if</CODE> - an I/O related error occurs
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="createEnvelopedData(byte[])"><!-- --></A><H3>
createEnvelopedData</H3>
<PRE>
public byte[] <B>createEnvelopedData</B>(byte[]&nbsp;message)
                           throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates a CMS <code>EnvelopedData</code> message and wraps it into a ContentInfo.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be enveloped, as byte representation
<DT><B>Returns:</B><DD>the DER encoded ContentInfo holding the EnvelopedData object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>EnvelopedData</code> object cannot
                          be created</DL>
</DD>
</DL>
<HR>

<A NAME="getEnvelopedData(byte[], java.security.PrivateKey, int)"><!-- --></A><H3>
getEnvelopedData</H3>
<PRE>
public byte[] <B>getEnvelopedData</B>(byte[]&nbsp;encoding,
                               java.security.PrivateKey&nbsp;privateKey,
                               int&nbsp;recipientInfoIndex)
                        throws iaik.cms.CMSException,
                               java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted content of the given <code>EnvelopedData</code> object for the
 specified recipient and returns the decrypted (= original) message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the DER encoded ContentInfo holding an EnvelopedData<DD><CODE>privateKey</CODE> - the private key to decrypt the message<DD><CODE>recipientInfoIndex</CODE> - the index into the <code>RecipientInfo</code> array
                           to which the specified private key belongs
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="createSignedData(byte[], int)"><!-- --></A><H3>
createSignedData</H3>
<PRE>
public byte[] <B>createSignedData</B>(byte[]&nbsp;message,
                               int&nbsp;mode)
                        throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates a CMS <code>SignedData</code> object and wraps it into a ContentInfo.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be signed, as byte representation<DD><CODE>mode</CODE> - the mode indicating whether to include the content 
        (SignedDataStream.IMPLICIT) or not (SignedDataStream.EXPLICIT)
<DT><B>Returns:</B><DD>the DER encoded ContentInfo holding the <code>SignedData</code> object just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>SignedData</code> object cannot
                          be created</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedData(byte[], byte[])"><!-- --></A><H3>
getSignedData</H3>
<PRE>
public byte[] <B>getSignedData</B>(byte[]&nbsp;encoding,
                            byte[]&nbsp;message)
                     throws iaik.cms.CMSException,
                            java.io.IOException</PRE>
<DL>
<DD>Parses a CMS <code>SignedData</code> object and verifies the signatures
 for all participated signers.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the ContentInfo with inherent <code>SignedData</code> object, as DER encoding<DD><CODE>message</CODE> - the the message which was transmitted out-of-band (explicit signed)
<DT><B>Returns:</B><DD>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>SignedData</code>
         object
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if any signature does not verify
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createSignedAndEncryptedData(byte[])"><!-- --></A><H3>
createSignedAndEncryptedData</H3>
<PRE>
public byte[] <B>createSignedAndEncryptedData</B>(byte[]&nbsp;message)
                                    throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates a <i>SignedAndEncrypted</i> (i.e. sequential combination of <code>
 SignedData</code> and <code>EnvelopedData</code>) object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be signed and encrypted, as byte representation
<DT><B>Returns:</B><DD>the DER encoded ContentInfo holding the signed and encrypted message object
         just created
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the the <code>SignedData</code> or
                          <code>EnvelopedData</code> object cannot be created</DL>
</DD>
</DL>
<HR>

<A NAME="getSignedAndEncryptedData(byte[])"><!-- --></A><H3>
getSignedAndEncryptedData</H3>
<PRE>
public byte[] <B>getSignedAndEncryptedData</B>(byte[]&nbsp;encoding)
                                 throws iaik.cms.CMSException,
                                        java.io.IOException</PRE>
<DL>
<DD>Recovers the original message and verifies the signature.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the DER encoded ContentInfo holding a SignedAndEnryptedData object
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createDigestedData(byte[], int)"><!-- --></A><H3>
createDigestedData</H3>
<PRE>
public byte[] <B>createDigestedData</B>(byte[]&nbsp;message,
                                 int&nbsp;mode)
                          throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates a CMS <code>DigestedData</code> object.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be digested, as byte representation
<DT><B>Returns:</B><DD>the <code>DigestedData</code> wrapped into a ContentInfo, as DER encoding
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>DigestedData</code> object cannot
                          be created</DL>
</DD>
</DL>
<HR>

<A NAME="getDigestedData(byte[], byte[])"><!-- --></A><H3>
getDigestedData</H3>
<PRE>
public byte[] <B>getDigestedData</B>(byte[]&nbsp;encoding,
                              byte[]&nbsp;message)
                       throws iaik.cms.CMSException,
                              java.io.IOException</PRE>
<DL>
<DD>Parses a CMS <code>DigestedData</code> object and verifies the hash value.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the ContentInfo holding a <code>DigestedData</code>, as DER encoding<DD><CODE>message</CODE> - the the message which was transmitted out-of-band (explicit digested)
<DT><B>Returns:</B><DD>the message
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if some parsing exception occurs
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createEncryptedData(byte[], iaik.asn1.structures.AlgorithmID, char[])"><!-- --></A><H3>
createEncryptedData</H3>
<PRE>
public byte[] <B>createEncryptedData</B>(byte[]&nbsp;message,
                                  <A HREF="http://javadoc.iaik.tugraz.at/iaik_jce/current/iaik/asn1/structures/AlgorithmID.html" title="class or interface in iaik.asn1.structures">AlgorithmID</A>&nbsp;pbeAlgorithm,
                                  char[]&nbsp;password)
                           throws iaik.cms.CMSException</PRE>
<DL>
<DD>Creates a CMS <code>EncryptedData</code> message.
 <p>
 The supplied content is PBE-encrypted using the specified password.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be encrypted, as byte representation<DD><CODE>pbeAlgorithm</CODE> - the PBE algorithm to be used<DD><CODE>password</CODE> - the password
<DT><B>Returns:</B><DD>the <code>EncryptedData</code> object wrapped into a ContentInfo, as DER encoding
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>EncryptedData</code> object cannot
                          be created</DL>
</DD>
</DL>
<HR>

<A NAME="getEncryptedData(byte[], char[])"><!-- --></A><H3>
getEncryptedData</H3>
<PRE>
public byte[] <B>getEncryptedData</B>(byte[]&nbsp;encoding,
                               char[]&nbsp;password)
                        throws iaik.cms.CMSException,
                               java.io.IOException</PRE>
<DL>
<DD>Decrypts the PBE-encrypted content of the given <code>EncryptedData</code> object
 using the specified password and returns the decrypted (= original) message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the DER encoded ContentInfo holding the <code>EncryptedData</code> object<DD><CODE>password</CODE> - the password to decrypt the message
<DT><B>Returns:</B><DD>the recovered message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the message cannot be recovered
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="createAuthenticatedData(byte[], boolean, int)"><!-- --></A><H3>
createAuthenticatedData</H3>
<PRE>
public byte[] <B>createAuthenticatedData</B>(byte[]&nbsp;message,
                                      boolean&nbsp;includeAuthAttrs,
                                      int&nbsp;mode)
                               throws iaik.cms.CMSException,
                                      java.io.IOException</PRE>
<DL>
<DD>Creates a CMS <code>AuthenticatedData</code> for the given message message.
 <p>
 <b>Attention:</b> This AuthenticatedData demo uses RSA as key management technique.
 In practice (see RFC 5652) a key management technique that provides data origin
 authentication should be used like, for instance, Static-Static Diffie-Hellman when
 both the originator and recipient public keys are bound to appropriate identities 
 in X.509 certificates, see, for instance, <A HREF="../../../demo/cms/authenticatedData/AuthenticatedDataDemo.html" title="class in demo.cms.authenticatedData"><CODE>AuthenticatedDataDemo</CODE></A>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>message</CODE> - the message to be authenticated, as byte representation<DD><CODE>includeAuthAttrs</CODE> - whether to include authenticated attributes<DD><CODE>mode</CODE> - the mode indicating whether to include the content 
             (AuthenticatedData.IMPLICIT) or not (AuthenticatedDatam.EXPLICIT)
<DT><B>Returns:</B><DD>the BER encoding of the <code>AuthenticatedData</code> object, wrapped in a ContentInfo
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the <code>AuthenticatedData</code> object cannot
                         be created
<DD><CODE>java.io.IOException</CODE> - if an I/O error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getAuthenticatedData(byte[], byte[], java.security.PrivateKey, int)"><!-- --></A><H3>
getAuthenticatedData</H3>
<PRE>
public byte[] <B>getAuthenticatedData</B>(byte[]&nbsp;encoding,
                                   byte[]&nbsp;message,
                                   java.security.PrivateKey&nbsp;key,
                                   int&nbsp;recipientInfoIndex)
                            throws iaik.cms.CMSException,
                                   java.io.IOException</PRE>
<DL>
<DD>Decrypts the encrypted MAC key for the recipient identified by its index
 into the recipientInfos field and uses the MAC key to verify
 the authenticated data.
 <p>
 This way of decrypting the MAC key and verifying the content may be used for 
 any type of RecipientInfo (KeyTransRecipientInfo, KeyAgreeRecipientInfo, 
 KEKRecipientInfo), but requires to know at what index of the recipientInfos
 field the RecipientInfo for the particular recipient in mind can be found. 
 If the recipient in mind uses a RecipientInfo of type KeyAgreeRecipientInfo
 some processing overhead may take place because a KeyAgreeRecipientInfo may
 contain encrypted mac keys for more than only one recipient; since the
 recipientInfoIndex only specifies the RecipientInfo but not the encrypted
 mac key -- if there are more than only one -- repeated decryption runs may be
 required as long as the decryption process completes successfully.
 <p>
 <b>Attention:</b> This AuthenticatedData demo uses RSA as key management technique.
 In practice (see RFC 5652) a key management technique that provides data origin
 authentication should be used like, for instance, Static-Static Diffie-Hellman when
 both the originator and recipient public keys are bound to appropriate identities 
 in X.509 certificates, see, for instance, <A HREF="../../../demo/cms/authenticatedData/AuthenticatedDataDemo.html" title="class in demo.cms.authenticatedData"><CODE>AuthenticatedDataDemo</CODE></A>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encoding</CODE> - the DER encoded ContentInfo holding the <code>AuthenticatedData</code> object<DD><CODE>message</CODE> - the content message, if transmitted by other means (explicit mode)<DD><CODE>key</CODE> - the key to decrypt the mac key<DD><CODE>recipientInfoIndex</CODE> - the index of the right <code>RecipientInfo</code> to 
                           which the given key belongs
<DT><B>Returns:</B><DD>the verified message, as byte array
<DT><B>Throws:</B>
<DD><CODE>iaik.cms.CMSException</CODE> - if the authenticated data cannot be verified
<DD><CODE>java.io.IOException</CODE> - if a IO read/write error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="start()"><!-- --></A><H3>
start</H3>
<PRE>
public void <B>start</B>()</PRE>
<DL>
<DD>Tests the CMS content type implementations <code>Data</code>, <code>EnvelopedData</code>,
 <code>SignedData</code>, <code>DigestedData</code>, <code>EncryptedData</code>.
 An additional <i>SignedAndEncryptedData</i> test sequentially combines
 signed and enveloped data.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="main(java.lang.String[])"><!-- --></A><H3>
main</H3>
<PRE>
public static void <B>main</B>(java.lang.String[]&nbsp;argv)
                 throws java.lang.Exception</PRE>
<DL>
<DD>Starts the CMS content type implementation tests.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - if some error occurs</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<small>This Javadoc may contain text parts from text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright.html#RFC>copyright</a> note).</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?demo/cms/basic/CMSDemo.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CMSDemo.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<IMG SRC=../../../siclogo.jpg> <IMG SRC=../../../iaik_logo.gif> IAIK-CMS 5.1, (c) 2002 <A HREF="http://jce.iaik.tugraz.at/">IAIK</A>, (c) 2003 - 2010 <A HREF="http://jce.iaik.tugraz.at/">SIC</A>
</BODY>
</HTML>
