<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Mon Dec 21 16:59:26 CET 2015 -->
<title>RSAPssSignature (5.3 API Documentation)</title>
<meta name="date" content="2015-12-21">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="RSAPssSignature (5.3 API Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
			
			<b>IAIK-JCE Provider API Documentation</b>
		<br>
			<font size=-1>Version 5.3</font>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/security/rsa/RSAPssPublicKey.html" title="class in iaik.security.rsa"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/security/rsa/RSAPublicKey.html" title="class in iaik.security.rsa"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/security/rsa/RSAPssSignature.html" target="_top">Frames</a></li>
<li><a href="RSAPssSignature.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">iaik.security.rsa</div>
<h2 title="Class RSAPssSignature" class="title">Class RSAPssSignature</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>java.security.SignatureSpi</li>
<li>
<ul class="inheritance">
<li>iaik.security.rsa.RSAPssSignature</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../iaik/security/rsa/MD2withRSAandMGF1Signature.html" title="class in iaik.security.rsa">MD2withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/MD5withRSAandMGF1Signature.html" title="class in iaik.security.rsa">MD5withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/RawRSAPssSignature.html" title="class in iaik.security.rsa">RawRSAPssSignature</a>, <a href="../../../iaik/security/rsa/RIPEMD128withRSAandMGF1Signature.html" title="class in iaik.security.rsa">RIPEMD128withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/RIPEMD160withRSAandMGF1Signature.html" title="class in iaik.security.rsa">RIPEMD160withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/SHA224withRSAandMGF1Signature.html" title="class in iaik.security.rsa">SHA224withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/SHA256withRSAandMGF1Signature.html" title="class in iaik.security.rsa">SHA256withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/SHA384withRSAandMGF1Signature.html" title="class in iaik.security.rsa">SHA384withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/SHA512withRSAandMGF1Signature.html" title="class in iaik.security.rsa">SHA512withRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/SHAwithRSAandMGF1Signature.html" title="class in iaik.security.rsa">SHAwithRSAandMGF1Signature</a>, <a href="../../../iaik/security/rsa/WHIRLPOOLwithRSAandMGF1Signature.html" title="class in iaik.security.rsa">WHIRLPOOLwithRSAandMGF1Signature</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">RSAPssSignature</span>
extends java.security.SignatureSpi</pre>
<div class="block">This class implements the sign and verify methods of the PKCS#1v2.1 PSS signature
 scheme (RSASSA-PSS).
 <p>
 This class follows the guidelines presented in <a href =
 http://www.rsasecurity.com/rsalabs/pkcs/pkcs-1/>PKCS#1 (v.2.1)</a>) for implementing the 
 RSASSA-PSS signature algorithm based on the RSA encryption method.
 <p>
 This class may be used to create/verify PSS based signatures according the
 specification where all parameters (hash algorithm, mask generation function, salt length,
 and trailer field) maybe supplied by the calling application. The trailer field is
 fixed to the 0xBC which is the only trailer field supported by PSS. Generally the
 following steps have to be performed for calculating/verifying a PSS signature:
 <p>
 <ul>
 <li>First an instance of the RSASSA-PSS signature engine has to be created using
 a proper <code>getInstance</code> method, e.g.:<p>
 <blockquote><pre>
 Signature pss = Signature.getInstance("RSASSA-PSS");
 </pre></blockquote><p>
 <li>Second, the Signature object just created has to be properly initialized for
 signing a message respectively verifying a signature using a RSA private
 respectively RSA public key, e.g.:
 <p>
 <ul>
 <li>Initialize for Signing:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <code>pss.initSign(rsaPrivateKey);</code>
 <li>Initialize for Verifying:&nbsp;&nbsp;&nbsp;&nbsp;
                             <code>pss.initVerify(rsaPublicKey);</code>
 </ul>
 <p>
 <li>Third, supply the required parameters (hash algorithm, mask generation function,
 salt length -- trailer field is fixed) as <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a> (default: SHA-1, MGF1, 20), e.g.:
 <p>
 <blockquote><pre>
 // hash algorithm
 AlgorithmID hashID = (AlgorithmID)AlgorithmID.ripeMd160.clone();
 // mask generation function ID
 AlgorithmID mgfID = (AlgorithmID)AlgorithmID.mgf1.clone();
 mgfID.setParameter(hashID.toASN1Object());
 // salt length
 int saltLength = 20;
 // create a RSAPssParameterSpec
 RSAPssParameterSpec pssParamSpec = new RSAPssParameterSpec(hashID, mgfID, saltLength);
 // optionally set hash and mgf engines
 MessageDigest hashEngine = MessageDigest.getInstance("SHA-1");
 pssParamSpec.setHashEngine(hashEngine);
 MaskGenerationAlgorithm mgfEngine = MaskGenerationAlgorithm.getInstance("MGF1");
 MGF1ParameterSpec mgf1Spec = new MGF1ParameterSpec(hashID);
 mgf1Spec.setHashEngine(hashEngine);
 mgfEngine.setParameters(mgf1Spec);
 pssParamSpec.setMGFEngine(mgfEngine);
 // set parameters (for JDK 1.1.8 use pss.setParameter(null, pssParamSpec);)
 pss.setParameter(pssParamSpec); 
 </pre></blockquote>
 If RSASSA-PSS keys (<a href="../../../iaik/security/rsa/RSAPssPrivateKey.html" title="class in iaik.security.rsa"><code>RSAPssPrivateKey</code></a>,
 <a href="../../../iaik/security/rsa/RSAPssPublicKey.html" title="class in iaik.security.rsa"><code>RSAPssPublicKey</code></a>) are used for initializing this 
 Signature engine, they may contain PSS <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>parameters</code></a>. In this case the parameters are taken from the keys,
 except for the application explicitly specifies parameters by calling
 method <code>setParameter</code>. If parameters are specified by
 calling method <code>setParameter</code> they may have to be validated
 against the parameters contained in the key (according to <a href =
 "http://www.ietf.org/rfc/rfc4055.txt"> RFC 4055</a>, the Signature engine
 must be only used with the hash algorithm, mask generation function and
 trailer field parameters that are specified in the key). By default no
 such validation is performed since it may be the responsibility
 of the application to take care for proper parameters (or the
 application may wish to verify a signature even if parameters
 are used that differ from the key parameters). Parameter validation
 can be turned on/off by calling static method <a href="../../../iaik/security/rsa/RSAPssSignature.html#setValidateAgainstPssKeyParameters(boolean)"><code>setValidateAgainstPssKeyParameters</code></a>.
 <p>
 <li>Finally, if the Signature object has been initialized for signing, the data to
 be signed is supplied to it and subsequently the signature is created by calling
 the <code>sign</code> method returning the signature as byte array.
 Otherwise, if the Signature object has been initialized for verifying, first the
 data to be verified is supplied to the Signature object, and subsequently the
 signature is verified by calling the <code>verify</code> method, supplied with
 the byte array holding the corresponding signature value:<p>
 <ul>
 <li>Supply the data to be signed, and subsequently sign it:
 <blockquote><pre>
 pss.update(data);
 byte[] signature = pss.sign();
 </pre></blockquote><p>
 <li>Supply the data to be verified, and verify the signature:
 <blockquote><pre>
 pss.update(data);
 System.out.println("Signature " + (pss.verify(signature) ? "correct!" : "not correct!"));
 </pre></blockquote>
 </ul>
 </ul>

 <p>
 Please note that the <i>Java Cryptography Architecture</i> only allows to set the salt length 
 as parameter and specifies all the other parameters by the algorithm standard name to be implemented by a 
 corresponding PSS signature engine: A signature engine that implements the, for instance,
 "SHA1withRSAandMGF1" (in general: <i>&lt;digest&gt;with&lt;encryption&gt;and&lt;mgf&gt;</i>) PSS signature
 algorithm has to use SHA-1 as hash- and MGF1 as mask generation algorithm. The trailer field
 (0xBC) is fixed by the PKCS#1v2.1 standard and the salt length may be supplied as
 parameter; if not, a default salt length (20 for the SHA-1 hash algorithm) will be used.
 IAIK-JCE implements JCA PSS based signature engine for all hash algorithms supported
 by the IAIK provider. The only mask generation in use is MGF1 as specified by
 <a href = http://www.rsasecurity.com/rsalabs/pkcs/pkcs-1/>PKCS#1 (v.2.1)</a>. For
 creating an instance of the PSS based signature engine call <code>Signature.getInstance</code>
 thereby using the JCA PSS naming convention (<i>&lt;digest&gt;with&lt;encryption&gt;and&lt;mgf&gt;</i>), e.g.:
 <pre>
 Signature shaRsaMgf1 = Signature.getInstance("SHA1withRSAandMGF1", "IAIK");
 </pre>
 The only parameter allowed to be set for such an JCA engine is the salt length.
 Because of the JDK1.1.x compatibility of IAIK-JCE there is no proper way to use the 
 <code>java.security.spec.PSSParameterSpec</code> class for modeling the saltLength 
 parameter. The same functionality is provided by class <a href="../../../iaik/pkcs/pkcs1/RSAPssSaltParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssSaltParameterSpec</code></a> which may be used to supply the saltLength to this PSS based
 signature engine; if no salt length is explicitly supplied, the defined default salt length
 for the underlying signature engine will be used.
 <p>
 <li>Please note that in contrast to PKCS1v1.5 -- where attacks that are based on hash algorithm
 compromise ("hash function substitution") are caught by including the hash algorithm id in
 the DigestInfo encoding -- no such mechanism is used by the PSS signature scheme. So hash
 function substitution has to be addressed by other means when using PSS. One possible solution
 is to use the same hash function for message hashing and any hash operations done by the mask
 generation function (if based on a hash algorithm). This is ensured for all JCA based hash
 engines where the hash algorithm(s) to be used are already given by the implementing class: 
 <a href="../../../iaik/security/rsa/SHAwithRSAandMGF1Signature.html" title="class in iaik.security.rsa"><code>SHA1withRSAandMGF1</code></a>, for instance, uses
 the SHA-1 algorithm for both message hashing and MGF1 hash operations. When using this general
 RSASSA-PSS signature engine, hash algorithm and mask generation function have to be supplied
 by the calling application. In this case it is the responsibility of the application to take 
 care of hash function substitution issues - if desired. This may be done by, for instance, setting
 the same hash algorithm parameter for message hashing and MGF hashing, or, for instance, using 
 one and only hash algorithm in any case, or following any other suitable strategy.</li></div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>File Revision <!-- $$Revision: --> 42 <!-- $ --></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/security/rsa/SHAwithRSAandMGF1Signature.html" title="class in iaik.security.rsa"><code>SHAwithRSAandMGF1Signature</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.security.MessageDigest</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#hash">hash</a></strong></code>
<div class="block">The MessageDigest engine used to hash the data; supplied with an instance of the desired MessageDigest
 algorithm by any extending subclass.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_java.security.SignatureSpi">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;java.security.SignatureSpi</h3>
<code>appRandom</code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#RSAPssSignature()">RSAPssSignature</a></strong>()</code>
<div class="block">Default constructor.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#RSAPssSignature(java.lang.String)">RSAPssSignature</a></strong>(java.lang.String&nbsp;name)</code>
<div class="block">Creates a RSAPssSignature engine with the given name.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.Object</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineGetParameter(java.lang.String)">engineGetParameter</a></strong>(java.lang.String&nbsp;param)</code>
<div class="block">Returns the PSS parameters (hashAlgorithm, mask generation algorithm, salt length, trailer field)
 as <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.security.AlgorithmParameters</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineGetParameters()">engineGetParameters</a></strong>()</code>
<div class="block">Returns the PSS parameters (hashAlgorithm, mask generation algorithm, salt length, trailer field)
 as <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineInitSign(java.security.PrivateKey)">engineInitSign</a></strong>(java.security.PrivateKey&nbsp;pk)</code>
<div class="block"><b>SPI</b>: Initializes this Signature object with the given
 RSA private key for going to sign some data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineInitSign(java.security.PrivateKey, java.security.SecureRandom)">engineInitSign</a></strong>(java.security.PrivateKey&nbsp;pk,
              java.security.SecureRandom&nbsp;random)</code>
<div class="block"><b>SPI</b>: Initializes this Signature object with the given
 RSA private key for going to sign some data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineInitVerify(java.security.PublicKey)">engineInitVerify</a></strong>(java.security.PublicKey&nbsp;pk)</code>
<div class="block"><b>SPI</b>: Initializes this Signature object with the given
 RSA public key for performing a signature verification.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineSetParameter(java.security.spec.AlgorithmParameterSpec)">engineSetParameter</a></strong>(java.security.spec.AlgorithmParameterSpec&nbsp;params)</code>
<div class="block">Sets the parameters (hashAlgorithm, mask generation algorithm, salt length, trailer field)
 for this RSA PSS signature engine.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineSetParameter(java.lang.String, java.lang.Object)">engineSetParameter</a></strong>(java.lang.String&nbsp;param,
                  java.lang.Object&nbsp;value)</code>
<div class="block">Allows to supply a SecureRandom object if required by the underlying signature scheme
 (e.g.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineSign()">engineSign</a></strong>()</code>
<div class="block"><b>SPI</b>: Calculates the signature.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineUpdate(byte)">engineUpdate</a></strong>(byte&nbsp;b)</code>
<div class="block"><b>SPI</b>: Updates the data to be signed or verified
 with the specified byte.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineUpdate(byte[], int, int)">engineUpdate</a></strong>(byte[]&nbsp;b,
            int&nbsp;off,
            int&nbsp;len)</code>
<div class="block"><b>SPI</b>: Updates the data to be signed or verified with the
 specified number of bytes, beginning at the specified offset within the given byte array.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#engineVerify(byte[])">engineVerify</a></strong>(byte[]&nbsp;sigBytes)</code>
<div class="block">Verifies the given signature.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/rsa/RSAPssSignature.html#setValidateAgainstPssKeyParameters(boolean)">setValidateAgainstPssKeyParameters</a></strong>(boolean&nbsp;validate)</code>
<div class="block">Decides whether parameters that are supplied by calling method 
 <code>setParameter</code> shall be validated against parameters
 that maybe contained in RSASSA-PSS keys.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.security.SignatureSpi">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.security.SignatureSpi</h3>
<code>clone, engineSign, engineUpdate, engineVerify</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="hash">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>hash</h4>
<pre>protected&nbsp;java.security.MessageDigest hash</pre>
<div class="block">The MessageDigest engine used to hash the data; supplied with an instance of the desired MessageDigest
 algorithm by any extending subclass.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="RSAPssSignature()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>RSAPssSignature</h4>
<pre>public&nbsp;RSAPssSignature()</pre>
<div class="block">Default constructor. Only used for dynamic object creation.
 An application shall use
 <pre>
 Signature.getInstance("RSASSA-PSS");
 </pre>
 to create a JCA Signature engine for the RSASSA-PSS signature scheme.
 <p>
 Default salt length is set to -1.</div>
</li>
</ul>
<a name="RSAPssSignature(java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>RSAPssSignature</h4>
<pre>protected&nbsp;RSAPssSignature(java.lang.String&nbsp;name)</pre>
<div class="block">Creates a RSAPssSignature engine with the given name. This constructor
 may be used by extending classes to implement PPS signature engines
 according the JCA convention where only the salt length maybe supplied
 as parameter whereas hash algorithm and mask generation function are
 fixed by the engine (e.g. <a href="../../../iaik/security/rsa/SHAwithRSAandMGF1Signature.html" title="class in iaik.security.rsa"><code>SHAwithRSAandMGF1</code></a>.
 <p>
 Default salt length is set to -1.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>name</code> - the name of the engine</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setValidateAgainstPssKeyParameters(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setValidateAgainstPssKeyParameters</h4>
<pre>public static&nbsp;void&nbsp;setValidateAgainstPssKeyParameters(boolean&nbsp;validate)</pre>
<div class="block">Decides whether parameters that are supplied by calling method 
 <code>setParameter</code> shall be validated against parameters
 that maybe contained in RSASSA-PSS keys. If RSASSA-PSS keys are
 used for initializing this Signature engine, they may contain PSS
 <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>parameters</code></a>. In this
 case, according to <a href = "http://www.ietf.org/rfc/rfc4055.txt">
 RFC 4055</a>, this Signature engine must be only used with the
 hash algorithm, mask generation function and trailer field parameters
 that are specified in the key. However, an application
 may want to use method <code>setParameter</code> to specify
 the parameters for this Signature engine. When doing
 so it may be required to validate the given parameters (hash
 algorithm, mask generation function, trailer field) against
 the parameters contained in the RSA-PSS key. By default no
 such validation is performed since it may be the responsibility
 of the application to take care for proper parameters (or the
 application may wish to verify a signature even if parameters
 are used that differ from the key parameters). 
 <br>
 This method maybe called for generally turning on/off validation against
 key parameters:
 <pre>
 RSAPssSignature.setValidateAgainstPssKeyParameters(true);
 </pre></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>validate</code> - whether to validate against key parameters or not</dd></dl>
</li>
</ul>
<a name="engineInitSign(java.security.PrivateKey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineInitSign</h4>
<pre>protected&nbsp;void&nbsp;engineInitSign(java.security.PrivateKey&nbsp;pk)
                       throws java.security.InvalidKeyException</pre>
<div class="block"><b>SPI</b>: Initializes this Signature object with the given
 RSA private key for going to sign some data.
 <br>
 If the given private key is a <a href="../../../iaik/security/rsa/RSAPssPrivateKey.html" title="class in iaik.security.rsa"><code>RSAPssPrivateKey</code></a> that contains <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>parameters</code></a>, these key parameters (hash algorithm, mask generation function,
 salt (length), trailer field) are used for initializing this
 Signature engine.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pk</code> - the RSA private key to be used for signing.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - if a key encoding error occurs or the
                                given key is a <a href="../../../iaik/security/rsa/RSAPssPrivateKey.html" title="class in iaik.security.rsa"><code>RSAPssPrivateKey</code></a> with invalid PSS parameters,
                                or the application has set parameters by calling
                                <code>setParameter</code> before initialization
                                and these parameters cannot be
                                <a href="../../../iaik/security/rsa/RSAPssSignature.html#setValidateAgainstPssKeyParameters(boolean)"><code>validated</code></a> 
                                against the parameters contained in the PSS key</dd></dl>
</li>
</ul>
<a name="engineInitVerify(java.security.PublicKey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineInitVerify</h4>
<pre>protected&nbsp;void&nbsp;engineInitVerify(java.security.PublicKey&nbsp;pk)
                         throws java.security.InvalidKeyException</pre>
<div class="block"><b>SPI</b>: Initializes this Signature object with the given
 RSA public key for performing a signature verification.
 If the given private key is a <a href="../../../iaik/security/rsa/RSAPssPublicKey.html" title="class in iaik.security.rsa"><code>RSAPssPublicKey</code></a> that contains <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>parameters</code></a>, these key parameters (hash algorithm, mask generation function,
 salt (length), trailer field) are used for initializing this
 Signature engine.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pk</code> - the RSA public key belonging to the RSA private key that has been used for signing.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - if a key encoding error occurs
                                or the given key is a <a href="../../../iaik/security/rsa/RSAPssPublicKey.html" title="class in iaik.security.rsa"><code>RSAPssPublicKey</code></a> with invalid PSS parameters,
                                or the application has set parameters by calling
                                <code>setParameter</code> before initialization
                                and these parameters cannot be
                                <a href="../../../iaik/security/rsa/RSAPssSignature.html#setValidateAgainstPssKeyParameters(boolean)"><code>validated</code></a> 
                                against the parameters contained in the PSS key</dd></dl>
</li>
</ul>
<a name="engineSetParameter(java.security.spec.AlgorithmParameterSpec)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineSetParameter</h4>
<pre>protected&nbsp;void&nbsp;engineSetParameter(java.security.spec.AlgorithmParameterSpec&nbsp;params)
                           throws java.security.InvalidAlgorithmParameterException</pre>
<div class="block">Sets the parameters (hashAlgorithm, mask generation algorithm, salt length, trailer field)
 for this RSA PSS signature engine.
 <p>
 <a href = http://www.rsasecurity.com/rsalabs/pkcs/pkcs-1/>PKCS#1 (v.2.1)</a> requires
 the following parameters for the RSA PSS signature scheme:
 <pre>
 RSASSA-PSS-params :: = SEQUENCE {
      hashAlgorithm            [0] HashAlgorithm     DEFAULT sha1,
      maskGenerationAlgorithm  [1] MaskGenAlgorithm  DEFAULT mgf1SHA1,
      saltLength               [2] INTEGER           DEFAULT 20,
      trailerField             [3] TrailerField      DEFAULT trailerFieldBC
 }

 HashAlgorithm ::= Algorithmidentifier { {OAEP-PSSDigestAlgorithms} }

 MaskGenAlgorithm ::= AlgorithmIdentifier { {PKCS1MGFAlgorithms} }

 TrailerField ::= INTEGER { trailerFieldBC(1) }
 </pre>
 This class does not use any default parameters. All parameters have to be supplied as
 <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>; the trailer field has
 to be set to 1 which corresponds to the trailer field byte 0xBC, which is the only
 trailer field supported by the RSA-PSS signature scheme.
 <p>
 An application also may use the <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>
 to provide a SecureRandom object for supplying any random numbers as required by the
 PSS signature algorithm. JDK 1.2 (or later) based applications may prefer to use method 
 <code>initSign(PrivateKey, SecureRandom)</code> to supply a SecureRandom object if required. 
 If a SecureRandom never has been supplied by the application, the signature engine will use
 a default SecureRandom for generating random numbers.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>params</code> - the PSS parameters supplied as RSAPssParameterSpec</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidParameterException</code> - if the parameters are not supplied as RSAPssParameterSpec, the
                                      trailer field is invalid (not 1), any of the required hash
                                      or mgf engines is not available, or a PSS-key is used with
                                      this engine and that the given parameters cannot be
                                      <a href="../../../iaik/security/rsa/RSAPssSignature.html#setValidateAgainstPssKeyParameters(boolean)"><code>validated</code></a> against
                                      the parameters contained in the key</dd>
<dd><code>java.security.InvalidAlgorithmParameterException</code></dd></dl>
</li>
</ul>
<a name="engineGetParameter(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineGetParameter</h4>
<pre>protected&nbsp;java.lang.Object&nbsp;engineGetParameter(java.lang.String&nbsp;param)
                                       throws java.security.InvalidParameterException</pre>
<div class="block">Returns the PSS parameters (hashAlgorithm, mask generation algorithm, salt length, trailer field)
 as <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>param</code> - ignored</dd>
<dt><span class="strong">Returns:</span></dt><dd>the PSS parameters as <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidParameterException</code> - should not occur</dd></dl>
</li>
</ul>
<a name="engineGetParameters()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineGetParameters</h4>
<pre>protected&nbsp;java.security.AlgorithmParameters&nbsp;engineGetParameters()</pre>
<div class="block">Returns the PSS parameters (hashAlgorithm, mask generation algorithm, salt length, trailer field)
 as <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>engineGetParameters</code>&nbsp;in class&nbsp;<code>java.security.SignatureSpi</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the PSS parameters as <a href="../../../iaik/pkcs/pkcs1/RSAPssParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>RSAPssParameterSpec</code></a>.</dd></dl>
</li>
</ul>
<a name="engineSign()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineSign</h4>
<pre>protected&nbsp;byte[]&nbsp;engineSign()
                     throws java.security.SignatureException</pre>
<div class="block"><b>SPI</b>: Calculates the signature.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineSign</code>&nbsp;in class&nbsp;<code>java.security.SignatureSpi</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>a byte array holding the signature value calculated on the data that has been
         supplied when updating this engine</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.SignatureException</code> - if an error occurs when creating the signature</dd></dl>
</li>
</ul>
<a name="engineVerify(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineVerify</h4>
<pre>protected&nbsp;boolean&nbsp;engineVerify(byte[]&nbsp;sigBytes)
                        throws java.security.SignatureException</pre>
<div class="block">Verifies the given signature.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineVerify</code>&nbsp;in class&nbsp;<code>java.security.SignatureSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>sigBytes</code> - the signature bytes to be verified</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> if signature is OK, <code>false</code> otherwise</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.SignatureException</code> - if an error occurs when verifying the signature</dd></dl>
</li>
</ul>
<a name="engineInitSign(java.security.PrivateKey, java.security.SecureRandom)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineInitSign</h4>
<pre>protected&nbsp;void&nbsp;engineInitSign(java.security.PrivateKey&nbsp;pk,
                  java.security.SecureRandom&nbsp;random)
                       throws java.security.InvalidKeyException</pre>
<div class="block"><b>SPI</b>: Initializes this Signature object with the given
 RSA private key for going to sign some data. The supplied 
 SecureRandom may be used by the signature engine if random 
 numbers are required (e.g. PSS).
 <p>
 If a SecureRandom never has been supplied by the application, the signature engine will use
 a default SecureRandom, if required.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>engineInitSign</code>&nbsp;in class&nbsp;<code>java.security.SignatureSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>pk</code> - the RSA private key to be used for signing.</dd><dd><code>random</code> - the SecureRandom if random numbers are required by the signature engine (e.g. PSS)</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - if a key encoding error occurs</dd></dl>
</li>
</ul>
<a name="engineUpdate(byte)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineUpdate</h4>
<pre>protected&nbsp;void&nbsp;engineUpdate(byte&nbsp;b)</pre>
<div class="block"><b>SPI</b>: Updates the data to be signed or verified
 with the specified byte.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineUpdate</code>&nbsp;in class&nbsp;<code>java.security.SignatureSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>b</code> - the byte to be used for updating.</dd></dl>
</li>
</ul>
<a name="engineUpdate(byte[], int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineUpdate</h4>
<pre>protected&nbsp;void&nbsp;engineUpdate(byte[]&nbsp;b,
                int&nbsp;off,
                int&nbsp;len)</pre>
<div class="block"><b>SPI</b>: Updates the data to be signed or verified with the
 specified number of bytes, beginning at the specified offset within the given byte array.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineUpdate</code>&nbsp;in class&nbsp;<code>java.security.SignatureSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>b</code> - the byte array holding the data to be used for this update operation.</dd><dd><code>off</code> - the offset, indicating the start position within the given byte array.</dd><dd><code>len</code> - the number of bytes to be obtained from the given byte array, starting at the given position.</dd></dl>
</li>
</ul>
<a name="engineSetParameter(java.lang.String, java.lang.Object)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>engineSetParameter</h4>
<pre>protected&nbsp;void&nbsp;engineSetParameter(java.lang.String&nbsp;param,
                      java.lang.Object&nbsp;value)
                           throws java.security.InvalidParameterException</pre>
<div class="block">Allows to supply a SecureRandom object if required by the underlying signature scheme
 (e.g. PSS). When using JDK versions prior JDK 1.2 method <code>initSign(PrivateKey, SecureRandom)</code>
 is not available. If required by the underlying signature scheme (e.g. PSS) an 
 application may supply a SecureRandom object as <a href="../../../iaik/pkcs/pkcs1/PKCS1AlgorithmParameterSpec.html" title="class in iaik.pkcs.pkcs1"><code>parameter</code></a>.
 If a SecureRandom never has been supplied by the application, the signature engine will use
 a default SecureRandom, if required.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineSetParameter</code>&nbsp;in class&nbsp;<code>java.security.SignatureSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>param</code> - ignored</dd><dd><code>value</code> - the SecureRandom supplied as PKCS1AlgorithmParameterSpec</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidParameterException</code> - if the SecureRandom is not supplied as PKCS1AlgorithmParameterSpec</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
					
			<small>This Javadoc may contain text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright_javadoc.html#RFC>copyright</a> note) and RSA Data Security Public-Key Cryptography Standards (PKCS, see <a href=../../../RefCopyright_javadoc.html#PKCS>copyright</a> note).</small>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/security/rsa/RSAPssPublicKey.html" title="class in iaik.security.rsa"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/security/rsa/RSAPublicKey.html" title="class in iaik.security.rsa"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/security/rsa/RSAPssSignature.html" target="_top">Frames</a></li>
<li><a href="RSAPssSignature.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
					
			
			<table cellpadding=10>
			<tr>
				<td align=left>
					<img src=../../../siclogo.jpg>
					</td>
					<td align=center>
						5.3<br>
						(c) 2002 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>IAIK</a>, (c) 2003 - 2015 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>SIC</a>
						</td>
						<td align=right>
							<img src=../../../iaik_logo.gif>
							</td>
						</tr>
					</table>
			
		
				</small></p>
</body>
</html>
