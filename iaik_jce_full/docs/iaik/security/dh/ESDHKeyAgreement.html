<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Mon Dec 21 16:59:24 CET 2015 -->
<title>ESDHKeyAgreement (5.3 API Documentation)</title>
<meta name="date" content="2015-12-21">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ESDHKeyAgreement (5.3 API Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
			
			<b>IAIK-JCE Provider API Documentation</b>
		<br>
			<font size=-1>Version 5.3</font>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/security/dh/ESDHKeyFactory.html" title="class in iaik.security.dh"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/security/dh/ESDHKeyAgreement.html" target="_top">Frames</a></li>
<li><a href="ESDHKeyAgreement.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">iaik.security.dh</div>
<h2 title="Class ESDHKeyAgreement" class="title">Class ESDHKeyAgreement</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>javax.crypto.KeyAgreementSpi</li>
<li>
<ul class="inheritance">
<li>iaik.security.dh.ESDHKeyAgreement</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">ESDHKeyAgreement</span>
extends javax.crypto.KeyAgreementSpi</pre>
<div class="block">This class extends implements the Ephemeral Static Diffie-Hellman key
 agreement algorithm for generating shared secret key encryption keys as
 specified by <a href = "http://www.ietf.org/rfc/rfc2631.txt">RFC 2631</a>.
 <p>
 RFC 2631 gives a special variant of the Diffie-Hellman algorithm, based on
 the ANSI X9.42 draft. From the shared secret value ZZ shared keying material
 -- typically used as key encryption key (KEK) for encrypting (wrapping) a
 content encryption key (CEK) -- is created by repeatedly calculating the
 SHA-1 hash of ZZ and additional other information:
 
 <pre>
 KM = H(ZZ || OtherInfo)
 </pre>
 
 where <code>OtherInfo</code> is specified as:
 
 <pre>
 OtherInfo ::= SEQUENCE {
   keyInfo KeySpecificInfo,
   partyAInfo  [0] OCTET STRING OPTIONAL,
   suppPubInfo [2] OCTET STRING }
 
 KeySpecificInfo ::= SEQUENCE {
   algorithm OBJECT IDENTIFIER,
   counter OCTET STRING SIZE (4..4) }
 </pre>
 
 <code>KeySpecificInfo</code> specifies the CEK wrapping algorithm with which
 this KEK will be used and a counter (32 bit number, represented in network
 byte order, initial value is 1 for any ZZ) that is incremented by one every
 time the above key generation function is run for a given KEK.
 <code>partyAInfo</code> is a random string provided by the sender, especially
 required in static-static mode (where the sender has a static key pair with
 the public key placed in a certificate). <code>suppPubInfo</code> id the
 length of the generated KEK , in bits, represented as a 32 bit number in
 network byte order. E.g. for 3DES it would be the byte sequence 00 00 00 C0.
 <p>
 For generating a KEK, the KM above (SHA-1 hash of ZZ || OtherInfo) is
 calculated as often as necessary to give the required keying material by
 concatenating the KM blocks resulting from the several steps. In each step
 the counter is incremented by 1. For 3DES, e.g., which requires 192 bits of
 keying material, the algorithm must be run twice, once with a counter value
 of 1 (to generate K1', K2', and the first 32 bits of K3') and once with a
 counter value of 2 (to generate the last 32 bits of K3). K1',K2' and K3' are
 then parity adjusted to generate the 3 DES keys K1,K2 and K3. For RC2-128,
 which requires 128 bits of keying material, the algorithm is run once, with a
 counter value of 1, and the left-most 128 bits are directly converted to an
 RC2 key. Similarly, for RC2-40, which requires 40 bits of keying material,
 the algorithm is run once, with a counter value of 1, and the leftmost 40
 bits are used as the key.
 <p>
 Any application wishing to be participated into a Ephemeral Static Diffie
 Hellman key agreement for generating a shared secret key according to RFC
 2631 has to instantiate the <code>javax.crypto.KeyAgreement</code> class
 (with "ESDH" as name) and initialize it with its ESDHPrivateKey for bringing
 in the required private information. A ESDH Hellman private key maybe
 generated using a proper key pair generator, e.g.:
 <p>
 
 <pre>
 KeyPairGnerator esdh_key_gen = KeyPairGenerator.getInstance(&quot;ESDH&quot;);
 esdh_key_gen.initialize(1024);
 KeyPair esdh_key_pair = esdh_key_gen.generateKeyPair();
 ESDHPrivateKey esdh_priv_key = (EsDHPrivateKey) esdh_key_pair.getPrivate();
 </pre>
 
 When initializing the ESDHKeyAgreement, together with the private key a
 <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a> has to be
 supplied giving the required other information as described above:
 
 <pre>
 // we want TripleDES key wrap
 AlgorithmID tripleDesWrap = AlgorithmID.cms_3DES_wrap;
 // key length of KEK:
 int keyLength = 192;
 // generate the OtherInfo
 ESDHKEKParameterSpec otherInfo = new ESDHKEKParameterSpec(
     tripleDesWrap.getAlgorithm(), keyLength);
 // the sender has supplied random patryAInfo:
 otherInfo.setPartyAInfo(partyAInfo);
 // now create an ESDHKeyAgreement object:
 KeyAgreement esdh_key_agreement = KeyAgreement.getInstance(&quot;ESDH&quot;);
 esdh_key_agreement.init(esdh_priv_key, otherInfo, random);
 </pre>
 
 Each phase of a key agreement is performed by a call to the
 <code>doPhase</code> method, supplied with some other entity's public key or
 some intermediate key resulting from the last phase. When calling
 <code>doPhase</code> it has to be specified, whether to perform already the
 last phase of the key agreement or not by setting the <code>lastPhase</code>
 parameter to <code>true</code> or <code>false</code>:
 
 <pre>
 esdh_key_agreement.doPhase(esdhPubKey_from_other_entity, true);
 </pre>
 
 Actually generating the shared secret is done by calling the
 <code>generateSecret</code> method:
 <p>
 
 <pre>
 byte[] shared_secret = esdh_key_agreemant.generateSecret();
 </pre>
 <p>
 Please note that calling <code>generateSecret</code> on a ESDHKeyAgreement
 may either return already the key material generated from the shared secret
 value ZZ or just the shared secret value (ZZ, see above). This depends on
 whether you initialize the ESDHKeyAgreement with
 <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a> parameters
 or not, respectively.
 <p>
 Please note that the key material retrieved from calling
 <code>generateSecret</code> may be different from that contained in the
 <code>SecretKey</code> retrieved when calling
 <code>generateSecret(algorithm)</code>. A 3DES key, e.g., returned by
 <code>generateSecret(algorithm)</code> already is parity adjusted, whereas
 the 3DES key material returned by <code>generateSecret</code> is not parity
 adjusted.
 <p>
 Please note that a <code>ESDHKeyAgreement</code> has to be initialized with a
 <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a>
 (representing the OtherInfo) to be distinguished from a
 <a href="../../../iaik/security/dh/ESDHParameterSpec.html" title="class in iaik.security.dh"><code>ESDHParameterSpec</code></a> which may be
 used for initializing a ESDH KeyPairGenerator or ESDHKeyAgreement (see
 <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a> for more
 information on this issue).</div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>File Revision <!-- $$Revision: --> 20 <!-- $ --></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/security/dh/DHKeyAgreement.html" title="class in iaik.security.dh"><code>DHKeyAgreement</code></a>, 
<a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a>, 
<a href="../../../iaik/security/dh/ESDHKEKParameters.html" title="class in iaik.security.dh"><code>ESDHKEKParameters</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../iaik/security/dh/ESDHKeyAgreement.html#ESDHKeyAgreement()">ESDHKeyAgreement</a></strong>()</code>
<div class="block">Empty default Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.security.Key</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/dh/ESDHKeyAgreement.html#engineDoPhase(java.security.Key, boolean)">engineDoPhase</a></strong>(java.security.Key&nbsp;key,
             boolean&nbsp;lastPhase)</code>
<div class="block">Returns the key resulting from the next phase of this ESDH key agreement.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/dh/ESDHKeyAgreement.html#engineGenerateSecret()">engineGenerateSecret</a></strong>()</code>
<div class="block">Returns the shared secret key material finally generated by this DH key
 agreement.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/dh/ESDHKeyAgreement.html#engineGenerateSecret(byte[], int)">engineGenerateSecret</a></strong>(byte[]&nbsp;sharedSecret,
                    int&nbsp;offset)</code>
<div class="block">Generates the shared secret key material finishing this ESDH key agreement
 procedure and writes it into the given byte array, beginning at the given
 offset position.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected javax.crypto.SecretKey</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/dh/ESDHKeyAgreement.html#engineGenerateSecret(java.lang.String)">engineGenerateSecret</a></strong>(java.lang.String&nbsp;algorithm)</code>
<div class="block">Returns the shared secret key material finally generated by this ESDH key
 agreement as SecretKey to be used for the specified secret key algorithm.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/dh/ESDHKeyAgreement.html#engineInit(java.security.Key, java.security.spec.AlgorithmParameterSpec, java.security.SecureRandom)">engineInit</a></strong>(java.security.Key&nbsp;key,
          java.security.spec.AlgorithmParameterSpec&nbsp;params,
          java.security.SecureRandom&nbsp;random)</code>
<div class="block">Initializes this Ephemeral Static Diffie-Hellman KeyAgreement with the given
 key, ESDHKEKParameterSpec, and random seed.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/security/dh/ESDHKeyAgreement.html#engineInit(java.security.Key, java.security.SecureRandom)">engineInit</a></strong>(java.security.Key&nbsp;key,
          java.security.SecureRandom&nbsp;random)</code>
<div class="block">Initialized this ESDHKeyAgreement with the given key and random seed.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ESDHKeyAgreement()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ESDHKeyAgreement</h4>
<pre>public&nbsp;ESDHKeyAgreement()</pre>
<div class="block">Empty default Constructor. Only for internal use. An application shall call
 
 <pre>
 KeyAgreement.getInstance(&quot;ESDH&quot;);
 </pre>
 
 for generating an ESDHKeyAgreement object.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="engineInit(java.security.Key, java.security.spec.AlgorithmParameterSpec, java.security.SecureRandom)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineInit</h4>
<pre>protected&nbsp;void&nbsp;engineInit(java.security.Key&nbsp;key,
              java.security.spec.AlgorithmParameterSpec&nbsp;params,
              java.security.SecureRandom&nbsp;random)
                   throws java.security.InvalidKeyException</pre>
<div class="block">Initializes this Ephemeral Static Diffie-Hellman KeyAgreement with the given
 key, ESDHKEKParameterSpec, and random seed.
 <p>
 The given key constitutes the private DH key of some entity being involved
 in this DH key agreement procedure. Each entity being involved in a DH key
 agreement process has to create a KeyAgreement object by using a proper
 <code>getInstance</code> factory method (e.g.
 <code>KeyAgreement.getInstance("DH");</code>) and subsequently initialize
 it with the entity's private DH key for bringing in the private information
 which will be accessed when required during any phase of the key agreement
 process. Any key later supplied to any of the <code>doPhase</code> methods
 will represent public key material of another participated entity or key
 material resulting from some previously performed phase (if there are more
 than two entities involved in the key agreement).
 <p>
 The supplied parameters have to be of type
 <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a> giving
 the other information required for later creating the shared secret key:
 
 <pre>
 // we want TripleDES key wrap
 AlgorithmID tripleDesWrap = AlgorithmID.cms_3DES_wrap;
 // key length of KEK:
 int keyLength = 192;
 // generate the OtherInfo
 ESDHKEKParameterSpec otherInfo = new ESDHKEKParameterSpec(
     tripleDesWrap.getAlgorithm(), keyLength);
 // the sender has supplied random patryAInfo:
 otherInfo.setPartyAInfo(partyAInfo);
 // now create an ESDHKeyAgreement object:
 KeyAgreement esdh_key_agreement = KeyAgreement.getInstance(&quot;ESDH&quot;);
 esdh_key_agreement.init(dh_priv_key, otherInfo, random);
 </pre></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineInit</code>&nbsp;in class&nbsp;<code>javax.crypto.KeyAgreementSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - the private ESDH key information of the entity involved in the key
          agreement</dd><dd><code>params</code> - the algorithm parameter specification (EDHParameterSpec)
          representing the OtherInfo required for generating the shared
          secret key material</dd><dd><code>random</code> - the random seed (unused)</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - if the given key cannot be used for this key agreement or the
              supplied ParameterSpec is not of type
              <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a></dd></dl>
</li>
</ul>
<a name="engineInit(java.security.Key, java.security.SecureRandom)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineInit</h4>
<pre>protected&nbsp;void&nbsp;engineInit(java.security.Key&nbsp;key,
              java.security.SecureRandom&nbsp;random)
                   throws java.security.InvalidKeyException</pre>
<div class="block">Initialized this ESDHKeyAgreement with the given key and random seed.
 <p>
 Please note that calling <code>generateSecret</code> on the
 ESDHKeyAgreement will just return the shared secret value ZZ and not
 already the key material generated from the shared secret value ZZ
 according to RFC 2631. If you want to get the key material you will have to
 initialize this KeyAgreement with a
 <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a>.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineInit</code>&nbsp;in class&nbsp;<code>javax.crypto.KeyAgreementSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - the private ESDH key information of the entity involved in the key
          agreement</dd><dd><code>random</code> - the random seed</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - if the given key cannot be used for this key agreement</dd></dl>
</li>
</ul>
<a name="engineDoPhase(java.security.Key, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineDoPhase</h4>
<pre>protected&nbsp;java.security.Key&nbsp;engineDoPhase(java.security.Key&nbsp;key,
                              boolean&nbsp;lastPhase)
                                   throws java.security.InvalidKeyException,
                                          java.lang.IllegalStateException</pre>
<div class="block">Returns the key resulting from the next phase of this ESDH key agreement.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineDoPhase</code>&nbsp;in class&nbsp;<code>javax.crypto.KeyAgreementSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - the required key for this phase, supplied by some other entity
          involved in this key agreement</dd><dd><code>lastPhase</code> - <code>true</code> if this is the last phase of this key agreemant,
          <code>false</code> if not</dd>
<dt><span class="strong">Returns:</span></dt><dd>the key resulting from this phase, or <code>null</code> if no key
         is returned by this phase</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - if the given key cannot be used for this key agreement
              algorithm / phase</dd>
<dd><code>java.lang.IllegalStateException</code> - if the given phase cannot be performed in this state of the
              key agreement procedure</dd></dl>
</li>
</ul>
<a name="engineGenerateSecret(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineGenerateSecret</h4>
<pre>protected&nbsp;javax.crypto.SecretKey&nbsp;engineGenerateSecret(java.lang.String&nbsp;algorithm)
                                               throws java.lang.IllegalStateException,
                                                      java.security.NoSuchAlgorithmException,
                                                      java.security.InvalidKeyException</pre>
<div class="block">Returns the shared secret key material finally generated by this ESDH key
 agreement as SecretKey to be used for the specified secret key algorithm.
 <p>
 DES or TripleDES keys are returned parity adjusted. If you want the
 unadjusted key material use one of the other <code>generateSecret</code>
 methods.
 <p>
 Please note that this method may either return already the key material
 generated from the shared secret value ZZ according to RFC 2631 or just the
 shared secret value (ZZ). This depends on whether you have initialized the
 ESDHKeyAgreement with <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a> parameters or not, respectively.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineGenerateSecret</code>&nbsp;in class&nbsp;<code>javax.crypto.KeyAgreementSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>algorithm</code> - the name of the secret key algorithm for which the generated
          secret key shall be used</dd>
<dt><span class="strong">Returns:</span></dt><dd>the generated shared secret as SecretKey</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this key agreement procedure yet is not ready for being
              finished by generating the shared secret</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the given secret key algorithm is not supported</dd>
<dd><code>java.security.InvalidKeyException</code> - if the generated shared secret cannot be returned as SecretKey
              matching to the given algorithm</dd></dl>
</li>
</ul>
<a name="engineGenerateSecret(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineGenerateSecret</h4>
<pre>protected&nbsp;int&nbsp;engineGenerateSecret(byte[]&nbsp;sharedSecret,
                       int&nbsp;offset)
                            throws java.lang.IllegalStateException,
                                   javax.crypto.ShortBufferException</pre>
<div class="block">Generates the shared secret key material finishing this ESDH key agreement
 procedure and writes it into the given byte array, beginning at the given
 offset position.
 <p>
 Please note that this method may either return already the key material
 generated from the shared secret value ZZ according to RFC 2631 or just the
 shared secret value (ZZ). This depends on whether you have initialized the
 ESDHKeyAgreement with <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a> parameters or not, respectively.
 <p>
 Please note that the key material retrieved from calling
 <code>generateSecret</code> may be different from that contained in the
 <code>SecretKey</code> retrieved when calling
 <code>generateSecret(algorithm)</code>. A 3DES key, e.g., returned by
 <code>generateSecret(algorithm)</code> already is parity adjusted, whereas
 the 3DES key material returned by <code>generateSecret</code> is not parity
 adjusted.
 <p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineGenerateSecret</code>&nbsp;in class&nbsp;<code>javax.crypto.KeyAgreementSpi</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>sharedSecret</code> - the byte array to which the generated secret has to be written</dd><dd><code>offset</code> - the offset indicating the start position within the output byte
          array to which to write the generated shared secret</dd>
<dt><span class="strong">Returns:</span></dt><dd>the number of bytes that are stored in the output byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this key agreement procedure yet is not ready for being
              finished by generating the shared secret</dd>
<dd><code>javax.crypto.ShortBufferException</code> - if the given output buffer is too small for holding the secret</dd></dl>
</li>
</ul>
<a name="engineGenerateSecret()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>engineGenerateSecret</h4>
<pre>protected&nbsp;byte[]&nbsp;engineGenerateSecret()
                               throws java.lang.IllegalStateException</pre>
<div class="block">Returns the shared secret key material finally generated by this DH key
 agreement.
 <p>
 Please note that this method may either return already the key material
 generated from the shared secret value ZZ according to RFC 2631 or just the
 shared secret value (ZZ). This depends on whether you have initialized the
 ESDHKeyAgreement with <a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><code>ESDHKEKParameterSpec</code></a> parameters or not, respectively.
 <p>
 Please note that the key material retrieved from calling
 <code>generateSecret</code> may be different from that contained in the
 <code>SecretKey</code> retrieved when calling
 <code>generateSecret(algorithm)</code>. A 3DES key, e.g., returned by
 <code>generateSecret(algorithm)</code> already is parity adjusted, whereas
 the 3DES key material returned by <code>generateSecret</code> is not parity
 adjusted.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>engineGenerateSecret</code>&nbsp;in class&nbsp;<code>javax.crypto.KeyAgreementSpi</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the generated shared secret within a byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this key agreement procedure yet is not ready for being
              finished by generating the shared secret</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
					
			<small>This Javadoc may contain text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright_javadoc.html#RFC>copyright</a> note) and RSA Data Security Public-Key Cryptography Standards (PKCS, see <a href=../../../RefCopyright_javadoc.html#PKCS>copyright</a> note).</small>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/security/dh/ESDHKEKParameterSpec.html" title="class in iaik.security.dh"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/security/dh/ESDHKeyFactory.html" title="class in iaik.security.dh"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/security/dh/ESDHKeyAgreement.html" target="_top">Frames</a></li>
<li><a href="ESDHKeyAgreement.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
					
			
			<table cellpadding=10>
			<tr>
				<td align=left>
					<img src=../../../siclogo.jpg>
					</td>
					<td align=center>
						5.3<br>
						(c) 2002 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>IAIK</a>, (c) 2003 - 2015 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>SIC</a>
						</td>
						<td align=right>
							<img src=../../../iaik_logo.gif>
							</td>
						</tr>
					</table>
			
		
				</small></p>
</body>
</html>
