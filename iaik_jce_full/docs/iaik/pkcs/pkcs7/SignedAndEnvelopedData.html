<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Mon Dec 21 16:59:22 CET 2015 -->
<title>SignedAndEnvelopedData (5.3 API Documentation)</title>
<meta name="date" content="2015-12-21">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SignedAndEnvelopedData (5.3 API Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
			
			<b>IAIK-JCE Provider API Documentation</b>
		<br>
			<font size=-1>Version 5.3</font>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/pkcs/pkcs7/RSACipherProvider.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedDataStream.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/pkcs/pkcs7/SignedAndEnvelopedData.html" target="_top">Frames</a></li>
<li><a href="SignedAndEnvelopedData.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_iaik.pkcs.pkcs7.SignedDataStream">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">iaik.pkcs.pkcs7</div>
<h2 title="Class SignedAndEnvelopedData" class="title">Class SignedAndEnvelopedData</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html" title="class in iaik.pkcs.pkcs7">iaik.pkcs.pkcs7.SignedDataStream</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">iaik.pkcs.pkcs7.SignedData</a></li>
<li>
<ul class="inheritance">
<li>iaik.pkcs.pkcs7.SignedAndEnvelopedData</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../iaik/pkcs/pkcs7/Content.html" title="interface in iaik.pkcs.pkcs7">Content</a>, <a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a>, <a href="../../../iaik/utils/EOFListener.html" title="interface in iaik.utils">EOFListener</a>, java.util.EventListener</dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">SignedAndEnvelopedData</span>
extends <a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></pre>
<div class="block">This class represents the non-stream supporting implementation of the PKCS#7
 <code>SignedAndEnvelopedData</code> type.
 <p>
 Each PKCS#7 content type is associated with a specific object identifier,
 derived from:
 <p>
 
 <PRE>
 pkcs-7 OBJECT IDENTIFIER ::=
   { iso(1) member-body(2) US(840) rsadsi(113549)
       pkcs(1) 7 }
 </PRE>
 <p>
 The object identifier for the <code>SignedAndEnvelopedData</code> content
 type is defined as:
 <p>
 <code>
 signedAndEnvelopedData OBJECT IDENTIFIER ::= { pkcs-7 4 }
 </code>
 <p>
 which corresponds to the OID string "1.2.840.1.113549.1.7.4".
 <p>
 The <a href = http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/>PKCS#7
 Cryptographic Message Standard</a> specifies the <code>SignedAndEnvelopedData
 </code>content type for providing a syntax for building digital envelopes
 whose authenticity and integrity is ensured by digital signatures. Content of
 any type may be enveloped for any number of recipients and signed by any
 number of signers in parallel.
 <p>
 For each recipient, a commonly at random generated content-encryption key is
 encrypted with the particular recipient's public key and - together with
 recipient-specific information - collected into a <code>RecipientInfo</code>
 value. The content is encrypted with the content-encryption key giving a
 <code>EncryptedContent</code> value, which - in combination with a
 recipient-specific encrypted content-encryption key - forms the digital
 envelope for each particular recipient.
 <p>
 For each signer, a message digest is computed on the content with a
 signer-specific message-digest algorithm. Subsequently, again for each
 signer, the corresponding message digest from the previous step is encrypted
 with the particular signer's private key, and the result is encrypted with
 the content-encryption key. This double encrypted message digest and some
 signer-specific information are collected into a<code>
 SignerInfo</code> value. The digital signature for each signer is the
 recovered single encrypted message digest.
 <p>
 Finally all created <code>SignerInfo</code> and <code>RecipientInfo</code>
 values are collected together with the encrypted content for forming a
 <code>SignedAndEnvelopedData</code> structure.
 <p>
 This class implements the <code>SignedAndEnvelopedData</code> structure
 resulting from the last step described above. The
 <code>SignedAndEnvelopedData
 </code>type is defined as ASN.1 SEQUENCE type containing the following
 components (see <a href =
 http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/>PKCS#7 specification</a>,
 Version&nbsp;1.5):
 <p>
 
 <PRE>
 SignedAndEnvelopedData ::= SEQUENCE {
    version                 Version,
    recipientInfos          RecipientInfos,
    digestAlgorithms        DigestAlgorithmIdentifiers,
    encryptedContentInfo    EncryptedContentInfo,
    certificates                  [0] IMPLICIT Certificates OPTIONAL,
    crls                    [1] IMPLICIT CertificateRevocationLists OPTIONAL,
    signerInfos             SignerInfos }
 </PRE>
 <p>
 The <code>digestAlgorithms</code> field contains the object identifiers of
 the message digest algorithms used by the several signers for digesting the
 content. The optional <code>certificates</code> field shall contain
 certificate chains for all the signers of the <code>signerInfos</code> field.
 The optional <code>crls</code> field may supply information about the
 revocation status of the certificates specified in the <code>certificates
 </code>field. The <code>encryptedContentInfo</code> field specifies the
 content type, the content-encryption algorithm, and holds the encrypted
 content. The non-empty <code>SignerInfos</code> and
 <code>RecipientInfos</code> collect per-signer (respectively per-recipient)
 information for all participated signers (recipients). Each
 <code>SignerInfo</code> includes the double encrypted message digest in its
 <code>encrypted_digest</code> field, and each <code>RecipientInfo</code>
 includes the content-encryption key, encrypted with the particular
 recipient's public key.
 <p>
 A recipient, when receiving the <code>SignedAndEnvelopedData</code> message,
 decrypts the encrypted content-encryption key from the corresponding <code>
 RecipientInfo</code> with his/her private key for subsequently decrypting the
 encrypted content using the content-encryption key just recovered.
 Subsequently the recovered content-encryption key is used for decrypting the
 double encrypted message digest for each signer, and the result is decrypted
 with the signer's public key giving the recovered message digest, which can
 be compared with an independently computed message digest for verifying the
 signature.
 <p>
 For more information consult the RSA <a href =
 http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/>PKCS#7</a> specification.
 Note, that PKCS#7 Version 1.6 removes support for extended certificates,
 which already is considered by this implementation.
 <p>
 It is recommended to use a sequential combination of the signed-data and the
 enveloped-data content types instead of using the signed-and-enveloped-data
 content type, since the signed-and-enveloped-data content type does not have
 authenticated or unauthenticated attributes, and does not provide enveloping
 of signer information other than the signature.
 <p>
 <hr>
 <p>
 <p>
 Assuming that <code>signer_certs</code> and <code>recipient_certs</code>
 represent the certificate chains of some single signer and some intended
 recipient, a typical proceeding may perform the following steps for building
 a <code>SignedAndEnvelopedData</code> object to be sent to the recipient:
 <p>
 
 <PRE>
 //the data to be signed and enveloped supplied as byte array:
 byte[] data = ...;
 //create a <i>SignedAndEnvelopedData</i> object thereby supplying the data
 //and the content-encryption algorithm to use:
 SignedAndEnvelopedData saed = new new SignedAndEnvelopedData(data, AlgorithmID.des_EDE3_CBC);
 //supply the signer's certificate chain (generally, there may be more than only
 //one signer):
 saed.setCertificates(signer_certs);
 //create a <i>SignerInfo</i> structure for the signer entity thereby
 //specifying the signer's certificate by an <i>IssuerAndSerialNumber</i>
 //structure, the signer's digest algorithm, and the signer's private key;
 //the IssuerAndSerialNumber can be created from signer_certs[0], which constitutes
 //the signer's certificate:
 IssuerAndSerialNumber issuer_and_serialNr = new IssuerAndSerialNumber(signer_certs[0]);
 SignerInfo signer_info = new SignerInfo(issuer_and_serialNr, AlgorithmID.sha, privateKey);
 //add the SignerInfo just created to the SignedAndEnvelopedData object:
 saed.addSignerInfo(signer_info);
 //create a <i>RecipientInfo</i> for the intended recipient thereby specifying
 //its certificate (for obtaining the IssuerAndSerialNumber) and the key
 //encryption algorithm to be used (at this time only the rsaEncryption method
 //is supported):
 RecipientInfo recipient = new RecipientInfo(recipient_certs[0], AlgorithmID.rsaEncryption);
 //add the recipient to the SignedAndEnvelopedData object:
 saed.addRecipientInfo(recipient);
 //prepare the SignedAndEnvelopedData structure for transmission by transforming it to an
 //ASN1Object or immediately DER encoding it:
 ASN1Object obj = saed.toASN1Object();
 //respectively byte[] encoding = saed.getEncoded();
 </PRE>
 
 When encoding the SignedAndEnvelopedData you optionally may force
 block-encoding by using the corresponding <code>writeTo</code> method of the
 <code>SignedData(Stream)</code> super class with a positive block size value.
 In this case, the encrypted data is BER encoded as indefinite constructed
 octet string being composed of a series of definite primitive encoded octet
 strings of <code>blockSize</code> length, e.g.:
 
 <pre>
 0x24 0x80
           0x04 &lt;blocksize&gt; &lt;first encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;second encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;third encrypted content block&gt;
              ...
 0x00 0x00
 </pre>
 
 instead of:
 
 <pre>
 0x04 &lt;length&gt; &lt;encrypted content&gt;
 </pre>
 
 The indefinite constructed encoding scheme may be preferable when intending
 to be compatible to the encoding practice of some particular application (for
 instance some versions of Netscape Navigator).
 <p>
 Each recipient decrypts the content-encryption key with his/her private key
 and subsequently decrypts the encrypted content and the double-encrypted
 message digest for each signer with the recovered content-encryption key. The
 signature is verified by decrypting the (now single-) encrypted message
 digest with the signer's public key for comparing it with a independently
 computed message digest, e.g.:
 
 <PRE>
 // if the SignedAndEnvelopedData is supplied as encoding, first decode it to an
 // ASN1Object:
 ASN1Object obj = DerCoder.decode(encoding);
 // create a SignedAndEnvelopedData from the received ASN1 object:
 SignedAndEnvelopedData saed = new SignedAndEnvelopedData(obj);
 // setup the cipher for decryption with the recipient's private key; perform the
 // encrypted-content decryption
 int recipientInfoIndex = 0;
 saed.setupCipher(privateKey, recipientInfoIndex);
 // get the recovered data:
 byte[] content = saed.getContent();
 // verify the signatures of all participated signers:
 SignerInfo[] signer_infos = saed.getSignerInfos();
 for (int i = 0; i &lt; signer_infos.length; i++) {
   try {
     // verify the signed data using the SignerInfo at index i
     X509Certificate signer_cert = saed.verify(i);
     // if the signature is OK the certificate of the signer is returned
     System.out.println(&quot;Signature OK from signer: &quot;
         + signer_cert.getSubjectDN());
   } catch (SignatureException ex) {
     // if the signature is not OK a SignatureException is thrown
     System.out.println(&quot;Signature ERROR from signer: &quot;
         + signed_and_enveloped_data.getCertificate(
             signer_infos[i].getIssuerAndSerialNumber()).getSubjectDN());
   }
 }
 </PRE>
 
 <b>PKCS#7v1.6 Support:<br>
 ===================</b><br>
 This class also may be used for creating/parsing SignedAndEnvelopedData
 objects of version 1.6. Main differences between v1.5 and v1.6 are the hash
 calculation and content encryption (v1.6 calculates the has respectively
 encrypts the whole content encoding and therefore may be unsuitable for
 handling large amounts of data) and the encoding of SET OF structures which
 is replaced by SEQUENCE OF in PKCS#7v1.6. For creating a v1.6
 SignedAndEnvelopedData object you only have to set the version number (2 for
 indicating PKCS#7v1.6) when
 <a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID, int)"><code>creating</code></a> a
 SignedAndEnvelopedData object:
 
 <pre>
 byte[] content = ...;
 AlgorithmID contentEA = ...;
 // version number 2 indicates PKCS#7v1.6
 int version = 2;
 SignedAndEnvelopedData sae = new SignedAndEnvelopedData(content, contentEA, version);
 ...
 </pre>
 
 On the receiving end you can use this class in the same way as described
 above for parsing and decrypting the content and verifying the signature(s)
 of a PKCS#7v1.5 or v1.6 SignedAndEnvelopedData object. Since PKCS#7v1.6 is
 unsuitable for stream handling, the stream based class
 <code>SignedAndEnvelopedDataStream</code> does not support PKCS#7v1.6.</div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>File Revision <!-- $$Revision: --> 30 <!-- $ --></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/pkcs/pkcs7/SignerInfo.html" title="class in iaik.pkcs.pkcs7"><code>SignerInfo</code></a>, 
<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a>, 
<a href="../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>IssuerAndSerialNumber</code></a>, 
<a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7"><code>SignedData</code></a>, 
<a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7"><code>EnvelopedData</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_iaik.pkcs.pkcs7.SignedDataStream">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;iaik.pkcs.pkcs7.<a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html" title="class in iaik.pkcs.pkcs7">SignedDataStream</a></h3>
<code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#block_size">block_size</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#certificates">certificates</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#content_type">content_type</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#crls">crls</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#EXPLICIT">EXPLICIT</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#IMPLICIT">IMPLICIT</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#input_stream">input_stream</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#mode">mode</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#signer_infos">signer_infos</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#this_object">this_object</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#version">version</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData()">SignedAndEnvelopedData</a></strong>()</code>
<div class="block">Default constructor for dynamic object creation in ContentInfo.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(iaik.asn1.ASN1Object)">SignedAndEnvelopedData</a></strong>(<a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a>&nbsp;obj)</code>
<div class="block">Creates a PKCS#7 <code>SignedAndEnvelopedData</code> from an ASN1Object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID)">SignedAndEnvelopedData</a></strong>(byte[]&nbsp;content,
                      <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA)</code>
<div class="block">Creates a new PKCS#7 SignedAndEnvelopedData object where the content is
 supplied as byte array.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID, int)">SignedAndEnvelopedData</a></strong>(byte[]&nbsp;content,
                      <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA,
                      int&nbsp;keyLength)</code>
<div class="block">Creates a new PKCS#7 SignedAndEnvelopedData object where the content is
 supplied as byte array.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID, int, int)">SignedAndEnvelopedData</a></strong>(byte[]&nbsp;content,
                      <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA,
                      int&nbsp;keyLength,
                      int&nbsp;version)</code>
<div class="block">Creates a new PKCS#7 SignedAndEnvelopedData object where the content is
 supplied as byte array.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(java.io.InputStream)">SignedAndEnvelopedData</a></strong>(java.io.InputStream&nbsp;is)</code>
<div class="block">Creates a new SignedAndEnvelopedData where the DER encoded data is read
 from the given InputStream.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#addRecipientInfo(iaik.pkcs.pkcs7.RecipientInfo)">addRecipientInfo</a></strong>(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>&nbsp;recipient)</code>
<div class="block">Adds one recipient to the list of recipient infos.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#decode(iaik.asn1.ASN1Object)">decode</a></strong>(<a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a>&nbsp;obj)</code>
<div class="block">Decodes the SignedAndEnvelopedData supplied as ASN1Object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#decode(java.io.InputStream)">decode</a></strong>(java.io.InputStream&nbsp;is)</code>
<div class="block">Reads and decodes the SignedAndEnvelopedData from a DerInputStream.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#getContent()">getContent</a></strong>()</code>
<div class="block">Returns the content as byte array.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../iaik/asn1/ObjectID.html" title="class in iaik.asn1">ObjectID</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#getContentType()">getContentType</a></strong>()</code>
<div class="block">Returns the content type this class implements.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfo.html" title="class in iaik.pkcs.pkcs7">EncryptedContentInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#getEncryptedContentInfo()">getEncryptedContentInfo</a></strong>()</code>
<div class="block">Returns the encrypted content info included in this SignedAndEnvelopedData
 object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.io.InputStream</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#getInputStream()">getInputStream</a></strong>()</code>
<div class="block">Returns an InputStream for reading the content.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#getRecipientInfos()">getRecipientInfos</a></strong>()</code>
<div class="block">Returns all the recipient infos included in this SignedAndEnvelopedData
 object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])">setRecipientInfos</a></strong>(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;recipients)</code>
<div class="block">Sets the recipient infos.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#setupCipher(java.security.PrivateKey, int)">setupCipher</a></strong>(java.security.PrivateKey&nbsp;recipientPrivateKey,
           int&nbsp;recipientInfoIndex)</code>
<div class="block">Uses the specified private key to setup the Cipher for decrypting the
 content-encryption key and subsequently using it to decrypt the encrypted
 content of this<code>
 EnvelopedData</code> object for the requesting recipient, specified by its
 <code>recipientInfoIndex</code>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#toASN1Object(int)">toASN1Object</a></strong>(int&nbsp;blockSize)</code>
<div class="block">Returns this SignedAndEnvelopedData as ASN1Object where a constructed OCTET
 STRING is used for encoding the content.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#toString()">toString</a></strong>()</code>
<div class="block">Returns a string giving some information about this SignedAndEnvelopedData
 object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#toString(boolean)">toString</a></strong>(boolean&nbsp;detailed)</code>
<div class="block">Returns a string giving some - if requested - detailed information about
 this SignedAndEnvelopedData object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#verify(java.security.PublicKey, int)">verify</a></strong>(java.security.PublicKey&nbsp;publicKey,
      int&nbsp;signerInfoIndex)</code>
<div class="block">Uses the provided public key for verifying the signature that has been
 created by the <code>signerInfoIndex</code>th signer.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_iaik.pkcs.pkcs7.SignedData">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;iaik.pkcs.pkcs7.<a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></h3>
<code><a href="../../../iaik/pkcs/pkcs7/SignedData.html#addSignerInfo(iaik.pkcs.pkcs7.SignerInfo)">addSignerInfo</a>, <a href="../../../iaik/pkcs/pkcs7/SignedData.html#getEncoded()">getEncoded</a>, <a href="../../../iaik/pkcs/pkcs7/SignedData.html#setInputStream(java.io.InputStream)">setInputStream</a>, <a href="../../../iaik/pkcs/pkcs7/SignedData.html#setupMessageDigests()">setupMessageDigests</a>, <a href="../../../iaik/pkcs/pkcs7/SignedData.html#setVersion(int)">setVersion</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_iaik.pkcs.pkcs7.SignedDataStream">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;iaik.pkcs.pkcs7.<a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html" title="class in iaik.pkcs.pkcs7">SignedDataStream</a></h3>
<code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getBlockSize()">getBlockSize</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getCertificate(iaik.pkcs.pkcs7.IssuerAndSerialNumber)">getCertificate</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getCertificates()">getCertificates</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getCRLs()">getCRLs</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getDigestAlgorithms()">getDigestAlgorithms</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getMessageDigest(iaik.asn1.structures.AlgorithmID)">getMessageDigest</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getMode()">getMode</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getSignedDigest(int)">getSignedDigest</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getSignerInfos()">getSignerInfos</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getVersion()">getVersion</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#notifyEOF()">notifyEOF</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#setBlockSize(int)">setBlockSize</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#setCertificates(iaik.x509.X509Certificate[])">setCertificates</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#setCRLs(iaik.x509.X509CRL[])">setCRLs</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#setMessageDigest(iaik.asn1.structures.AlgorithmID, byte[])">setMessageDigest</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#setSignerInfos(iaik.pkcs.pkcs7.SignerInfo[])">setSignerInfos</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#toASN1Object()">toASN1Object</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#verify(int)">verify</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#verify(iaik.x509.X509Certificate)">verify</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#writeTo(java.io.OutputStream)">writeTo</a>, <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_iaik.pkcs.pkcs7.ContentStream">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;iaik.pkcs.pkcs7.<a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></h3>
<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#getBlockSize()">getBlockSize</a>, <a href="../../../iaik/pkcs/pkcs7/ContentStream.html#setBlockSize(int)">setBlockSize</a>, <a href="../../../iaik/pkcs/pkcs7/ContentStream.html#toASN1Object()">toASN1Object</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="SignedAndEnvelopedData()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SignedAndEnvelopedData</h4>
<pre>protected&nbsp;SignedAndEnvelopedData()</pre>
<div class="block">Default constructor for dynamic object creation in ContentInfo. An
 application shall not use this constructor for creating a
 SignedAndEnvelopedData object. The block size is set to -1 meaning that the
 data will be encoded a one simple octet string by default.</div>
</li>
</ul>
<a name="SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SignedAndEnvelopedData</h4>
<pre>public&nbsp;SignedAndEnvelopedData(byte[]&nbsp;content,
                      <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA)
                       throws java.security.NoSuchAlgorithmException</pre>
<div class="block">Creates a new PKCS#7 SignedAndEnvelopedData object where the content is
 supplied as byte array. The content type is set to PKCS#7 <b>Data</b>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>content</code> - the raw data to sign and envelope</dd><dd><code>contentEA</code> - the content encryption algorithm for encrypting the content</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation for the specified algorithm</dd></dl>
</li>
</ul>
<a name="SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SignedAndEnvelopedData</h4>
<pre>public&nbsp;SignedAndEnvelopedData(byte[]&nbsp;content,
                      <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA,
                      int&nbsp;keyLength)
                       throws java.security.NoSuchAlgorithmException</pre>
<div class="block">Creates a new PKCS#7 SignedAndEnvelopedData object where the content is
 supplied as byte array. The content type is set to PKCS#7 <b>Data</b>.
 <p>
 When using this constructor, automatically a symmetric key for content
 encryption is generated. If the specified content encryption algorithm
 supports variable key lengths, a particular key length may be set by means
 of the <code>keyLength</code> parameter. If no length is specified, the
 defined default key length will be used. If the algorithm only works with
 keys of fixed-size length, the keyLength parameter may be set to -1 or the
 <a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID)"><code>SignedAndEnvelopedData(byte[] content,
 AlgorithmID contentEA)</code></a> constructor may be used.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>content</code> - the raw data to sign and envelope</dd><dd><code>contentEA</code> - the content encryption algorithm for encrypting the content</dd><dd><code>keyLength</code> - the key length that may be set when using a content encryption
          algorithm that supports variable key lengths, or -1 to use the
          default key length for the content encryption algorithm.             
          <br><b>Attention!</b> The meaning of this parameter has changed
          from <code>version</code> to <code>keyLength</code>. However,
          for backwards compatibility to prior versions of this class,
          the <code>keyLength</code> parameter is interpreted as <code>version</code>
          if it has one of the two only possible version values 1 (default; indicating a PKCS#7v1.5 
          SignedAndEnvelopedData) or 2 (indicating a PKCS#71.6 SignedAndEnvelopedData). Since
          1 or 2 are no reasonable key length values no mis-interpretation of the <code>keyLength</code>
          parameter shall occur.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation for the specified algorithm</dd></dl>
</li>
</ul>
<a name="SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SignedAndEnvelopedData</h4>
<pre>public&nbsp;SignedAndEnvelopedData(byte[]&nbsp;content,
                      <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA,
                      int&nbsp;keyLength,
                      int&nbsp;version)
                       throws java.security.NoSuchAlgorithmException</pre>
<div class="block">Creates a new PKCS#7 SignedAndEnvelopedData object where the content is
 supplied as byte array. The content type is set to PKCS#7 <b>Data</b>.
 <p>
 When using this constructor, automatically a symmetric key for content
 encryption is generated. If the specified content encryption algorithm
 supports variable key lengths, a particular key length may be set by means
 of the <code>keyLength</code> parameter. If no length is specified, the
 defined default key length will be used. If the algorithm only works with
 keys of fixed-size length, the keyLength parameter may be set to -1 or the
 <a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#SignedAndEnvelopedData(byte[], iaik.asn1.structures.AlgorithmID)"><code>SignedAndEnvelopedData(byte[] content,
 AlgorithmID contentEA)</code></a> constructor may be used.
 <p>
 This constructor may be used for creating an v1.6 SignedAndEnvelopedData
 message, where the version number (2) has to be supplied for indicating to
 calculate the hash over and encrypt the (content) encoding.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>content</code> - the raw data to sign and envelope</dd><dd><code>contentEA</code> - the content encryption algorithm for encrypting the content</dd><dd><code>keyLength</code> - the key length that may be set when using a content encryption
          algorithm that supports variable key lengths, or -1 to use the
          default key length for the content encryption algorithm</dd><dd><code>version</code> - either 1 (indicating a PKCS#7v1.5 SignedAndEnvelopedData) or 2
          (indicating a PKCS#71.6 SignedAndEnvelopedData); default is 1.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation for the specified algorithm</dd></dl>
</li>
</ul>
<a name="SignedAndEnvelopedData(iaik.asn1.ASN1Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SignedAndEnvelopedData</h4>
<pre>public&nbsp;SignedAndEnvelopedData(<a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a>&nbsp;obj)
                       throws <a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></pre>
<div class="block">Creates a PKCS#7 <code>SignedAndEnvelopedData</code> from an ASN1Object.
 <p>
 Do <i><b>not</b></i> use this constructor for supplying the content value
 to be signed and enveloped. This constructor may be used by the recipient
 for parsing an already existing <code>SignedAndEnvelopedData</code> object,
 supplied as ASN1Object that may have been created by calling
 <a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#toASN1Object()"><code>toASN1Object</code></a>.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the PKCS#7 <code>SignedAndEnvelopedData</code> as ASN1Object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></code> - if the object can not be parsed</dd></dl>
</li>
</ul>
<a name="SignedAndEnvelopedData(java.io.InputStream)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SignedAndEnvelopedData</h4>
<pre>public&nbsp;SignedAndEnvelopedData(java.io.InputStream&nbsp;is)
                       throws <a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a>,
                              java.io.IOException</pre>
<div class="block">Creates a new SignedAndEnvelopedData where the DER encoded data is read
 from the given InputStream.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>is</code> - the InputStream holding a DER encoded PKCS#7
          SignedAndEnvelopedData object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an I/O error occurs during reading from the InputStream</dd>
<dd><code><a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></code> - if an error occurs while parsing the object</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="decode(iaik.asn1.ASN1Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decode</h4>
<pre>public&nbsp;void&nbsp;decode(<a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a>&nbsp;obj)
            throws <a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></pre>
<div class="block">Decodes the SignedAndEnvelopedData supplied as ASN1Object.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/Content.html#decode(iaik.asn1.ASN1Object)">decode</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/Content.html" title="interface in iaik.pkcs.pkcs7">Content</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedData.html#decode(iaik.asn1.ASN1Object)">decode</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the PKCS#7 SignedAndEnvelopedData as ASN1Object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></code> - if an error occurs while parsing the object</dd></dl>
</li>
</ul>
<a name="decode(java.io.InputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decode</h4>
<pre>public&nbsp;void&nbsp;decode(java.io.InputStream&nbsp;is)
            throws java.io.IOException,
                   <a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></pre>
<div class="block">Reads and decodes the SignedAndEnvelopedData from a DerInputStream. If the
 supplied InputStream actually is not an instance of
 <a href="../../../iaik/asn1/DerInputStream.html" title="class in iaik.asn1"><code>DerInputStream</code></a>, internally a
 DerInputStream is created before parsing the data.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#decode(java.io.InputStream)">decode</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedData.html#decode(java.io.InputStream)">decode</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>is</code> - the InputStream holding a DER encoded PKCS#7
          SignedAndEnvelopedData object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an I/O error occurs during reading from the InputStream</dd>
<dd><code><a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></code> - if an error occurs while parsing the object</dd></dl>
</li>
</ul>
<a name="setupCipher(java.security.PrivateKey, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupCipher</h4>
<pre>public&nbsp;void&nbsp;setupCipher(java.security.PrivateKey&nbsp;recipientPrivateKey,
               int&nbsp;recipientInfoIndex)
                 throws <a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a>,
                        java.security.NoSuchAlgorithmException,
                        java.security.InvalidKeyException</pre>
<div class="block">Uses the specified private key to setup the Cipher for decrypting the
 content-encryption key and subsequently using it to decrypt the encrypted
 content of this<code>
 EnvelopedData</code> object for the requesting recipient, specified by its
 <code>recipientInfoIndex</code>.
 <p>
 This method first uses the given private key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding
 <code>RecipientInfo</code> structure, and subsequently uses this key for
 decrypting the encrypted content.
 <p>
 Unlike the stream supporting
 <a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedDataStream.html" title="class in iaik.pkcs.pkcs7"><code>SignedAndEnvelopedDataStream</code></a> class where the <code>setupCipher</code>
 method only initializes the cipher for decryption, whole the
 encrypted-content decryption already is performed inside the
 <code>setupCipher</code> method of this class.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipientPrivateKey</code> - the private key of one recipient specified in a RecipientInfo
          object</dd><dd><code>recipientInfoIndex</code> - specifies which RecipientInfo the private key belongs to</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></code> - if there occurs an error while decrypting the data</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation of the content-encryption
              algorithm</dd>
<dd><code>java.security.InvalidKeyException</code> - if the specified private key is not valid</dd></dl>
</li>
</ul>
<a name="getContentType()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContentType</h4>
<pre>public&nbsp;<a href="../../../iaik/asn1/ObjectID.html" title="class in iaik.asn1">ObjectID</a>&nbsp;getContentType()</pre>
<div class="block">Returns the content type this class implements.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#getContentType()">getContentType</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#getContentType()">getContentType</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html" title="class in iaik.pkcs.pkcs7">SignedDataStream</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd><code>ObjectID.pkcs7_signedAndEnvelopedData</code></dd></dl>
</li>
</ul>
<a name="setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setRecipientInfos</h4>
<pre>public&nbsp;void&nbsp;setRecipientInfos(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;recipients)</pre>
<div class="block">Sets the recipient infos.
 <p>
 Each single <a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a> specifies
 the particular recipient's certificate by IssuerAndSerialNumber, and the
 key encryption algorithm to be used; currently only PKCS#1
 <i>rsaEncryption</i> is supported.
 <p>
 Example:
 
 <PRE>
 RecipientInfo[] recipients = new RecipientInfo[2];
 recipients[0] = new RecipientInfo(cert1, AlgorithmID.rsaEncryption);
 recipients[1] = new RecipientInfo(cert2, AlgorithmID.rsaEncryption);
 enveloped_data.setRecipientInfos(recipients);
 </PRE></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipients</code> - a collection of per-recipient information</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a></dd></dl>
</li>
</ul>
<a name="addRecipientInfo(iaik.pkcs.pkcs7.RecipientInfo)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addRecipientInfo</h4>
<pre>public&nbsp;void&nbsp;addRecipientInfo(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>&nbsp;recipient)</pre>
<div class="block">Adds one recipient to the list of recipient infos.
 <p>
 The <a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a> specifies the
 particular recipient's certificate by IssuerAndSerialNumber, and the key
 encryption algorithm to be used; currently only PKCS#1 <i>rsaEncryption</i>
 is supported.
 <p>
 Example:
 
 <PRE>
 RecipientInfo recipient = new RecipientInfo(cert1, AlgorithmID.rsaEncryption);
 enveloped_data.addRecipientInfo(recipient);
 </PRE></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipient</code> - the RecipientInfo to be added</dd></dl>
</li>
</ul>
<a name="verify(java.security.PublicKey, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verify</h4>
<pre>public&nbsp;void&nbsp;verify(java.security.PublicKey&nbsp;publicKey,
          int&nbsp;signerInfoIndex)
            throws java.security.SignatureException</pre>
<div class="block">Uses the provided public key for verifying the signature that has been
 created by the <code>signerInfoIndex</code>th signer.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#verify(java.security.PublicKey, int)">verify</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html" title="class in iaik.pkcs.pkcs7">SignedDataStream</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>publicKey</code> - the public key of the signer to verify the message</dd><dd><code>signerInfoIndex</code> - the index into the SignerInfos array for identifying the
          SignerInfo belonging to the signer whose signature has to be
          verified</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.SignatureException</code> - if the signature turns out to be incorrect</dd></dl>
</li>
</ul>
<a name="getRecipientInfos()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRecipientInfos</h4>
<pre>public&nbsp;<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;getRecipientInfos()</pre>
<div class="block">Returns all the recipient infos included in this SignedAndEnvelopedData
 object.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>an array containing all the <code>RecipientInfo</code> objects
         included in this <code>SignedAndEnvelopedData</code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedData.html#setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])"><code>setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])</code></a></dd></dl>
</li>
</ul>
<a name="getInputStream()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInputStream</h4>
<pre>public&nbsp;java.io.InputStream&nbsp;getInputStream()</pre>
<div class="block">Returns an InputStream for reading the content.
 <p>
 The returned content depends on whether creating a new
 SignedAndEnvelopedData or parsing an existing one:
 <ul>
 <li>When creating a new SignedAndEnvelopedData:<br>
 If the content yet has not been encrypted, the plain content is returned
 <li>When parsing an existing SignedAndEnvelopedData:<br>
 If the content yet has not been decrypted, the encrypted content is
 returned
 </ul></div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedData.html#getInputStream()">getInputStream</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>an InputStream holding the content</dd></dl>
</li>
</ul>
<a name="getContent()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContent</h4>
<pre>public&nbsp;byte[]&nbsp;getContent()</pre>
<div class="block">Returns the content as byte array.
 
 <p>
 The returned content depends on whether creating a new SignedEnvelopedData
 or parsing an existing one:
 <ul>
 <li>When creating a new SignedAndEnvelopedData:<br>
 If the content yet has not been encrypted, the plain content is returned
 <li>When parsing an existing SignedAndEnvelopedData:<br>
 If the content yet has not been decrypted, the encrypted content is
 returned
 </ul></div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedData.html#getContent()">getContent</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>a byte array holding the content</dd></dl>
</li>
</ul>
<a name="getEncryptedContentInfo()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEncryptedContentInfo</h4>
<pre>public&nbsp;<a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfo.html" title="class in iaik.pkcs.pkcs7">EncryptedContentInfo</a>&nbsp;getEncryptedContentInfo()</pre>
<div class="block">Returns the encrypted content info included in this SignedAndEnvelopedData
 object.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the encrypted content info</dd></dl>
</li>
</ul>
<a name="toASN1Object(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toASN1Object</h4>
<pre>protected&nbsp;<a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a>&nbsp;toASN1Object(int&nbsp;blockSize)
                           throws <a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></pre>
<div class="block">Returns this SignedAndEnvelopedData as ASN1Object where a constructed OCTET
 STRING is used for encoding the content.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedData.html#toASN1Object(int)">toASN1Object</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>blockSize</code> - the block size defining the encoding scheme - and specifying the
          length of each primitive encoded octet string component, if
          positive</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></code> - if the ASN1Object could not be created</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString()</pre>
<div class="block">Returns a string giving some information about this SignedAndEnvelopedData
 object.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html#toString()">toString</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedDataStream.html" title="class in iaik.pkcs.pkcs7">SignedDataStream</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the string representation</dd></dl>
</li>
</ul>
<a name="toString(boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString(boolean&nbsp;detailed)</pre>
<div class="block">Returns a string giving some - if requested - detailed information about
 this SignedAndEnvelopedData object.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#toString(boolean)">toString</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/SignedData.html#toString(boolean)">toString</a></code>&nbsp;in class&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/SignedData.html" title="class in iaik.pkcs.pkcs7">SignedData</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>detailed</code> - - whether or not to give detailed information</dd>
<dt><span class="strong">Returns:</span></dt><dd>the string representation</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
					
			<small>This Javadoc may contain text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright_javadoc.html#RFC>copyright</a> note) and RSA Data Security Public-Key Cryptography Standards (PKCS, see <a href=../../../RefCopyright_javadoc.html#PKCS>copyright</a> note).</small>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/pkcs/pkcs7/RSACipherProvider.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/pkcs/pkcs7/SignedAndEnvelopedDataStream.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/pkcs/pkcs7/SignedAndEnvelopedData.html" target="_top">Frames</a></li>
<li><a href="SignedAndEnvelopedData.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_iaik.pkcs.pkcs7.SignedDataStream">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
					
			
			<table cellpadding=10>
			<tr>
				<td align=left>
					<img src=../../../siclogo.jpg>
					</td>
					<td align=center>
						5.3<br>
						(c) 2002 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>IAIK</a>, (c) 2003 - 2015 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>SIC</a>
						</td>
						<td align=right>
							<img src=../../../iaik_logo.gif>
							</td>
						</tr>
					</table>
			
		
				</small></p>
</body>
</html>
