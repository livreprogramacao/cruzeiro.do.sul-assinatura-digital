<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Mon Dec 21 16:59:21 CET 2015 -->
<title>EnvelopedDataStream (5.3 API Documentation)</title>
<meta name="date" content="2015-12-21">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="EnvelopedDataStream (5.3 API Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
			
			<b>IAIK-JCE Provider API Documentation</b>
		<br>
			<font size=-1>Version 5.3</font>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/pkcs/pkcs7/EnvelopedDataStream.html" target="_top">Frames</a></li>
<li><a href="EnvelopedDataStream.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">iaik.pkcs.pkcs7</div>
<h2 title="Class EnvelopedDataStream" class="title">Class EnvelopedDataStream</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>iaik.pkcs.pkcs7.EnvelopedDataStream</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7">EnvelopedData</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">EnvelopedDataStream</span>
extends java.lang.Object
implements <a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></pre>
<div class="block">This class represents the stream-supporting implementation of the PKCS#7
 content type <code>EnvelopedData</code>.
 <p>
 Each PKCS#7 content type is associated with a specific object identifier,
 derived from:
 <p>
 
 <PRE>
 pkcs-7 OBJECT IDENTIFIER ::=
   { iso(1) member-body(2) US(840) rsadsi(113549)
       pkcs(1) 7 }
 </PRE>
 <p>
 The object identifier for the <code>EnvelopedData</code> content type is
 defined as:
 <p>
 <code>
 envelopedData OBJECT IDENTIFIER ::= { pkcs-7 3 }
 </code>
 <p>
 which corresponds to the OID string "1.2.840.1.113549.1.7.3".
 <p>
 The <a href = http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/>PKCS#7
 Cryptographic Message Standard</a> specifies the <code>EnvelopedData</code>
 content type for providing a syntax for building digital envelopes. Content
 of any type may be enveloped for any number of recipients in parallel. For
 each recipient, a commonly at random generated content-encryption key is
 encrypted with the particular recipient's public key and - together with
 recipient-specific information - collected into a <code>RecipientInfo</code>
 value. The content is encrypted with the content-encryption key giving a
 <code>EncryptedContent</code> value, which - in combination with a
 recipient-specific encrypted content-encryption key - forms the digital
 envelope for each particular recipient. All <code>RecipientInfo</code> values
 are collected together with the encrypted content into an<code>
 EnvelopedData</code> value to be sent to each intended recipient.
 <p>
 This class implements the <code>EnvelopedData</code> structure resulting from
 the last step described above. The <code>EnvelopedData</code> type is defined
 as ASN.1 SEQUENCE type containing the following components (see <a href =
 http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/>PKCS#7 specification</a>,
 Version&nbsp;1.5):
 <p>
 
 <PRE>
 EnvelopedData ::= SEQUENCE {
   version                Version,
   recipientInfos         RecipientInfos,
   encryptedContentInfo   EncryptedContentInfo }
 <br>
 RecipientInfos ::= SET OF RecipientInfo
 <br>
 EncryptedContentInfo ::= SEQUENCE {
   contentType                 ContentType,
   contentEncryptionAlgorithm  ContentEncryptionAlgorithmIdentifier,
   encryptedContent            [0] IMPLICIT EncryptedContent OPTIONAL }
 <br>
 EncryptedContent ::= OCTET STRING
 </PRE>
 <p>
 The <code>recipientInfos</code> field is a non-empty collection of
 per-recipient information. The <code>encryptedContentInfo</code> field
 specifies the type of the content being enveloped, the content-encryption
 algorithm (the same for all recipients) used for encrypting the content, and
 the result of the content encryption. If the encrypted content value is not
 present in the <code>encryptedContent</code> field, it has to be supplied by
 other means.
 <p>
 A recipient, when receiving the <code>EnvelopedData</code> message, decrypts
 the corresponding encrypted content-encryption key with his/her private key
 for subsequently decrypting the encrypted content using the
 content-encryption key just recovered. The recipient's private key is
 referenced by an issuer distinguished name and an issuer-specific serial
 number that uniquely identify the certificate for the corresponding public
 key.
 <p>
 For more information consult the RSA <a href =
 http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/>PKCS#7</a> specification.
 <p>
 <hr>
 <p>
 When creating a new <code>EnvelopedDataStream</code> object for the data to
 be enveloped the symmetric algorithm has to be specified to be used for
 content-encryption. After setting the recipients, the EnvelopedDataStream
 object may be encoded and written to an output stream by using a proper
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#writeTo(java.io.OutputStream, int)"><code>writeTo</code></a> method, e.g.:
 <ol>
 <li>Create a new EnvelopedDataStream object and specify the content
 encryption algorithm to be used by means of the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><code>EnvelopedDataStream(InputStream is, AlgorithmID contentEA)</code></a> constructor:
 
 <pre>
     //the data to be enveloped supplied from an input stream:
     InputStream dataStream = ...;
     //use TripleDES in CBC mode for encrypting the content
     EnvelopedDataStream enveloped_data = new EnvelopedDataStream(dataStream, AlgorithmID.des_EDE3_CBC);
 </pre>
 
 <li>For each intended recipient, create a
 <a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a> object, and add all
 RecipientInfos to the EnvelopedDataStream structure by calling the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])"><code>setRecipientInfos</code></a> method, e.g.
 (assuming to add two recipients with corresponding certificates
 <code>cert1</code> and <code>cert2</code>; currently only the PKCS#1
 <i>rsaEncryption</i> is supported as key- encryption algorithm):
 
 <pre>
 RecipientInfo[] recipients = new RecipientInfo[2];
 recipients[0] = new RecipientInfo(cert1, AlgorithmID.rsaEncryption);
 recipients[1] = new RecipientInfo(cert2, AlgorithmID.rsaEncryption);
 enveloped_data.setRecipientInfos(recipients);
 </pre>
 
 <li>Use a proper <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#writeTo(java.io.OutputStream, int)"><code>writeTo</code></a> method for BER
 encoding the EnvelopedData object and writing it to an output stream. You
 optionally may specify a particular block size for splitting the encoding of
 encrypted content. This step also will perform the encryption of the
 symmetric content-encryption key for each participated recipient.
 
 <pre>
     int blockSize = ...;
     OutputStream encoded_stream = ...;
     enveloped_data.writeTo(encoded_stream, blockSize);
 </pre>
 
 respectively
 
 <pre>
 enveloped_data.writeTo(encoded_stream);
 </pre>
 
 It is recommended only to use the <code>writeTo</code> method where a
 particular block size can be specified, because it is the intended purpose of
 this stream-supporting EnvelopedData implementation to handle large amounts
 of data. When no block size is specified whole the encrypted content is
 encoded as primitive definite octet string, which advantageously may be done
 when using the non-stream supporting <a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7"><code>EnvelopedData</code></a> implementation. When a positive block size is specified for
 encoding the EnvelopedData to a stream, the encrypted content is BER encoded
 as indefinite constructed octet string being composed of a series of definite
 primitive encoded octet strings of <code>blockSize</code> length:
 
 <pre>
     0x24 0x80
               0x04 &lt;blocksize&gt; &lt;first encrypted content block&gt;
               0x04 &lt;blocksize&gt; &lt;second encrypted content block&gt;
               0x04 &lt;blocksize&gt; &lt;third encrypted content block&gt;
                   ...
     0x00 0x00
 </pre>
 
 instead of:
 
 <pre>
     0x04 &lt;length&gt; &lt;encrypted content&gt;
 </pre>
 
 The indefinite constructed encoding scheme also may be preferable when
 intending to be compatible to the encoding practice of some particular
 application (for instance some versions of Netscape Navigator).
 </ol>
 A recipient, when receiving a EnvelopedDataStream encoding, uses the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream)"><code>EnvelopedDataStream(InputStream is)</code></a>
 constructor for parsing the internal structure. Before reading the recovered
 content by means of the <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getInputStream()"><code>getInputStream</code></a> method, the
 cipher has to be initialized for decryption with the particular recipient's
 private key by calling the <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setupCipher(java.security.PrivateKey, int)"><code>setupCipher</code></a>
 method:
 <ol>
 <li>Create an EnvelopedDataStream structure from the supplied encoding,
 decode and parse the internal structure:
 
 <pre>
 EnvelopedDataStream enveloped_data = new EnvelopedDataStream(encoded_stream);
 </pre>
 
 <li>Get information about the inherent EncryptedContentInfo:
 
 <pre>
 EncryptedContentInfoStream eci = (EncryptedContentInfoStream) enveloped_data
     .getEncryptedContentInfo();
 System.out.println(&quot;Content type: &quot; + eci.getContentType().getName());
 System.out.println(&quot;Content encryption algorithm: &quot;
     + eci.getContentEncryptionAlgorithm().getName());
 </pre>
 
 <li>Get information about the included RecipientInfos:
 
 <pre>
 RecipientInfo[] recipients = enveloped_data.getRecipientInfos();
 System.out.pritnln(&quot;Included RecipientInfos:&quot;);
 for (int i = 0; i &lt; recipients.length; i++) {
   System.out.print(&quot;Recipient &quot; + (i + 1) + &quot;:&quot;);
   System.out.println(recipients[i].getIssuerAndSerialNumber());
 }
 </pre>
 
 <li>Use some recipient's specific private key to decrypt the inherent
 encrypted secret key to be used for initializing the cipher for
 encrypted-content decryption:
 
 <pre>
 // setup cipher for recipient 1:
 int recipientInfoIndex = 0;
 enveloped_data.setupCipher(privateKey, recipientInfoIndex);
 </pre>
 
 Unlike the non-stream supporting <a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7"><code>EnvelopedData</code></a> class where the encrypted-content decryption already is
 performed inside the <code>setupCipher</code> method, the cipher will be only
 initialized for decryption in this class. The encrypted-content decryption
 actually is done during reading the data obtained by calling the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getInputStream()"><code>getInputStream</code></a> method. So don't call
 <code>getInputStream</code> before setting up the cipher!
 <p>
 <li>Get and read the recovered content:
 
 <pre>
 InputStream data_is = enveloped_data.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) &gt; 0) {
   // do something useful
 }
 </pre>
 
 </ol>
 <p></div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>File Revision <!-- $$Revision: --> 30 <!-- $ --></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a>, 
<a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7"><code>EncryptedContentInfoStream</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#block_size">block_size</a></strong></code>
<div class="block">The block size for block oriented stream encoding.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7">EncryptedContentInfoStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#encrypted_content_info">encrypted_content_info</a></strong></code>
<div class="block">The EncryptedContentInfo for the encrypted content.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.util.Vector</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#recipient_infos">recipient_infos</a></strong></code>
<div class="block">Repository for the RecipientInfos.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected javax.crypto.SecretKey</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#symmetric_key">symmetric_key</a></strong></code>
<div class="block">The secret content encryption key.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#version">version</a></strong></code>
<div class="block">The version number; currently 0.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream()">EnvelopedDataStream</a></strong>()</code>
<div class="block">Default constructor for dynamic object creation in ContentInfo.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream)">EnvelopedDataStream</a></strong>(java.io.InputStream&nbsp;is)</code>
<div class="block">Creates a new EnvelopedDataStream where the DER encoded data is read from
 the given InputStream.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)">EnvelopedDataStream</a></strong>(java.io.InputStream&nbsp;is,
                   <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA)</code>
<div class="block">Creates a new PKCS#7 EnvelopedDataStream object where the content to be
 enveloped is read from the supplied InputStream.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)">EnvelopedDataStream</a></strong>(java.io.InputStream&nbsp;is,
                   <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA,
                   int&nbsp;keyLength)</code>
<div class="block">Creates a new PKCS#7 EnvelopedDataStream object where the content to be
 enveloped is read from the supplied InputStream.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(iaik.pkcs.pkcs7.RecipientInfo[], iaik.pkcs.pkcs7.EncryptedContentInfoStream)">EnvelopedDataStream</a></strong>(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;recipients,
                   <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7">EncryptedContentInfoStream</a>&nbsp;encryptedCI)</code>
<div class="block">Constructs an EnvelopedDataStream object with an already created
 EncryptedContentInfoStream.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#addRecipientInfo(iaik.pkcs.pkcs7.RecipientInfo)">addRecipientInfo</a></strong>(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>&nbsp;recipient)</code>
<div class="block">Adds one recipient to the list of recipient infos.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#decode(java.io.InputStream)">decode</a></strong>(java.io.InputStream&nbsp;is)</code>
<div class="block">Reads and decodes the EnvelopedData from a DerInputStream.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getBlockSize()">getBlockSize</a></strong>()</code>
<div class="block">Gets the block size defining the length of each definite primitive encoded
 octet string component.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../iaik/asn1/ObjectID.html" title="class in iaik.asn1">ObjectID</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getContentType()">getContentType</a></strong>()</code>
<div class="block">Returns the content type this class implements.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.Object</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getEncryptedContentInfo()">getEncryptedContentInfo</a></strong>()</code>
<div class="block">Returns the encrypted content info included in this
 <code>EnvelopedDataStream</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.io.InputStream</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getInputStream()">getInputStream</a></strong>()</code>
<div class="block">Returns an InputStream from where the decrypted data can be read.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getRecipientInfo(java.security.cert.X509Certificate)">getRecipientInfo</a></strong>(java.security.cert.X509Certificate&nbsp;recipientCertificate)</code>
<div class="block">Returns the recipient info matching to the supplied recipient certificate.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getRecipientInfos()">getRecipientInfos</a></strong>()</code>
<div class="block">Returns all the recipient infos included in this <code>EnvelopedData</code>
 object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getVersion()">getVersion</a></strong>()</code>
<div class="block">Returns the syntax version number.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setBlockSize(int)">setBlockSize</a></strong>(int&nbsp;blockSize)</code>
<div class="block">Sets the block size for defining the length of each definite primitive
 encoded octet string component.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])">setRecipientInfos</a></strong>(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;recipients)</code>
<div class="block">Sets the recipient infos.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setupCipher(java.security.Key)">setupCipher</a></strong>(java.security.Key&nbsp;key)</code>
<div class="block">Uses the given symmetric key to setup the cipher for decrypting the
 content.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setupCipher(java.security.PrivateKey, int)">setupCipher</a></strong>(java.security.PrivateKey&nbsp;recipientPrivateKey,
           int&nbsp;recipientInfoIndex)</code>
<div class="block">Uses the specified private key to setup the Cipher for decrypting the
 content-encryption key and subsequently using it to decrypt the encrypted
 content of this<code>
 EnvelopedDataStream</code> object for the requesting recipient, specified
 by its <code>recipientInfoIndex</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#toASN1Object()">toASN1Object</a></strong>()</code>
<div class="block">Returns this EnvelopedDataStream as ASN1Object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#toASN1Object(int)">toASN1Object</a></strong>(int&nbsp;blockSize)</code>
<div class="block">Returns this EnvelopedData as ASN1Object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#toString()">toString</a></strong>()</code>
<div class="block">Returns a string giving some information about this
 <code>EnvelopedData</code> object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#toString(boolean)">toString</a></strong>(boolean&nbsp;detailed)</code>
<div class="block">Returns a string giving some - if requested - detailed information about
 this <code>EnvelopedData</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#writeTo(java.io.OutputStream)">writeTo</a></strong>(java.io.OutputStream&nbsp;os)</code>
<div class="block">DER encoded this EnvelopedData and writes the encoding to the supplied
 output stream.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#writeTo(java.io.OutputStream, int)">writeTo</a></strong>(java.io.OutputStream&nbsp;os,
       int&nbsp;blockSize)</code>
<div class="block">Writes the BER encoding of this EnvelopedData to the supplied output stream
 where a constructed OCTET STRING is used for encoding the content.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="version">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>version</h4>
<pre>protected&nbsp;int version</pre>
<div class="block">The version number; currently 0.</div>
</li>
</ul>
<a name="recipient_infos">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recipient_infos</h4>
<pre>protected&nbsp;java.util.Vector recipient_infos</pre>
<div class="block">Repository for the RecipientInfos.</div>
</li>
</ul>
<a name="encrypted_content_info">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encrypted_content_info</h4>
<pre>protected&nbsp;<a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7">EncryptedContentInfoStream</a> encrypted_content_info</pre>
<div class="block">The EncryptedContentInfo for the encrypted content.</div>
</li>
</ul>
<a name="symmetric_key">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetric_key</h4>
<pre>protected&nbsp;javax.crypto.SecretKey symmetric_key</pre>
<div class="block">The secret content encryption key.</div>
</li>
</ul>
<a name="block_size">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>block_size</h4>
<pre>protected&nbsp;int block_size</pre>
<div class="block">The block size for block oriented stream encoding.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="EnvelopedDataStream()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EnvelopedDataStream</h4>
<pre>protected&nbsp;EnvelopedDataStream()</pre>
<div class="block">Default constructor for dynamic object creation in ContentInfo. The block
 size is set to 2048.</div>
</li>
</ul>
<a name="EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EnvelopedDataStream</h4>
<pre>public&nbsp;EnvelopedDataStream(java.io.InputStream&nbsp;is,
                   <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA)
                    throws java.security.NoSuchAlgorithmException</pre>
<div class="block">Creates a new PKCS#7 EnvelopedDataStream object where the content to be
 enveloped is read from the supplied InputStream. The content type is set to
 PKCS#7 <b>Data</b>.
 <p>
 When using this constructor, automatically a symmetric key for content
 encryption is generated. For that reason this constructor shall not be used
 in situations where the desired content encryption algorithm requires a
 specific key/parameter handling. In such cases the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(iaik.pkcs.pkcs7.RecipientInfo[], iaik.pkcs.pkcs7.EncryptedContentInfoStream)"><code>EnvelopedDataStream(RecipientInfo[], EncryptedContentInfoStream)</code></a>
 constructor shall be used to be supplied with precomputed RecipientInfos
 and EncryptedContentInfo. Consult the
 <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7"><code>EncryptedContentInfoStream</code></a> class documentation for more information about
 special key/parameter handling.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>is</code> - the InputStream containing the data to envelope</dd><dd><code>contentEA</code> - the content encryption algorithm for encrypting the content</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation for the specified algorithm</dd></dl>
</li>
</ul>
<a name="EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EnvelopedDataStream</h4>
<pre>public&nbsp;EnvelopedDataStream(java.io.InputStream&nbsp;is,
                   <a href="../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;contentEA,
                   int&nbsp;keyLength)
                    throws java.security.NoSuchAlgorithmException</pre>
<div class="block">Creates a new PKCS#7 EnvelopedDataStream object where the content to be
 enveloped is read from the supplied InputStream. The content type is set to
 PKCS#7 <b>Data</b>.
 <p>
 When using this constructor, automatically a symmetric key for content
 encryption is generated. If the specified content encryption algorithm
 supports variable key lengths, a particular key length may be set by means
 of the <code>keyLength</code> parameter. If no length is specified, the
 defined default key length will be used. If the algorithm only works with
 keys of fixed-size length, the keyLength parameter may be set to -1 or the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(java.io.InputStream, iaik.asn1.structures.AlgorithmID)"><code>EnvelopedDataStream(InputStream is, AlgorithmID contentEA)</code></a> constructor may
 be used.
 <p>
 This constructor shall not be used in situations where the desired content
 encryption algorithm requires a specific parameter handling. In such cases
 the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#EnvelopedDataStream(iaik.pkcs.pkcs7.RecipientInfo[], iaik.pkcs.pkcs7.EncryptedContentInfoStream)"><code>EnvelopedDataStream(RecipientInfo[], EncryptedContentInfoStream)</code></a>
 constructor shall be used to be supplied with precomputed RcipientInfos and
 EncryptedContentInfo. Consult the
 <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7"><code>EncryptedContentInfoStream</code></a> class documentation for more information about
 special key/parameter handling.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>is</code> - the InputStream containing the data to envelope</dd><dd><code>contentEA</code> - the content encryption algorithm for encrypting the content</dd><dd><code>keyLength</code> - the key length that may be set when using a content encryption
          algorithm that supports variable key lengths</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation for the specified algorithm</dd></dl>
</li>
</ul>
<a name="EnvelopedDataStream(iaik.pkcs.pkcs7.RecipientInfo[], iaik.pkcs.pkcs7.EncryptedContentInfoStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EnvelopedDataStream</h4>
<pre>public&nbsp;EnvelopedDataStream(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;recipients,
                   <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7">EncryptedContentInfoStream</a>&nbsp;encryptedCI)</pre>
<div class="block">Constructs an EnvelopedDataStream object with an already created
 EncryptedContentInfoStream.
 
 The given array of <code>RecipientInfo</code> specifies a collection of
 per-recipient information, and the given
 <code>EncryptedContentInfoStream</code> supplies the already encrypted
 content.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipients</code> - information about the recipients</dd><dd><code>encryptedCI</code> - the encrypted content info</dd></dl>
</li>
</ul>
<a name="EnvelopedDataStream(java.io.InputStream)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>EnvelopedDataStream</h4>
<pre>public&nbsp;EnvelopedDataStream(java.io.InputStream&nbsp;is)
                    throws <a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a>,
                           java.io.IOException</pre>
<div class="block">Creates a new EnvelopedDataStream where the DER encoded data is read from
 the given InputStream.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>is</code> - the InputStream holding a DER encoded PKCS#7 EnvelopedData object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an I/O error occurs during reading from the InputStream</dd>
<dd><code><a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></code> - if an error occurs while parsing the object</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="decode(java.io.InputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decode</h4>
<pre>public&nbsp;void&nbsp;decode(java.io.InputStream&nbsp;is)
            throws java.io.IOException,
                   <a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></pre>
<div class="block">Reads and decodes the EnvelopedData from a DerInputStream. If the supplied
 InputStream actually is not an instance of <a href="../../../iaik/asn1/DerInputStream.html" title="class in iaik.asn1"><code>DerInputStream</code></a>, internally a DerInputStream is created before parsing the
 data.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#decode(java.io.InputStream)">decode</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>is</code> - the InputStream holding a DER encoded PKCS#7 EnvelopedData object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an I/O error occurs during reading from the InputStream</dd>
<dd><code><a href="../../../iaik/pkcs/PKCSParsingException.html" title="class in iaik.pkcs">PKCSParsingException</a></code> - if an error occurs while parsing the object</dd></dl>
</li>
</ul>
<a name="getContentType()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContentType</h4>
<pre>public&nbsp;<a href="../../../iaik/asn1/ObjectID.html" title="class in iaik.asn1">ObjectID</a>&nbsp;getContentType()</pre>
<div class="block">Returns the content type this class implements.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#getContentType()">getContentType</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd><code>ObjectID.pkcs7_envelopedData</code></dd></dl>
</li>
</ul>
<a name="setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setRecipientInfos</h4>
<pre>public&nbsp;void&nbsp;setRecipientInfos(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;recipients)</pre>
<div class="block">Sets the recipient infos.
 
 Each single <a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a> specifies
 the particular recipient's certificate by IssuerAndAserialNumber, and the
 key encryption algorithm to be used; currently only PKCS#1
 <i>rsaEncryption</i> is supported.
 <p>
 Example:
 
 <PRE>
 RecipientInfo[] recipients = new RecipientInfo[2];
 recipients[0] = new RecipientInfo(cert1, AlgorithmID.rsaEncryption);
 recipients[1] = new RecipientInfo(cert2, AlgorithmID.rsaEncryption);
 enveloped_data.setRecipientInfos(recipients);
 </PRE></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipients</code> - a collection of per-recipient information</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7"><code>RecipientInfo</code></a></dd></dl>
</li>
</ul>
<a name="addRecipientInfo(iaik.pkcs.pkcs7.RecipientInfo)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addRecipientInfo</h4>
<pre>public&nbsp;void&nbsp;addRecipientInfo(<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>&nbsp;recipient)</pre>
<div class="block">Adds one recipient to the list of recipient infos.
 <p>
 The <code>RecipientInfo</code> specifies the particular recipient's
 certificate by IssuerAndAserialNumber, and the key encryption algorithm to
 be used; currently only PKCS#1 <i>rsaEncryption</i> is supported.
 
 <p>
 Example:
 
 <PRE>
 RecipientInfo recipient = new RecipientInfo(cert, AlgorithmID.rsaEncryption);
 enveloped_data.addRecipientInfo(recipient);
 </PRE></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipient</code> - the RecipientInfo to be added</dd></dl>
</li>
</ul>
<a name="setBlockSize(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setBlockSize</h4>
<pre>public&nbsp;void&nbsp;setBlockSize(int&nbsp;blockSize)</pre>
<div class="block">Sets the block size for defining the length of each definite primitive
 encoded octet string component. If the value of <code>blockSize</code> is
 smaller or equal to zero the whole encrypted data is encoded as definite
 primitive octet string. This method may be used for enforcing block
 encoding when wrapping the EnvelopedData into a ContentInfo.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#setBlockSize(int)">setBlockSize</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>blockSize</code> - for defining the encoding scheme and setting the octet string
          component length, if positive</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/asn1/OCTET_STRING.html" title="class in iaik.asn1"><code>OCTET_STRING</code></a></dd></dl>
</li>
</ul>
<a name="getBlockSize()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBlockSize</h4>
<pre>public&nbsp;int&nbsp;getBlockSize()</pre>
<div class="block">Gets the block size defining the length of each definite primitive encoded
 octet string component. If the value of <code>blockSize</code> is smaller
 or equal to zero the whole data is encoded as definite primitive octet
 string. This method may be used for enforcing block encoding when wrapping
 the EncryptedData into a ContentInfo.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#getBlockSize()">getBlockSize</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>blockSize defining the encoding scheme and setting the octet string
         component length, if positive</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/asn1/OCTET_STRING.html" title="class in iaik.asn1"><code>OCTET_STRING</code></a></dd></dl>
</li>
</ul>
<a name="setupCipher(java.security.PrivateKey, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupCipher</h4>
<pre>public&nbsp;void&nbsp;setupCipher(java.security.PrivateKey&nbsp;recipientPrivateKey,
               int&nbsp;recipientInfoIndex)
                 throws <a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a>,
                        java.security.NoSuchAlgorithmException,
                        java.security.InvalidKeyException</pre>
<div class="block">Uses the specified private key to setup the Cipher for decrypting the
 content-encryption key and subsequently using it to decrypt the encrypted
 content of this<code>
 EnvelopedDataStream</code> object for the requesting recipient, specified
 by its <code>recipientInfoIndex</code>.
 <p>
 This method first uses the given private key for decrypting the encrypted
 temporary symmetric key obtained from the corresponding
 <code>RecipientInfo</code> structure, and subsequently uses this key to
 initialize a CipherInputStream for the inherent encrypted content.
 <p>
 Unlike the non-stream supporting <a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7"><code>EnvelopedData</code></a> class where the encrypted-content decryption already is
 performed inside the <code>setupCipher</code> method, the cipher will be
 only initialized for decrypting in this class. The encrypted-content
 decryption actually is done during reading the data obtained by calling the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getInputStream()"><code>getInputStream</code></a> method. So don't call
 <code>getInputStream</code> before setting up the cipher!
 <p>
 <b>Attention!</b> This method only can be used when the content encryption
 AlgorithmID contains IV parameters encoded as an OCTET_STRING. When the
 algorithmID contains parameters of other type (e.g. S/MIME RC2-CBC
 parameters) they have to be decoded separately, and the
 <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html#setupCipher(java.security.Key, java.security.spec.AlgorithmParameterSpec)"><code>setupCipher(Key key, AlgorithmParameterSpec)</code></a> method of the
 <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7"><code>EncryptedContentInfoStream</code></a> class has to be used to setup the cipher for
 content decryption, e.g.:
 
 <pre>
 //get the ECI from the enveloped data:
 EncryptedContentInfoStream eci =
      (EncryptedContentInfoStream)enveloped_data.getEncryptedContentInfo();
 // get the recipient infos
 RecipientInfo[] recipients = enveloped_data.getRecipientInfos();
 // use the specific recipient's private key for decrypting the required
 // symmetric content encryption key, e.g.:
 SecretKey secretKey =
   recipient_infos[0].decryptKey(recipientPrivateKey)
 //get the content encryption algorithm:
 AlgorithmID contentEA = eci.getContentEncryptionAlgorithm();
 //get the content encryption algorithm:
 AlgorithmID contentEA = eci.getContentEncryptionAlgorithm();
 // get the parameters as SEQUENCE
 SEQUENCE seq = (SEQUENCE)contentEA.getParameter();
 // create an RC2ParameterSpec:
 int rc2ParameterVersion = ((BigInteger)seq.getComponentAt(0).getValue()).intValue();
 int effective_key_bits = 32;
 switch (rc2ParameterVersion) {
   case 160:
     effective_key_bits = 40;
     break;
   case 120:
     effective_key_bits = 64;
     break;
   case 58:
     effective_key_bits = 128;
     break;
   default:
     throw new Exception("Invalid rc2ParameterVersion " + rc2ParameterVersion + "!");
  }
  // the iv is the second component
 OCTET_STRING oct = (OCTET_STRING)seq.getComponentAt(1);
 byte[] iv = (byte[])oct.getValue();
 RC2ParameterSpec paramSpec = new RC2ParameterSpec(effective_key_bits, iv);
 //now setup the cipher with previously decrypted recipient key amd params
 eci.setupCipher(secretKey, paramSpec);
 //get and read the data thereby actually performing the decryption
 InputStream data_is = signed_data.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) > 0) {
   // do something useful
 }
 </pre>
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipientPrivateKey</code> - the private key of the recipient to be used for decrypting the
          encrypted content-encryption key.</dd><dd><code>recipientInfoIndex</code> - specifies which RecipientInfo the private key belongs to</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></code> - if there occurs an error while decrypting the data</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation of the content-encryption
              algorithm</dd>
<dd><code>java.security.InvalidKeyException</code> - if the specified private key is not valid</dd></dl>
</li>
</ul>
<a name="setupCipher(java.security.Key)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupCipher</h4>
<pre>public&nbsp;void&nbsp;setupCipher(java.security.Key&nbsp;key)
                 throws <a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a>,
                        java.security.NoSuchAlgorithmException,
                        java.security.InvalidKeyException</pre>
<div class="block">Uses the given symmetric key to setup the cipher for decrypting the
 content.
 <p>
 Unlike the non-stream supporting <a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7"><code>EnvelopedData</code></a> class where the encrypted-content decryption already is
 performed inside the <code>setupCipher</code> method, the cipher will be
 only initialized for decrypting in this class. The encrypted-content
 decryption actually is done during reading the data obtained by calling the
 <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#getInputStream()"><code>getInputStream</code></a> method. So don't call
 <code>getInputStream</code> before setting up the cipher!
 <p>
 <b>Attention!</b> This method only can be used when the content encryption
 AlgorithmID contains IV parameters encoded as an OCTET_STRING. When the
 algorithmID contains parameters of other type (e.g. S/MIME RC2-CBC
 parameters) they have to be decoded separately, and the
 <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html#setupCipher(java.security.Key, java.security.spec.AlgorithmParameterSpec)"><code>setupCipher(Key key, AlgorithmParameterSpec)</code></a> method of the
 <a href="../../../iaik/pkcs/pkcs7/EncryptedContentInfoStream.html" title="class in iaik.pkcs.pkcs7"><code>EncryptedContentInfoStream</code></a> class has to be used to setup the cipher for
 content decryption, e.g.:
 
 <pre>
 // get the ECI from the enveloped data:
 EncryptedContentInfoStream eci = (EncryptedContentInfoStream) enveloped_data
     .getEncryptedContentInfo();
 // get the content encryption algorithm:
 AlgorithmID contentEA = eci.getContentEncryptionAlgorithm();
 // get the parameters as SEQUENCE
 SEQUENCE seq = (SEQUENCE) contentEA.getParameter();
 // create an RC2ParameterSpec:
 int rc2ParameterVersion = ((BigInteger) seq.getComponentAt(0).getValue())
     .intValue();
 int effective_key_bits = 32;
 switch (rc2ParameterVersion) {
 case 160:
   effective_key_bits = 40;
   break;
 case 120:
   effective_key_bits = 64;
   break;
 case 58:
   effective_key_bits = 128;
   break;
 default:
   throw new Exception(&quot;Invalid rc2ParameterVersion &quot; + rc2ParameterVersion
       + &quot;!&quot;);
 }
 // the iv is the second component
 OCTET_STRING oct = (OCTET_STRING) seq.getComponentAt(1);
 byte[] iv = (byte[]) oct.getValue();
 RC2ParameterSpec paramSpec = new RC2ParameterSpec(effective_key_bits, iv);
 // now setup the cipher with previously decrypted recipient key and params
 eci.setupCipher(secretKey, paramSpec);
 // get and read the data thereby actually performing the decryption
 InputStream data_is = signed_data.getInputStream();
 byte[] buf = new byte[1024];
 int r;
 while ((r = data_is.read(buf)) &gt; 0) {
   // do something useful
 }
 </pre>
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - the temporary symmetric key that has been used to encrypt the
          content, and now is used for decrypting it again</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></code> - if there occurs an error while decrypting the data</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if there is no implementation for the content-encryption
              algorithm</dd>
<dd><code>java.security.InvalidKeyException</code> - if the specified private key is not valid</dd></dl>
</li>
</ul>
<a name="getInputStream()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInputStream</h4>
<pre>public&nbsp;java.io.InputStream&nbsp;getInputStream()</pre>
<div class="block">Returns an InputStream from where the decrypted data can be read.
 Attention! The stream only may be read once.
 <p>
 When having created a new <code>EnvelopedDataStream</code> object to be
 encoded to a stream, this method should not be utilized at all, since the
 stream automatically will be read during performing the encoding (which is
 done when calling a <a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#writeTo(java.io.OutputStream)"><code>writeTo</code></a> method). <br>
 When having decoded and parsed a received <code>EnvelopedDataStream</code>
 object comimg from some stream, this method may be used for obtaining the
 raw (decrypted) data after having setup the cipher.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>an InputStream for reading the decrypted data</dd></dl>
</li>
</ul>
<a name="getVersion()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVersion</h4>
<pre>public&nbsp;int&nbsp;getVersion()</pre>
<div class="block">Returns the syntax version number.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the syntax version number</dd></dl>
</li>
</ul>
<a name="getRecipientInfos()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRecipientInfos</h4>
<pre>public&nbsp;<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>[]&nbsp;getRecipientInfos()</pre>
<div class="block">Returns all the recipient infos included in this <code>EnvelopedData</code>
 object.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>an array containing all the <code>RecipientInfo</code> objects
         included into this <code>EnvelopedData</code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])"><code>setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])</code></a></dd></dl>
</li>
</ul>
<a name="getRecipientInfo(java.security.cert.X509Certificate)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRecipientInfo</h4>
<pre>public&nbsp;<a href="../../../iaik/pkcs/pkcs7/RecipientInfo.html" title="class in iaik.pkcs.pkcs7">RecipientInfo</a>&nbsp;getRecipientInfo(java.security.cert.X509Certificate&nbsp;recipientCertificate)</pre>
<div class="block">Returns the recipient info matching to the supplied recipient certificate.
 This method may be used by a recipient for quering for the recipient info
 that holds the content encryption key encrypted with the public key of the
 given certificate.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the recipient info matching to the supplied recipient certificate,
         or <code>null</code> if no recipient info belonging to the given
         certificate can be found</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../iaik/pkcs/pkcs7/EnvelopedDataStream.html#setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])"><code>setRecipientInfos(iaik.pkcs.pkcs7.RecipientInfo[])</code></a></dd></dl>
</li>
</ul>
<a name="getEncryptedContentInfo()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEncryptedContentInfo</h4>
<pre>public&nbsp;java.lang.Object&nbsp;getEncryptedContentInfo()</pre>
<div class="block">Returns the encrypted content info included in this
 <code>EnvelopedDataStream</code> object. When calling this method for
 obtaining the inherent <code>EncryptedContentInfoStream</code> an explicit
 cast to <code>EncryptedContentInfoStream</code> has to be made:
 
 <pre>
 EncryptedContentInfoStream eci = (EncryptedContentInfoStream) enveloped_data
     .getEncryptedContentInfo();
 </pre></div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the encrypted content info</dd></dl>
</li>
</ul>
<a name="toASN1Object()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toASN1Object</h4>
<pre>public&nbsp;<a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a>&nbsp;toASN1Object()
                        throws <a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></pre>
<div class="block">Returns this EnvelopedDataStream as ASN1Object.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#toASN1Object()">toASN1Object</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>this <code>EnvelopedDataStream</code> as ASN1Object.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></code> - if the ASN1Object could not be created</dd></dl>
</li>
</ul>
<a name="toASN1Object(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toASN1Object</h4>
<pre>protected&nbsp;<a href="../../../iaik/asn1/ASN1Object.html" title="class in iaik.asn1">ASN1Object</a>&nbsp;toASN1Object(int&nbsp;blockSize)
                           throws <a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></pre>
<div class="block">Returns this EnvelopedData as ASN1Object.
 <p>
 If <blockSize> is positive a constructed OCTET STRING is used for encoding
 the encrypted content. This method also will perform the encryption of the
 symmetric content-encryption key for each participated recipient.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>blockSize</code> - the block size defining the encoding scheme - and specifying the
          length of each primitive encoded octet string component, if
          positive</dd>
<dt><span class="strong">Returns:</span></dt><dd>this PKCS#7 <code>EnvelopedData</code> as ASN1Object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></code> - if the ASN1Object could not be created</dd></dl>
</li>
</ul>
<a name="writeTo(java.io.OutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeTo</h4>
<pre>public&nbsp;void&nbsp;writeTo(java.io.OutputStream&nbsp;os)
             throws java.io.IOException</pre>
<div class="block">DER encoded this EnvelopedData and writes the encoding to the supplied
 output stream.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>os</code> - the output stream to which this EnvelopedData shall be written</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="writeTo(java.io.OutputStream, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeTo</h4>
<pre>public&nbsp;void&nbsp;writeTo(java.io.OutputStream&nbsp;os,
           int&nbsp;blockSize)
             throws java.io.IOException</pre>
<div class="block">Writes the BER encoding of this EnvelopedData to the supplied output stream
 where a constructed OCTET STRING is used for encoding the content.
 <p>
 When encoding the content data to the given stream it is piped through a
 cipher stream thereby performing the content encryption.
 <p>
 If the a positive <code>blockSize</code> value is specified, the encrypted
 content is encoded as indefinite constructed octet string being composed of
 a certain number of definite primitive encoded octet strings of
 <code>blockSize</code> length:
 
 <pre>
 0x24 0x80
           0x04 &lt;blocksize&gt; &lt;first encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;second encrypted content block&gt;
           0x04 &lt;blocksize&gt; &lt;third encrypted content block&gt;
                ...
 0x00 0x00
 </pre>
 
 Otherwise, whole the encrypted content is encoded as definite primitive
 octet string:
 
 <pre>
  0x04 &lt;length&gt; &lt;encrypted content&gt;
 </pre></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>os</code> - the output stream to which this SignedData shall be written</dd><dd><code>blockSize</code> - the block size defining the encoding scheme - and specifying the
          length of each primitive encoded octet string component, if
          positive</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an error occurs during writing the object</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString()</pre>
<div class="block">Returns a string giving some information about this
 <code>EnvelopedData</code> object.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>toString</code>&nbsp;in class&nbsp;<code>java.lang.Object</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the string representation</dd></dl>
</li>
</ul>
<a name="toString(boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString(boolean&nbsp;detailed)</pre>
<div class="block">Returns a string giving some - if requested - detailed information about
 this <code>EnvelopedData</code> object.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html#toString(boolean)">toString</a></code>&nbsp;in interface&nbsp;<code><a href="../../../iaik/pkcs/pkcs7/ContentStream.html" title="interface in iaik.pkcs.pkcs7">ContentStream</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>detailed</code> - - whether or not to give detailed information</dd>
<dt><span class="strong">Returns:</span></dt><dd>the string representation</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
					
			<small>This Javadoc may contain text parts from IETF Internet Standard specifications (see <a href=../../../RefCopyright_javadoc.html#RFC>copyright</a> note) and RSA Data Security Public-Key Cryptography Standards (PKCS, see <a href=../../../RefCopyright_javadoc.html#PKCS>copyright</a> note).</small>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/pkcs/pkcs7/EnvelopedData.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/pkcs/pkcs7/EnvelopedDataStream.html" target="_top">Frames</a></li>
<li><a href="EnvelopedDataStream.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
					
			
			<table cellpadding=10>
			<tr>
				<td align=left>
					<img src=../../../siclogo.jpg>
					</td>
					<td align=center>
						5.3<br>
						(c) 2002 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>IAIK</a>, (c) 2003 - 2015 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>SIC</a>
						</td>
						<td align=right>
							<img src=../../../iaik_logo.gif>
							</td>
						</tr>
					</table>
			
		
				</small></p>
</body>
</html>
