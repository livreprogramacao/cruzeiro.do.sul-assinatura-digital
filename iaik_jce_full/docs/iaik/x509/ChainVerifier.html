<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Mon Dec 21 16:59:28 CET 2015 -->
<title>ChainVerifier (5.3 API Documentation)</title>
<meta name="date" content="2015-12-21">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ChainVerifier (5.3 API Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
			
			<b>IAIK-JCE Provider API Documentation</b>
		<br>
			<font size=-1>Version 5.3</font>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../iaik/x509/CertificateFactory.html" title="class in iaik.x509"><span class="strong">Prev Class</span></a></li>
<li><a href="../../iaik/x509/NetscapeCertRequest.html" title="class in iaik.x509"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?iaik/x509/ChainVerifier.html" target="_top">Frames</a></li>
<li><a href="ChainVerifier.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">iaik.x509</div>
<h2 title="Class ChainVerifier" class="title">Class ChainVerifier</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>iaik.x509.ChainVerifier</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../iaik/x509/SimpleChainVerifier.html" title="class in iaik.x509">SimpleChainVerifier</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">ChainVerifier</span>
extends java.lang.Object</pre>
<div class="block">This class provides a framework that allows you to verify certificate chains.
 It implements the cryptographic verification logic, but has to be subclassed
 for the trust verification, see the <a href="../../iaik/x509/SimpleChainVerifier.html" title="class in iaik.x509"><code>SimpleChainVerifier</code></a> class for a basic implementation of such logic.
 <P>
 See the documentation of the
 <a href="../../iaik/x509/ChainVerifier.html#verifyChain(java.security.cert.X509Certificate[])"><code>verifyChain</code></a> method
 for more information about the verification that is performed.
 <P>
 NOTE: This class currently includes only a very basic support for X.509v3
 extensions.</div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>File Revision <!-- $$Revision: --> 18 <!-- $ --></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../iaik/x509/SimpleChainVerifier.html" title="class in iaik.x509"><code>SimpleChainVerifier</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><strong><a href="../../iaik/x509/ChainVerifier.html#ChainVerifier()">ChainVerifier</a></strong>()</code>
<div class="block">Constructor for use by subclasses.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../iaik/x509/ChainVerifier.html#checkExtensions(java.security.cert.X509Certificate[], int)">checkExtensions</a></strong>(java.security.cert.X509Certificate[]&nbsp;certificateChain,
               int&nbsp;index)</code>
<div class="block">Verifies if the extensions in the certificate at the given index in the
 certificate chain are valid.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../iaik/x509/ChainVerifier.html#isTrustedCertificate(java.security.cert.X509Certificate)">isTrustedCertificate</a></strong>(java.security.cert.X509Certificate&nbsp;cert)</code>
<div class="block">Tests whether the given certificate is explicitly trusted.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.security.cert.X509Certificate[]</code></td>
<td class="colLast"><code><strong><a href="../../iaik/x509/ChainVerifier.html#orderCertificateChain(java.security.cert.X509Certificate, java.security.cert.X509Certificate[])">orderCertificateChain</a></strong>(java.security.cert.X509Certificate&nbsp;leaf,
                     java.security.cert.X509Certificate[]&nbsp;certs)</code>
<div class="block">Reorder a set of certificates so that it becomes a valid chain.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../iaik/x509/ChainVerifier.html#verifyChain(java.security.cert.X509Certificate[])">verifyChain</a></strong>(java.security.cert.X509Certificate[]&nbsp;certificateChain)</code>
<div class="block">This method verifies a certificate chain.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../iaik/x509/ChainVerifier.html#verifyChain(java.security.cert.X509Certificate[], boolean)">verifyChain</a></strong>(java.security.cert.X509Certificate[]&nbsp;certificateChain,
           boolean&nbsp;reversed)</code>
<div class="block">This method verifies a (reversed) certificate chain.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ChainVerifier()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ChainVerifier</h4>
<pre>protected&nbsp;ChainVerifier()</pre>
<div class="block">Constructor for use by subclasses.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="isTrustedCertificate(java.security.cert.X509Certificate)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isTrustedCertificate</h4>
<pre>public abstract&nbsp;boolean&nbsp;isTrustedCertificate(java.security.cert.X509Certificate&nbsp;cert)
                                      throws java.security.cert.CertificateException</pre>
<div class="block">Tests whether the given certificate is explicitly trusted. This method has
 to be implemented by subclasses, which will typically check the certificate
 against a list (or some other database) of trusted certificates. This
 method may also throw a certificate exception if there is trouble with the
 given certificate, but this is not recommended in normal use. The exception
 will be directly passed through by
 <a href="../../iaik/x509/ChainVerifier.html#verifyChain(java.security.cert.X509Certificate[])"><code>verifyChain</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>cert</code> - the certificate to be checked</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> if the certificate shall be trusted,
         <code>false</code> if not</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.cert.CertificateException</code></dd></dl>
</li>
</ul>
<a name="verifyChain(java.security.cert.X509Certificate[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyChain</h4>
<pre>public&nbsp;boolean&nbsp;verifyChain(java.security.cert.X509Certificate[]&nbsp;certificateChain)
                    throws java.security.cert.CertificateException</pre>
<div class="block">This method verifies a certificate chain. The user certificate must be at
 index 0 with increasing indices towards the top level certificate at n-1.
 The method will walk through the chain starting at the user certificate
 searching for trusted certificates and verifying the certificate signatures
 on the way. As soon as a trusted certificate is found, the method returns
 true, the rest of the chain is not verified cryptographically (as a
 certificate explicitly marked trusted was already found). If no trusted
 certificate is found but the chain verifies ok it returns false. If there
 is some error in the chain, e.g. a certificate does not verify or is
 expired, it throws a CertificateException.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>certificateChain</code> - the certificate chain to be checked</dd>
<dt><span class="strong">Returns:</span></dt><dd>true, if a valid path from the client certificate to a trusted
         signer can be built and verified</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.cert.CertificateException</code> - if there is some error in the certificate chain</dd></dl>
</li>
</ul>
<a name="checkExtensions(java.security.cert.X509Certificate[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkExtensions</h4>
<pre>protected&nbsp;void&nbsp;checkExtensions(java.security.cert.X509Certificate[]&nbsp;certificateChain,
                   int&nbsp;index)
                        throws java.security.cert.CertificateException</pre>
<div class="block">Verifies if the extensions in the certificate at the given index in the
 certificate chain are valid. If an error occurs, a CertificateException
 will be thrown. The chain will always contain the user certificate at index
 0.
 <P>
 NOTE: This method currently only works for instances of
 iaik.x509.X509Certificate, for other subclasses of
 java.security.cert.X509Certificate no extension checking will be done at
 all.
 <P>
 The handling of X.509 extensions by this class is far from complete. If you
 want to implement your own extension checking, override this method. It is
 supposed to be called only by <CODE>verifyChain()</CODE>.
 <P>
 Current handling of extensions:
 <UL>
 <LI>BasicConstraints: if a basic constraints extension is present, it must
 specify ca=false for the certificate at index 0 and ca=true for all others.
 If ca=true and pathLenConstraint is set (not equal -1) it will be checked
 by the index as well.
 <LI>KeyUsage: this extension is ignored for the user certificate, all other
 certificates have to include <CODE>KeyUsage.keyCertSign</CODE> if the
 extension is present.
 <LI>The extensions in the following list are simply ignored, no matter if
 they are marked critical or not, what there contents, and if they are
 present in the user or in the CA certificates.
 <UL>
 <LI>AuthorityKeyIdentifier
 <LI>CRLDistributionPoints
 <LI>CRLNumber
 <LI>ExtendedKeyUsage
 <LI>IssuerAltName
 <LI>PolicyConstraints
 <LI>PolicyMappings
 <LI>ReasonCode
 <LI>SubjectAltName
 <LI>SubjectKeyIdentifier
 <LI>NetscapeBaseUrl
 <LI>NetscapeCaPolicyUrl
 <LI>NetscapeCaRevocationUrl
 <LI>NetscapeCertRenewalUrl
 <LI>NetscapeComment
 <LI>NetscapeRevocationUrl
 <LI>NetscapeSSLServerName
 </UL>
 <LI>All other non-critical extensions are ignored as well.
 <LI>All other critical extensions cause a CertificateException to be
 thrown. This includes among others the certificate extensions
 CertificatePolicies, NameConstraints, etc. which are supported by the IAIK
 JCE but not checked by this method.
 </UL></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>certificateChain</code> - the certificate chain containing the certificate to be checked</dd><dd><code>index</code> - the index of the certificate to be checked</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.cert.CertificateException</code> - if the verification fails</dd></dl>
</li>
</ul>
<a name="verifyChain(java.security.cert.X509Certificate[], boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyChain</h4>
<pre>public&nbsp;boolean&nbsp;verifyChain(java.security.cert.X509Certificate[]&nbsp;certificateChain,
                  boolean&nbsp;reversed)
                    throws java.security.cert.CertificateException</pre>
<div class="block">This method verifies a (reversed) certificate chain. If your certificate
 chain has the top level certificate at index 0 and the user certificate at
 index n-1, call this method with the reversed parameter set to true.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>certificateChain</code> - the certificate chain to be verified</dd><dd><code>reversed</code> - whether the user certificate is loacted at index 0 (reversed =
          false), or at index n-1 (reversed = true)</dd>
<dt><span class="strong">Returns:</span></dt><dd>true, if a valid path from the client certificate to a trusted
         signer can be built and verified</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.cert.CertificateException</code> - if there is some error in the certificate chain</dd></dl>
</li>
</ul>
<a name="orderCertificateChain(java.security.cert.X509Certificate, java.security.cert.X509Certificate[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>orderCertificateChain</h4>
<pre>public static&nbsp;java.security.cert.X509Certificate[]&nbsp;orderCertificateChain(java.security.cert.X509Certificate&nbsp;leaf,
                                                         java.security.cert.X509Certificate[]&nbsp;certs)
                                                                  throws java.security.cert.CertificateException</pre>
<div class="block">Reorder a set of certificates so that it becomes a valid chain. In some
 cases an application/ protocol might not supply you with a correctly
 ordered certificate chain but only give you a set of certificates. This
 class can build a valid certificate chain from this set. It will start at
 the given leaf certificate, which becomes the end of the chain and search
 through the set of certificates for the issuer certificates until it finds
 a self signed certificate. The resulting chain is then returned with the
 leaf certificate at index 0.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>leaf</code> - the leaf certificate</dd><dd><code>certs</code> - the certificate chain to be reordered</dd>
<dt><span class="strong">Returns:</span></dt><dd>the reordered certificate chain</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.cert.CertificateException</code> - if a required issuer certificate cannot be found in the set of
              certificates.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
					
			<small>This Javadoc may contain text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright_javadoc.html#RFC>copyright</a> note) and RSA Data Security Public-Key Cryptography Standards (PKCS, see <a href=../../RefCopyright_javadoc.html#PKCS>copyright</a> note).</small>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../iaik/x509/CertificateFactory.html" title="class in iaik.x509"><span class="strong">Prev Class</span></a></li>
<li><a href="../../iaik/x509/NetscapeCertRequest.html" title="class in iaik.x509"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?iaik/x509/ChainVerifier.html" target="_top">Frames</a></li>
<li><a href="ChainVerifier.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
					
			
			<table cellpadding=10>
			<tr>
				<td align=left>
					<img src=../../siclogo.jpg>
					</td>
					<td align=center>
						5.3<br>
						(c) 2002 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>IAIK</a>, (c) 2003 - 2015 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>SIC</a>
						</td>
						<td align=right>
							<img src=../../iaik_logo.gif>
							</td>
						</tr>
					</table>
			
		
				</small></p>
</body>
</html>
