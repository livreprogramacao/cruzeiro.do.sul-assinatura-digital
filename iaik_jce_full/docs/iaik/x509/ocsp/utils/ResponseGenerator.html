<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Mon Dec 21 16:59:30 CET 2015 -->
<title>ResponseGenerator (5.3 API Documentation)</title>
<meta name="date" content="2015-12-21">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ResponseGenerator (5.3 API Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
			
			<b>IAIK-JCE Provider API Documentation</b>
		<br>
			<font size=-1>Version 5.3</font>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../iaik/x509/ocsp/utils/TrustedResponders.html" title="class in iaik.x509.ocsp.utils"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?iaik/x509/ocsp/utils/ResponseGenerator.html" target="_top">Frames</a></li>
<li><a href="ResponseGenerator.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">iaik.x509.ocsp.utils</div>
<h2 title="Class ResponseGenerator" class="title">Class ResponseGenerator</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>iaik.x509.ocsp.utils.ResponseGenerator</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">ResponseGenerator</span>
extends java.lang.Object</pre>
<div class="block">A simple utility for generating OCSP responses (of type BasicOCSPResponse).
 <p>
 This class provides an utility for caching pre-calculated single responses
 (either immediately set or
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addResponseEntries(iaik.x509.X509CRL, iaik.x509.X509Certificate, int)"><code>computed</code></a> from a
 crl) and creating a <a href="../../../../iaik/x509/ocsp/OCSPResponse.html" title="class in iaik.x509.ocsp"><code>OCSPResponse</code></a>
 according to the single reponses cached.
 <p>
 When creating a ResponseGenerator object the certificates and private signing
 key of the responder have to be supplied (either as PrivateKey and
 X509Certificate chain) or as <a href="../../../../iaik/pkcs/pkcs12/PKCS12.html" title="class in iaik.pkcs.pkcs12"><code>PKCS12</code></a> object:
 
 <pre>
 // the responder certs:
 X509Certificate[] responderCerts = ...;
 // the private key of the responder:
 PrivateKey responderKey = ...;
 ResponseGenerator generator = 
   new ResponseGenerator(responderKey, responderCerts);
 </pre>
 
 respectively:
 
 <pre>
 // the PKCS12Object containing key and ceritifcates of the responder:
 PKCS12 pkcs12 = ...;
 // the password for decrypting the PKCS12 object:
 char[] password = ...;
 ResponseGenerator generator = 
   new ResponseGenerator(pkcs12, password);
 </pre>
 
 After optionally <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#init(java.io.InputStream)"><code>initializing</code></a> the generator with
 the contents previously <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#writeTo(java.io.OutputStream)"><code>written</code></a> to a file,
 adding single response entries (by using one of the
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addResponseEntry(iaik.x509.ocsp.SingleResponse)"><code>addResponseEntry</code></a> methods or
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addResponseEntries(iaik.x509.X509CRL, iaik.x509.X509Certificate, int)"><code>creating</code></a> them from
 a CRL) and/or adding trusted certificate <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>issuers</code></a> method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#createOCSPResponse(java.io.InputStream, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, iaik.x509.V3Extension[])"><code>createOCSPResponse</code></a> may be called for creating an
 <a href="../../../../iaik/x509/ocsp/OCSPResponse.html" title="class in iaik.x509.ocsp"><code>OCSPResponse</code></a> in response to an
 <a href="../../../../iaik/x509/ocsp/OCSPRequest.html" title="class in iaik.x509.ocsp"><code>OCSPRequest</code></a> received, e.g.:
 
 <pre>
 // add a single response
 generator.addResponseEntry(singleResponse);
 // create and add a second response
 generator.addResponseEntry(reqCert, certStatus, thisUpdate, nextUpdate);
 // create and add response entries from a crl
 X509CRL crl = ...;
 // the crl issuer cert
 X509Certificate crlIssuer = ...;
 generator.addResponseEntries(crl, crlIssuer, ReqCert.certID);
 // add a trusted certificate issuer
 Name issuer = ...;
 generator.addCertificateIssuer(issuer);
 // sign and create an OCSPResponse for an OCSPRequest read from a stream
 InputStream is = ...;
 AlgorithmID signingAlg = ...;
 OCSPResponse ocspResponse = createOCSPResponse(is, null, sigingAlg, null);
 </pre>
 
 The OCSPResponse will be created according to the following proceeding: First
 the OCSP request is read and decoded from the given input stream. For each of
 the included single <a href="../../../../iaik/x509/ocsp/Request.html" title="class in iaik.x509.ocsp"><code>requests</code></a> a
 <a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp"><code>SingleResponse</code></a> is created thereby
 setting the <a href="../../../../iaik/x509/ocsp/CertStatus.html" title="class in iaik.x509.ocsp"><code>CertStatus</code></a> according to the
 following rules (in this order):
 <ul>
 <li>If the request contains a
 <a href="../../../../iaik/x509/ocsp/extensions/ServiceLocator.html" title="class in iaik.x509.ocsp.extensions"><code>ServiceLocator</code></a> extension
 indicating that the owner of this generator is not an accepted responder for
 the request in mind, the CertStatus of the corresponding single response is
 set to "unknown".
 <li>If any of the single responses in the cache matches to the
 <a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp"><code>ReqCert</code></a> of the request in mind, this single
 response is the one to be sent in response to the request.
 <li>If the ReqCert of the request is of a type (<a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>, <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find the issuer of its
 target certificate, and the owner of this generator itself is equal to the
 target certificate issuer, the CertStatus of the corresponding single
 response is set to "good".
 <li>If the ReqCert of the request is of a type (<a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>, <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find the issuer of its
 target certificate, and the owner of this generator has a certificate (with
 ExtendedKeyUsage ocspSigning set) issued by the target certificate issuer,
 the CertStatus of the corresponding single response is set to "good".
 <li>If the ReqCert of the request is of a type (<a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>, <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find that any of the
 certificate issuers <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>cached</code></a> is the issuer
 of the target certificate and also the issuer of the responder certificate,
 the certStaus of the corresponding single response is set to "good" if the
 responder certificate is allowed to sign OCSP responses (has to ocspSigning
 <a href="../../../../iaik/x509/extensions/ExtendedKeyUsage.html" title="class in iaik.x509.extensions"><code>ExtendedKeyUsage</code></a> set.
 <li>In any other case the CertStatus of the corresponding request is set to
 "unknown"
 </ul>
 <p>
 The <a href="../../../../iaik/x509/ocsp/OCSPResponse.html" title="class in iaik.x509.ocsp"><code>OCSPResponse</code></a> created will indicate
 another response status than "successful" if any of the following situations
 occur:
 <ul>
 <li>The OCSP <a href="../../../../iaik/x509/ocsp/OCSPRequest.html" title="class in iaik.x509.ocsp"><code>request</code></a> supplied by the given
 input stream cannot be read because of an decoding/parsing error ==> response
 status "malformedRequest"
 <li>The OCSP request is signed but the signature is invalid ==> response
 status "malformedRequest"
 <li>The OCSP request is signed but the ceritificates included to not belong
 to the request signer ==> response status "malformedRequest"
 <li>The OCSP request is signed but no ceritificates are included and no
 signer key is available; so the signature cannot be verified ==> response
 status "malformedRequest"
 <li>The OCSP request is signed but the verification key is invalid ==>
 response status "malformedRequest"
 <li>The OCSP request is signed but the signature cannot be verified because
 the signature algorithm used is not supported ==> response status
 "internalError"
 <li>If some other, general, not request specific error occurs during request
 parsing or verification ==> response status "tryLater"
 <li>If an error occurs when signing the OCSPResponse ==> response status
 "tryLater"
 <li>If some general error occurs ==> response status "tryLater"
 </ul></div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>File Revision <!-- $$Revision: --> 18 <!-- $ --></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../../iaik/x509/ocsp/OCSPResponse.html" title="class in iaik.x509.ocsp"><code>OCSPResponse</code></a>, 
<a href="../../../../iaik/x509/ocsp/OCSPRequest.html" title="class in iaik.x509.ocsp"><code>OCSPRequest</code></a>, 
<a href="../../../../iaik/x509/ocsp/BasicOCSPResponse.html" title="class in iaik.x509.ocsp"><code>BasicOCSPResponse</code></a>, 
<a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp"><code>SingleResponse</code></a>, 
<a href="../../../../iaik/x509/ocsp/Request.html" title="class in iaik.x509.ocsp"><code>Request</code></a>, 
<a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp"><code>ReqCert</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#ResponseGenerator(iaik.pkcs.pkcs12.PKCS12, char[])">ResponseGenerator</a></strong>(<a href="../../../../iaik/pkcs/pkcs12/PKCS12.html" title="class in iaik.pkcs.pkcs12">PKCS12</a>&nbsp;pkcs12,
                 char[]&nbsp;password)</code>
<div class="block">Creates a ResponseGenerator from the given PCSK#12 object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#ResponseGenerator(java.security.PrivateKey, iaik.x509.X509Certificate[])">ResponseGenerator</a></strong>(java.security.PrivateKey&nbsp;responderKey,
                 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>[]&nbsp;responderCerts)</code>
<div class="block">Creates a ResponseGenerator from responder private key and responder certs.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)">addCertificateIssuer</a></strong>(<a href="../../../../iaik/asn1/structures/Name.html" title="class in iaik.asn1.structures">Name</a>&nbsp;issuer)</code>
<div class="block">Adds a certificate issuers to this response generator.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addResponseEntries(iaik.x509.X509CRL, iaik.x509.X509Certificate, int)">addResponseEntries</a></strong>(<a href="../../../../iaik/x509/X509CRL.html" title="class in iaik.x509">X509CRL</a>&nbsp;crl,
                  <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>&nbsp;crlIssuer,
                  int&nbsp;reqCertType)</code>
<div class="block">Creates and adds SingleResponse entries for the given CRL.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addResponseEntries(iaik.x509.X509CRL, iaik.x509.X509Certificate, int, iaik.x509.ocsp.extensions.CrlID)">addResponseEntries</a></strong>(<a href="../../../../iaik/x509/X509CRL.html" title="class in iaik.x509">X509CRL</a>&nbsp;crl,
                  <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>&nbsp;crlIssuer,
                  int&nbsp;reqCertType,
                  <a href="../../../../iaik/x509/ocsp/extensions/CrlID.html" title="class in iaik.x509.ocsp.extensions">CrlID</a>&nbsp;crlID)</code>
<div class="block">Creates and adds SingleResponse entries for the given CRL.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addResponseEntry(iaik.x509.ocsp.ReqCert, iaik.x509.ocsp.CertStatus, java.util.Date, java.util.Date)">addResponseEntry</a></strong>(<a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp">ReqCert</a>&nbsp;reqCert,
                <a href="../../../../iaik/x509/ocsp/CertStatus.html" title="class in iaik.x509.ocsp">CertStatus</a>&nbsp;certStatus,
                java.util.Date&nbsp;thisUpdate,
                java.util.Date&nbsp;nextUpdate)</code>
<div class="block">Creates a SingleResponse for the given reqCert, certStatus and thisUpdate
 (and optional nextUpdate) date and adds it to the list of single responses.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addResponseEntry(iaik.x509.ocsp.SingleResponse)">addResponseEntry</a></strong>(<a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a>&nbsp;singleResponse)</code>
<div class="block">Adds the given SingleResponse.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../iaik/x509/ocsp/OCSPResponse.html" title="class in iaik.x509.ocsp">OCSPResponse</a></code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#createOCSPResponse(java.io.InputStream, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, iaik.x509.V3Extension[])">createOCSPResponse</a></strong>(java.io.InputStream&nbsp;requestStream,
                  java.security.PublicKey&nbsp;requestorKey,
                  <a href="../../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;signatureAlgorithm,
                  <a href="../../../../iaik/x509/V3Extension.html" title="class in iaik.x509">V3Extension</a>[]&nbsp;extensions)</code>
<div class="block">Creates an OCSPResponse for the OCSPRequest read from the given input
 stream.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#getResponderCertificates()">getResponderCertificates</a></strong>()</code>
<div class="block">Gets the certificates of the responder.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.security.PrivateKey</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#getResponderKey()">getResponderKey</a></strong>()</code>
<div class="block">Gets the signing key of the responder.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a></code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#getSingleResponse(iaik.x509.ocsp.ReqCert)">getSingleResponse</a></strong>(<a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp">ReqCert</a>&nbsp;reqCert)</code>
<div class="block">Returns the single response identified by the given ReqCert, if included.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a></code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#getSingleResponse(iaik.x509.ocsp.Request)">getSingleResponse</a></strong>(<a href="../../../../iaik/x509/ocsp/Request.html" title="class in iaik.x509.ocsp">Request</a>&nbsp;request)</code>
<div class="block">Creates a single response for the given single request.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.Enumeration</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#getSingleResponses()">getSingleResponses</a></strong>()</code>
<div class="block">Returns all single responses produced by this response generator.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#init(java.io.InputStream)">init</a></strong>(java.io.InputStream&nbsp;is)</code>
<div class="block">Inits the single response repository from the from the given input stream.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#printDebug(boolean)">printDebug</a></strong>(boolean&nbsp;debug)</code>
<div class="block">Turns debug printing to System.out on/off.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#removeAllCertIssuers()">removeAllCertIssuers</a></strong>()</code>
<div class="block">Removes all certificate issuers included.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#removeAllSingleResponses()">removeAllSingleResponses</a></strong>()</code>
<div class="block">Removes all single responses included.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#removeCertificateIssuer(iaik.asn1.structures.Name)">removeCertificateIssuer</a></strong>(<a href="../../../../iaik/asn1/structures/Name.html" title="class in iaik.asn1.structures">Name</a>&nbsp;issuer)</code>
<div class="block">Removes the given certificate issuer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a></code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#removeSingleResponse(iaik.x509.ocsp.ReqCert)">removeSingleResponse</a></strong>(<a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp">ReqCert</a>&nbsp;reqCert)</code>
<div class="block">Removes the single response identified by the given ReqCert.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#setDebugStream(java.io.OutputStream)">setDebugStream</a></strong>(java.io.OutputStream&nbsp;out)</code>
<div class="block">Sets the stream to which debug information shall be printed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#toString()">toString</a></strong>()</code>
<div class="block">Returns a string representation of this response generator.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#writeTo(java.io.OutputStream)">writeTo</a></strong>(java.io.OutputStream&nbsp;os)</code>
<div class="block">Writes the contents of this response generator to the given output stream.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ResponseGenerator(java.security.PrivateKey, iaik.x509.X509Certificate[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ResponseGenerator</h4>
<pre>public&nbsp;ResponseGenerator(java.security.PrivateKey&nbsp;responderKey,
                 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>[]&nbsp;responderCerts)</pre>
<div class="block">Creates a ResponseGenerator from responder private key and responder certs.
 <p>
 The certificate of the response signer (i.e. the certificate corresponding
 to the responder key) has to be at index 0 of the supplied array. No
 certificate chain verification or rearranging is performed. It is the
 responsibility of the calling application to supply valid certificates.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>responderKey</code> - the key used for signing the response</dd><dd><code>responderCerts</code> - the certificates of the responder</dd></dl>
</li>
</ul>
<a name="ResponseGenerator(iaik.pkcs.pkcs12.PKCS12, char[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ResponseGenerator</h4>
<pre>public&nbsp;ResponseGenerator(<a href="../../../../iaik/pkcs/pkcs12/PKCS12.html" title="class in iaik.pkcs.pkcs12">PKCS12</a>&nbsp;pkcs12,
                 char[]&nbsp;password)
                  throws <a href="../../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></pre>
<div class="block">Creates a ResponseGenerator from the given PCSK#12 object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pkcs12</code> - the <a href="../../../../iaik/pkcs/pkcs12/PKCS12.html" title="class in iaik.pkcs.pkcs12"><code>PKCS12</code></a> object supplying
          responder key and certs.</dd><dd><code>password</code> - the password for decrypting the PKCS12 object.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../iaik/pkcs/PKCSException.html" title="class in iaik.pkcs">PKCSException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getResponderKey()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getResponderKey</h4>
<pre>public&nbsp;java.security.PrivateKey&nbsp;getResponderKey()</pre>
<div class="block">Gets the signing key of the responder.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the signing key of the responder.</dd></dl>
</li>
</ul>
<a name="getResponderCertificates()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getResponderCertificates</h4>
<pre>public&nbsp;<a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>[]&nbsp;getResponderCertificates()</pre>
<div class="block">Gets the certificates of the responder.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the certificates of the responder.</dd></dl>
</li>
</ul>
<a name="addResponseEntry(iaik.x509.ocsp.ReqCert, iaik.x509.ocsp.CertStatus, java.util.Date, java.util.Date)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addResponseEntry</h4>
<pre>public&nbsp;void&nbsp;addResponseEntry(<a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp">ReqCert</a>&nbsp;reqCert,
                    <a href="../../../../iaik/x509/ocsp/CertStatus.html" title="class in iaik.x509.ocsp">CertStatus</a>&nbsp;certStatus,
                    java.util.Date&nbsp;thisUpdate,
                    java.util.Date&nbsp;nextUpdate)</pre>
<div class="block">Creates a SingleResponse for the given reqCert, certStatus and thisUpdate
 (and optional nextUpdate) date and adds it to the list of single responses.
 <p>
 Any included SingleResponse with the same ReqCert is cleared. <br>
 <b>Attention!</b> This method does not check if the owner of this generator
 is authorized to send the single response created from the given
 information (such a check only might be possible if only ReqCert types
 (CertID, issuerSerial, pKCert) were used allowing to find the issuer of the
 corresponding target certificate. It is the responsibiltity of the calling
 application to ensure that the given single responses matches to the OCSP
 signing abilities of the owner of this generator (i.e. the responder).</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>reqCert</code> - the reqCert identifying the target cert for which revocation
          information maybe requested</dd><dd><code>certStatus</code> - the certStatus for the target certificate in mind</dd><dd><code>thisUpdate</code> - the time at which the certStatus is known as being correct</dd><dd><code>nextUpdate</code> - the time at or before newer information will be available about
          the status of the certificate (maybe <code>null</code>)</dd></dl>
</li>
</ul>
<a name="addResponseEntry(iaik.x509.ocsp.SingleResponse)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addResponseEntry</h4>
<pre>public&nbsp;void&nbsp;addResponseEntry(<a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a>&nbsp;singleResponse)</pre>
<div class="block">Adds the given SingleResponse.
 <p>
 Any included SingleResponse with the same ReqCert is cleared. <br>
 <b>Attention!</b> This method does not check if the owner of this generator
 is authorized to send the given single response (such a check only might be
 possible if only ReqCert types (CertID, issuerSerial, pKCert) were used
 allowing to find the issuer of the corresponding target certificate. It is
 the responsibiltity of the calling application to ensure that the given
 single responses matches to the OCSP signing abilities of the owner of this
 generator (i.e. the responder).</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>singleResponse</code> - the SingleResponse to be added</dd></dl>
</li>
</ul>
<a name="addResponseEntries(iaik.x509.X509CRL, iaik.x509.X509Certificate, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addResponseEntries</h4>
<pre>public&nbsp;void&nbsp;addResponseEntries(<a href="../../../../iaik/x509/X509CRL.html" title="class in iaik.x509">X509CRL</a>&nbsp;crl,
                      <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>&nbsp;crlIssuer,
                      int&nbsp;reqCertType)
                        throws <a href="../../../../iaik/x509/ocsp/OCSPException.html" title="class in iaik.x509.ocsp">OCSPException</a>,
                               java.security.SignatureException</pre>
<div class="block">Creates and adds SingleResponse entries for the given CRL.
 <p>
 This method tries to create single response entries for the revoked
 certificate of the given crl. This method throws an OCSPException if one of
 the following situations occur:
 <p>
 <ul>
 <li>Single responses only can be created for ReqCert types certID or
 IssuerSerial; if the given crl is an indirect crl, certID cannot be used,
 too. If any other ReqCert type is claimed, an OCSPException is thrown.
 <li>If the given crl is not an indirect CRL, but the response signer is
 different from the crl issuer and is not authorized by the crl issuer to
 sign the response (ExtendedKeyUsage bit ocpSigning is not set). If
 ocspSigning is set but the response signing cert is not issued by the crl
 issuer also an OCSPException is thrown.
 <li>If the given crl is an indirect one but the response signer is not
 authorized by any certificate issuer included (ExtendedKeyUsage bit
 ocpSigning is not set). If ocspSigning is set but the response signing cert
 is not issued by the ceritificate issuer in mind also an OCSPException is
 thrown. However, if the response signer is equal to a certificate issuer an
 entry for the corresponding revoked certificate may be created
 <li>If some processing error occurs when creating the single response for
 an revoked certificate included.
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>crl</code> - the crl from which to create single responses</dd><dd><code>crlIssuer</code> - the certificate of the CRL issuer (required for OCSPv1 CertID
          creation)</dd><dd><code>reqCertType</code> - the ReqCert type the single responses should have (either certID
          or issuerSerial</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../iaik/x509/ocsp/OCSPException.html" title="class in iaik.x509.ocsp">OCSPException</a></code> - if single response entries cannot be created because one of
              the reasons stated above</dd>
<dd><code>java.security.SignatureException</code> - if the crl cannot be verified with the given crl issuer cert</dd></dl>
</li>
</ul>
<a name="addResponseEntries(iaik.x509.X509CRL, iaik.x509.X509Certificate, int, iaik.x509.ocsp.extensions.CrlID)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addResponseEntries</h4>
<pre>public&nbsp;void&nbsp;addResponseEntries(<a href="../../../../iaik/x509/X509CRL.html" title="class in iaik.x509">X509CRL</a>&nbsp;crl,
                      <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509">X509Certificate</a>&nbsp;crlIssuer,
                      int&nbsp;reqCertType,
                      <a href="../../../../iaik/x509/ocsp/extensions/CrlID.html" title="class in iaik.x509.ocsp.extensions">CrlID</a>&nbsp;crlID)
                        throws <a href="../../../../iaik/x509/ocsp/OCSPException.html" title="class in iaik.x509.ocsp">OCSPException</a>,
                               java.security.SignatureException</pre>
<div class="block">Creates and adds SingleResponse entries for the given CRL.
 <p>
 This method tries to create single response entries for the revoked
 certificate of the given crl. This method throws an OCSPException if one of
 the following situations occur:
 <p>
 <ul>
 <li>Single responses only can be created for ReqCert types certID or
 IssuerSerial; if the given crl is an indirect crl, certID cannot be used,
 too. If any other ReqCert type is claimed, an OCSPException is thrown.
 <li>If the given crl is not an indirect CRL, but the response signer is
 different from the crl issuer and is not authorized by the crl issuer to
 sign the response (ExtendedKeyUsage bit ocpSigning is not set). If
 ocspSigning is set but the response signing cert is not issued by the crl
 issuer also an OCSPException is thrown.
 <li>If the given crl is an indirect but the response signer is not
 authorized by any certificate issuer included (ExtendedKeyUsage bit
 ocpSigning is not set). If ocspSigning is set but the response signing cert
 is not issued by the ceritificate issuer in mind also an OCSPException is
 thrown. However, if the response signer is equal to a certificate issuer an
 entry for the corresponding revoked certificate may be created
 <li>If some processing error occurs when creating the single response for
 an revoked certificate included.
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>crl</code> - the crl from which to create single responses</dd><dd><code>crlIssuer</code> - the certificate of the CRL issuer (required for OCSPv1 CertID
          creation)</dd><dd><code>reqCertType</code> - the ReqCert type the single responses should have (either certID
          or issuerSerial</dd><dd><code>crlID</code> - the crlID extension, if to be included, otherwise
          <code>null</code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../iaik/x509/ocsp/OCSPException.html" title="class in iaik.x509.ocsp">OCSPException</a></code> - if single response entries cannot be created because one of
              the reasons stated above</dd>
<dd><code>java.security.SignatureException</code> - if the crl cannot be verified with the given crl issuer cert</dd></dl>
</li>
</ul>
<a name="getSingleResponses()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSingleResponses</h4>
<pre>public&nbsp;java.util.Enumeration&nbsp;getSingleResponses()</pre>
<div class="block">Returns all single responses produced by this response generator.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>all single responses produced in this response generator.</dd></dl>
</li>
</ul>
<a name="getSingleResponse(iaik.x509.ocsp.ReqCert)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSingleResponse</h4>
<pre>public&nbsp;<a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a>&nbsp;getSingleResponse(<a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp">ReqCert</a>&nbsp;reqCert)</pre>
<div class="block">Returns the single response identified by the given ReqCert, if included.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the single response identified by the given ReqCert, or
         <code>null</code> if no single response for the given ReqCert is
         included</dd></dl>
</li>
</ul>
<a name="removeSingleResponse(iaik.x509.ocsp.ReqCert)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeSingleResponse</h4>
<pre>public&nbsp;<a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a>&nbsp;removeSingleResponse(<a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp">ReqCert</a>&nbsp;reqCert)</pre>
<div class="block">Removes the single response identified by the given ReqCert.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>reqCert</code> - the reqCert ID for the single response to be removed</dd>
<dt><span class="strong">Returns:</span></dt><dd>the SingleResponse, if removed, <code>null</code> if the
         SingleResponse cannot be removed because it was not included</dd></dl>
</li>
</ul>
<a name="removeAllSingleResponses()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeAllSingleResponses</h4>
<pre>public&nbsp;void&nbsp;removeAllSingleResponses()</pre>
<div class="block">Removes all single responses included.</div>
</li>
</ul>
<a name="addCertificateIssuer(iaik.asn1.structures.Name)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addCertificateIssuer</h4>
<pre>public&nbsp;void&nbsp;addCertificateIssuer(<a href="../../../../iaik/asn1/structures/Name.html" title="class in iaik.asn1.structures">Name</a>&nbsp;issuer)</pre>
<div class="block">Adds a certificate issuers to this response generator.
 <p>
 When <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#getSingleResponse(iaik.x509.ocsp.Request)"><code>asking</code></a> for a single response for a
 particular <a href="../../../../iaik/x509/ocsp/Request.html" title="class in iaik.x509.ocsp"><code>request</code></a>, but no SingleResponse
 has been set for this request, a new SingleResponse has to be created for
 this request using the following proceeding for determining the certStatus
 of the single response: <br>
 If the <a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp"><code>ReqCert</code></a> of the request in mind has a
 type (certID, issuerSerial or pKCert} allowing to find the issuer of its
 target certificate, and if this issuer is the response signer itself or is
 some of the issuers previously set by method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>addCertificateIssuer</code></a> and has signed the
 responder's OCSP signing certificate, the certStatus is set to "good". In
 any other case the cert status is set to "unknown".</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>issuer</code> - the issuer name to be set</dd></dl>
</li>
</ul>
<a name="removeCertificateIssuer(iaik.asn1.structures.Name)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeCertificateIssuer</h4>
<pre>public&nbsp;boolean&nbsp;removeCertificateIssuer(<a href="../../../../iaik/asn1/structures/Name.html" title="class in iaik.asn1.structures">Name</a>&nbsp;issuer)</pre>
<div class="block">Removes the given certificate issuer.
 <p>
 Certificate issuer names can be added by calling method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>addCertificateIssuer</code></a> to be used for
 determining the certStatus of a SingleResponse for a request for which no
 SingleResponse has been explicitly set: If the
 <a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp"><code>ReqCert</code></a> of the request in mind has a type
 (certID, issuerSerial or pKCert} allowing to find the issuer of its target
 certificate, and if this issuer is the response signer itself or is some of
 the issuers previously set by method <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>addCertificateIssuer</code></a> and has signed the responder's OCSP signing
 certificate, the certStatus is set to "good". In any other case the cert
 status is set to "unknown".</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>issuer</code> - the issuer name to be removed</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code>, if removed, <code>false</code> if the issuer
         name cannot be removed because it was not included</dd></dl>
</li>
</ul>
<a name="removeAllCertIssuers()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeAllCertIssuers</h4>
<pre>public&nbsp;void&nbsp;removeAllCertIssuers()</pre>
<div class="block">Removes all certificate issuers included.
 <p>
 Certificate issuer names can be added by calling method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>addCertificateIssuer</code></a> to be used for
 determining the certStatus of a SingleResponse for a request for which no
 SingleResponse has been explicitly set: If the
 <a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp"><code>ReqCert</code></a> of the request in mind has a type
 (certID, issuerSerial or pKCert} allowing to find the issuer of its target
 certificate, and if this issuer is the response signer itself or is some of
 the issuers previously set by method <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>addCertificateIssuer</code></a> and has signed the responder's OCSP signing
 certificate, the certStatus is set to "good". In any other case the cert
 status is set to "unknown".</div>
</li>
</ul>
<a name="getSingleResponse(iaik.x509.ocsp.Request)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSingleResponse</h4>
<pre>public&nbsp;<a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp">SingleResponse</a>&nbsp;getSingleResponse(<a href="../../../../iaik/x509/ocsp/Request.html" title="class in iaik.x509.ocsp">Request</a>&nbsp;request)</pre>
<div class="block">Creates a single response for the given single request.
 <p>
 For the given single <a href="../../../../iaik/x509/ocsp/Request.html" title="class in iaik.x509.ocsp"><code>request</code></a> a
 <a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp"><code>SingleResponse</code></a> is created thereby
 setting the <a href="../../../../iaik/x509/ocsp/CertStatus.html" title="class in iaik.x509.ocsp"><code>CertStatus</code></a> according to the
 following rules (in this order):
 <ul>
 <li>If the request contains a <a href="../../../../iaik/x509/ocsp/extensions/package-summary.html"><code>ServiceLocator ServiceLocator</code></a> extension indicating that the owner of this
 generator is not an accepted responder for the request in mind, the
 CertStatus of the corresponding single response is set to "unknown".
 <li>If any of the single responses in the cache matches to the
 <a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp"><code>ReqCert</code></a> of the request in mind, this single
 response is the one sent in response to the request.
 <li>If the ReqCert of the request is of a type (
 <a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>,
 <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find the issuer of
 its target certificate, and the owner of this generator itself is equal to
 the target certificate issuer, the CertStatus of the corresponding single
 response is set to "good".
 <li>If the given ReqCert of the request is of a type (
 <a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>,
 <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find the issuer of
 its target certificate, and the owner of this generator has a certificate
 (with ExtendedKeyUsage ocspSigning set) issued by the target certificate
 issuer, the CertStatus of the corresponding single response is set to
 "good".
 <li>If the ReqCert of the request is of a type (
 <a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>,
 <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find that any of the
 certificate issuers <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>cached</code></a> is the
 issuer of the target certificate and also the issuer of the responder
 certificate, the certStaus of the corresponding single response is set to
 "good" if the responder certificate is allowed to sign OCSP responses (has
 to ocspSigning <a href="../../../../iaik/x509/extensions/ExtendedKeyUsage.html" title="class in iaik.x509.extensions"><code>ExtendedKeyUsage</code></a> set.
 <li>In any other case the CertStatus of the corresponding request is set to
 "unknown"
 </ul>
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>request</code> - the request for which to create a single response</dd>
<dt><span class="strong">Returns:</span></dt><dd>a SingleResponse for the given request</dd></dl>
</li>
</ul>
<a name="createOCSPResponse(java.io.InputStream, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, iaik.x509.V3Extension[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createOCSPResponse</h4>
<pre>public&nbsp;<a href="../../../../iaik/x509/ocsp/OCSPResponse.html" title="class in iaik.x509.ocsp">OCSPResponse</a>&nbsp;createOCSPResponse(java.io.InputStream&nbsp;requestStream,
                              java.security.PublicKey&nbsp;requestorKey,
                              <a href="../../../../iaik/asn1/structures/AlgorithmID.html" title="class in iaik.asn1.structures">AlgorithmID</a>&nbsp;signatureAlgorithm,
                              <a href="../../../../iaik/x509/V3Extension.html" title="class in iaik.x509">V3Extension</a>[]&nbsp;extensions)</pre>
<div class="block">Creates an OCSPResponse for the OCSPRequest read from the given input
 stream.
 <p>
 This method first reads and decodes the request from the given input
 stream. For each of the included single <a href="../../../../iaik/x509/ocsp/Request.html" title="class in iaik.x509.ocsp"><code>requests</code></a> a <a href="../../../../iaik/x509/ocsp/SingleResponse.html" title="class in iaik.x509.ocsp"><code>SingleResponse</code></a> is created
 thereby setting the <a href="../../../../iaik/x509/ocsp/CertStatus.html" title="class in iaik.x509.ocsp"><code>CertStatus</code></a> according
 to the following rules (in this order):
 <ul>
 <li>If the request contains a
 <a href="../../../../iaik/x509/ocsp/extensions/ServiceLocator.html" title="class in iaik.x509.ocsp.extensions"><code>ServiceLocator</code></a> extension
 indicating that the owner of this generator is not an accepted responder
 for the request in mind, the CertStatus of the corresponding single
 response is set to "unknown".
 <li>If any of the single responses in the cache matches to the
 <a href="../../../../iaik/x509/ocsp/ReqCert.html" title="class in iaik.x509.ocsp"><code>ReqCert</code></a> of the request in mind, this single
 response is the one sent in response to the request.
 <li>If the ReqCert of the request is of a type (
 <a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>,
 <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find the issuer of
 its target certificate, and the owner of this generator itself is equal to
 the target certificate issuer, the CertStatus of the corresponding single
 response is set to "good".
 <li>If the ReqCert of the request is of a type (
 <a href="../../../../iaik/x509/ocsp/CertID.html" title="class in iaik.x509.ocsp"><code>CertID</code></a>,
 <a href="../../../../iaik/pkcs/pkcs7/IssuerAndSerialNumber.html" title="class in iaik.pkcs.pkcs7"><code>issuerSerial</code></a>, or
 <a href="../../../../iaik/x509/X509Certificate.html" title="class in iaik.x509"><code>pKCert</code></a>) allowing to find that any of the
 certificate issuers <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#addCertificateIssuer(iaik.asn1.structures.Name)"><code>cached</code></a> is the
 issuer of the target certificate and also the issuer of the responder
 certificate, the certStaus of the corresponding single response is set to
 "good" if the responder certificate is allowed to sign OCSP responses (has
 to ocspSigning <a href="../../../../iaik/x509/extensions/ExtendedKeyUsage.html" title="class in iaik.x509.extensions"><code>ExtendedKeyUsage</code></a> set.
 <li>In any other case the CertStatus of the corresponding request is set to
 "unknown"
 </ul>
 <p>
 The <a href="../../../../iaik/x509/ocsp/OCSPResponse.html" title="class in iaik.x509.ocsp"><code>OCSPResponse</code></a> returned by this
 method will indicate another response status than "successful" if any of
 the following situations occur:
 <ul>
 <li>The OCSP <a href="../../../../iaik/x509/ocsp/OCSPRequest.html" title="class in iaik.x509.ocsp"><code>request</code></a> supplied by the
 given input stream cannot be read because of an decoding/parsing error ==>
 response status "malformedRequest"
 <li>The OCSP request is signed but the signature is invalid ==> response
 status "malformedRequest"
 <li>The OCSP request is signed but the ceritificates included to not belong
 to the request signer ==> response status "malformedRequest"
 <li>The OCSP request is signed but no ceritificates are included and no
 signer key is available; so the signature cannot be verified ==> response
 status "malformedRequest"
 <li>The OCSP request is signed but the verification key is invalid ==>
 response status "malformedRequest"
 <li>The OCSP request is signed but the signature cannot be verified because
 the signature algorithm used is not supported ==> response status
 "internalError"
 <li>If some other, general, not request specific error occurs during
 request parsing or verification ==> response status "tryLater"
 <li>If an error occurs when signing the OCSPResponse ==> response status
 "tryLater"
 <li>If some general error occurs ==> response status "tryLater"
 </ul>
 If any of the given extensions cannot be added to the response because of
 some reason, the response is sent without including the particular
 extension (i.e. it is ignored)</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>requestStream</code> - the input stream from where to read the DER encoded OCSP request</dd><dd><code>requestorKey</code> - the public key of the requestor used to verify the request (may be
          <code>null</code> if the request is not signed or is signed and
          has the requestor certificates included</dd><dd><code>signatureAlgorithm</code> - the signature algorithm which will be used for signing the
          OCSPResponse</dd><dd><code>extensions</code> - any response extensions to be added to the OCSPResponse created by
          this method</dd></dl>
</li>
</ul>
<a name="init(java.io.InputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>public&nbsp;void&nbsp;init(java.io.InputStream&nbsp;is)
          throws java.io.IOException</pre>
<div class="block">Inits the single response repository from the from the given input stream.
 <p>
 <b>Attention!</b> The data read in by this method does not represent the
 OCSPResponse to be sent in response to a request. The final OCSPResponse is
 created when calling method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#createOCSPResponse(java.io.InputStream, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, iaik.x509.V3Extension[])"><code>createOCSPResponse</code></a>. This method only provides the possibilty to init the
 generator from a file previously created by calling method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#writeTo(java.io.OutputStream)"><code>writeTo</code></a>. <br>
 This method reads in the (previously written) contents of the generator
 thereby using a proprietary ASN.1 structure:
 
 <pre>
 GeneratorContents  ::= SEQUENCE {
   tbs         Contents,
   signature   BIT STRING }
 
 Contents ::= SEQUENCE {
   responderID      ResponderID,
   certIssuers      SEQUENCE OF Name OPTIONAL
    responses   [0] SEQUENCE OF SingleResponse }
 </pre>
 
 For providing the integrity and authenticity of the generator the contents
 has been signed with the responder's private key and now is verified with
 its public key.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>is</code> - the input stream supplying the contents of this generator</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an initialization, verification error,... occurs or the
              contents read in has does not belong to the owner of this
              generator</dd></dl>
</li>
</ul>
<a name="writeTo(java.io.OutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeTo</h4>
<pre>public&nbsp;void&nbsp;writeTo(java.io.OutputStream&nbsp;os)
             throws java.io.IOException</pre>
<div class="block">Writes the contents of this response generator to the given output stream.
 <p>
 <b>Attention!</b> The output created and stored by this method is not the
 the OCSPResponse to be sent in response to a request. The final
 OCSPResponse is created when calling method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#createOCSPResponse(java.io.InputStream, java.security.PublicKey, iaik.asn1.structures.AlgorithmID, iaik.x509.V3Extension[])"><code>createOCSPResponse</code></a>. This method only provides the possibilty to store the
 repository to a file from where it can be read back when calling method
 <a href="../../../../iaik/x509/ocsp/utils/ResponseGenerator.html#init(java.io.InputStream)"><code>init</code></a>.<br>
 This method uses a proprietary ASN.1 structure for writing the contents to
 the given stream:
 
 <pre>
 GeneratorContents  ::= SEQUENCE {
   tbs         Contents,
   signature   BIT STRING }
 
 Contents ::= SEQUENCE {
   responderID      ResponderID,
   certIssuers      SEQUENCE OF Name OPTIONAL
    responses   [0] SEQUENCE OF SingleResponse }
 </pre>
 
 For providing the integrity and authenticity of the generator the contents
 is signed with the responder's private key before writing it to the stream.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>os</code> - the output stream to which to write the contents of this generator</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if some I/O, signing, ... error occurs</dd></dl>
</li>
</ul>
<a name="printDebug(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>printDebug</h4>
<pre>public&nbsp;void&nbsp;printDebug(boolean&nbsp;debug)</pre>
<div class="block">Turns debug printing to System.out on/off.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>debug</code> - whether to write debug messages to System.out or not</dd></dl>
</li>
</ul>
<a name="setDebugStream(java.io.OutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setDebugStream</h4>
<pre>public&nbsp;void&nbsp;setDebugStream(java.io.OutputStream&nbsp;out)</pre>
<div class="block">Sets the stream to which debug information shall be printed.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>out</code> - the stream to which debug information shall be written; maybe
          <code>null</code> for disabling debug output</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString()</pre>
<div class="block">Returns a string representation of this response generator.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>toString</code>&nbsp;in class&nbsp;<code>java.lang.Object</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the String representation</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
					
			<small>This Javadoc may contain text parts from IETF Internet Standard specifications (see <a href=../../../../RefCopyright_javadoc.html#RFC>copyright</a> note) and RSA Data Security Public-Key Cryptography Standards (PKCS, see <a href=../../../../RefCopyright_javadoc.html#PKCS>copyright</a> note).</small>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../iaik/x509/ocsp/utils/TrustedResponders.html" title="class in iaik.x509.ocsp.utils"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?iaik/x509/ocsp/utils/ResponseGenerator.html" target="_top">Frames</a></li>
<li><a href="ResponseGenerator.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
					
			
			<table cellpadding=10>
			<tr>
				<td align=left>
					<img src=../../../../siclogo.jpg>
					</td>
					<td align=center>
						5.3<br>
						(c) 2002 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>IAIK</a>, (c) 2003 - 2015 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>SIC</a>
						</td>
						<td align=right>
							<img src=../../../../iaik_logo.gif>
							</td>
						</tr>
					</table>
			
		
				</small></p>
</body>
</html>
