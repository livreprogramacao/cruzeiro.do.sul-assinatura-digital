<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Mon Dec 21 16:59:17 CET 2015 -->
<title>PKCS7Demo (5.3 API Documentation)</title>
<meta name="date" content="2015-12-21">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PKCS7Demo (5.3 API Documentation)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
			
			<b>IAIK-JCE Provider API Documentation</b>
		<br>
			<font size=-1>Version 5.3</font>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../demo/pkcs/PKCS7.html" title="class in demo.pkcs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../demo/pkcs/PKCS8.html" title="class in demo.pkcs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?demo/pkcs/PKCS7Demo.html" target="_top">Frames</a></li>
<li><a href="PKCS7Demo.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">demo.pkcs</div>
<h2 title="Class PKCS7Demo" class="title">Class PKCS7Demo</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>demo.pkcs.PKCS7Demo</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../demo/IAIKDemo.html" title="interface in demo">IAIKDemo</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">PKCS7Demo</span>
extends java.lang.Object
implements <a href="../../demo/IAIKDemo.html" title="interface in demo">IAIKDemo</a></pre>
<div class="block">This class shows some PKCS#7 examples and uses the stream interface for
 processing large amounts of data.
 <p>
 All keys and certificates are read from a keystore created by the
 SetupKeyStore program.
 <p>
 This class tests the following PKCS#7 content type implementations:
 <p>
 <ul>
 <li>EnvelopedData
 <li>SignedData including the message
 <li>SignedData without message
 <li>SignedAndEnvelopedData
 </ul>
 <p>
 Additionally, a <i>SignedAndEncryptedData</i> test is performed, which is a
 sequential combination of signed and enveloped data and should be prefered to
 the <code>SignedAndEnvelopedData</code> content type.
 <p>
 All sub-tests use the same proceeding: A test message is properly processed
 to give the requested content type object, which subsequently is DER encoded
 to be "sent" to some recipient, who parses it for the inherent structures.</div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>File Revision <!-- $$Revision: --> 26 <!-- $ --></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#PKCS7Demo()">PKCS7Demo</a></strong>()</code>
<div class="block">Setup the demo certificate chains.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createData(byte[])">createData</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a PKCS#7 <code>Data</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createDataStream(byte[])">createDataStream</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a PKCS#7 <code>Data</code> object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createDigestedData(byte[])">createDigestedData</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a PKCS#7 <code>DigestedData</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createDigestedData(byte[], int)">createDigestedData</a></strong>(byte[]&nbsp;message,
                  int&nbsp;mode)</code>
<div class="block">Creates a PKCS#7 <code>DigestedData</code> object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createDigestedDataStream(byte[], int)">createDigestedDataStream</a></strong>(byte[]&nbsp;message,
                        int&nbsp;mode)</code>
<div class="block">Creates a PKCS#7 <code>DigestedData</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createEncryptedData(byte[], iaik.asn1.structures.AlgorithmID, char[])">createEncryptedData</a></strong>(byte[]&nbsp;message,
                   iaik.asn1.structures.AlgorithmID&nbsp;pbeAlgorithm,
                   char[]&nbsp;password)</code>
<div class="block">Creates a PKCS#7 <code>EncryptedData</code> message.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createEncryptedDataStream(byte[], iaik.asn1.structures.AlgorithmID, char[])">createEncryptedDataStream</a></strong>(byte[]&nbsp;message,
                         iaik.asn1.structures.AlgorithmID&nbsp;pbeAlgorithm,
                         char[]&nbsp;password)</code>
<div class="block">Creates a PKCS#7 <code>EncryptedDataStream</code> message.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createEnvelopedData(byte[])">createEnvelopedData</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a PKCS#7 <code>EnvelopedData</code> message.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createEnvelopedDataStream(byte[])">createEnvelopedDataStream</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a PKCS#7 <code>EnvelopedDataStream</code> message.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createSignedAndEncryptedData(byte[])">createSignedAndEncryptedData</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a <i>SignedAndEncrypted</i> (i.e.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createSignedAndEncryptedDataStream(byte[])">createSignedAndEncryptedDataStream</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a <i>SignedAndEncrypted</i> (i.e.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createSignedAndEnvelopedData(byte[])">createSignedAndEnvelopedData</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a PKCS#7 <code>SignedAndEnvelopedData</code> object for one
 recipient signed by one signer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createSignedAndEnvelopedDataStream(byte[])">createSignedAndEnvelopedDataStream</a></strong>(byte[]&nbsp;message)</code>
<div class="block">Creates a PKCS#7 <code>SignedAndEnvelopedData</code> object for one
 recipient signed by one signer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>iaik.asn1.ASN1Object</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createSignedData(byte[], int)">createSignedData</a></strong>(byte[]&nbsp;message,
                int&nbsp;mode)</code>
<div class="block">Creates a PKCS#7 <code>SignedData</code> object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#createSignedDataStream(byte[], int)">createSignedDataStream</a></strong>(byte[]&nbsp;message,
                      int&nbsp;mode)</code>
<div class="block">Creates a PKCS#7 <code>SignedData</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getData(iaik.asn1.ASN1Object)">getData</a></strong>(iaik.asn1.ASN1Object&nbsp;asn1Object)</code>
<div class="block">Parses a PKCS#7 <code>Data</code> object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getDataStream(byte[])">getDataStream</a></strong>(byte[]&nbsp;data)</code>
<div class="block">Parses a PKCS#7 <code>Data</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getDigestedData(iaik.asn1.ASN1Object)">getDigestedData</a></strong>(iaik.asn1.ASN1Object&nbsp;asn1Obj)</code>
<div class="block">Parses a PKCS#7 <code>DigestedData</code> object and verifies the hash.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getDigestedData(iaik.asn1.ASN1Object, byte[])">getDigestedData</a></strong>(iaik.asn1.ASN1Object&nbsp;obj,
               byte[]&nbsp;message)</code>
<div class="block">Parses a PKCS#7 <code>DigestedData</code> object and verifies the hash
 value.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getDigestedDataStream(byte[], byte[])">getDigestedDataStream</a></strong>(byte[]&nbsp;digestedData,
                     byte[]&nbsp;message)</code>
<div class="block">Parses a PKCS#7 <code>DigestedData</code> object and verifies the hash.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getEncryptedData(iaik.asn1.ASN1Object, char[])">getEncryptedData</a></strong>(iaik.asn1.ASN1Object&nbsp;asn1Object,
                char[]&nbsp;password)</code>
<div class="block">Decrypts the PBE-encrypted content of the given <code>EncryptedData</code>
 object using the specified password and returns the decrypted (= original)
 message.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getEncryptedDataStream(byte[], char[])">getEncryptedDataStream</a></strong>(byte[]&nbsp;encoding,
                      char[]&nbsp;password)</code>
<div class="block">Decrypts the PBE-encrypted content of the given <code>EncryptedData</code>
 object using the specified password and returns the decrypted (= original)
 message.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getEnvelopedData(iaik.asn1.ASN1Object, java.security.PrivateKey, int)">getEnvelopedData</a></strong>(iaik.asn1.ASN1Object&nbsp;obj,
                java.security.PrivateKey&nbsp;privateKey,
                int&nbsp;recipientInfoIndex)</code>
<div class="block">Decrypts the encrypted content of the given <code>EnvelopedData</code>
 object for the specified recipient and returns the decrypted (= original)
 message.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getEnvelopedDataStream(byte[], java.security.PrivateKey, int)">getEnvelopedDataStream</a></strong>(byte[]&nbsp;encoding,
                      java.security.PrivateKey&nbsp;privateKey,
                      int&nbsp;recipientInfoIndex)</code>
<div class="block">Decrypts the encrypted content of the given EnvelopedData object for the
 specified recipient and returns the decrypted (= original) message.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getSignedAndEncryptedData(iaik.asn1.ASN1Object)">getSignedAndEncryptedData</a></strong>(iaik.asn1.ASN1Object&nbsp;obj)</code>
<div class="block">Recovers the original message and verifies the signature.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getSignedAndEncryptedDataStream(byte[])">getSignedAndEncryptedDataStream</a></strong>(byte[]&nbsp;in)</code>
<div class="block">Recovers the original message and verifies the signature.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getSignedAndEnvelopedData(iaik.asn1.ASN1Object)">getSignedAndEnvelopedData</a></strong>(iaik.asn1.ASN1Object&nbsp;obj)</code>
<div class="block">Decrypts the encrypted content of the given <code>SignedAndEnvelopedData
 </code>object and returns the decrypted (= original) message.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getSignedAndEnvelopedDataStream(byte[])">getSignedAndEnvelopedDataStream</a></strong>(byte[]&nbsp;encoding)</code>
<div class="block">Decrypts the encrypted content of the given <code>SignedAndEnvelopedData
 </code>object and returns the decrypted (= original) message.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getSignedData(iaik.asn1.ASN1Object, byte[])">getSignedData</a></strong>(iaik.asn1.ASN1Object&nbsp;obj,
             byte[]&nbsp;message)</code>
<div class="block">Parses a PKCS#7 <code>SignedData</code> object and verifies the signatures
 for all participated signers.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#getSignedDataStream(byte[], byte[])">getSignedDataStream</a></strong>(byte[]&nbsp;signedData,
                   byte[]&nbsp;message)</code>
<div class="block">Parses a PKCS#7 <code>SignedData</code> object and verifies the signatures
 for all participated signers.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#main(java.lang.String[])">main</a></strong>(java.lang.String[]&nbsp;argv)</code>
<div class="block">Starts the PKCS#7 content type implementation tests.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../demo/pkcs/PKCS7Demo.html#start()">start</a></strong>()</code>
<div class="block">Tests the PKCS#7 content type implementations <code>EnvelopedData</code>,
 <code>SignedData</code>, and <code>SignedAndEnvelopedData</code>.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PKCS7Demo()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PKCS7Demo</h4>
<pre>public&nbsp;PKCS7Demo()</pre>
<div class="block">Setup the demo certificate chains.
 
 Keys and certificate are retrieved from the demo KeyStore.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="createDataStream(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;createDataStream(byte[]&nbsp;message)
                        throws iaik.pkcs.PKCSException,
                               java.io.IOException</pre>
<div class="block">Creates a PKCS#7 <code>Data</code> object.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be sent, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoding ContentInfo containing the <code>Data</code>
         object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>Data</code> object cannot be created</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="getDataStream(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;getDataStream(byte[]&nbsp;data)
                     throws iaik.pkcs.PKCSException,
                            java.io.IOException</pre>
<div class="block">Parses a PKCS#7 <code>Data</code> object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>data</code> - the DER encoded ContentInfo holding the <code>Data</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>data</code> object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an IOException occurs</dd>
<dd><code>iaik.pkcs.PKCSException</code> - if an parsing exception occurs</dd></dl>
</li>
</ul>
<a name="createEnvelopedDataStream(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createEnvelopedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;createEnvelopedDataStream(byte[]&nbsp;message)
                                 throws iaik.pkcs.PKCSException,
                                        java.io.IOException</pre>
<div class="block">Creates a PKCS#7 <code>EnvelopedDataStream</code> message.
 <p>
 The enveloped-data content type consists of encrypted content of any type
 and encrypted content-encryption keys for one or more recipients. The
 combination of encrypted content and encrypted content-encryption key for a
 recipient is a "digital envelope" for that recipient. Any type of content
 can be enveloped for any number of recipients in parallel.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be enveloped, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoded ContentInfo containing the EnvelopedData object
         just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>EnvelopedData</code> object cannot be created</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="getEnvelopedDataStream(byte[], java.security.PrivateKey, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEnvelopedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;getEnvelopedDataStream(byte[]&nbsp;encoding,
                            java.security.PrivateKey&nbsp;privateKey,
                            int&nbsp;recipientInfoIndex)
                              throws iaik.pkcs.PKCSException,
                                     java.io.IOException</pre>
<div class="block">Decrypts the encrypted content of the given EnvelopedData object for the
 specified recipient and returns the decrypted (= original) message.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>encoding</code> - the DER encoded ContentInfo containing an EnvelopedData object</dd><dd><code>privateKey</code> - the private key to decrypt the message</dd><dd><code>recipientInfoIndex</code> - the index into the <code>RecipientInfo</code> array to which the
          specified private key belongs</dd>
<dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createSignedDataStream(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSignedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;createSignedDataStream(byte[]&nbsp;message,
                            int&nbsp;mode)
                              throws iaik.pkcs.PKCSException,
                                     java.io.IOException</pre>
<div class="block">Creates a PKCS#7 <code>SignedData</code> object.
 <p>
 The signed-data content type consists of content of any type and encrypted
 message digests of the content for zero or more signers. The encrypted
 digest for a signer is a "digital signature" on the content for that
 signer. Any type of content can be signed by any number of signers in
 parallel. Furthermore, the syntax has a degenerate case in which there are
 no signers on the content. The degenerate case provides a means for
 disseminating certificates and certificate-revocation lists.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoding of the ContentInfo holding the
         <code>SignedData</code> object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>SignedData</code> object cannot be created</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="getSignedDataStream(byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSignedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;getSignedDataStream(byte[]&nbsp;signedData,
                         byte[]&nbsp;message)
                           throws iaik.pkcs.PKCSException,
                                  java.io.IOException</pre>
<div class="block">Parses a PKCS#7 <code>SignedData</code> object and verifies the signatures
 for all participated signers.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>signedData</code> - the ContentInfo with inherent SignedData, as DER encoded byte
          array</dd><dd><code>message</code> - the message which was transmitted out-of-band (explicit signed)</dd>
<dt><span class="strong">Returns:</span></dt><dd>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>SignedData</code>
         object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if any signature does not verify</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createSignedAndEnvelopedDataStream(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSignedAndEnvelopedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;createSignedAndEnvelopedDataStream(byte[]&nbsp;message)
                                          throws iaik.pkcs.PKCSException,
                                                 java.io.IOException</pre>
<div class="block">Creates a PKCS#7 <code>SignedAndEnvelopedData</code> object for one
 recipient signed by one signer.
 <p>
 The signed-and-enveloped-data content type consists of encrypted content of
 any type, encrypted content-encryption keys for one or more recipients, and
 doubly encrypted message digests for one or more signers. The "double
 encryption" consists of an encryption with a signer's private key followed
 by an encryption with the content-encryption key.
 <p>
 The combination of encrypted content and encrypted content-encryption key
 for a recipient is a "digital envelope" for that recipient. The recovered
 singly encrypted message digest for a signer is a "digital signature" on
 the recovered content for that signer. Any type of content can be enveloped
 for any number of recipients and signed by any number of signers in
 parallel.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed and enveloped, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoded ContentInfo containing the SignedAndEnvelopedData
         object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>SignedAndEnvelopedData</code> object cannot be
              created</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="getSignedAndEnvelopedDataStream(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSignedAndEnvelopedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;getSignedAndEnvelopedDataStream(byte[]&nbsp;encoding)
                                       throws iaik.pkcs.PKCSException,
                                              java.io.IOException</pre>
<div class="block">Decrypts the encrypted content of the given <code>SignedAndEnvelopedData
 </code>object and returns the decrypted (= original) message.
 <p>
 The <code>SignedAndEnvelopedData</code> is given as DER encoded byte array
 holding an encrypted message for one recipient, signed by one signer. This
 method recovers and returns the original message for the recipient and
 verifies the signature of the signer.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>encoding</code> - the DER encoded ContentInfo containing a SignedAndEnvelopedData
          object</dd>
<dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createSignedAndEncryptedDataStream(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSignedAndEncryptedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;createSignedAndEncryptedDataStream(byte[]&nbsp;message)
                                          throws iaik.pkcs.PKCSException,
                                                 java.io.IOException</pre>
<div class="block">Creates a <i>SignedAndEncrypted</i> (i.e. sequential combination of <code>
 SignedData</code> and <code>EnvelopedData</code>) object as suggested in
 the <a href = http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/> PKCS#7</a>
 specification.
 <p>
 <b>PKCS#7 specification:</b>
 <p>
 <i>Note. The signed-and-enveloped-data content type provides cryptographic
 enhancements similar to those resulting from the sequential combination of
 signed-data and enveloped-data content types. However, since the
 signed-and-enveloped-data content type does not have authenticated or
 unauthenticated attributes, nor does it provide enveloping of signer
 information other than the signature, the sequential combination of
 signed-data and enveloped-data content types is generally preferable to the
 SignedAndEnvelopedData content type, except when compatibility with the
 ENCRYPTED process type in Privacy-Enhanced Mail is intended. </i></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed and encrypted, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoded ContentInfo holding the the signed and encrypted
         message object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the the <code>SignedData</code> or
              <code>EnvelopedData</code> object cannot be created</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="getSignedAndEncryptedDataStream(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSignedAndEncryptedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;getSignedAndEncryptedDataStream(byte[]&nbsp;in)
                                       throws iaik.pkcs.PKCSException,
                                              java.io.IOException</pre>
<div class="block">Recovers the original message and verifies the signature.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createDigestedDataStream(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createDigestedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;createDigestedDataStream(byte[]&nbsp;message,
                              int&nbsp;mode)
                                throws iaik.pkcs.PKCSException,
                                       java.io.IOException</pre>
<div class="block">Creates a PKCS#7 <code>DigestedData</code> object.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be digested, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoded ContentInfo containing the DigestedData object just
         created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>DigestedData</code> object cannot be created</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="getDigestedDataStream(byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;getDigestedDataStream(byte[]&nbsp;digestedData,
                           byte[]&nbsp;message)
                             throws iaik.pkcs.PKCSException,
                                    java.io.IOException</pre>
<div class="block">Parses a PKCS#7 <code>DigestedData</code> object and verifies the hash.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>digestedData</code> - the DER encoded ContentInfo holding a DigestedData object</dd><dd><code>message</code> - the message which was transmitted out-of-band</dd>
<dt><span class="strong">Returns:</span></dt><dd>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>DigestedData</code>
         object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if any signature does not verify</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createEncryptedDataStream(byte[], iaik.asn1.structures.AlgorithmID, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createEncryptedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;createEncryptedDataStream(byte[]&nbsp;message,
                               iaik.asn1.structures.AlgorithmID&nbsp;pbeAlgorithm,
                               char[]&nbsp;password)
                                 throws iaik.pkcs.PKCSException,
                                        java.io.IOException</pre>
<div class="block">Creates a PKCS#7 <code>EncryptedDataStream</code> message.
 <p>
 The supplied content is PBE-encrypted using the specified password.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be encrypted, as byte representation</dd><dd><code>pbeAlgorithm</code> - the PBE algorithm to be used</dd><dd><code>password</code> - the password</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoding of the ContentInfo holding the
         <code>EncryptedData</code> object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>EncryptedData</code> object cannot be created</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="getEncryptedDataStream(byte[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEncryptedDataStream</h4>
<pre>public&nbsp;byte[]&nbsp;getEncryptedDataStream(byte[]&nbsp;encoding,
                            char[]&nbsp;password)
                              throws iaik.pkcs.PKCSException,
                                     java.io.IOException</pre>
<div class="block">Decrypts the PBE-encrypted content of the given <code>EncryptedData</code>
 object using the specified password and returns the decrypted (= original)
 message.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>encoding</code> - the DER encoded ContentInfo holding an <code>EncryptedData</code>
          object</dd><dd><code>password</code> - the password to decrypt the message</dd>
<dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createData(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createData(byte[]&nbsp;message)
                                throws iaik.pkcs.PKCSException</pre>
<div class="block">Creates a PKCS#7 <code>Data</code> object.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be sent, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the ASN.1 representation of the ContentInfo holding the
         <code>Data</code> object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>Data</code> object cannot be created</dd></dl>
</li>
</ul>
<a name="getData(iaik.asn1.ASN1Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getData</h4>
<pre>public&nbsp;byte[]&nbsp;getData(iaik.asn1.ASN1Object&nbsp;asn1Object)
               throws iaik.pkcs.PKCSException,
                      java.io.IOException</pre>
<div class="block">Parses a PKCS#7 <code>Data</code> object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>asn1Object</code> - the ContentInfo holding with inherent <code>Data</code>, as ASN.1
          object</dd>
<dt><span class="strong">Returns:</span></dt><dd>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>data</code> object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an IOException occurs</dd>
<dd><code>iaik.pkcs.PKCSException</code> - if an parsing exception occurs</dd></dl>
</li>
</ul>
<a name="createEnvelopedData(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createEnvelopedData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createEnvelopedData(byte[]&nbsp;message)
                                         throws iaik.pkcs.PKCSException</pre>
<div class="block">Creates a PKCS#7 <code>EnvelopedData</code> message.
 <p>
 The enveloped-data content type consists of encrypted content of any type
 and encrypted content-encryption keys for one or more recipients. The
 combination of encrypted content and encrypted content-encryption key for a
 recipient is a "digital envelope" for that recipient. Any type of content
 can be enveloped for any number of recipients in parallel.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be enveloped, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>a DER encoded ContentInfo holding the EnvelopedData object just
         created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>EnvelopedData</code> object cannot be created</dd></dl>
</li>
</ul>
<a name="getEnvelopedData(iaik.asn1.ASN1Object, java.security.PrivateKey, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEnvelopedData</h4>
<pre>public&nbsp;byte[]&nbsp;getEnvelopedData(iaik.asn1.ASN1Object&nbsp;obj,
                      java.security.PrivateKey&nbsp;privateKey,
                      int&nbsp;recipientInfoIndex)
                        throws iaik.pkcs.PKCSException</pre>
<div class="block">Decrypts the encrypted content of the given <code>EnvelopedData</code>
 object for the specified recipient and returns the decrypted (= original)
 message.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the ContentInfo holding an EnvelopedData, as ASN.1 object</dd><dd><code>privateKey</code> - the private key to decrypt the message</dd><dd><code>recipientInfoIndex</code> - the index into the <code>RecipientInfo</code> array to which the
          specified private key belongs</dd>
<dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd></dl>
</li>
</ul>
<a name="createSignedData(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSignedData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createSignedData(byte[]&nbsp;message,
                                    int&nbsp;mode)
                                      throws iaik.pkcs.PKCSException</pre>
<div class="block">Creates a PKCS#7 <code>SignedData</code> object.
 <p>
 The signed-data content type consists of content of any type and encrypted
 message digests of the content for zero or more signers. The encrypted
 digest for a signer is a "digital signature" on the content for that
 signer. Any type of content can be signed by any number of signers in
 parallel. Furthermore, the syntax has a degenerate case in which there are
 no signers on the content. The degenerate case provides a means for
 disseminating certificates and certificate-revocation lists.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoding of the ContentInfo holding the
         <code>SignedData</code> object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>SignedData</code> object cannot be created</dd></dl>
</li>
</ul>
<a name="getSignedData(iaik.asn1.ASN1Object, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSignedData</h4>
<pre>public&nbsp;byte[]&nbsp;getSignedData(iaik.asn1.ASN1Object&nbsp;obj,
                   byte[]&nbsp;message)
                     throws iaik.pkcs.PKCSException,
                            java.io.IOException</pre>
<div class="block">Parses a PKCS#7 <code>SignedData</code> object and verifies the signatures
 for all participated signers.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the ContentInfo with inherent <code>SignedData</code> object, in
          ASN.1 representation</dd><dd><code>message</code> - the the message which was transmitted out-of-band (explicit
          signed)</dd>
<dt><span class="strong">Returns:</span></dt><dd>the inherent message as byte array, or <code>null</code> if there
         is no message included into the supplied <code>SignedData</code>
         object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if any signature does not verify</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createSignedAndEnvelopedData(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSignedAndEnvelopedData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createSignedAndEnvelopedData(byte[]&nbsp;message)
                                                  throws iaik.pkcs.PKCSException</pre>
<div class="block">Creates a PKCS#7 <code>SignedAndEnvelopedData</code> object for one
 recipient signed by one signer.
 <p>
 The signed-and-enveloped-data content type consists of encrypted content of
 any type, encrypted content-encryption keys for one or more recipients, and
 doubly encrypted message digests for one or more signers. The "double
 encryption" consists of an encryption with a signer's private key followed
 by an encryption with the content-encryption key.
 <p>
 The combination of encrypted content and encrypted content-encryption key
 for a recipient is a "digital envelope" for that recipient. The recovered
 singly encrypted message digest for a signer is a "digital signature" on
 the recovered content for that signer. Any type of content can be enveloped
 for any number of recipients and signed by any number of signers in
 parallel.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed and enveloped, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoded ContentInfo holding the SignedAndEnvelopedData
         object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>SignedAndEnvelopedData</code> object cannot be
              created</dd></dl>
</li>
</ul>
<a name="getSignedAndEnvelopedData(iaik.asn1.ASN1Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSignedAndEnvelopedData</h4>
<pre>public&nbsp;byte[]&nbsp;getSignedAndEnvelopedData(iaik.asn1.ASN1Object&nbsp;obj)
                                 throws iaik.pkcs.PKCSException</pre>
<div class="block">Decrypts the encrypted content of the given <code>SignedAndEnvelopedData
 </code>object and returns the decrypted (= original) message.
 <p>
 The <code>SignedAndEnvelopedData</code> is given as DER encoded byte array
 hoding an encrypted message for one recipient, signed by one signer. This
 method recovers and returns the original message for the recipient and
 verifies the signature of the signer.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the ContentInfo holding a SignedAndEnvelopedData object, in ASN.1
          representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd></dl>
</li>
</ul>
<a name="createSignedAndEncryptedData(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSignedAndEncryptedData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createSignedAndEncryptedData(byte[]&nbsp;message)
                                                  throws iaik.pkcs.PKCSException</pre>
<div class="block">Creates a <i>SignedAndEncrypted</i> (i.e. sequential combination of <code>
 SignedData</code> and <code>EnvelopedData</code>) object as suggested in
 the <a href = http://www.rsasecurity.com/rsalabs/pkcs/pkcs-7/> PKCS#7</a>
 specification.
 <p>
 <b>PKCS#7 specification:</b>
 <p>
 <i>Note. The signed-and-enveloped-data content type provides cryptographic
 enhancements similar to those resulting from the sequential combination of
 signed-data and enveloped-data content types. However, since the
 signed-and-enveloped-data content type does not have authenticated or
 unauthenticated attributes, nor does it provide enveloping of signer
 information other than the signature, the sequential combination of
 signed-data and enveloped-data content types is generally preferable to the
 SignedAndEnvelopedData content type, except when compatibility with the
 ENCRYPTED process type in Privacy-Enhanced Mail is intended. </i></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed and encrypted, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the DER encoded ContentInfo holding the signed and encrypted
         message object just created</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the the <code>SignedData</code> or
              <code>EnvelopedData</code> object cannot be created</dd></dl>
</li>
</ul>
<a name="getSignedAndEncryptedData(iaik.asn1.ASN1Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSignedAndEncryptedData</h4>
<pre>public&nbsp;byte[]&nbsp;getSignedAndEncryptedData(iaik.asn1.ASN1Object&nbsp;obj)
                                 throws iaik.pkcs.PKCSException,
                                        java.io.IOException</pre>
<div class="block">Recovers the original message and verifies the signature.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the ContentInfo holding a SignedAndEnryptedData object, in ASN.1
          representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createDigestedData(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createDigestedData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createDigestedData(byte[]&nbsp;message)
                                        throws java.lang.Exception</pre>
<div class="block">Creates a PKCS#7 <code>DigestedData</code> object.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be digested, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the <code>DigestedData</code> wrapped in a ContentInfo, as
         ASN1Object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if the <code>DigestedData</code> object cannot be created</dd></dl>
</li>
</ul>
<a name="getDigestedData(iaik.asn1.ASN1Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestedData</h4>
<pre>public&nbsp;byte[]&nbsp;getDigestedData(iaik.asn1.ASN1Object&nbsp;asn1Obj)
                       throws iaik.pkcs.PKCSException,
                              java.security.NoSuchAlgorithmException</pre>
<div class="block">Parses a PKCS#7 <code>DigestedData</code> object and verifies the hash.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>asn1Obj</code> - the ContentInfo holding a DigestedData object, in ASN.1
          representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the inherent message as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if any signature does not verify</dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd></dl>
</li>
</ul>
<a name="createDigestedData(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createDigestedData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createDigestedData(byte[]&nbsp;message,
                                      int&nbsp;mode)
                                        throws iaik.pkcs.PKCSException</pre>
<div class="block">Creates a PKCS#7 <code>DigestedData</code> object.
 <p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be digested, as byte representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the <code>DigestedData</code> wrapped into a ContentInfo, as ASN.1
         object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>DigestedData</code> object cannot be created</dd></dl>
</li>
</ul>
<a name="getDigestedData(iaik.asn1.ASN1Object, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestedData</h4>
<pre>public&nbsp;byte[]&nbsp;getDigestedData(iaik.asn1.ASN1Object&nbsp;obj,
                     byte[]&nbsp;message)
                       throws iaik.pkcs.PKCSException,
                              java.io.IOException</pre>
<div class="block">Parses a PKCS#7 <code>DigestedData</code> object and verifies the hash
 value.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the ContentInfo holding a <code>DigestedData</code>, as ASN.1
          object</dd><dd><code>message</code> - the message which was transmitted out-of-band (explicit digested)</dd>
<dt><span class="strong">Returns:</span></dt><dd>the message</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if some parsing exception occurs</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="createEncryptedData(byte[], iaik.asn1.structures.AlgorithmID, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createEncryptedData</h4>
<pre>public&nbsp;iaik.asn1.ASN1Object&nbsp;createEncryptedData(byte[]&nbsp;message,
                                       iaik.asn1.structures.AlgorithmID&nbsp;pbeAlgorithm,
                                       char[]&nbsp;password)
                                         throws iaik.pkcs.PKCSException</pre>
<div class="block">Creates a PKCS#7 <code>EncryptedData</code> message.
 <p>
 The supplied content is PBE-encrypted using the specified password.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be encrypted, as byte representation</dd><dd><code>pbeAlgorithm</code> - the PBE algorithm to be used</dd><dd><code>password</code> - the password</dd>
<dt><span class="strong">Returns:</span></dt><dd>the <code>EncryptedData</code> object wrapped into a ContentInfo,
         as ASN1Object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the <code>EncryptedData</code> object cannot be created</dd></dl>
</li>
</ul>
<a name="getEncryptedData(iaik.asn1.ASN1Object, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEncryptedData</h4>
<pre>public&nbsp;byte[]&nbsp;getEncryptedData(iaik.asn1.ASN1Object&nbsp;asn1Object,
                      char[]&nbsp;password)
                        throws iaik.pkcs.PKCSException</pre>
<div class="block">Decrypts the PBE-encrypted content of the given <code>EncryptedData</code>
 object using the specified password and returns the decrypted (= original)
 message.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>asn1Object</code> - a ContentInfo-ASN1Object holding the <code>EncryptedData</code>
          object</dd><dd><code>password</code> - the password to decrypt the message</dd>
<dt><span class="strong">Returns:</span></dt><dd>the recovered message, as byte array</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>iaik.pkcs.PKCSException</code> - if the message cannot be recovered</dd></dl>
</li>
</ul>
<a name="start()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>public&nbsp;void&nbsp;start()</pre>
<div class="block">Tests the PKCS#7 content type implementations <code>EnvelopedData</code>,
 <code>SignedData</code>, and <code>SignedAndEnvelopedData</code>. An
 additional <i>SignedAndEncryptedData</i> test sequentially combines signed
 and enveloped data, which should be prefered to the
 <code>SignedAndEnvelopedData</code> content type.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../demo/IAIKDemo.html#start()">start</a></code>&nbsp;in interface&nbsp;<code><a href="../../demo/IAIKDemo.html" title="interface in demo">IAIKDemo</a></code></dd>
</dl>
</li>
</ul>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;argv)</pre>
<div class="block">Starts the PKCS#7 content type implementation tests.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
					
					
			<small>This Javadoc may contain text parts from IETF Internet Standard specifications (see <a href=../../RefCopyright_javadoc.html#RFC>copyright</a> note) and RSA Data Security Public-Key Cryptography Standards (PKCS, see <a href=../../RefCopyright_javadoc.html#PKCS>copyright</a> note).</small>
			
		
				</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../demo/pkcs/PKCS7.html" title="class in demo.pkcs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../demo/pkcs/PKCS8.html" title="class in demo.pkcs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?demo/pkcs/PKCS7Demo.html" target="_top">Frames</a></li>
<li><a href="PKCS7Demo.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
					
			
			<table cellpadding=10>
			<tr>
				<td align=left>
					<img src=../../siclogo.jpg>
					</td>
					<td align=center>
						5.3<br>
						(c) 2002 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>IAIK</a>, (c) 2003 - 2015 
						<a href=http://jce.iaik.tugraz.at/ target=_blank>SIC</a>
						</td>
						<td align=right>
							<img src=../../iaik_logo.gif>
							</td>
						</tr>
					</table>
			
		
				</small></p>
</body>
</html>
