<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_45) on Fri Dec 02 13:53:31 CET 2016 -->
<title>TimeStampTokenUtil</title>
<meta name="date" content="2016-12-02">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TimeStampTokenUtil";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9,"i8":9,"i9":9,"i10":9,"i11":9,"i12":9,"i13":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">
				
					<b>IAIK [CP]AdES Toolkit API Documentation</b>
					<br>
					<font size="-1">Version 2.2</font>
				
			</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/pdf/cmscades/SignatureTimestampEncodeListener.html" title="class in iaik.pdf.cmscades"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/pdf/cmscades/TimeStampTokenUtil.html" target="_top">Frames</a></li>
<li><a href="TimeStampTokenUtil.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">iaik.pdf.cmscades</div>
<h2 title="Class TimeStampTokenUtil" class="title">Class TimeStampTokenUtil</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>iaik.pdf.cmscades.TimeStampTokenUtil</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">TimeStampTokenUtil</span>
extends java.lang.Object</pre>
<div class="block">Provides methods to create and verify time stamps.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#DEFAULTDIGESTALGORITHM">DEFAULTDIGESTALGORITHM</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#TimeStampTokenUtil--">TimeStampTokenUtil</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getDigestValue-byte:A-">getDigestValue</a></span>(byte[]&nbsp;dataToBeTimestamped)</code>
<div class="block">Calculates the digest value for the given data using the default digest algorithm SHA-256.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getDigestValue-byte:A-java.lang.String-">getDigestValue</a></span>(byte[]&nbsp;dataToBeTimestamped,
              java.lang.String&nbsp;digestAlgorithm)</code>
<div class="block">Calculates the digest value for the given data using the specified digest algorithm.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getDigestValue-java.io.InputStream-">getDigestValue</a></span>(java.io.InputStream&nbsp;dataToBeTimestamped)</code>
<div class="block">Calculates the digest value for the given data using the default digest algorithm SHA-256.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getDigestValue-java.io.InputStream-java.lang.String-">getDigestValue</a></span>(java.io.InputStream&nbsp;dataToBeTimestamped,
              java.lang.String&nbsp;digestAlgorithm)</code>
<div class="block">Calculates the digest value for the given data using the specified digest algorithm.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static iaik.tsp.TimeStampToken</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getTimeStampToken-byte:A-java.lang.String-">getTimeStampToken</a></span>(byte[]&nbsp;imprint,
                 java.lang.String&nbsp;tsaUrl)</code>
<div class="block">Sends a timestamp request to the given TSA and returns the timestamp token if successful.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static iaik.tsp.TimeStampToken</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getTimeStampToken-byte:A-java.lang.String-java.lang.String-java.lang.String-java.lang.String-">getTimeStampToken</a></span>(byte[]&nbsp;imprint,
                 java.lang.String&nbsp;digestAlgorithm,
                 java.lang.String&nbsp;tsaUrl,
                 java.lang.String&nbsp;username,
                 java.lang.String&nbsp;password)</code>
<div class="block">Sends a timestamp request to the given TSA and returns the timestamp token if successful.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>static iaik.tsp.TimeStampToken</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getTimeStampTokenWithHashing-byte:A-java.lang.String-">getTimeStampTokenWithHashing</a></span>(byte[]&nbsp;dataToBeTimestamped,
                            java.lang.String&nbsp;tsaUrl)</code>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>static iaik.tsp.TimeStampToken</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getTimeStampTokenWithHashing-byte:A-java.lang.String-java.lang.String-java.lang.String-java.lang.String-">getTimeStampTokenWithHashing</a></span>(byte[]&nbsp;dataToBeTimestamped,
                            java.lang.String&nbsp;digestAlgorithm,
                            java.lang.String&nbsp;tsaUrl,
                            java.lang.String&nbsp;username,
                            java.lang.String&nbsp;password)</code>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>static iaik.tsp.TimeStampToken</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getTimeStampTokenWithHashing-java.io.InputStream-java.lang.String-">getTimeStampTokenWithHashing</a></span>(java.io.InputStream&nbsp;dataToBeTimestamped,
                            java.lang.String&nbsp;tsaUrl)</code>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>static iaik.tsp.TimeStampToken</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getTimeStampTokenWithHashing-java.io.InputStream-java.lang.String-java.lang.String-java.lang.String-java.lang.String-">getTimeStampTokenWithHashing</a></span>(java.io.InputStream&nbsp;dataToBeTimestamped,
                            java.lang.String&nbsp;digestAlgorithm,
                            java.lang.String&nbsp;tsaUrl,
                            java.lang.String&nbsp;username,
                            java.lang.String&nbsp;password)</code>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#getTsaUrl-iaik.x509.X509Certificate-">getTsaUrl</a></span>(iaik.x509.X509Certificate&nbsp;certificate)</code>
<div class="block">Extract URL to time stamp authority to be used for creating a time stamp for the signature
 time.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#verifyTimestamp-iaik.tsp.TimeStampToken-iaik.x509.X509Certificate-byte:A-">verifyTimestamp</a></span>(iaik.tsp.TimeStampToken&nbsp;token,
               iaik.x509.X509Certificate&nbsp;tsa_cert,
               byte[]&nbsp;data)</code>
<div class="block">Verifies the given timestamp token.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#verifyTimestamp-iaik.tsp.TimeStampToken-iaik.x509.X509Certificate-java.io.InputStream-">verifyTimestamp</a></span>(iaik.tsp.TimeStampToken&nbsp;token,
               iaik.x509.X509Certificate&nbsp;tsa_cert,
               java.io.InputStream&nbsp;data)</code>
<div class="block">Verifies the given timestamp token.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../iaik/pdf/cmscades/TimeStampTokenUtil.html#verifyTimestampNoHashing-iaik.tsp.TimeStampToken-iaik.x509.X509Certificate-byte:A-">verifyTimestampNoHashing</a></span>(iaik.tsp.TimeStampToken&nbsp;token,
                        iaik.x509.X509Certificate&nbsp;tsa_cert,
                        byte[]&nbsp;hashedData)</code>
<div class="block">Verifies the given timestamp token.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEFAULTDIGESTALGORITHM">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEFAULTDIGESTALGORITHM</h4>
<pre>public static final&nbsp;java.lang.String DEFAULTDIGESTALGORITHM</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#iaik.pdf.cmscades.TimeStampTokenUtil.DEFAULTDIGESTALGORITHM">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TimeStampTokenUtil--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TimeStampTokenUtil</h4>
<pre>public&nbsp;TimeStampTokenUtil()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getTimeStampToken-byte:A-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStampToken</h4>
<pre>public static&nbsp;iaik.tsp.TimeStampToken&nbsp;getTimeStampToken(byte[]&nbsp;imprint,
                                                        java.lang.String&nbsp;tsaUrl)
                                                 throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                                        iaik.tsp.TspVerificationException</pre>
<div class="block">Sends a timestamp request to the given TSA and returns the timestamp token if successful.
 Assumes that imprint has been calculated using default hash algorithm SHA-256.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imprint</code> - the data imprint (already hashed) to be timestamped</dd>
<dd><code>tsaUrl</code> - the URL to the timestamp authority to send the request to</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the timestamp token</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if the timestamp request can't be sent or the response is not valid</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
</dl>
</li>
</ul>
<a name="getTimeStampToken-byte:A-java.lang.String-java.lang.String-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStampToken</h4>
<pre>public static&nbsp;iaik.tsp.TimeStampToken&nbsp;getTimeStampToken(byte[]&nbsp;imprint,
                                                        java.lang.String&nbsp;digestAlgorithm,
                                                        java.lang.String&nbsp;tsaUrl,
                                                        java.lang.String&nbsp;username,
                                                        java.lang.String&nbsp;password)
                                                 throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                                        iaik.tsp.TspVerificationException</pre>
<div class="block">Sends a timestamp request to the given TSA and returns the timestamp token if successful.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imprint</code> - the data imprint (already hashed) to be timestamped</dd>
<dd><code>digestAlgorithm</code> - the digest algorithm that has been used to create the given imprint</dd>
<dd><code>tsaUrl</code> - the URL to the timestamp authority to send the request to</dd>
<dd><code>username</code> - username for authentication at the timestamp authority</dd>
<dd><code>password</code> - password for authentication at the timestamp authority</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the timestamp token</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if the timestamp request can't be sent or the response is not valid</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
</dl>
</li>
</ul>
<a name="getTimeStampTokenWithHashing-byte:A-java.lang.String-java.lang.String-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStampTokenWithHashing</h4>
<pre>public static&nbsp;iaik.tsp.TimeStampToken&nbsp;getTimeStampTokenWithHashing(byte[]&nbsp;dataToBeTimestamped,
                                                                   java.lang.String&nbsp;digestAlgorithm,
                                                                   java.lang.String&nbsp;tsaUrl,
                                                                   java.lang.String&nbsp;username,
                                                                   java.lang.String&nbsp;password)
                                                            throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                                                   iaik.tsp.TspVerificationException,
                                                                   java.security.NoSuchAlgorithmException</pre>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be hashed and timestamped</dd>
<dd><code>digestAlgorithm</code> - the digest algorithm that has been used to create the given imprint</dd>
<dd><code>tsaUrl</code> - the URL to the timestamp authority to send the request to</dd>
<dd><code>username</code> - username for authentication at the timestamp authority</dd>
<dd><code>password</code> - password for authentication at the timestamp authority</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the timestamp token</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if the timestamp request can't be sent or the response is not valid</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the given digest algorithm is unknown</dd>
</dl>
</li>
</ul>
<a name="getTimeStampTokenWithHashing-byte:A-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStampTokenWithHashing</h4>
<pre>public static&nbsp;iaik.tsp.TimeStampToken&nbsp;getTimeStampTokenWithHashing(byte[]&nbsp;dataToBeTimestamped,
                                                                   java.lang.String&nbsp;tsaUrl)
                                                            throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                                                   iaik.tsp.TspVerificationException,
                                                                   java.security.NoSuchAlgorithmException</pre>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be hashed and timestamped</dd>
<dd><code>tsaUrl</code> - the URL to the timestamp authority to send the request to</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the timestamp token</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if the timestamp request can't be sent or the response is not valid</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the given digest algorithm is unknown</dd>
</dl>
</li>
</ul>
<a name="getTimeStampTokenWithHashing-java.io.InputStream-java.lang.String-java.lang.String-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStampTokenWithHashing</h4>
<pre>public static&nbsp;iaik.tsp.TimeStampToken&nbsp;getTimeStampTokenWithHashing(java.io.InputStream&nbsp;dataToBeTimestamped,
                                                                   java.lang.String&nbsp;digestAlgorithm,
                                                                   java.lang.String&nbsp;tsaUrl,
                                                                   java.lang.String&nbsp;username,
                                                                   java.lang.String&nbsp;password)
                                                            throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                                                   iaik.tsp.TspVerificationException,
                                                                   java.security.NoSuchAlgorithmException,
                                                                   java.io.IOException</pre>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be hashed and timestamped</dd>
<dd><code>digestAlgorithm</code> - the digest algorithm that has been used to create the given imprint</dd>
<dd><code>tsaUrl</code> - the URL to the timestamp authority to send the request to</dd>
<dd><code>username</code> - username for authentication at the timestamp authority</dd>
<dd><code>password</code> - password for authentication at the timestamp authority</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the timestamp token</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if the timestamp request can't be sent or the response is not valid</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the given digest algorithm is unknown</dd>
<dd><code>java.io.IOException</code> - if the data can't be read</dd>
</dl>
</li>
</ul>
<a name="getTimeStampTokenWithHashing-java.io.InputStream-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStampTokenWithHashing</h4>
<pre>public static&nbsp;iaik.tsp.TimeStampToken&nbsp;getTimeStampTokenWithHashing(java.io.InputStream&nbsp;dataToBeTimestamped,
                                                                   java.lang.String&nbsp;tsaUrl)
                                                            throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                                                   iaik.tsp.TspVerificationException,
                                                                   java.security.NoSuchAlgorithmException,
                                                                   java.io.IOException</pre>
<div class="block">Hashes the given data, sends a timestamp request for the resulting imprint to the given TSA and
 returns the timestamp token if successful.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be hashed and timestamped</dd>
<dd><code>tsaUrl</code> - the URL to the timestamp authority to send the request to</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the timestamp token</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if the timestamp request can't be sent or the response is not valid</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the given digest algorithm is unknown</dd>
<dd><code>java.io.IOException</code> - if the data can't be read</dd>
</dl>
</li>
</ul>
<a name="getDigestValue-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestValue</h4>
<pre>public static&nbsp;byte[]&nbsp;getDigestValue(byte[]&nbsp;dataToBeTimestamped)
                             throws java.security.NoSuchAlgorithmException</pre>
<div class="block">Calculates the digest value for the given data using the default digest algorithm SHA-256.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be digested for the timestamp</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>digest of the given data</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the default digest algorithm is not available</dd>
</dl>
</li>
</ul>
<a name="getDigestValue-byte:A-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestValue</h4>
<pre>public static&nbsp;byte[]&nbsp;getDigestValue(byte[]&nbsp;dataToBeTimestamped,
                                    java.lang.String&nbsp;digestAlgorithm)
                             throws java.security.NoSuchAlgorithmException</pre>
<div class="block">Calculates the digest value for the given data using the specified digest algorithm.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be digested for the timestamp</dd>
<dd><code>digestAlgorithm</code> - the digest algorithm, that shall be used</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>digest of the given data</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the given digest algorithm is unknown</dd>
</dl>
</li>
</ul>
<a name="getDigestValue-java.io.InputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestValue</h4>
<pre>public static&nbsp;byte[]&nbsp;getDigestValue(java.io.InputStream&nbsp;dataToBeTimestamped)
                             throws java.security.NoSuchAlgorithmException,
                                    java.io.IOException</pre>
<div class="block">Calculates the digest value for the given data using the default digest algorithm SHA-256.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be digested for the timestamp</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>digest of the given data</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the default digest algorithm is not available</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd>
</dl>
</li>
</ul>
<a name="getDigestValue-java.io.InputStream-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestValue</h4>
<pre>public static&nbsp;byte[]&nbsp;getDigestValue(java.io.InputStream&nbsp;dataToBeTimestamped,
                                    java.lang.String&nbsp;digestAlgorithm)
                             throws java.security.NoSuchAlgorithmException,
                                    java.io.IOException</pre>
<div class="block">Calculates the digest value for the given data using the specified digest algorithm.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataToBeTimestamped</code> - data to be digested for the timestamp</dd>
<dd><code>digestAlgorithm</code> - the digest algorithm, that shall be used</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>digest of the given data</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code> - if the given digest algorithm is unknown</dd>
<dd><code>java.io.IOException</code> - if an I/O error occurs</dd>
</dl>
</li>
</ul>
<a name="verifyTimestamp-iaik.tsp.TimeStampToken-iaik.x509.X509Certificate-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyTimestamp</h4>
<pre>public static&nbsp;void&nbsp;verifyTimestamp(iaik.tsp.TimeStampToken&nbsp;token,
                                   iaik.x509.X509Certificate&nbsp;tsa_cert,
                                   byte[]&nbsp;data)
                            throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                   iaik.tsp.TspVerificationException</pre>
<div class="block">Verifies the given timestamp token. Verifies the signature value and whether the message
 imprint corresponds with the digest of the given data. No certificate path validation is done.
 
 To verify the signature value the given TSA certificate is used. If the given TSA certificate
 is null and this timestamp contains the corresponding TSA certificate, the included TSA
 certificate is used.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>token</code> - the timestamp token to be verified</dd>
<dd><code>tsa_cert</code> - certificate of the time stamp authority to verify the signature value</dd>
<dd><code>data</code> - data, claimed to be timestamped</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if timestamped data has been changed or tsa certificate is missing</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
</dl>
</li>
</ul>
<a name="verifyTimestamp-iaik.tsp.TimeStampToken-iaik.x509.X509Certificate-java.io.InputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyTimestamp</h4>
<pre>public static&nbsp;void&nbsp;verifyTimestamp(iaik.tsp.TimeStampToken&nbsp;token,
                                   iaik.x509.X509Certificate&nbsp;tsa_cert,
                                   java.io.InputStream&nbsp;data)
                            throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                   iaik.tsp.TspVerificationException,
                                   java.io.IOException</pre>
<div class="block">Verifies the given timestamp token. Verifies the signature value and whether the message
 imprint corresponds with the digest of the given data. No certificate path validation is done.
 
 To verify the signature value the given TSA certificate is used. If the given TSA certificate
 is null and this timestamp contains the corresponding TSA certificate, the included TSA
 certificate is used.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>token</code> - the timestamp token to be verified</dd>
<dd><code>tsa_cert</code> - certificate of the time stamp authority to verify the signature value</dd>
<dd><code>data</code> - data, claimed to be timestamped</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if timestamped data has been changed or tsa certificate is missing</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
<dd><code>java.io.IOException</code> - if data stream can't be read</dd>
</dl>
</li>
</ul>
<a name="verifyTimestampNoHashing-iaik.tsp.TimeStampToken-iaik.x509.X509Certificate-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyTimestampNoHashing</h4>
<pre>public static&nbsp;void&nbsp;verifyTimestampNoHashing(iaik.tsp.TimeStampToken&nbsp;token,
                                            iaik.x509.X509Certificate&nbsp;tsa_cert,
                                            byte[]&nbsp;hashedData)
                                     throws <a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a>,
                                            iaik.tsp.TspVerificationException</pre>
<div class="block">Verifies the given timestamp token. Verifies the signature value and whether the message
 imprint corresponds with the given expected imprint. No certificate path validation is done.
 
 To verify the signature value the given TSA certificate is used. If the given TSA certificate
 is null and this timestamp contains the corresponding TSA certificate, the included TSA
 certificate is used.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>token</code> - the timestamp token to be verified</dd>
<dd><code>tsa_cert</code> - certificate of the time stamp authority to verify the signature value</dd>
<dd><code>hashedData</code> - imprint (hash) of the data, claimed to be timestamped</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../iaik/pdf/cmscades/CmsCadesException.html" title="class in iaik.pdf.cmscades">CmsCadesException</a></code> - if timestamped data has been changed or tsa certificate is missing</dd>
<dd><code>iaik.tsp.TspVerificationException</code> - if signature of timestamp token is invalid or an parsing error occurs</dd>
</dl>
</li>
</ul>
<a name="getTsaUrl-iaik.x509.X509Certificate-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getTsaUrl</h4>
<pre>public static&nbsp;java.lang.String&nbsp;getTsaUrl(iaik.x509.X509Certificate&nbsp;certificate)
                                  throws java.security.GeneralSecurityException</pre>
<div class="block">Extract URL to time stamp authority to be used for creating a time stamp for the signature
 time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>certificate</code> - certificate to extract the URL from</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>URL to the time stamp authority if included in certificate or null</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.GeneralSecurityException</code> - if the URL can't be extracted</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">
				
					<b>IAIK [CP]AdES Toolkit API Documentation</b>
					<br>
					<font size="-1">Version 2.2</font>
				
			</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../iaik/pdf/cmscades/SignatureTimestampEncodeListener.html" title="class in iaik.pdf.cmscades"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?iaik/pdf/cmscades/TimeStampTokenUtil.html" target="_top">Frames</a></li>
<li><a href="TimeStampTokenUtil.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
				
				<table cellpadding="10">
					<tr>
						<td align="left">
							<img src="../../../siclogo.jpg">
						</td>
						<td align="center">
							2.2<br>
							(c) 2002 
							<a href="http://jce.iaik.tugraz.at/" target="_blank">IAIK</a>, (c) 2003 - 2016 
							<a href="http://jce.iaik.tugraz.at/" target="_blank">SIC</a>
						</td>
						<td align="right">
							<img src="../../../iaik_logo.gif">
						</td>
					</tr>
				</table>
				
			</small></p>
</body>
</html>
